#ifdef __GNUC__
#pragma GCC diagnostic ignored "-Wunused-function"
#pragma GCC diagnostic ignored "-Wunused-variable"
#pragma GCC diagnostic ignored "-Wparentheses"
#pragma GCC diagnostic ignored "-Wunused-label"
#endif
#ifdef __clang__
#pragma clang diagnostic ignored "-Wunused-function"
#pragma clang diagnostic ignored "-Wunused-variable"
#pragma clang diagnostic ignored "-Wparentheses"
#pragma clang diagnostic ignored "-Wunused-label"
#endif
// Headers

#define _GNU_SOURCE
#include <stdint.h>
#include <stddef.h>
#include <stdbool.h>
#include <float.h>
#include <cuda.h>
#include <cuda_runtime.h>
#include <nvrtc.h>


// Initialisation

int futhark_get_num_sizes(void);
const char *futhark_get_size_name(int);
const char *futhark_get_size_class(int);
struct futhark_context_config ;
struct futhark_context_config *futhark_context_config_new(void);
void futhark_context_config_free(struct futhark_context_config *cfg);
void futhark_context_config_add_nvrtc_option(struct futhark_context_config *cfg,
                                             const char *opt);
void futhark_context_config_set_debugging(struct futhark_context_config *cfg,
                                          int flag);
void futhark_context_config_set_profiling(struct futhark_context_config *cfg,
                                          int flag);
void futhark_context_config_set_logging(struct futhark_context_config *cfg,
                                        int flag);
void futhark_context_config_set_device(struct futhark_context_config *cfg, const
                                       char *s);
void futhark_context_config_dump_program_to(struct futhark_context_config *cfg,
                                            const char *path);
void
futhark_context_config_load_program_from(struct futhark_context_config *cfg,
                                         const char *path);
void futhark_context_config_dump_ptx_to(struct futhark_context_config *cfg,
                                        const char *path);
void futhark_context_config_load_ptx_from(struct futhark_context_config *cfg,
                                          const char *path);
void
futhark_context_config_set_default_group_size(struct futhark_context_config *cfg,
                                              int size);
void
futhark_context_config_set_default_num_groups(struct futhark_context_config *cfg,
                                              int num);
void
futhark_context_config_set_default_tile_size(struct futhark_context_config *cfg,
                                             int num);
void
futhark_context_config_set_default_threshold(struct futhark_context_config *cfg,
                                             int num);
int futhark_context_config_set_size(struct futhark_context_config *cfg, const
                                    char *size_name, size_t size_value);
struct futhark_context ;
struct futhark_context *futhark_context_new(struct futhark_context_config *cfg);
void futhark_context_free(struct futhark_context *ctx);

// Arrays

struct futhark_f64_1d ;
struct futhark_f64_1d *futhark_new_f64_1d(struct futhark_context *ctx, const
                                          double *data, int64_t dim0);
struct futhark_f64_1d *futhark_new_raw_f64_1d(struct futhark_context *ctx, const
                                              CUdeviceptr data, int offset,
                                              int64_t dim0);
int futhark_free_f64_1d(struct futhark_context *ctx,
                        struct futhark_f64_1d *arr);
int futhark_values_f64_1d(struct futhark_context *ctx,
                          struct futhark_f64_1d *arr, double *data);
CUdeviceptr futhark_values_raw_f64_1d(struct futhark_context *ctx,
                                      struct futhark_f64_1d *arr);
const int64_t *futhark_shape_f64_1d(struct futhark_context *ctx,
                                    struct futhark_f64_1d *arr);
struct futhark_i64_1d ;
struct futhark_i64_1d *futhark_new_i64_1d(struct futhark_context *ctx, const
                                          int64_t *data, int64_t dim0);
struct futhark_i64_1d *futhark_new_raw_i64_1d(struct futhark_context *ctx, const
                                              CUdeviceptr data, int offset,
                                              int64_t dim0);
int futhark_free_i64_1d(struct futhark_context *ctx,
                        struct futhark_i64_1d *arr);
int futhark_values_i64_1d(struct futhark_context *ctx,
                          struct futhark_i64_1d *arr, int64_t *data);
CUdeviceptr futhark_values_raw_i64_1d(struct futhark_context *ctx,
                                      struct futhark_i64_1d *arr);
const int64_t *futhark_shape_i64_1d(struct futhark_context *ctx,
                                    struct futhark_i64_1d *arr);

// Opaque values


// Entry points

int futhark_entry_eWiseAddEntry(struct futhark_context *ctx,
                                struct futhark_f64_1d **out0,
                                struct futhark_i64_1d **out1,
                                struct futhark_i64_1d **out2, const
                                struct futhark_f64_1d *in0, const
                                struct futhark_i64_1d *in1, const
                                struct futhark_i64_1d *in2, const
                                struct futhark_f64_1d *in3, const
                                struct futhark_i64_1d *in4, const
                                struct futhark_i64_1d *in5);
int futhark_entry_eWiseAddMultEntry(struct futhark_context *ctx,
                                    struct futhark_f64_1d **out0,
                                    struct futhark_i64_1d **out1,
                                    struct futhark_i64_1d **out2, const
                                    struct futhark_f64_1d *in0, const
                                    struct futhark_i64_1d *in1, const
                                    struct futhark_i64_1d *in2, const
                                    struct futhark_f64_1d *in3, const
                                    struct futhark_i64_1d *in4, const
                                    struct futhark_i64_1d *in5);
int futhark_entry_eWiseMultEntry(struct futhark_context *ctx,
                                 struct futhark_f64_1d **out0,
                                 struct futhark_i64_1d **out1,
                                 struct futhark_i64_1d **out2, const
                                 struct futhark_f64_1d *in0, const
                                 struct futhark_i64_1d *in1, const
                                 struct futhark_i64_1d *in2, const
                                 struct futhark_f64_1d *in3, const
                                 struct futhark_i64_1d *in4, const
                                 struct futhark_i64_1d *in5);

// Miscellaneous

int futhark_context_sync(struct futhark_context *ctx);
int futhark_context_clear_caches(struct futhark_context *ctx);
char *futhark_context_report(struct futhark_context *ctx);
char *futhark_context_get_error(struct futhark_context *ctx);
void futhark_context_pause_profiling(struct futhark_context *ctx);
void futhark_context_unpause_profiling(struct futhark_context *ctx);
#define FUTHARK_BACKEND_cuda
#include <stdio.h>
#include <stdlib.h>
#include <stdbool.h>
#include <math.h>
#include <stdint.h>
#undef NDEBUG
#include <assert.h>
#include <stdarg.h>
// Start of util.h.
//
// Various helper functions that are useful in all generated C code.

#include <errno.h>
#include <string.h>

static const char *fut_progname = "(embedded Futhark)";

static void futhark_panic(int eval, const char *fmt, ...) {
  va_list ap;
  va_start(ap, fmt);
  fprintf(stderr, "%s: ", fut_progname);
  vfprintf(stderr, fmt, ap);
  va_end(ap);
  exit(eval);
}

// For generating arbitrary-sized error messages.  It is the callers
// responsibility to free the buffer at some point.
static char* msgprintf(const char *s, ...) {
  va_list vl;
  va_start(vl, s);
  size_t needed = 1 + (size_t)vsnprintf(NULL, 0, s, vl);
  char *buffer = (char*) malloc(needed);
  va_start(vl, s); // Must re-init.
  vsnprintf(buffer, needed, s, vl);
  return buffer;
}


static inline void check_err(int errval, int sets_errno, const char *fun, int line,
                            const char *msg, ...) {
  if (errval) {
    char errnum[10];

    va_list vl;
    va_start(vl, msg);

    fprintf(stderr, "ERROR: ");
    vfprintf(stderr, msg, vl);
    fprintf(stderr, " in %s() at line %d with error code %s\n",
            fun, line,
            sets_errno ? strerror(errno) : errnum);
    exit(errval);
  }
}

#define CHECK_ERR(err, msg...) check_err(err, 0, __func__, __LINE__, msg)
#define CHECK_ERRNO(err, msg...) check_err(err, 1, __func__, __LINE__, msg)

// Read a file into a NUL-terminated string; returns NULL on error.
static void* slurp_file(const char *filename, size_t *size) {
  unsigned char *s;
  FILE *f = fopen(filename, "rb"); // To avoid Windows messing with linebreaks.
  if (f == NULL) return NULL;
  fseek(f, 0, SEEK_END);
  size_t src_size = ftell(f);
  fseek(f, 0, SEEK_SET);
  s = (unsigned char*) malloc(src_size + 1);
  if (fread(s, 1, src_size, f) != src_size) {
    free(s);
    s = NULL;
  } else {
    s[src_size] = '\0';
  }
  fclose(f);

  if (size) {
    *size = src_size;
  }

  return s;
}

// Dump 'n' bytes from 'buf' into the file at the designated location.
// Returns 0 on success.
static int dump_file(const char *file, const void *buf, size_t n) {
  FILE *f = fopen(file, "w");

  if (f == NULL) {
    return 1;
  }

  if (fwrite(buf, sizeof(char), n, f) != n) {
    return 1;
  }

  if (fclose(f) != 0) {
    return 1;
  }

  return 0;
}

struct str_builder {
  char *str;
  size_t capacity; // Size of buffer.
  size_t used; // Bytes used, *not* including final zero.
};

static void str_builder_init(struct str_builder *b) {
  b->capacity = 10;
  b->used = 0;
  b->str = malloc(b->capacity);
  b->str[0] = 0;
}

static void str_builder(struct str_builder *b, const char *s, ...) {
  va_list vl;
  va_start(vl, s);
  size_t needed = (size_t)vsnprintf(NULL, 0, s, vl);

  while (b->capacity < b->used + needed + 1) {
    b->capacity *= 2;
    b->str = realloc(b->str, b->capacity);
  }

  va_start(vl, s); // Must re-init.
  vsnprintf(b->str+b->used, b->capacity-b->used, s, vl);
  b->used += needed;
}

// End of util.h.

// Start of timing.h.

// The function get_wall_time() returns the wall time in microseconds
// (with an unspecified offset).

#ifdef _WIN32

#include <windows.h>

static int64_t get_wall_time(void) {
  LARGE_INTEGER time,freq;
  assert(QueryPerformanceFrequency(&freq));
  assert(QueryPerformanceCounter(&time));
  return ((double)time.QuadPart / freq.QuadPart) * 1000000;
}

#else
// Assuming POSIX

#include <time.h>
#include <sys/time.h>

static int64_t get_wall_time(void) {
  struct timeval time;
  assert(gettimeofday(&time,NULL) == 0);
  return time.tv_sec * 1000000 + time.tv_usec;
}

static int64_t get_wall_time_ns(void) {
  struct timespec time;
  assert(clock_gettime(CLOCK_REALTIME, &time) == 0);
  return time.tv_sec * 1000000000 + time.tv_nsec;
}

#endif

// End of timing.h.

#ifdef _MSC_VER
#define inline __inline
#endif
#include <string.h>
#include <inttypes.h>
#include <ctype.h>
#include <errno.h>
#include <assert.h>
#include <cuda.h>
#include <cuda_runtime.h>
#include <nvrtc.h>

// Start of lock.h.

// A very simple cross-platform implementation of locks.  Uses
// pthreads on Unix and some Windows thing there.  Futhark's
// host-level code is not multithreaded, but user code may be, so we
// need some mechanism for ensuring atomic access to API functions.
// This is that mechanism.  It is not exposed to user code at all, so
// we do not have to worry about name collisions.

#ifdef _WIN32

typedef HANDLE lock_t;

static void create_lock(lock_t *lock) {
  *lock = CreateMutex(NULL,  // Default security attributes.
                      FALSE, // Initially unlocked.
                      NULL); // Unnamed.
}

static void lock_lock(lock_t *lock) {
  assert(WaitForSingleObject(*lock, INFINITE) == WAIT_OBJECT_0);
}

static void lock_unlock(lock_t *lock) {
  assert(ReleaseMutex(*lock));
}

static void free_lock(lock_t *lock) {
  CloseHandle(*lock);
}

#else
// Assuming POSIX

#include <pthread.h>

typedef pthread_mutex_t lock_t;

static void create_lock(lock_t *lock) {
  int r = pthread_mutex_init(lock, NULL);
  assert(r == 0);
}

static void lock_lock(lock_t *lock) {
  int r = pthread_mutex_lock(lock);
  assert(r == 0);
}

static void lock_unlock(lock_t *lock) {
  int r = pthread_mutex_unlock(lock);
  assert(r == 0);
}

static void free_lock(lock_t *lock) {
  // Nothing to do for pthreads.
  (void)lock;
}

#endif

// End of lock.h.

static inline uint8_t add8(uint8_t x, uint8_t y)
{
    return x + y;
}
static inline uint16_t add16(uint16_t x, uint16_t y)
{
    return x + y;
}
static inline uint32_t add32(uint32_t x, uint32_t y)
{
    return x + y;
}
static inline uint64_t add64(uint64_t x, uint64_t y)
{
    return x + y;
}
static inline uint8_t sub8(uint8_t x, uint8_t y)
{
    return x - y;
}
static inline uint16_t sub16(uint16_t x, uint16_t y)
{
    return x - y;
}
static inline uint32_t sub32(uint32_t x, uint32_t y)
{
    return x - y;
}
static inline uint64_t sub64(uint64_t x, uint64_t y)
{
    return x - y;
}
static inline uint8_t mul8(uint8_t x, uint8_t y)
{
    return x * y;
}
static inline uint16_t mul16(uint16_t x, uint16_t y)
{
    return x * y;
}
static inline uint32_t mul32(uint32_t x, uint32_t y)
{
    return x * y;
}
static inline uint64_t mul64(uint64_t x, uint64_t y)
{
    return x * y;
}
static inline uint8_t udiv8(uint8_t x, uint8_t y)
{
    return x / y;
}
static inline uint16_t udiv16(uint16_t x, uint16_t y)
{
    return x / y;
}
static inline uint32_t udiv32(uint32_t x, uint32_t y)
{
    return x / y;
}
static inline uint64_t udiv64(uint64_t x, uint64_t y)
{
    return x / y;
}
static inline uint8_t udiv_up8(uint8_t x, uint8_t y)
{
    return (x + y - 1) / y;
}
static inline uint16_t udiv_up16(uint16_t x, uint16_t y)
{
    return (x + y - 1) / y;
}
static inline uint32_t udiv_up32(uint32_t x, uint32_t y)
{
    return (x + y - 1) / y;
}
static inline uint64_t udiv_up64(uint64_t x, uint64_t y)
{
    return (x + y - 1) / y;
}
static inline uint8_t umod8(uint8_t x, uint8_t y)
{
    return x % y;
}
static inline uint16_t umod16(uint16_t x, uint16_t y)
{
    return x % y;
}
static inline uint32_t umod32(uint32_t x, uint32_t y)
{
    return x % y;
}
static inline uint64_t umod64(uint64_t x, uint64_t y)
{
    return x % y;
}
static inline uint8_t udiv_safe8(uint8_t x, uint8_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline uint16_t udiv_safe16(uint16_t x, uint16_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline uint32_t udiv_safe32(uint32_t x, uint32_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline uint64_t udiv_safe64(uint64_t x, uint64_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline uint8_t udiv_up_safe8(uint8_t x, uint8_t y)
{
    return y == 0 ? 0 : (x + y - 1) / y;
}
static inline uint16_t udiv_up_safe16(uint16_t x, uint16_t y)
{
    return y == 0 ? 0 : (x + y - 1) / y;
}
static inline uint32_t udiv_up_safe32(uint32_t x, uint32_t y)
{
    return y == 0 ? 0 : (x + y - 1) / y;
}
static inline uint64_t udiv_up_safe64(uint64_t x, uint64_t y)
{
    return y == 0 ? 0 : (x + y - 1) / y;
}
static inline uint8_t umod_safe8(uint8_t x, uint8_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline uint16_t umod_safe16(uint16_t x, uint16_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline uint32_t umod_safe32(uint32_t x, uint32_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline uint64_t umod_safe64(uint64_t x, uint64_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline int8_t sdiv8(int8_t x, int8_t y)
{
    int8_t q = x / y;
    int8_t r = x % y;
    
    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}
static inline int16_t sdiv16(int16_t x, int16_t y)
{
    int16_t q = x / y;
    int16_t r = x % y;
    
    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}
static inline int32_t sdiv32(int32_t x, int32_t y)
{
    int32_t q = x / y;
    int32_t r = x % y;
    
    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}
static inline int64_t sdiv64(int64_t x, int64_t y)
{
    int64_t q = x / y;
    int64_t r = x % y;
    
    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);
}
static inline int8_t sdiv_up8(int8_t x, int8_t y)
{
    return sdiv8(x + y - 1, y);
}
static inline int16_t sdiv_up16(int16_t x, int16_t y)
{
    return sdiv16(x + y - 1, y);
}
static inline int32_t sdiv_up32(int32_t x, int32_t y)
{
    return sdiv32(x + y - 1, y);
}
static inline int64_t sdiv_up64(int64_t x, int64_t y)
{
    return sdiv64(x + y - 1, y);
}
static inline int8_t smod8(int8_t x, int8_t y)
{
    int8_t r = x % y;
    
    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}
static inline int16_t smod16(int16_t x, int16_t y)
{
    int16_t r = x % y;
    
    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}
static inline int32_t smod32(int32_t x, int32_t y)
{
    int32_t r = x % y;
    
    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}
static inline int64_t smod64(int64_t x, int64_t y)
{
    int64_t r = x % y;
    
    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);
}
static inline int8_t sdiv_safe8(int8_t x, int8_t y)
{
    return y == 0 ? 0 : sdiv8(x, y);
}
static inline int16_t sdiv_safe16(int16_t x, int16_t y)
{
    return y == 0 ? 0 : sdiv16(x, y);
}
static inline int32_t sdiv_safe32(int32_t x, int32_t y)
{
    return y == 0 ? 0 : sdiv32(x, y);
}
static inline int64_t sdiv_safe64(int64_t x, int64_t y)
{
    return y == 0 ? 0 : sdiv64(x, y);
}
static inline int8_t sdiv_up_safe8(int8_t x, int8_t y)
{
    return sdiv_safe8(x + y - 1, y);
}
static inline int16_t sdiv_up_safe16(int16_t x, int16_t y)
{
    return sdiv_safe16(x + y - 1, y);
}
static inline int32_t sdiv_up_safe32(int32_t x, int32_t y)
{
    return sdiv_safe32(x + y - 1, y);
}
static inline int64_t sdiv_up_safe64(int64_t x, int64_t y)
{
    return sdiv_safe64(x + y - 1, y);
}
static inline int8_t smod_safe8(int8_t x, int8_t y)
{
    return y == 0 ? 0 : smod8(x, y);
}
static inline int16_t smod_safe16(int16_t x, int16_t y)
{
    return y == 0 ? 0 : smod16(x, y);
}
static inline int32_t smod_safe32(int32_t x, int32_t y)
{
    return y == 0 ? 0 : smod32(x, y);
}
static inline int64_t smod_safe64(int64_t x, int64_t y)
{
    return y == 0 ? 0 : smod64(x, y);
}
static inline int8_t squot8(int8_t x, int8_t y)
{
    return x / y;
}
static inline int16_t squot16(int16_t x, int16_t y)
{
    return x / y;
}
static inline int32_t squot32(int32_t x, int32_t y)
{
    return x / y;
}
static inline int64_t squot64(int64_t x, int64_t y)
{
    return x / y;
}
static inline int8_t srem8(int8_t x, int8_t y)
{
    return x % y;
}
static inline int16_t srem16(int16_t x, int16_t y)
{
    return x % y;
}
static inline int32_t srem32(int32_t x, int32_t y)
{
    return x % y;
}
static inline int64_t srem64(int64_t x, int64_t y)
{
    return x % y;
}
static inline int8_t squot_safe8(int8_t x, int8_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline int16_t squot_safe16(int16_t x, int16_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline int32_t squot_safe32(int32_t x, int32_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline int64_t squot_safe64(int64_t x, int64_t y)
{
    return y == 0 ? 0 : x / y;
}
static inline int8_t srem_safe8(int8_t x, int8_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline int16_t srem_safe16(int16_t x, int16_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline int32_t srem_safe32(int32_t x, int32_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline int64_t srem_safe64(int64_t x, int64_t y)
{
    return y == 0 ? 0 : x % y;
}
static inline int8_t smin8(int8_t x, int8_t y)
{
    return x < y ? x : y;
}
static inline int16_t smin16(int16_t x, int16_t y)
{
    return x < y ? x : y;
}
static inline int32_t smin32(int32_t x, int32_t y)
{
    return x < y ? x : y;
}
static inline int64_t smin64(int64_t x, int64_t y)
{
    return x < y ? x : y;
}
static inline uint8_t umin8(uint8_t x, uint8_t y)
{
    return x < y ? x : y;
}
static inline uint16_t umin16(uint16_t x, uint16_t y)
{
    return x < y ? x : y;
}
static inline uint32_t umin32(uint32_t x, uint32_t y)
{
    return x < y ? x : y;
}
static inline uint64_t umin64(uint64_t x, uint64_t y)
{
    return x < y ? x : y;
}
static inline int8_t smax8(int8_t x, int8_t y)
{
    return x < y ? y : x;
}
static inline int16_t smax16(int16_t x, int16_t y)
{
    return x < y ? y : x;
}
static inline int32_t smax32(int32_t x, int32_t y)
{
    return x < y ? y : x;
}
static inline int64_t smax64(int64_t x, int64_t y)
{
    return x < y ? y : x;
}
static inline uint8_t umax8(uint8_t x, uint8_t y)
{
    return x < y ? y : x;
}
static inline uint16_t umax16(uint16_t x, uint16_t y)
{
    return x < y ? y : x;
}
static inline uint32_t umax32(uint32_t x, uint32_t y)
{
    return x < y ? y : x;
}
static inline uint64_t umax64(uint64_t x, uint64_t y)
{
    return x < y ? y : x;
}
static inline uint8_t shl8(uint8_t x, uint8_t y)
{
    return x << y;
}
static inline uint16_t shl16(uint16_t x, uint16_t y)
{
    return x << y;
}
static inline uint32_t shl32(uint32_t x, uint32_t y)
{
    return x << y;
}
static inline uint64_t shl64(uint64_t x, uint64_t y)
{
    return x << y;
}
static inline uint8_t lshr8(uint8_t x, uint8_t y)
{
    return x >> y;
}
static inline uint16_t lshr16(uint16_t x, uint16_t y)
{
    return x >> y;
}
static inline uint32_t lshr32(uint32_t x, uint32_t y)
{
    return x >> y;
}
static inline uint64_t lshr64(uint64_t x, uint64_t y)
{
    return x >> y;
}
static inline int8_t ashr8(int8_t x, int8_t y)
{
    return x >> y;
}
static inline int16_t ashr16(int16_t x, int16_t y)
{
    return x >> y;
}
static inline int32_t ashr32(int32_t x, int32_t y)
{
    return x >> y;
}
static inline int64_t ashr64(int64_t x, int64_t y)
{
    return x >> y;
}
static inline uint8_t and8(uint8_t x, uint8_t y)
{
    return x & y;
}
static inline uint16_t and16(uint16_t x, uint16_t y)
{
    return x & y;
}
static inline uint32_t and32(uint32_t x, uint32_t y)
{
    return x & y;
}
static inline uint64_t and64(uint64_t x, uint64_t y)
{
    return x & y;
}
static inline uint8_t or8(uint8_t x, uint8_t y)
{
    return x | y;
}
static inline uint16_t or16(uint16_t x, uint16_t y)
{
    return x | y;
}
static inline uint32_t or32(uint32_t x, uint32_t y)
{
    return x | y;
}
static inline uint64_t or64(uint64_t x, uint64_t y)
{
    return x | y;
}
static inline uint8_t xor8(uint8_t x, uint8_t y)
{
    return x ^ y;
}
static inline uint16_t xor16(uint16_t x, uint16_t y)
{
    return x ^ y;
}
static inline uint32_t xor32(uint32_t x, uint32_t y)
{
    return x ^ y;
}
static inline uint64_t xor64(uint64_t x, uint64_t y)
{
    return x ^ y;
}
static inline bool ult8(uint8_t x, uint8_t y)
{
    return x < y;
}
static inline bool ult16(uint16_t x, uint16_t y)
{
    return x < y;
}
static inline bool ult32(uint32_t x, uint32_t y)
{
    return x < y;
}
static inline bool ult64(uint64_t x, uint64_t y)
{
    return x < y;
}
static inline bool ule8(uint8_t x, uint8_t y)
{
    return x <= y;
}
static inline bool ule16(uint16_t x, uint16_t y)
{
    return x <= y;
}
static inline bool ule32(uint32_t x, uint32_t y)
{
    return x <= y;
}
static inline bool ule64(uint64_t x, uint64_t y)
{
    return x <= y;
}
static inline bool slt8(int8_t x, int8_t y)
{
    return x < y;
}
static inline bool slt16(int16_t x, int16_t y)
{
    return x < y;
}
static inline bool slt32(int32_t x, int32_t y)
{
    return x < y;
}
static inline bool slt64(int64_t x, int64_t y)
{
    return x < y;
}
static inline bool sle8(int8_t x, int8_t y)
{
    return x <= y;
}
static inline bool sle16(int16_t x, int16_t y)
{
    return x <= y;
}
static inline bool sle32(int32_t x, int32_t y)
{
    return x <= y;
}
static inline bool sle64(int64_t x, int64_t y)
{
    return x <= y;
}
static inline int8_t pow8(int8_t x, int8_t y)
{
    int8_t res = 1, rem = y;
    
    while (rem != 0) {
        if (rem & 1)
            res *= x;
        rem >>= 1;
        x *= x;
    }
    return res;
}
static inline int16_t pow16(int16_t x, int16_t y)
{
    int16_t res = 1, rem = y;
    
    while (rem != 0) {
        if (rem & 1)
            res *= x;
        rem >>= 1;
        x *= x;
    }
    return res;
}
static inline int32_t pow32(int32_t x, int32_t y)
{
    int32_t res = 1, rem = y;
    
    while (rem != 0) {
        if (rem & 1)
            res *= x;
        rem >>= 1;
        x *= x;
    }
    return res;
}
static inline int64_t pow64(int64_t x, int64_t y)
{
    int64_t res = 1, rem = y;
    
    while (rem != 0) {
        if (rem & 1)
            res *= x;
        rem >>= 1;
        x *= x;
    }
    return res;
}
static inline bool itob_i8_bool(int8_t x)
{
    return x;
}
static inline bool itob_i16_bool(int16_t x)
{
    return x;
}
static inline bool itob_i32_bool(int32_t x)
{
    return x;
}
static inline bool itob_i64_bool(int64_t x)
{
    return x;
}
static inline int8_t btoi_bool_i8(bool x)
{
    return x;
}
static inline int16_t btoi_bool_i16(bool x)
{
    return x;
}
static inline int32_t btoi_bool_i32(bool x)
{
    return x;
}
static inline int64_t btoi_bool_i64(bool x)
{
    return x;
}
#define sext_i8_i8(x) ((int8_t) (int8_t) x)
#define sext_i8_i16(x) ((int16_t) (int8_t) x)
#define sext_i8_i32(x) ((int32_t) (int8_t) x)
#define sext_i8_i64(x) ((int64_t) (int8_t) x)
#define sext_i16_i8(x) ((int8_t) (int16_t) x)
#define sext_i16_i16(x) ((int16_t) (int16_t) x)
#define sext_i16_i32(x) ((int32_t) (int16_t) x)
#define sext_i16_i64(x) ((int64_t) (int16_t) x)
#define sext_i32_i8(x) ((int8_t) (int32_t) x)
#define sext_i32_i16(x) ((int16_t) (int32_t) x)
#define sext_i32_i32(x) ((int32_t) (int32_t) x)
#define sext_i32_i64(x) ((int64_t) (int32_t) x)
#define sext_i64_i8(x) ((int8_t) (int64_t) x)
#define sext_i64_i16(x) ((int16_t) (int64_t) x)
#define sext_i64_i32(x) ((int32_t) (int64_t) x)
#define sext_i64_i64(x) ((int64_t) (int64_t) x)
#define zext_i8_i8(x) ((int8_t) (uint8_t) x)
#define zext_i8_i16(x) ((int16_t) (uint8_t) x)
#define zext_i8_i32(x) ((int32_t) (uint8_t) x)
#define zext_i8_i64(x) ((int64_t) (uint8_t) x)
#define zext_i16_i8(x) ((int8_t) (uint16_t) x)
#define zext_i16_i16(x) ((int16_t) (uint16_t) x)
#define zext_i16_i32(x) ((int32_t) (uint16_t) x)
#define zext_i16_i64(x) ((int64_t) (uint16_t) x)
#define zext_i32_i8(x) ((int8_t) (uint32_t) x)
#define zext_i32_i16(x) ((int16_t) (uint32_t) x)
#define zext_i32_i32(x) ((int32_t) (uint32_t) x)
#define zext_i32_i64(x) ((int64_t) (uint32_t) x)
#define zext_i64_i8(x) ((int8_t) (uint64_t) x)
#define zext_i64_i16(x) ((int16_t) (uint64_t) x)
#define zext_i64_i32(x) ((int32_t) (uint64_t) x)
#define zext_i64_i64(x) ((int64_t) (uint64_t) x)
#if defined(__OPENCL_VERSION__)
static int32_t futrts_popc8(int8_t x)
{
    return popcount(x);
}
static int32_t futrts_popc16(int16_t x)
{
    return popcount(x);
}
static int32_t futrts_popc32(int32_t x)
{
    return popcount(x);
}
static int32_t futrts_popc64(int64_t x)
{
    return popcount(x);
}
#elif defined(__CUDA_ARCH__)
static int32_t futrts_popc8(int8_t x)
{
    return __popc(zext_i8_i32(x));
}
static int32_t futrts_popc16(int16_t x)
{
    return __popc(zext_i16_i32(x));
}
static int32_t futrts_popc32(int32_t x)
{
    return __popc(x);
}
static int32_t futrts_popc64(int64_t x)
{
    return __popcll(x);
}
#else
static int32_t futrts_popc8(int8_t x)
{
    int c = 0;
    
    for (; x; ++c)
        x &= x - 1;
    return c;
}
static int32_t futrts_popc16(int16_t x)
{
    int c = 0;
    
    for (; x; ++c)
        x &= x - 1;
    return c;
}
static int32_t futrts_popc32(int32_t x)
{
    int c = 0;
    
    for (; x; ++c)
        x &= x - 1;
    return c;
}
static int32_t futrts_popc64(int64_t x)
{
    int c = 0;
    
    for (; x; ++c)
        x &= x - 1;
    return c;
}
#endif
#if defined(__OPENCL_VERSION__)
static uint8_t futrts_mul_hi8(uint8_t a, uint8_t b)
{
    return mul_hi(a, b);
}
static uint16_t futrts_mul_hi16(uint16_t a, uint16_t b)
{
    return mul_hi(a, b);
}
static uint32_t futrts_mul_hi32(uint32_t a, uint32_t b)
{
    return mul_hi(a, b);
}
static uint64_t futrts_mul_hi64(uint64_t a, uint64_t b)
{
    return mul_hi(a, b);
}
#elif defined(__CUDA_ARCH__)
static uint8_t futrts_mul_hi8(uint8_t a, uint8_t b)
{
    uint16_t aa = a;
    uint16_t bb = b;
    
    return aa * bb >> 8;
}
static uint16_t futrts_mul_hi16(uint16_t a, uint16_t b)
{
    uint32_t aa = a;
    uint32_t bb = b;
    
    return aa * bb >> 16;
}
static uint32_t futrts_mul_hi32(uint32_t a, uint32_t b)
{
    return mulhi(a, b);
}
static uint64_t futrts_mul_hi64(uint64_t a, uint64_t b)
{
    return mul64hi(a, b);
}
#else
static uint8_t futrts_mul_hi8(uint8_t a, uint8_t b)
{
    uint16_t aa = a;
    uint16_t bb = b;
    
    return aa * bb >> 8;
}
static uint16_t futrts_mul_hi16(uint16_t a, uint16_t b)
{
    uint32_t aa = a;
    uint32_t bb = b;
    
    return aa * bb >> 16;
}
static uint32_t futrts_mul_hi32(uint32_t a, uint32_t b)
{
    uint64_t aa = a;
    uint64_t bb = b;
    
    return aa * bb >> 32;
}
static uint64_t futrts_mul_hi64(uint64_t a, uint64_t b)
{
    __uint128_t aa = a;
    __uint128_t bb = b;
    
    return aa * bb >> 64;
}
#endif
#if defined(__OPENCL_VERSION__)
static uint8_t futrts_mad_hi8(uint8_t a, uint8_t b, uint8_t c)
{
    return mad_hi(a, b, c);
}
static uint16_t futrts_mad_hi16(uint16_t a, uint16_t b, uint16_t c)
{
    return mad_hi(a, b, c);
}
static uint32_t futrts_mad_hi32(uint32_t a, uint32_t b, uint32_t c)
{
    return mad_hi(a, b, c);
}
static uint64_t futrts_mad_hi64(uint64_t a, uint64_t b, uint64_t c)
{
    return mad_hi(a, b, c);
}
#else
static uint8_t futrts_mad_hi8(uint8_t a, uint8_t b, uint8_t c)
{
    return futrts_mul_hi8(a, b) + c;
}
static uint16_t futrts_mad_hi16(uint16_t a, uint16_t b, uint16_t c)
{
    return futrts_mul_hi16(a, b) + c;
}
static uint32_t futrts_mad_hi32(uint32_t a, uint32_t b, uint32_t c)
{
    return futrts_mul_hi32(a, b) + c;
}
static uint64_t futrts_mad_hi64(uint64_t a, uint64_t b, uint64_t c)
{
    return futrts_mul_hi64(a, b) + c;
}
#endif
#if defined(__OPENCL_VERSION__)
static int32_t futrts_clzz8(int8_t x)
{
    return clz(x);
}
static int32_t futrts_clzz16(int16_t x)
{
    return clz(x);
}
static int32_t futrts_clzz32(int32_t x)
{
    return clz(x);
}
static int32_t futrts_clzz64(int64_t x)
{
    return clz(x);
}
#elif defined(__CUDA_ARCH__)
static int32_t futrts_clzz8(int8_t x)
{
    return __clz(zext_i8_i32(x)) - 24;
}
static int32_t futrts_clzz16(int16_t x)
{
    return __clz(zext_i16_i32(x)) - 16;
}
static int32_t futrts_clzz32(int32_t x)
{
    return __clz(x);
}
static int32_t futrts_clzz64(int64_t x)
{
    return __clzll(x);
}
#else
static int32_t futrts_clzz8(int8_t x)
{
    int n = 0;
    int bits = sizeof(x) * 8;
    
    for (int i = 0; i < bits; i++) {
        if (x < 0)
            break;
        n++;
        x <<= 1;
    }
    return n;
}
static int32_t futrts_clzz16(int16_t x)
{
    int n = 0;
    int bits = sizeof(x) * 8;
    
    for (int i = 0; i < bits; i++) {
        if (x < 0)
            break;
        n++;
        x <<= 1;
    }
    return n;
}
static int32_t futrts_clzz32(int32_t x)
{
    int n = 0;
    int bits = sizeof(x) * 8;
    
    for (int i = 0; i < bits; i++) {
        if (x < 0)
            break;
        n++;
        x <<= 1;
    }
    return n;
}
static int32_t futrts_clzz64(int64_t x)
{
    int n = 0;
    int bits = sizeof(x) * 8;
    
    for (int i = 0; i < bits; i++) {
        if (x < 0)
            break;
        n++;
        x <<= 1;
    }
    return n;
}
#endif
#if defined(__OPENCL_VERSION__)
static int32_t futrts_ctzz8(int8_t x)
{
    int i = 0;
    
    for (; i < 8 && (x & 1) == 0; i++, x >>= 1)
        ;
    return i;
}
static int32_t futrts_ctzz16(int16_t x)
{
    int i = 0;
    
    for (; i < 16 && (x & 1) == 0; i++, x >>= 1)
        ;
    return i;
}
static int32_t futrts_ctzz32(int32_t x)
{
    int i = 0;
    
    for (; i < 32 && (x & 1) == 0; i++, x >>= 1)
        ;
    return i;
}
static int32_t futrts_ctzz64(int64_t x)
{
    int i = 0;
    
    for (; i < 64 && (x & 1) == 0; i++, x >>= 1)
        ;
    return i;
}
#elif defined(__CUDA_ARCH__)
static int32_t futrts_ctzz8(int8_t x)
{
    int y = __ffs(x);
    
    return y == 0 ? 8 : y - 1;
}
static int32_t futrts_ctzz16(int16_t x)
{
    int y = __ffs(x);
    
    return y == 0 ? 16 : y - 1;
}
static int32_t futrts_ctzz32(int32_t x)
{
    int y = __ffs(x);
    
    return y == 0 ? 32 : y - 1;
}
static int32_t futrts_ctzz64(int64_t x)
{
    int y = __ffsll(x);
    
    return y == 0 ? 64 : y - 1;
}
#else
static int32_t futrts_ctzz8(int8_t x)
{
    return x == 0 ? 8 : __builtin_ctz((uint32_t) x);
}
static int32_t futrts_ctzz16(int16_t x)
{
    return x == 0 ? 16 : __builtin_ctz((uint32_t) x);
}
static int32_t futrts_ctzz32(int32_t x)
{
    return x == 0 ? 32 : __builtin_ctz(x);
}
static int32_t futrts_ctzz64(int64_t x)
{
    return x == 0 ? 64 : __builtin_ctzll(x);
}
#endif
static inline float fdiv32(float x, float y)
{
    return x / y;
}
static inline float fadd32(float x, float y)
{
    return x + y;
}
static inline float fsub32(float x, float y)
{
    return x - y;
}
static inline float fmul32(float x, float y)
{
    return x * y;
}
static inline float fmin32(float x, float y)
{
    return fmin(x, y);
}
static inline float fmax32(float x, float y)
{
    return fmax(x, y);
}
static inline float fpow32(float x, float y)
{
    return pow(x, y);
}
static inline bool cmplt32(float x, float y)
{
    return x < y;
}
static inline bool cmple32(float x, float y)
{
    return x <= y;
}
static inline float sitofp_i8_f32(int8_t x)
{
    return (float) x;
}
static inline float sitofp_i16_f32(int16_t x)
{
    return (float) x;
}
static inline float sitofp_i32_f32(int32_t x)
{
    return (float) x;
}
static inline float sitofp_i64_f32(int64_t x)
{
    return (float) x;
}
static inline float uitofp_i8_f32(uint8_t x)
{
    return (float) x;
}
static inline float uitofp_i16_f32(uint16_t x)
{
    return (float) x;
}
static inline float uitofp_i32_f32(uint32_t x)
{
    return (float) x;
}
static inline float uitofp_i64_f32(uint64_t x)
{
    return (float) x;
}
static inline int8_t fptosi_f32_i8(float x)
{
    return (int8_t) x;
}
static inline int16_t fptosi_f32_i16(float x)
{
    return (int16_t) x;
}
static inline int32_t fptosi_f32_i32(float x)
{
    return (int32_t) x;
}
static inline int64_t fptosi_f32_i64(float x)
{
    return (int64_t) x;
}
static inline uint8_t fptoui_f32_i8(float x)
{
    return (uint8_t) x;
}
static inline uint16_t fptoui_f32_i16(float x)
{
    return (uint16_t) x;
}
static inline uint32_t fptoui_f32_i32(float x)
{
    return (uint32_t) x;
}
static inline uint64_t fptoui_f32_i64(float x)
{
    return (uint64_t) x;
}
static inline double fdiv64(double x, double y)
{
    return x / y;
}
static inline double fadd64(double x, double y)
{
    return x + y;
}
static inline double fsub64(double x, double y)
{
    return x - y;
}
static inline double fmul64(double x, double y)
{
    return x * y;
}
static inline double fmin64(double x, double y)
{
    return fmin(x, y);
}
static inline double fmax64(double x, double y)
{
    return fmax(x, y);
}
static inline double fpow64(double x, double y)
{
    return pow(x, y);
}
static inline bool cmplt64(double x, double y)
{
    return x < y;
}
static inline bool cmple64(double x, double y)
{
    return x <= y;
}
static inline double sitofp_i8_f64(int8_t x)
{
    return (double) x;
}
static inline double sitofp_i16_f64(int16_t x)
{
    return (double) x;
}
static inline double sitofp_i32_f64(int32_t x)
{
    return (double) x;
}
static inline double sitofp_i64_f64(int64_t x)
{
    return (double) x;
}
static inline double uitofp_i8_f64(uint8_t x)
{
    return (double) x;
}
static inline double uitofp_i16_f64(uint16_t x)
{
    return (double) x;
}
static inline double uitofp_i32_f64(uint32_t x)
{
    return (double) x;
}
static inline double uitofp_i64_f64(uint64_t x)
{
    return (double) x;
}
static inline int8_t fptosi_f64_i8(double x)
{
    return (int8_t) x;
}
static inline int16_t fptosi_f64_i16(double x)
{
    return (int16_t) x;
}
static inline int32_t fptosi_f64_i32(double x)
{
    return (int32_t) x;
}
static inline int64_t fptosi_f64_i64(double x)
{
    return (int64_t) x;
}
static inline uint8_t fptoui_f64_i8(double x)
{
    return (uint8_t) x;
}
static inline uint16_t fptoui_f64_i16(double x)
{
    return (uint16_t) x;
}
static inline uint32_t fptoui_f64_i32(double x)
{
    return (uint32_t) x;
}
static inline uint64_t fptoui_f64_i64(double x)
{
    return (uint64_t) x;
}
static inline float fpconv_f32_f32(float x)
{
    return (float) x;
}
static inline double fpconv_f32_f64(float x)
{
    return (double) x;
}
static inline float fpconv_f64_f32(double x)
{
    return (float) x;
}
static inline double fpconv_f64_f64(double x)
{
    return (double) x;
}
static inline float futrts_log32(float x)
{
    return log(x);
}
static inline float futrts_log2_32(float x)
{
    return log2(x);
}
static inline float futrts_log10_32(float x)
{
    return log10(x);
}
static inline float futrts_sqrt32(float x)
{
    return sqrt(x);
}
static inline float futrts_exp32(float x)
{
    return exp(x);
}
static inline float futrts_cos32(float x)
{
    return cos(x);
}
static inline float futrts_sin32(float x)
{
    return sin(x);
}
static inline float futrts_tan32(float x)
{
    return tan(x);
}
static inline float futrts_acos32(float x)
{
    return acos(x);
}
static inline float futrts_asin32(float x)
{
    return asin(x);
}
static inline float futrts_atan32(float x)
{
    return atan(x);
}
static inline float futrts_cosh32(float x)
{
    return cosh(x);
}
static inline float futrts_sinh32(float x)
{
    return sinh(x);
}
static inline float futrts_tanh32(float x)
{
    return tanh(x);
}
static inline float futrts_acosh32(float x)
{
    return acosh(x);
}
static inline float futrts_asinh32(float x)
{
    return asinh(x);
}
static inline float futrts_atanh32(float x)
{
    return atanh(x);
}
static inline float futrts_atan2_32(float x, float y)
{
    return atan2(x, y);
}
static inline float futrts_gamma32(float x)
{
    return tgamma(x);
}
static inline float futrts_lgamma32(float x)
{
    return lgamma(x);
}
static inline bool futrts_isnan32(float x)
{
    return isnan(x);
}
static inline bool futrts_isinf32(float x)
{
    return isinf(x);
}
static inline int32_t futrts_to_bits32(float x)
{
    union {
        float f;
        int32_t t;
    } p;
    
    p.f = x;
    return p.t;
}
static inline float futrts_from_bits32(int32_t x)
{
    union {
        int32_t f;
        float t;
    } p;
    
    p.f = x;
    return p.t;
}
#ifdef __OPENCL_VERSION__
static inline float fmod32(float x, float y)
{
    return fmod(x, y);
}
static inline float futrts_round32(float x)
{
    return rint(x);
}
static inline float futrts_floor32(float x)
{
    return floor(x);
}
static inline float futrts_ceil32(float x)
{
    return ceil(x);
}
static inline float futrts_lerp32(float v0, float v1, float t)
{
    return mix(v0, v1, t);
}
static inline float futrts_mad32(float a, float b, float c)
{
    return mad(a, b, c);
}
static inline float futrts_fma32(float a, float b, float c)
{
    return fma(a, b, c);
}
#else
static inline float fmod32(float x, float y)
{
    return fmodf(x, y);
}
static inline float futrts_round32(float x)
{
    return rintf(x);
}
static inline float futrts_floor32(float x)
{
    return floorf(x);
}
static inline float futrts_ceil32(float x)
{
    return ceilf(x);
}
static inline float futrts_lerp32(float v0, float v1, float t)
{
    return v0 + (v1 - v0) * t;
}
static inline float futrts_mad32(float a, float b, float c)
{
    return a * b + c;
}
static inline float futrts_fma32(float a, float b, float c)
{
    return fmaf(a, b, c);
}
#endif
static inline double futrts_log64(double x)
{
    return log(x);
}
static inline double futrts_log2_64(double x)
{
    return log2(x);
}
static inline double futrts_log10_64(double x)
{
    return log10(x);
}
static inline double futrts_sqrt64(double x)
{
    return sqrt(x);
}
static inline double futrts_exp64(double x)
{
    return exp(x);
}
static inline double futrts_cos64(double x)
{
    return cos(x);
}
static inline double futrts_sin64(double x)
{
    return sin(x);
}
static inline double futrts_tan64(double x)
{
    return tan(x);
}
static inline double futrts_acos64(double x)
{
    return acos(x);
}
static inline double futrts_asin64(double x)
{
    return asin(x);
}
static inline double futrts_atan64(double x)
{
    return atan(x);
}
static inline double futrts_cosh64(double x)
{
    return cosh(x);
}
static inline double futrts_sinh64(double x)
{
    return sinh(x);
}
static inline double futrts_tanh64(double x)
{
    return tanh(x);
}
static inline double futrts_acosh64(double x)
{
    return acosh(x);
}
static inline double futrts_asinh64(double x)
{
    return asinh(x);
}
static inline double futrts_atanh64(double x)
{
    return atanh(x);
}
static inline double futrts_atan2_64(double x, double y)
{
    return atan2(x, y);
}
static inline double futrts_gamma64(double x)
{
    return tgamma(x);
}
static inline double futrts_lgamma64(double x)
{
    return lgamma(x);
}
static inline double futrts_fma64(double a, double b, double c)
{
    return fma(a, b, c);
}
static inline double futrts_round64(double x)
{
    return rint(x);
}
static inline double futrts_ceil64(double x)
{
    return ceil(x);
}
static inline double futrts_floor64(double x)
{
    return floor(x);
}
static inline bool futrts_isnan64(double x)
{
    return isnan(x);
}
static inline bool futrts_isinf64(double x)
{
    return isinf(x);
}
static inline int64_t futrts_to_bits64(double x)
{
    union {
        double f;
        int64_t t;
    } p;
    
    p.f = x;
    return p.t;
}
static inline double futrts_from_bits64(int64_t x)
{
    union {
        int64_t f;
        double t;
    } p;
    
    p.f = x;
    return p.t;
}
static inline double fmod64(double x, double y)
{
    return fmod(x, y);
}
#ifdef __OPENCL_VERSION__
static inline double futrts_lerp64(double v0, double v1, double t)
{
    return mix(v0, v1, t);
}
static inline double futrts_mad64(double a, double b, double c)
{
    return mad(a, b, c);
}
#else
static inline double futrts_lerp64(double v0, double v1, double t)
{
    return v0 + (v1 - v0) * t;
}
static inline double futrts_mad64(double a, double b, double c)
{
    return a * b + c;
}
#endif
static int init_constants(struct futhark_context *);
static int free_constants(struct futhark_context *);
static int32_t eWiseAddEntryzicounter_mem_realtype_30122[10] = {0, 0, 0, 0, 0,
                                                                0, 0, 0, 0, 0};
static int32_t eWiseAddEntryziid_counter_mem_realtype_30146[1];
static int32_t eWiseAddEntryziid_counter_mem_realtype_30174[1];
static int32_t eWiseAddEntryziid_counter_mem_realtype_30221[1];
static int32_t eWiseAddMultEntryzicounter_mem_realtype_30273[10] = {0, 0, 0, 0,
                                                                    0, 0, 0, 0,
                                                                    0, 0};
static int32_t eWiseAddMultEntryziid_counter_mem_realtype_30297[1];
static int32_t eWiseAddMultEntryziid_counter_mem_realtype_30325[1];
static int32_t eWiseAddMultEntryziid_counter_mem_realtype_30372[1];
static int32_t eWiseAddMultEntryzicounter_mem_realtype_30419[10] = {0, 0, 0, 0,
                                                                    0, 0, 0, 0,
                                                                    0, 0};
static int32_t eWiseAddMultEntryziid_counter_mem_realtype_30443[1];
static int32_t eWiseAddMultEntryziid_counter_mem_realtype_30471[1];
static int32_t eWiseAddMultEntryziid_counter_mem_realtype_30517[1];
static int32_t eWiseMultEntryzicounter_mem_realtype_30564[10] = {0, 0, 0, 0, 0,
                                                                 0, 0, 0, 0, 0};
static int32_t eWiseMultEntryziid_counter_mem_realtype_30588[1];
static int32_t eWiseMultEntryziid_counter_mem_realtype_30616[1];
static int32_t eWiseMultEntryziid_counter_mem_realtype_30662[1];
struct memblock_device {
    int *references;
    CUdeviceptr mem;
    int64_t size;
    const char *desc;
} ;
struct memblock {
    int *references;
    char *mem;
    int64_t size;
    const char *desc;
} ;
#include <cuda.h>
#include <nvrtc.h>
typedef CUdeviceptr fl_mem_t;
// Start of free_list.h.

// An entry in the free list.  May be invalid, to avoid having to
// deallocate entries as soon as they are removed.  There is also a
// tag, to help with memory reuse.
struct free_list_entry {
  size_t size;
  fl_mem_t mem;
  const char *tag;
  unsigned char valid;
};

struct free_list {
  struct free_list_entry *entries;        // Pointer to entries.
  int capacity;                           // Number of entries.
  int used;                               // Number of valid entries.
};

static void free_list_init(struct free_list *l) {
  l->capacity = 30; // Picked arbitrarily.
  l->used = 0;
  l->entries = (struct free_list_entry*) malloc(sizeof(struct free_list_entry) * l->capacity);
  for (int i = 0; i < l->capacity; i++) {
    l->entries[i].valid = 0;
  }
}

// Remove invalid entries from the free list.
static void free_list_pack(struct free_list *l) {
  int p = 0;
  for (int i = 0; i < l->capacity; i++) {
    if (l->entries[i].valid) {
      l->entries[p] = l->entries[i];
      p++;
    }
  }

  // Now p is the number of used elements.  We don't want it to go
  // less than the default capacity (although in practice it's OK as
  // long as it doesn't become 1).
  if (p < 30) {
    p = 30;
  }
  l->entries = realloc(l->entries, p * sizeof(struct free_list_entry));
  l->capacity = p;
}

static void free_list_destroy(struct free_list *l) {
  assert(l->used == 0);
  free(l->entries);
}

static int free_list_find_invalid(struct free_list *l) {
  int i;
  for (i = 0; i < l->capacity; i++) {
    if (!l->entries[i].valid) {
      break;
    }
  }
  return i;
}

static void free_list_insert(struct free_list *l, size_t size, fl_mem_t mem, const char *tag) {
  int i = free_list_find_invalid(l);

  if (i == l->capacity) {
    // List is full; so we have to grow it.
    int new_capacity = l->capacity * 2 * sizeof(struct free_list_entry);
    l->entries = realloc(l->entries, new_capacity);
    for (int j = 0; j < l->capacity; j++) {
      l->entries[j+l->capacity].valid = 0;
    }
    l->capacity *= 2;
  }

  // Now 'i' points to the first invalid entry.
  l->entries[i].valid = 1;
  l->entries[i].size = size;
  l->entries[i].mem = mem;
  l->entries[i].tag = tag;

  l->used++;
}

// Find and remove a memory block of the indicated tag, or if that
// does not exist, another memory block with exactly the desired size.
// Returns 0 on success.
static int free_list_find(struct free_list *l, size_t size,
                          size_t *size_out, fl_mem_t *mem_out) {
  int size_match = -1;
  int i;
  for (i = 0; i < l->capacity; i++) {
    if (l->entries[i].valid &&
        size <= l->entries[i].size &&
        (size_match < 0 || l->entries[i].size < l->entries[size_match].size)) {
      // If this entry is valid, has sufficient size, and is smaller than the
      // best entry found so far, use this entry.
      size_match = i;
    }
  }

  if (size_match >= 0) {
    l->entries[size_match].valid = 0;
    *size_out = l->entries[size_match].size;
    *mem_out = l->entries[size_match].mem;
    l->used--;
    return 0;
  } else {
    return 1;
  }
}

// Remove the first block in the free list.  Returns 0 if a block was
// removed, and nonzero if the free list was already empty.
static int free_list_first(struct free_list *l, fl_mem_t *mem_out) {
  for (int i = 0; i < l->capacity; i++) {
    if (l->entries[i].valid) {
      l->entries[i].valid = 0;
      *mem_out = l->entries[i].mem;
      l->used--;
      return 0;
    }
  }

  return 1;
}

// End of free_list.h.

// Start of cuda.h.

#define CUDA_SUCCEED(x) cuda_api_succeed(x, #x, __FILE__, __LINE__)
#define NVRTC_SUCCEED(x) nvrtc_api_succeed(x, #x, __FILE__, __LINE__)

static inline void cuda_api_succeed(CUresult res, const char *call,
    const char *file, int line) {
  if (res != CUDA_SUCCESS) {
    const char *err_str;
    cuGetErrorString(res, &err_str);
    if (err_str == NULL) { err_str = "Unknown"; }
    futhark_panic(-1, "%s:%d: CUDA call\n  %s\nfailed with error code %d (%s)\n",
        file, line, call, res, err_str);
  }
}

static inline void nvrtc_api_succeed(nvrtcResult res, const char *call,
                                     const char *file, int line) {
  if (res != NVRTC_SUCCESS) {
    const char *err_str = nvrtcGetErrorString(res);
    futhark_panic(-1, "%s:%d: NVRTC call\n  %s\nfailed with error code %d (%s)\n",
        file, line, call, res, err_str);
  }
}

struct cuda_config {
  int debugging;
  int logging;
  const char *preferred_device;
  int preferred_device_num;

  const char *dump_program_to;
  const char *load_program_from;

  const char *dump_ptx_to;
  const char *load_ptx_from;

  size_t default_block_size;
  size_t default_grid_size;
  size_t default_tile_size;
  size_t default_threshold;

  int default_block_size_changed;
  int default_grid_size_changed;
  int default_tile_size_changed;

  int num_sizes;
  const char **size_names;
  const char **size_vars;
  int64_t *size_values;
  const char **size_classes;
};

static void cuda_config_init(struct cuda_config *cfg,
                             int num_sizes,
                             const char *size_names[],
                             const char *size_vars[],
                             int64_t *size_values,
                             const char *size_classes[]) {
  cfg->debugging = 0;
  cfg->logging = 0;
  cfg->preferred_device_num = 0;
  cfg->preferred_device = "";
  cfg->dump_program_to = NULL;
  cfg->load_program_from = NULL;

  cfg->dump_ptx_to = NULL;
  cfg->load_ptx_from = NULL;

  cfg->default_block_size = 256;
  cfg->default_grid_size = 0; // Set properly later.
  cfg->default_tile_size = 32;
  cfg->default_threshold = 32*1024;

  cfg->default_block_size_changed = 0;
  cfg->default_grid_size_changed = 0;
  cfg->default_tile_size_changed = 0;

  cfg->num_sizes = num_sizes;
  cfg->size_names = size_names;
  cfg->size_vars = size_vars;
  cfg->size_values = size_values;
  cfg->size_classes = size_classes;
}

// A record of something that happened.
struct profiling_record {
  cudaEvent_t *events; // Points to two events.
  int *runs;
  int64_t *runtime;
};

struct cuda_context {
  CUdevice dev;
  CUcontext cu_ctx;
  CUmodule module;

  struct cuda_config cfg;

  struct free_list free_list;

  size_t max_block_size;
  size_t max_grid_size;
  size_t max_tile_size;
  size_t max_threshold;
  size_t max_shared_memory;
  size_t max_bespoke;

  size_t lockstep_width;

  struct profiling_record *profiling_records;
  int profiling_records_capacity;
  int profiling_records_used;
};

#define CU_DEV_ATTR(x) (CU_DEVICE_ATTRIBUTE_##x)
#define device_query(dev,attrib) _device_query(dev, CU_DEV_ATTR(attrib))
static int _device_query(CUdevice dev, CUdevice_attribute attrib) {
  int val;
  CUDA_SUCCEED(cuDeviceGetAttribute(&val, attrib, dev));
  return val;
}

#define CU_FUN_ATTR(x) (CU_FUNC_ATTRIBUTE_##x)
#define function_query(fn,attrib) _function_query(dev, CU_FUN_ATTR(attrib))
static int _function_query(CUfunction dev, CUfunction_attribute attrib) {
  int val;
  CUDA_SUCCEED(cuFuncGetAttribute(&val, attrib, dev));
  return val;
}

static void set_preferred_device(struct cuda_config *cfg, const char *s) {
  int x = 0;
  if (*s == '#') {
    s++;
    while (isdigit(*s)) {
      x = x * 10 + (*s++)-'0';
    }
    // Skip trailing spaces.
    while (isspace(*s)) {
      s++;
    }
  }
  cfg->preferred_device = s;
  cfg->preferred_device_num = x;
}

static int cuda_device_setup(struct cuda_context *ctx) {
  char name[256];
  int count, chosen = -1, best_cc = -1;
  int cc_major_best, cc_minor_best;
  int cc_major, cc_minor;
  CUdevice dev;

  CUDA_SUCCEED(cuDeviceGetCount(&count));
  if (count == 0) { return 1; }

  int num_device_matches = 0;

  // XXX: Current device selection policy is to choose the device with the
  // highest compute capability (if no preferred device is set).
  // This should maybe be changed, since greater compute capability is not
  // necessarily an indicator of better performance.
  for (int i = 0; i < count; i++) {
    CUDA_SUCCEED(cuDeviceGet(&dev, i));

    cc_major = device_query(dev, COMPUTE_CAPABILITY_MAJOR);
    cc_minor = device_query(dev, COMPUTE_CAPABILITY_MINOR);

    CUDA_SUCCEED(cuDeviceGetName(name, sizeof(name) - 1, dev));
    name[sizeof(name) - 1] = 0;

    if (ctx->cfg.debugging) {
      fprintf(stderr, "Device #%d: name=\"%s\", compute capability=%d.%d\n",
          i, name, cc_major, cc_minor);
    }

    if (device_query(dev, COMPUTE_MODE) == CU_COMPUTEMODE_PROHIBITED) {
      if (ctx->cfg.debugging) {
        fprintf(stderr, "Device #%d is compute-prohibited, ignoring\n", i);
      }
      continue;
    }

    if (best_cc == -1 || cc_major > cc_major_best ||
        (cc_major == cc_major_best && cc_minor > cc_minor_best)) {
      best_cc = i;
      cc_major_best = cc_major;
      cc_minor_best = cc_minor;
    }

    if (strstr(name, ctx->cfg.preferred_device) != NULL &&
        num_device_matches++ == ctx->cfg.preferred_device_num) {
      chosen = i;
      break;
    }
  }

  if (chosen == -1) { chosen = best_cc; }
  if (chosen == -1) { return 1; }

  if (ctx->cfg.debugging) {
    fprintf(stderr, "Using device #%d\n", chosen);
  }

  CUDA_SUCCEED(cuDeviceGet(&ctx->dev, chosen));
  return 0;
}

static char *concat_fragments(const char *src_fragments[]) {
  size_t src_len = 0;
  const char **p;

  for (p = src_fragments; *p; p++) {
    src_len += strlen(*p);
  }

  char *src = (char*) malloc(src_len + 1);
  size_t n = 0;
  for (p = src_fragments; *p; p++) {
    strcpy(src + n, *p);
    n += strlen(*p);
  }

  return src;
}

static const char *cuda_nvrtc_get_arch(CUdevice dev) {
  struct {
    int major;
    int minor;
    const char *arch_str;
  } static const x[] = {
    { 3, 0, "compute_30" },
    { 3, 2, "compute_32" },
    { 3, 5, "compute_35" },
    { 3, 7, "compute_37" },
    { 5, 0, "compute_50" },
    { 5, 2, "compute_52" },
    { 5, 3, "compute_53" },
    { 6, 0, "compute_60" },
    { 6, 1, "compute_61" },
    { 6, 2, "compute_62" },
    { 7, 0, "compute_70" },
    { 7, 2, "compute_72" },
    { 7, 5, "compute_75" }
  };

  int major = device_query(dev, COMPUTE_CAPABILITY_MAJOR);
  int minor = device_query(dev, COMPUTE_CAPABILITY_MINOR);

  int chosen = -1;
  for (int i = 0; i < sizeof(x)/sizeof(x[0]); i++) {
    if (x[i].major < major || (x[i].major == major && x[i].minor <= minor)) {
      chosen = i;
    } else {
      break;
    }
  }

  if (chosen == -1) {
    futhark_panic(-1, "Unsupported compute capability %d.%d\n", major, minor);
  }

  if (x[chosen].major != major || x[chosen].minor != minor) {
    fprintf(stderr,
            "Warning: device compute capability is %d.%d, but newest supported by Futhark is %d.%d.\n",
            major, minor, x[chosen].major, x[chosen].minor);
  }

  return x[chosen].arch_str;
}

static char *cuda_nvrtc_build(struct cuda_context *ctx, const char *src,
                              const char *extra_opts[]) {
  nvrtcProgram prog;
  NVRTC_SUCCEED(nvrtcCreateProgram(&prog, src, "futhark-cuda", 0, NULL, NULL));
  int arch_set = 0, num_extra_opts;

  // nvrtc cannot handle multiple -arch options.  Hence, if one of the
  // extra_opts is -arch, we have to be careful not to do our usual
  // automatic generation.
  for (num_extra_opts = 0; extra_opts[num_extra_opts] != NULL; num_extra_opts++) {
    if (strstr(extra_opts[num_extra_opts], "-arch")
        == extra_opts[num_extra_opts] ||
        strstr(extra_opts[num_extra_opts], "--gpu-architecture")
        == extra_opts[num_extra_opts]) {
      arch_set = 1;
    }
  }

  size_t n_opts, i = 0, i_dyn, n_opts_alloc = 20 + num_extra_opts + ctx->cfg.num_sizes;
  const char **opts = (const char**) malloc(n_opts_alloc * sizeof(const char *));
  if (!arch_set) {
    opts[i++] = "-arch";
    opts[i++] = cuda_nvrtc_get_arch(ctx->dev);
  }
  opts[i++] = "-default-device";
  if (ctx->cfg.debugging) {
    opts[i++] = "-G";
    opts[i++] = "-lineinfo";
  } else {
    opts[i++] = "--disable-warnings";
  }
  i_dyn = i;
  for (size_t j = 0; j < ctx->cfg.num_sizes; j++) {
    opts[i++] = msgprintf("-D%s=%zu", ctx->cfg.size_vars[j],
        ctx->cfg.size_values[j]);
  }
  opts[i++] = msgprintf("-DLOCKSTEP_WIDTH=%zu", ctx->lockstep_width);
  opts[i++] = msgprintf("-DMAX_THREADS_PER_BLOCK=%zu", ctx->max_block_size);

  // It is crucial that the extra_opts are last, so that the free()
  // logic below does not cause problems.
  for (int j = 0; extra_opts[j] != NULL; j++) {
    opts[i++] = extra_opts[j];
  }

  n_opts = i;

  if (ctx->cfg.debugging) {
    fprintf(stderr, "NVRTC compile options:\n");
    for (size_t j = 0; j < n_opts; j++) {
      fprintf(stderr, "\t%s\n", opts[j]);
    }
    fprintf(stderr, "\n");
  }

  nvrtcResult res = nvrtcCompileProgram(prog, n_opts, opts);
  if (res != NVRTC_SUCCESS) {
    size_t log_size;
    if (nvrtcGetProgramLogSize(prog, &log_size) == NVRTC_SUCCESS) {
      char *log = (char*) malloc(log_size);
      if (nvrtcGetProgramLog(prog, log) == NVRTC_SUCCESS) {
        fprintf(stderr,"Compilation log:\n%s\n", log);
      }
      free(log);
    }
    NVRTC_SUCCEED(res);
  }

  for (i = i_dyn; i < n_opts-num_extra_opts; i++) { free((char *)opts[i]); }
  free(opts);

  char *ptx;
  size_t ptx_size;
  NVRTC_SUCCEED(nvrtcGetPTXSize(prog, &ptx_size));
  ptx = (char*) malloc(ptx_size);
  NVRTC_SUCCEED(nvrtcGetPTX(prog, ptx));

  NVRTC_SUCCEED(nvrtcDestroyProgram(&prog));

  return ptx;
}

static void cuda_size_setup(struct cuda_context *ctx)
{
  if (ctx->cfg.default_block_size > ctx->max_block_size) {
    if (ctx->cfg.default_block_size_changed) {
      fprintf(stderr,
          "Note: Device limits default block size to %zu (down from %zu).\n",
          ctx->max_block_size, ctx->cfg.default_block_size);
    }
    ctx->cfg.default_block_size = ctx->max_block_size;
  }
  if (ctx->cfg.default_grid_size > ctx->max_grid_size) {
    if (ctx->cfg.default_grid_size_changed) {
      fprintf(stderr,
          "Note: Device limits default grid size to %zu (down from %zu).\n",
          ctx->max_grid_size, ctx->cfg.default_grid_size);
    }
    ctx->cfg.default_grid_size = ctx->max_grid_size;
  }
  if (ctx->cfg.default_tile_size > ctx->max_tile_size) {
    if (ctx->cfg.default_tile_size_changed) {
      fprintf(stderr,
          "Note: Device limits default tile size to %zu (down from %zu).\n",
          ctx->max_tile_size, ctx->cfg.default_tile_size);
    }
    ctx->cfg.default_tile_size = ctx->max_tile_size;
  }

  if (!ctx->cfg.default_grid_size_changed) {
    ctx->cfg.default_grid_size =
      (device_query(ctx->dev, MULTIPROCESSOR_COUNT) *
       device_query(ctx->dev, MAX_THREADS_PER_MULTIPROCESSOR))
      / ctx->cfg.default_block_size;
  }

  for (int i = 0; i < ctx->cfg.num_sizes; i++) {
    const char *size_class = ctx->cfg.size_classes[i];
    int64_t *size_value = &ctx->cfg.size_values[i];
    const char* size_name = ctx->cfg.size_names[i];
    int64_t max_value = 0, default_value = 0;

    if (strstr(size_class, "group_size") == size_class) {
      max_value = ctx->max_block_size;
      default_value = ctx->cfg.default_block_size;
    } else if (strstr(size_class, "num_groups") == size_class) {
      max_value = ctx->max_grid_size;
      default_value = ctx->cfg.default_grid_size;
      // XXX: as a quick and dirty hack, use twice as many threads for
      // histograms by default.  We really should just be smarter
      // about sizes somehow.
      if (strstr(size_name, ".seghist_") != NULL) {
        default_value *= 2;
      }
    } else if (strstr(size_class, "tile_size") == size_class) {
      max_value = ctx->max_tile_size;
      default_value = ctx->cfg.default_tile_size;
    } else if (strstr(size_class, "threshold") == size_class) {
      // Threshold can be as large as it takes.
      default_value = ctx->cfg.default_threshold;
    } else {
      // Bespoke sizes have no limit or default.
    }

    if (*size_value == 0) {
      *size_value = default_value;
    } else if (max_value > 0 && *size_value > max_value) {
      fprintf(stderr, "Note: Device limits %s to %zu (down from %zu)\n",
              size_name, max_value, *size_value);
      *size_value = max_value;
    }
  }
}

static void cuda_module_setup(struct cuda_context *ctx,
                              const char *src_fragments[],
                              const char *extra_opts[]) {
  char *ptx = NULL, *src = NULL;

  if (ctx->cfg.load_program_from == NULL) {
    src = concat_fragments(src_fragments);
  } else {
    src = slurp_file(ctx->cfg.load_program_from, NULL);
  }

  if (ctx->cfg.load_ptx_from) {
    if (ctx->cfg.load_program_from != NULL) {
      fprintf(stderr,
              "WARNING: Using PTX from %s instead of C code from %s\n",
              ctx->cfg.load_ptx_from, ctx->cfg.load_program_from);
    }
    ptx = slurp_file(ctx->cfg.load_ptx_from, NULL);
  }

  if (ctx->cfg.dump_program_to != NULL) {
    dump_file(ctx->cfg.dump_program_to, src, strlen(src));
  }

  if (ptx == NULL) {
    ptx = cuda_nvrtc_build(ctx, src, extra_opts);
  }

  if (ctx->cfg.dump_ptx_to != NULL) {
    dump_file(ctx->cfg.dump_ptx_to, ptx, strlen(ptx));
  }

  CUDA_SUCCEED(cuModuleLoadData(&ctx->module, ptx));

  free(ptx);
  if (src != NULL) {
    free(src);
  }
}

static void cuda_setup(struct cuda_context *ctx, const char *src_fragments[], const char *extra_opts[]) {
  CUDA_SUCCEED(cuInit(0));

  if (cuda_device_setup(ctx) != 0) {
    futhark_panic(-1, "No suitable CUDA device found.\n");
  }
  CUDA_SUCCEED(cuCtxCreate(&ctx->cu_ctx, 0, ctx->dev));

  free_list_init(&ctx->free_list);

  ctx->max_shared_memory = device_query(ctx->dev, MAX_SHARED_MEMORY_PER_BLOCK);
  ctx->max_block_size = device_query(ctx->dev, MAX_THREADS_PER_BLOCK);
  ctx->max_grid_size = device_query(ctx->dev, MAX_GRID_DIM_X);
  ctx->max_tile_size = sqrt(ctx->max_block_size);
  ctx->max_threshold = 0;
  ctx->max_bespoke = 0;
  ctx->lockstep_width = device_query(ctx->dev, WARP_SIZE);

  cuda_size_setup(ctx);
  cuda_module_setup(ctx, src_fragments, extra_opts);
}

// Count up the runtime all the profiling_records that occured during execution.
// Also clears the buffer of profiling_records.
static cudaError_t cuda_tally_profiling_records(struct cuda_context *ctx) {
  cudaError_t err;
  for (int i = 0; i < ctx->profiling_records_used; i++) {
    struct profiling_record record = ctx->profiling_records[i];

    float ms;
    if ((err = cudaEventElapsedTime(&ms, record.events[0], record.events[1])) != CUDA_SUCCESS) {
      return err;
    }

    // CUDA provides milisecond resolution, but we want microseconds.
    *record.runs += 1;
    *record.runtime += ms*1000;

    if ((err = cudaEventDestroy(record.events[0])) != CUDA_SUCCESS) {
      return err;
    }
    if ((err = cudaEventDestroy(record.events[1])) != CUDA_SUCCESS) {
      return err;
    }

    free(record.events);
  }

  ctx->profiling_records_used = 0;

  return CUDA_SUCCESS;
}

// Returns pointer to two events.
static cudaEvent_t* cuda_get_events(struct cuda_context *ctx, int *runs, int64_t *runtime) {
    if (ctx->profiling_records_used == ctx->profiling_records_capacity) {
      ctx->profiling_records_capacity *= 2;
      ctx->profiling_records =
        realloc(ctx->profiling_records,
                ctx->profiling_records_capacity *
                sizeof(struct profiling_record));
    }
    cudaEvent_t *events = calloc(2, sizeof(cudaEvent_t));
    cudaEventCreate(&events[0]);
    cudaEventCreate(&events[1]);
    ctx->profiling_records[ctx->profiling_records_used].events = events;
    ctx->profiling_records[ctx->profiling_records_used].runs = runs;
    ctx->profiling_records[ctx->profiling_records_used].runtime = runtime;
    ctx->profiling_records_used++;
    return events;
}

static CUresult cuda_free_all(struct cuda_context *ctx);

static void cuda_cleanup(struct cuda_context *ctx) {
  CUDA_SUCCEED(cuda_free_all(ctx));
  (void)cuda_tally_profiling_records(ctx);
  free(ctx->profiling_records);
  CUDA_SUCCEED(cuModuleUnload(ctx->module));
  CUDA_SUCCEED(cuCtxDestroy(ctx->cu_ctx));
}

static CUresult cuda_alloc(struct cuda_context *ctx, size_t min_size,
                           const char *tag, CUdeviceptr *mem_out) {
  if (min_size < sizeof(int)) {
    min_size = sizeof(int);
  }

  size_t size;
  if (free_list_find(&ctx->free_list, min_size, &size, mem_out) == 0) {
    if (size >= min_size) {
      return CUDA_SUCCESS;
    } else {
      CUresult res = cuMemFree(*mem_out);
      if (res != CUDA_SUCCESS) {
        return res;
      }
    }
  }

  CUresult res = cuMemAlloc(mem_out, min_size);
  while (res == CUDA_ERROR_OUT_OF_MEMORY) {
    CUdeviceptr mem;
    if (free_list_first(&ctx->free_list, &mem) == 0) {
      res = cuMemFree(mem);
      if (res != CUDA_SUCCESS) {
        return res;
      }
    } else {
      break;
    }
    res = cuMemAlloc(mem_out, min_size);
  }

  return res;
}

static CUresult cuda_free(struct cuda_context *ctx, CUdeviceptr mem,
                          const char *tag) {
  size_t size;
  CUdeviceptr existing_mem;

  // If there is already a block with this tag, then remove it.
  if (free_list_find(&ctx->free_list, -1, &size, &existing_mem) == 0) {
    CUresult res = cuMemFree(existing_mem);
    if (res != CUDA_SUCCESS) {
      return res;
    }
  }

  CUresult res = cuMemGetAddressRange(NULL, &size, mem);
  if (res == CUDA_SUCCESS) {
    free_list_insert(&ctx->free_list, size, mem, tag);
  }

  return res;
}

static CUresult cuda_free_all(struct cuda_context *ctx) {
  CUdeviceptr mem;
  free_list_pack(&ctx->free_list);
  while (free_list_first(&ctx->free_list, &mem) == 0) {
    CUresult res = cuMemFree(mem);
    if (res != CUDA_SUCCESS) {
      return res;
    }
  }

  return CUDA_SUCCESS;
}

// End of cuda.h.

const char *cuda_program[] =
           {"#define FUTHARK_CUDA\ntypedef char int8_t;\ntypedef short int16_t;\ntypedef int int32_t;\ntypedef long long int64_t;\ntypedef unsigned char uint8_t;\ntypedef unsigned short uint16_t;\ntypedef unsigned int uint32_t;\ntypedef unsigned long long uint64_t;\ntypedef uint8_t uchar;\ntypedef uint16_t ushort;\ntypedef uint32_t uint;\ntypedef uint64_t ulong;\n#define __kernel extern \"C\" __global__ __launch_bounds__(MAX_THREADS_PER_BLOCK)\n#define __global\n#define __local\n#define __private\n#define __constant\n#define __write_only\n#define __read_only\nstatic inline int get_group_id_fn(int block_dim0, int block_dim1,\n                                  int block_dim2, int d)\n{\n    switch (d) {\n        \n      case 0:\n        d = block_dim0;\n        break;\n        \n      case 1:\n        d = block_dim1;\n        break;\n        \n      case 2:\n        d = block_dim2;\n        break;\n    }\n    switch (d) {\n        \n      case 0:\n        return blockIdx.x;\n        \n      case 1:\n        return blockIdx.y;\n        \n      case 2:\n        return blockIdx.z;\n        \n      default:\n        return 0;\n    }\n}\n#define get_group_id(d) get_group_id_fn(block_dim0, block_dim1, block_dim2, d)\nstatic inline int get_num_groups_fn(int block_dim0, int block_dim1,\n                                    int block_dim2, int d)\n{\n    switch (d) {\n        \n      case 0:\n        d = block_dim0;\n        break;\n        \n      case 1:\n        d = block_dim1;\n        break;\n        \n      case 2:\n        d = block_dim2;\n        break;\n    }\n    switch (d) {\n        \n      case 0:\n        return gridDim.x;\n        \n      case 1:\n        return gridDim.y;\n        \n      case 2:\n        return gridDim.z;\n        \n      default:\n        return 0;\n    }\n}\n#define get_num_groups(d) get_num_groups_fn(block_dim0, block_dim1, block_dim2, d)\nstatic inline int get_local_id(int d)\n{\n    switch (d) {\n        \n      case 0:\n        return threadIdx.x;\n        \n      case 1:\n        return threadIdx.y;\n        \n      case 2:\n        return threadI",
            "dx.z;\n        \n      default:\n        return 0;\n    }\n}\nstatic inline int get_local_size(int d)\n{\n    switch (d) {\n        \n      case 0:\n        return blockDim.x;\n        \n      case 1:\n        return blockDim.y;\n        \n      case 2:\n        return blockDim.z;\n        \n      default:\n        return 0;\n    }\n}\nstatic inline int get_global_id_fn(int block_dim0, int block_dim1,\n                                   int block_dim2, int d)\n{\n    return get_group_id(d) * get_local_size(d) + get_local_id(d);\n}\n#define get_global_id(d) get_global_id_fn(block_dim0, block_dim1, block_dim2, d)\nstatic inline int get_global_size(int block_dim0, int block_dim1,\n                                  int block_dim2, int d)\n{\n    return get_num_groups(d) * get_local_size(d);\n}\n#define CLK_LOCAL_MEM_FENCE 1\n#define CLK_GLOBAL_MEM_FENCE 2\nstatic inline void barrier(int x)\n{\n    __syncthreads();\n}\nstatic inline void mem_fence_local()\n{\n    __threadfence_block();\n}\nstatic inline void mem_fence_global()\n{\n    __threadfence();\n}\n#define NAN (0.0/0.0)\n#define INFINITY (1.0/0.0)\nextern volatile __shared__ char shared_mem[];\nstatic inline uint8_t add8(uint8_t x, uint8_t y)\n{\n    return x + y;\n}\nstatic inline uint16_t add16(uint16_t x, uint16_t y)\n{\n    return x + y;\n}\nstatic inline uint32_t add32(uint32_t x, uint32_t y)\n{\n    return x + y;\n}\nstatic inline uint64_t add64(uint64_t x, uint64_t y)\n{\n    return x + y;\n}\nstatic inline uint8_t sub8(uint8_t x, uint8_t y)\n{\n    return x - y;\n}\nstatic inline uint16_t sub16(uint16_t x, uint16_t y)\n{\n    return x - y;\n}\nstatic inline uint32_t sub32(uint32_t x, uint32_t y)\n{\n    return x - y;\n}\nstatic inline uint64_t sub64(uint64_t x, uint64_t y)\n{\n    return x - y;\n}\nstatic inline uint8_t mul8(uint8_t x, uint8_t y)\n{\n    return x * y;\n}\nstatic inline uint16_t mul16(uint16_t x, uint16_t y)\n{\n    return x * y;\n}\nstatic inline uint32_t mul32(uint32_t x, uint32_t y)\n{\n    return x * y;\n}\nstatic inline uint64_t mul64(uint64_t x, uint64_t y)\n{\n    return x * y;\n",
            "}\nstatic inline uint8_t udiv8(uint8_t x, uint8_t y)\n{\n    return x / y;\n}\nstatic inline uint16_t udiv16(uint16_t x, uint16_t y)\n{\n    return x / y;\n}\nstatic inline uint32_t udiv32(uint32_t x, uint32_t y)\n{\n    return x / y;\n}\nstatic inline uint64_t udiv64(uint64_t x, uint64_t y)\n{\n    return x / y;\n}\nstatic inline uint8_t udiv_up8(uint8_t x, uint8_t y)\n{\n    return (x + y - 1) / y;\n}\nstatic inline uint16_t udiv_up16(uint16_t x, uint16_t y)\n{\n    return (x + y - 1) / y;\n}\nstatic inline uint32_t udiv_up32(uint32_t x, uint32_t y)\n{\n    return (x + y - 1) / y;\n}\nstatic inline uint64_t udiv_up64(uint64_t x, uint64_t y)\n{\n    return (x + y - 1) / y;\n}\nstatic inline uint8_t umod8(uint8_t x, uint8_t y)\n{\n    return x % y;\n}\nstatic inline uint16_t umod16(uint16_t x, uint16_t y)\n{\n    return x % y;\n}\nstatic inline uint32_t umod32(uint32_t x, uint32_t y)\n{\n    return x % y;\n}\nstatic inline uint64_t umod64(uint64_t x, uint64_t y)\n{\n    return x % y;\n}\nstatic inline uint8_t udiv_safe8(uint8_t x, uint8_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline uint16_t udiv_safe16(uint16_t x, uint16_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline uint32_t udiv_safe32(uint32_t x, uint32_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline uint64_t udiv_safe64(uint64_t x, uint64_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline uint8_t udiv_up_safe8(uint8_t x, uint8_t y)\n{\n    return y == 0 ? 0 : (x + y - 1) / y;\n}\nstatic inline uint16_t udiv_up_safe16(uint16_t x, uint16_t y)\n{\n    return y == 0 ? 0 : (x + y - 1) / y;\n}\nstatic inline uint32_t udiv_up_safe32(uint32_t x, uint32_t y)\n{\n    return y == 0 ? 0 : (x + y - 1) / y;\n}\nstatic inline uint64_t udiv_up_safe64(uint64_t x, uint64_t y)\n{\n    return y == 0 ? 0 : (x + y - 1) / y;\n}\nstatic inline uint8_t umod_safe8(uint8_t x, uint8_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline uint16_t umod_safe16(uint16_t x, uint16_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline uint32_t umod_safe32(uint32_t x, uint32_t y)\n{\n    r",
            "eturn y == 0 ? 0 : x % y;\n}\nstatic inline uint64_t umod_safe64(uint64_t x, uint64_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline int8_t sdiv8(int8_t x, int8_t y)\n{\n    int8_t q = x / y;\n    int8_t r = x % y;\n    \n    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\nstatic inline int16_t sdiv16(int16_t x, int16_t y)\n{\n    int16_t q = x / y;\n    int16_t r = x % y;\n    \n    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\nstatic inline int32_t sdiv32(int32_t x, int32_t y)\n{\n    int32_t q = x / y;\n    int32_t r = x % y;\n    \n    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\nstatic inline int64_t sdiv64(int64_t x, int64_t y)\n{\n    int64_t q = x / y;\n    int64_t r = x % y;\n    \n    return q - ((r != 0 && r < 0 != y < 0) ? 1 : 0);\n}\nstatic inline int8_t sdiv_up8(int8_t x, int8_t y)\n{\n    return sdiv8(x + y - 1, y);\n}\nstatic inline int16_t sdiv_up16(int16_t x, int16_t y)\n{\n    return sdiv16(x + y - 1, y);\n}\nstatic inline int32_t sdiv_up32(int32_t x, int32_t y)\n{\n    return sdiv32(x + y - 1, y);\n}\nstatic inline int64_t sdiv_up64(int64_t x, int64_t y)\n{\n    return sdiv64(x + y - 1, y);\n}\nstatic inline int8_t smod8(int8_t x, int8_t y)\n{\n    int8_t r = x % y;\n    \n    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\nstatic inline int16_t smod16(int16_t x, int16_t y)\n{\n    int16_t r = x % y;\n    \n    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\nstatic inline int32_t smod32(int32_t x, int32_t y)\n{\n    int32_t r = x % y;\n    \n    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\nstatic inline int64_t smod64(int64_t x, int64_t y)\n{\n    int64_t r = x % y;\n    \n    return r + (r == 0 || (x > 0 && y > 0) || (x < 0 && y < 0) ? 0 : y);\n}\nstatic inline int8_t sdiv_safe8(int8_t x, int8_t y)\n{\n    return y == 0 ? 0 : sdiv8(x, y);\n}\nstatic inline int16_t sdiv_safe16(int16_t x, int16_t y)\n{\n    return y == 0 ? 0 : sdiv16(x, y);\n}\nstatic inline int32_t sdiv_safe32(int32_t x, int32_t y)\n{\n    return y == 0 ? 0",
            " : sdiv32(x, y);\n}\nstatic inline int64_t sdiv_safe64(int64_t x, int64_t y)\n{\n    return y == 0 ? 0 : sdiv64(x, y);\n}\nstatic inline int8_t sdiv_up_safe8(int8_t x, int8_t y)\n{\n    return sdiv_safe8(x + y - 1, y);\n}\nstatic inline int16_t sdiv_up_safe16(int16_t x, int16_t y)\n{\n    return sdiv_safe16(x + y - 1, y);\n}\nstatic inline int32_t sdiv_up_safe32(int32_t x, int32_t y)\n{\n    return sdiv_safe32(x + y - 1, y);\n}\nstatic inline int64_t sdiv_up_safe64(int64_t x, int64_t y)\n{\n    return sdiv_safe64(x + y - 1, y);\n}\nstatic inline int8_t smod_safe8(int8_t x, int8_t y)\n{\n    return y == 0 ? 0 : smod8(x, y);\n}\nstatic inline int16_t smod_safe16(int16_t x, int16_t y)\n{\n    return y == 0 ? 0 : smod16(x, y);\n}\nstatic inline int32_t smod_safe32(int32_t x, int32_t y)\n{\n    return y == 0 ? 0 : smod32(x, y);\n}\nstatic inline int64_t smod_safe64(int64_t x, int64_t y)\n{\n    return y == 0 ? 0 : smod64(x, y);\n}\nstatic inline int8_t squot8(int8_t x, int8_t y)\n{\n    return x / y;\n}\nstatic inline int16_t squot16(int16_t x, int16_t y)\n{\n    return x / y;\n}\nstatic inline int32_t squot32(int32_t x, int32_t y)\n{\n    return x / y;\n}\nstatic inline int64_t squot64(int64_t x, int64_t y)\n{\n    return x / y;\n}\nstatic inline int8_t srem8(int8_t x, int8_t y)\n{\n    return x % y;\n}\nstatic inline int16_t srem16(int16_t x, int16_t y)\n{\n    return x % y;\n}\nstatic inline int32_t srem32(int32_t x, int32_t y)\n{\n    return x % y;\n}\nstatic inline int64_t srem64(int64_t x, int64_t y)\n{\n    return x % y;\n}\nstatic inline int8_t squot_safe8(int8_t x, int8_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline int16_t squot_safe16(int16_t x, int16_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline int32_t squot_safe32(int32_t x, int32_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline int64_t squot_safe64(int64_t x, int64_t y)\n{\n    return y == 0 ? 0 : x / y;\n}\nstatic inline int8_t srem_safe8(int8_t x, int8_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline int16_t srem_safe16(int16_t x, int16_t y)\n{\n    retu",
            "rn y == 0 ? 0 : x % y;\n}\nstatic inline int32_t srem_safe32(int32_t x, int32_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline int64_t srem_safe64(int64_t x, int64_t y)\n{\n    return y == 0 ? 0 : x % y;\n}\nstatic inline int8_t smin8(int8_t x, int8_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline int16_t smin16(int16_t x, int16_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline int32_t smin32(int32_t x, int32_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline int64_t smin64(int64_t x, int64_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline uint8_t umin8(uint8_t x, uint8_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline uint16_t umin16(uint16_t x, uint16_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline uint32_t umin32(uint32_t x, uint32_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline uint64_t umin64(uint64_t x, uint64_t y)\n{\n    return x < y ? x : y;\n}\nstatic inline int8_t smax8(int8_t x, int8_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline int16_t smax16(int16_t x, int16_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline int32_t smax32(int32_t x, int32_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline int64_t smax64(int64_t x, int64_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline uint8_t umax8(uint8_t x, uint8_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline uint16_t umax16(uint16_t x, uint16_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline uint32_t umax32(uint32_t x, uint32_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline uint64_t umax64(uint64_t x, uint64_t y)\n{\n    return x < y ? y : x;\n}\nstatic inline uint8_t shl8(uint8_t x, uint8_t y)\n{\n    return x << y;\n}\nstatic inline uint16_t shl16(uint16_t x, uint16_t y)\n{\n    return x << y;\n}\nstatic inline uint32_t shl32(uint32_t x, uint32_t y)\n{\n    return x << y;\n}\nstatic inline uint64_t shl64(uint64_t x, uint64_t y)\n{\n    return x << y;\n}\nstatic inline uint8_t lshr8(uint8_t x, uint8_t y)\n{\n    return x >> y;\n}\nstatic inline uint16_t lshr16(uint16_t x, uint16_t y)\n{\n    return x >> y;\n}\nstatic inline uint32_t lshr32(uint32_t ",
            "x, uint32_t y)\n{\n    return x >> y;\n}\nstatic inline uint64_t lshr64(uint64_t x, uint64_t y)\n{\n    return x >> y;\n}\nstatic inline int8_t ashr8(int8_t x, int8_t y)\n{\n    return x >> y;\n}\nstatic inline int16_t ashr16(int16_t x, int16_t y)\n{\n    return x >> y;\n}\nstatic inline int32_t ashr32(int32_t x, int32_t y)\n{\n    return x >> y;\n}\nstatic inline int64_t ashr64(int64_t x, int64_t y)\n{\n    return x >> y;\n}\nstatic inline uint8_t and8(uint8_t x, uint8_t y)\n{\n    return x & y;\n}\nstatic inline uint16_t and16(uint16_t x, uint16_t y)\n{\n    return x & y;\n}\nstatic inline uint32_t and32(uint32_t x, uint32_t y)\n{\n    return x & y;\n}\nstatic inline uint64_t and64(uint64_t x, uint64_t y)\n{\n    return x & y;\n}\nstatic inline uint8_t or8(uint8_t x, uint8_t y)\n{\n    return x | y;\n}\nstatic inline uint16_t or16(uint16_t x, uint16_t y)\n{\n    return x | y;\n}\nstatic inline uint32_t or32(uint32_t x, uint32_t y)\n{\n    return x | y;\n}\nstatic inline uint64_t or64(uint64_t x, uint64_t y)\n{\n    return x | y;\n}\nstatic inline uint8_t xor8(uint8_t x, uint8_t y)\n{\n    return x ^ y;\n}\nstatic inline uint16_t xor16(uint16_t x, uint16_t y)\n{\n    return x ^ y;\n}\nstatic inline uint32_t xor32(uint32_t x, uint32_t y)\n{\n    return x ^ y;\n}\nstatic inline uint64_t xor64(uint64_t x, uint64_t y)\n{\n    return x ^ y;\n}\nstatic inline bool ult8(uint8_t x, uint8_t y)\n{\n    return x < y;\n}\nstatic inline bool ult16(uint16_t x, uint16_t y)\n{\n    return x < y;\n}\nstatic inline bool ult32(uint32_t x, uint32_t y)\n{\n    return x < y;\n}\nstatic inline bool ult64(uint64_t x, uint64_t y)\n{\n    return x < y;\n}\nstatic inline bool ule8(uint8_t x, uint8_t y)\n{\n    return x <= y;\n}\nstatic inline bool ule16(uint16_t x, uint16_t y)\n{\n    return x <= y;\n}\nstatic inline bool ule32(uint32_t x, uint32_t y)\n{\n    return x <= y;\n}\nstatic inline bool ule64(uint64_t x, uint64_t y)\n{\n    return x <= y;\n}\nstatic inline bool slt8(int8_t x, int8_t y)\n{\n    return x < y;\n}\nstatic inline bool slt16(int16_t x, int16_t y)\n{\n    return x < y;\n}\nstatic i",
            "nline bool slt32(int32_t x, int32_t y)\n{\n    return x < y;\n}\nstatic inline bool slt64(int64_t x, int64_t y)\n{\n    return x < y;\n}\nstatic inline bool sle8(int8_t x, int8_t y)\n{\n    return x <= y;\n}\nstatic inline bool sle16(int16_t x, int16_t y)\n{\n    return x <= y;\n}\nstatic inline bool sle32(int32_t x, int32_t y)\n{\n    return x <= y;\n}\nstatic inline bool sle64(int64_t x, int64_t y)\n{\n    return x <= y;\n}\nstatic inline int8_t pow8(int8_t x, int8_t y)\n{\n    int8_t res = 1, rem = y;\n    \n    while (rem != 0) {\n        if (rem & 1)\n            res *= x;\n        rem >>= 1;\n        x *= x;\n    }\n    return res;\n}\nstatic inline int16_t pow16(int16_t x, int16_t y)\n{\n    int16_t res = 1, rem = y;\n    \n    while (rem != 0) {\n        if (rem & 1)\n            res *= x;\n        rem >>= 1;\n        x *= x;\n    }\n    return res;\n}\nstatic inline int32_t pow32(int32_t x, int32_t y)\n{\n    int32_t res = 1, rem = y;\n    \n    while (rem != 0) {\n        if (rem & 1)\n            res *= x;\n        rem >>= 1;\n        x *= x;\n    }\n    return res;\n}\nstatic inline int64_t pow64(int64_t x, int64_t y)\n{\n    int64_t res = 1, rem = y;\n    \n    while (rem != 0) {\n        if (rem & 1)\n            res *= x;\n        rem >>= 1;\n        x *= x;\n    }\n    return res;\n}\nstatic inline bool itob_i8_bool(int8_t x)\n{\n    return x;\n}\nstatic inline bool itob_i16_bool(int16_t x)\n{\n    return x;\n}\nstatic inline bool itob_i32_bool(int32_t x)\n{\n    return x;\n}\nstatic inline bool itob_i64_bool(int64_t x)\n{\n    return x;\n}\nstatic inline int8_t btoi_bool_i8(bool x)\n{\n    return x;\n}\nstatic inline int16_t btoi_bool_i16(bool x)\n{\n    return x;\n}\nstatic inline int32_t btoi_bool_i32(bool x)\n{\n    return x;\n}\nstatic inline int64_t btoi_bool_i64(bool x)\n{\n    return x;\n}\n#define sext_i8_i8(x) ((int8_t) (int8_t) x)\n#define sext_i8_i16(x) ((int16_t) (int8_t) x)\n#define sext_i8_i32(x) ((int32_t) (int8_t) x)\n#define sext_i8_i64(x) ((int64_t) (int8_t) x)\n#define sext_i16_i8(x) ((int8_t) (int16_t) x)\n#define sext_i16_i16(x) ((int1",
            "6_t) (int16_t) x)\n#define sext_i16_i32(x) ((int32_t) (int16_t) x)\n#define sext_i16_i64(x) ((int64_t) (int16_t) x)\n#define sext_i32_i8(x) ((int8_t) (int32_t) x)\n#define sext_i32_i16(x) ((int16_t) (int32_t) x)\n#define sext_i32_i32(x) ((int32_t) (int32_t) x)\n#define sext_i32_i64(x) ((int64_t) (int32_t) x)\n#define sext_i64_i8(x) ((int8_t) (int64_t) x)\n#define sext_i64_i16(x) ((int16_t) (int64_t) x)\n#define sext_i64_i32(x) ((int32_t) (int64_t) x)\n#define sext_i64_i64(x) ((int64_t) (int64_t) x)\n#define zext_i8_i8(x) ((int8_t) (uint8_t) x)\n#define zext_i8_i16(x) ((int16_t) (uint8_t) x)\n#define zext_i8_i32(x) ((int32_t) (uint8_t) x)\n#define zext_i8_i64(x) ((int64_t) (uint8_t) x)\n#define zext_i16_i8(x) ((int8_t) (uint16_t) x)\n#define zext_i16_i16(x) ((int16_t) (uint16_t) x)\n#define zext_i16_i32(x) ((int32_t) (uint16_t) x)\n#define zext_i16_i64(x) ((int64_t) (uint16_t) x)\n#define zext_i32_i8(x) ((int8_t) (uint32_t) x)\n#define zext_i32_i16(x) ((int16_t) (uint32_t) x)\n#define zext_i32_i32(x) ((int32_t) (uint32_t) x)\n#define zext_i32_i64(x) ((int64_t) (uint32_t) x)\n#define zext_i64_i8(x) ((int8_t) (uint64_t) x)\n#define zext_i64_i16(x) ((int16_t) (uint64_t) x)\n#define zext_i64_i32(x) ((int32_t) (uint64_t) x)\n#define zext_i64_i64(x) ((int64_t) (uint64_t) x)\n#if defined(__OPENCL_VERSION__)\nstatic int32_t futrts_popc8(int8_t x)\n{\n    return popcount(x);\n}\nstatic int32_t futrts_popc16(int16_t x)\n{\n    return popcount(x);\n}\nstatic int32_t futrts_popc32(int32_t x)\n{\n    return popcount(x);\n}\nstatic int32_t futrts_popc64(int64_t x)\n{\n    return popcount(x);\n}\n#elif defined(__CUDA_ARCH__)\nstatic int32_t futrts_popc8(int8_t x)\n{\n    return __popc(zext_i8_i32(x));\n}\nstatic int32_t futrts_popc16(int16_t x)\n{\n    return __popc(zext_i16_i32(x));\n}\nstatic int32_t futrts_popc32(int32_t x)\n{\n    return __popc(x);\n}\nstatic int32_t futrts_popc64(int64_t x)\n{\n    return __popcll(x);\n}\n#else\nstatic int32_t futrts_popc8(int8_t x)\n{\n    int c = 0;\n    \n    for (; x; ++c)\n        x &= x - 1;\n    return ",
            "c;\n}\nstatic int32_t futrts_popc16(int16_t x)\n{\n    int c = 0;\n    \n    for (; x; ++c)\n        x &= x - 1;\n    return c;\n}\nstatic int32_t futrts_popc32(int32_t x)\n{\n    int c = 0;\n    \n    for (; x; ++c)\n        x &= x - 1;\n    return c;\n}\nstatic int32_t futrts_popc64(int64_t x)\n{\n    int c = 0;\n    \n    for (; x; ++c)\n        x &= x - 1;\n    return c;\n}\n#endif\n#if defined(__OPENCL_VERSION__)\nstatic uint8_t futrts_mul_hi8(uint8_t a, uint8_t b)\n{\n    return mul_hi(a, b);\n}\nstatic uint16_t futrts_mul_hi16(uint16_t a, uint16_t b)\n{\n    return mul_hi(a, b);\n}\nstatic uint32_t futrts_mul_hi32(uint32_t a, uint32_t b)\n{\n    return mul_hi(a, b);\n}\nstatic uint64_t futrts_mul_hi64(uint64_t a, uint64_t b)\n{\n    return mul_hi(a, b);\n}\n#elif defined(__CUDA_ARCH__)\nstatic uint8_t futrts_mul_hi8(uint8_t a, uint8_t b)\n{\n    uint16_t aa = a;\n    uint16_t bb = b;\n    \n    return aa * bb >> 8;\n}\nstatic uint16_t futrts_mul_hi16(uint16_t a, uint16_t b)\n{\n    uint32_t aa = a;\n    uint32_t bb = b;\n    \n    return aa * bb >> 16;\n}\nstatic uint32_t futrts_mul_hi32(uint32_t a, uint32_t b)\n{\n    return mulhi(a, b);\n}\nstatic uint64_t futrts_mul_hi64(uint64_t a, uint64_t b)\n{\n    return mul64hi(a, b);\n}\n#else\nstatic uint8_t futrts_mul_hi8(uint8_t a, uint8_t b)\n{\n    uint16_t aa = a;\n    uint16_t bb = b;\n    \n    return aa * bb >> 8;\n}\nstatic uint16_t futrts_mul_hi16(uint16_t a, uint16_t b)\n{\n    uint32_t aa = a;\n    uint32_t bb = b;\n    \n    return aa * bb >> 16;\n}\nstatic uint32_t futrts_mul_hi32(uint32_t a, uint32_t b)\n{\n    uint64_t aa = a;\n    uint64_t bb = b;\n    \n    return aa * bb >> 32;\n}\nstatic uint64_t futrts_mul_hi64(uint64_t a, uint64_t b)\n{\n    __uint128_t aa = a;\n    __uint128_t bb = b;\n    \n    return aa * bb >> 64;\n}\n#endif\n#if defined(__OPENCL_VERSION__)\nstatic uint8_t futrts_mad_hi8(uint8_t a, uint8_t b, uint8_t c)\n{\n    return mad_hi(a, b, c);\n}\nstatic uint16_t futrts_mad_hi16(uint16_t a, uint16_t b, uint16_t c)\n{\n    return mad_hi(a, b, c);\n}\nstatic uint32_t futrts_mad_hi32(uint",
            "32_t a, uint32_t b, uint32_t c)\n{\n    return mad_hi(a, b, c);\n}\nstatic uint64_t futrts_mad_hi64(uint64_t a, uint64_t b, uint64_t c)\n{\n    return mad_hi(a, b, c);\n}\n#else\nstatic uint8_t futrts_mad_hi8(uint8_t a, uint8_t b, uint8_t c)\n{\n    return futrts_mul_hi8(a, b) + c;\n}\nstatic uint16_t futrts_mad_hi16(uint16_t a, uint16_t b, uint16_t c)\n{\n    return futrts_mul_hi16(a, b) + c;\n}\nstatic uint32_t futrts_mad_hi32(uint32_t a, uint32_t b, uint32_t c)\n{\n    return futrts_mul_hi32(a, b) + c;\n}\nstatic uint64_t futrts_mad_hi64(uint64_t a, uint64_t b, uint64_t c)\n{\n    return futrts_mul_hi64(a, b) + c;\n}\n#endif\n#if defined(__OPENCL_VERSION__)\nstatic int32_t futrts_clzz8(int8_t x)\n{\n    return clz(x);\n}\nstatic int32_t futrts_clzz16(int16_t x)\n{\n    return clz(x);\n}\nstatic int32_t futrts_clzz32(int32_t x)\n{\n    return clz(x);\n}\nstatic int32_t futrts_clzz64(int64_t x)\n{\n    return clz(x);\n}\n#elif defined(__CUDA_ARCH__)\nstatic int32_t futrts_clzz8(int8_t x)\n{\n    return __clz(zext_i8_i32(x)) - 24;\n}\nstatic int32_t futrts_clzz16(int16_t x)\n{\n    return __clz(zext_i16_i32(x)) - 16;\n}\nstatic int32_t futrts_clzz32(int32_t x)\n{\n    return __clz(x);\n}\nstatic int32_t futrts_clzz64(int64_t x)\n{\n    return __clzll(x);\n}\n#else\nstatic int32_t futrts_clzz8(int8_t x)\n{\n    int n = 0;\n    int bits = sizeof(x) * 8;\n    \n    for (int i = 0; i < bits; i++) {\n        if (x < 0)\n            break;\n        n++;\n        x <<= 1;\n    }\n    return n;\n}\nstatic int32_t futrts_clzz16(int16_t x)\n{\n    int n = 0;\n    int bits = sizeof(x) * 8;\n    \n    for (int i = 0; i < bits; i++) {\n        if (x < 0)\n            break;\n        n++;\n        x <<= 1;\n    }\n    return n;\n}\nstatic int32_t futrts_clzz32(int32_t x)\n{\n    int n = 0;\n    int bits = sizeof(x) * 8;\n    \n    for (int i = 0; i < bits; i++) {\n        if (x < 0)\n            break;\n        n++;\n        x <<= 1;\n    }\n    return n;\n}\nstatic int32_t futrts_clzz64(int64_t x)\n{\n    int n = 0;\n    int bits = sizeof(x) * 8;\n    \n    for (int i = 0; i < bits",
            "; i++) {\n        if (x < 0)\n            break;\n        n++;\n        x <<= 1;\n    }\n    return n;\n}\n#endif\n#if defined(__OPENCL_VERSION__)\nstatic int32_t futrts_ctzz8(int8_t x)\n{\n    int i = 0;\n    \n    for (; i < 8 && (x & 1) == 0; i++, x >>= 1)\n        ;\n    return i;\n}\nstatic int32_t futrts_ctzz16(int16_t x)\n{\n    int i = 0;\n    \n    for (; i < 16 && (x & 1) == 0; i++, x >>= 1)\n        ;\n    return i;\n}\nstatic int32_t futrts_ctzz32(int32_t x)\n{\n    int i = 0;\n    \n    for (; i < 32 && (x & 1) == 0; i++, x >>= 1)\n        ;\n    return i;\n}\nstatic int32_t futrts_ctzz64(int64_t x)\n{\n    int i = 0;\n    \n    for (; i < 64 && (x & 1) == 0; i++, x >>= 1)\n        ;\n    return i;\n}\n#elif defined(__CUDA_ARCH__)\nstatic int32_t futrts_ctzz8(int8_t x)\n{\n    int y = __ffs(x);\n    \n    return y == 0 ? 8 : y - 1;\n}\nstatic int32_t futrts_ctzz16(int16_t x)\n{\n    int y = __ffs(x);\n    \n    return y == 0 ? 16 : y - 1;\n}\nstatic int32_t futrts_ctzz32(int32_t x)\n{\n    int y = __ffs(x);\n    \n    return y == 0 ? 32 : y - 1;\n}\nstatic int32_t futrts_ctzz64(int64_t x)\n{\n    int y = __ffsll(x);\n    \n    return y == 0 ? 64 : y - 1;\n}\n#else\nstatic int32_t futrts_ctzz8(int8_t x)\n{\n    return x == 0 ? 8 : __builtin_ctz((uint32_t) x);\n}\nstatic int32_t futrts_ctzz16(int16_t x)\n{\n    return x == 0 ? 16 : __builtin_ctz((uint32_t) x);\n}\nstatic int32_t futrts_ctzz32(int32_t x)\n{\n    return x == 0 ? 32 : __builtin_ctz(x);\n}\nstatic int32_t futrts_ctzz64(int64_t x)\n{\n    return x == 0 ? 64 : __builtin_ctzll(x);\n}\n#endif\nstatic inline float fdiv32(float x, float y)\n{\n    return x / y;\n}\nstatic inline float fadd32(float x, float y)\n{\n    return x + y;\n}\nstatic inline float fsub32(float x, float y)\n{\n    return x - y;\n}\nstatic inline float fmul32(float x, float y)\n{\n    return x * y;\n}\nstatic inline float fmin32(float x, float y)\n{\n    return fmin(x, y);\n}\nstatic inline float fmax32(float x, float y)\n{\n    return fmax(x, y);\n}\nstatic inline float fpow32(float x, float y)\n{\n    return pow(x, y);\n}\nstatic inlin",
            "e bool cmplt32(float x, float y)\n{\n    return x < y;\n}\nstatic inline bool cmple32(float x, float y)\n{\n    return x <= y;\n}\nstatic inline float sitofp_i8_f32(int8_t x)\n{\n    return (float) x;\n}\nstatic inline float sitofp_i16_f32(int16_t x)\n{\n    return (float) x;\n}\nstatic inline float sitofp_i32_f32(int32_t x)\n{\n    return (float) x;\n}\nstatic inline float sitofp_i64_f32(int64_t x)\n{\n    return (float) x;\n}\nstatic inline float uitofp_i8_f32(uint8_t x)\n{\n    return (float) x;\n}\nstatic inline float uitofp_i16_f32(uint16_t x)\n{\n    return (float) x;\n}\nstatic inline float uitofp_i32_f32(uint32_t x)\n{\n    return (float) x;\n}\nstatic inline float uitofp_i64_f32(uint64_t x)\n{\n    return (float) x;\n}\nstatic inline int8_t fptosi_f32_i8(float x)\n{\n    return (int8_t) x;\n}\nstatic inline int16_t fptosi_f32_i16(float x)\n{\n    return (int16_t) x;\n}\nstatic inline int32_t fptosi_f32_i32(float x)\n{\n    return (int32_t) x;\n}\nstatic inline int64_t fptosi_f32_i64(float x)\n{\n    return (int64_t) x;\n}\nstatic inline uint8_t fptoui_f32_i8(float x)\n{\n    return (uint8_t) x;\n}\nstatic inline uint16_t fptoui_f32_i16(float x)\n{\n    return (uint16_t) x;\n}\nstatic inline uint32_t fptoui_f32_i32(float x)\n{\n    return (uint32_t) x;\n}\nstatic inline uint64_t fptoui_f32_i64(float x)\n{\n    return (uint64_t) x;\n}\nstatic inline float futrts_log32(float x)\n{\n    return log(x);\n}\nstatic inline float futrts_log2_32(float x)\n{\n    return log2(x);\n}\nstatic inline float futrts_log10_32(float x)\n{\n    return log10(x);\n}\nstatic inline float futrts_sqrt32(float x)\n{\n    return sqrt(x);\n}\nstatic inline float futrts_exp32(float x)\n{\n    return exp(x);\n}\nstatic inline float futrts_cos32(float x)\n{\n    return cos(x);\n}\nstatic inline float futrts_sin32(float x)\n{\n    return sin(x);\n}\nstatic inline float futrts_tan32(float x)\n{\n    return tan(x);\n}\nstatic inline float futrts_acos32(float x)\n{\n    return acos(x);\n}\nstatic inline float futrts_asin32(float x)\n{\n    return asin(x);\n}\nstatic inline float futrts_atan32(float x)\n",
            "{\n    return atan(x);\n}\nstatic inline float futrts_cosh32(float x)\n{\n    return cosh(x);\n}\nstatic inline float futrts_sinh32(float x)\n{\n    return sinh(x);\n}\nstatic inline float futrts_tanh32(float x)\n{\n    return tanh(x);\n}\nstatic inline float futrts_acosh32(float x)\n{\n    return acosh(x);\n}\nstatic inline float futrts_asinh32(float x)\n{\n    return asinh(x);\n}\nstatic inline float futrts_atanh32(float x)\n{\n    return atanh(x);\n}\nstatic inline float futrts_atan2_32(float x, float y)\n{\n    return atan2(x, y);\n}\nstatic inline float futrts_gamma32(float x)\n{\n    return tgamma(x);\n}\nstatic inline float futrts_lgamma32(float x)\n{\n    return lgamma(x);\n}\nstatic inline bool futrts_isnan32(float x)\n{\n    return isnan(x);\n}\nstatic inline bool futrts_isinf32(float x)\n{\n    return isinf(x);\n}\nstatic inline int32_t futrts_to_bits32(float x)\n{\n    union {\n        float f;\n        int32_t t;\n    } p;\n    \n    p.f = x;\n    return p.t;\n}\nstatic inline float futrts_from_bits32(int32_t x)\n{\n    union {\n        int32_t f;\n        float t;\n    } p;\n    \n    p.f = x;\n    return p.t;\n}\n#ifdef __OPENCL_VERSION__\nstatic inline float fmod32(float x, float y)\n{\n    return fmod(x, y);\n}\nstatic inline float futrts_round32(float x)\n{\n    return rint(x);\n}\nstatic inline float futrts_floor32(float x)\n{\n    return floor(x);\n}\nstatic inline float futrts_ceil32(float x)\n{\n    return ceil(x);\n}\nstatic inline float futrts_lerp32(float v0, float v1, float t)\n{\n    return mix(v0, v1, t);\n}\nstatic inline float futrts_mad32(float a, float b, float c)\n{\n    return mad(a, b, c);\n}\nstatic inline float futrts_fma32(float a, float b, float c)\n{\n    return fma(a, b, c);\n}\n#else\nstatic inline float fmod32(float x, float y)\n{\n    return fmodf(x, y);\n}\nstatic inline float futrts_round32(float x)\n{\n    return rintf(x);\n}\nstatic inline float futrts_floor32(float x)\n{\n    return floorf(x);\n}\nstatic inline float futrts_ceil32(float x)\n{\n    return ceilf(x);\n}\nstatic inline float futrts_lerp32(float v0, float v1, float t",
            ")\n{\n    return v0 + (v1 - v0) * t;\n}\nstatic inline float futrts_mad32(float a, float b, float c)\n{\n    return a * b + c;\n}\nstatic inline float futrts_fma32(float a, float b, float c)\n{\n    return fmaf(a, b, c);\n}\n#endif\nstatic inline double fdiv64(double x, double y)\n{\n    return x / y;\n}\nstatic inline double fadd64(double x, double y)\n{\n    return x + y;\n}\nstatic inline double fsub64(double x, double y)\n{\n    return x - y;\n}\nstatic inline double fmul64(double x, double y)\n{\n    return x * y;\n}\nstatic inline double fmin64(double x, double y)\n{\n    return fmin(x, y);\n}\nstatic inline double fmax64(double x, double y)\n{\n    return fmax(x, y);\n}\nstatic inline double fpow64(double x, double y)\n{\n    return pow(x, y);\n}\nstatic inline bool cmplt64(double x, double y)\n{\n    return x < y;\n}\nstatic inline bool cmple64(double x, double y)\n{\n    return x <= y;\n}\nstatic inline double sitofp_i8_f64(int8_t x)\n{\n    return (double) x;\n}\nstatic inline double sitofp_i16_f64(int16_t x)\n{\n    return (double) x;\n}\nstatic inline double sitofp_i32_f64(int32_t x)\n{\n    return (double) x;\n}\nstatic inline double sitofp_i64_f64(int64_t x)\n{\n    return (double) x;\n}\nstatic inline double uitofp_i8_f64(uint8_t x)\n{\n    return (double) x;\n}\nstatic inline double uitofp_i16_f64(uint16_t x)\n{\n    return (double) x;\n}\nstatic inline double uitofp_i32_f64(uint32_t x)\n{\n    return (double) x;\n}\nstatic inline double uitofp_i64_f64(uint64_t x)\n{\n    return (double) x;\n}\nstatic inline int8_t fptosi_f64_i8(double x)\n{\n    return (int8_t) x;\n}\nstatic inline int16_t fptosi_f64_i16(double x)\n{\n    return (int16_t) x;\n}\nstatic inline int32_t fptosi_f64_i32(double x)\n{\n    return (int32_t) x;\n}\nstatic inline int64_t fptosi_f64_i64(double x)\n{\n    return (int64_t) x;\n}\nstatic inline uint8_t fptoui_f64_i8(double x)\n{\n    return (uint8_t) x;\n}\nstatic inline uint16_t fptoui_f64_i16(double x)\n{\n    return (uint16_t) x;\n}\nstatic inline uint32_t fptoui_f64_i32(double x)\n{\n    return (uint32_t) x;\n}\nstatic inline uint64",
            "_t fptoui_f64_i64(double x)\n{\n    return (uint64_t) x;\n}\nstatic inline double futrts_log64(double x)\n{\n    return log(x);\n}\nstatic inline double futrts_log2_64(double x)\n{\n    return log2(x);\n}\nstatic inline double futrts_log10_64(double x)\n{\n    return log10(x);\n}\nstatic inline double futrts_sqrt64(double x)\n{\n    return sqrt(x);\n}\nstatic inline double futrts_exp64(double x)\n{\n    return exp(x);\n}\nstatic inline double futrts_cos64(double x)\n{\n    return cos(x);\n}\nstatic inline double futrts_sin64(double x)\n{\n    return sin(x);\n}\nstatic inline double futrts_tan64(double x)\n{\n    return tan(x);\n}\nstatic inline double futrts_acos64(double x)\n{\n    return acos(x);\n}\nstatic inline double futrts_asin64(double x)\n{\n    return asin(x);\n}\nstatic inline double futrts_atan64(double x)\n{\n    return atan(x);\n}\nstatic inline double futrts_cosh64(double x)\n{\n    return cosh(x);\n}\nstatic inline double futrts_sinh64(double x)\n{\n    return sinh(x);\n}\nstatic inline double futrts_tanh64(double x)\n{\n    return tanh(x);\n}\nstatic inline double futrts_acosh64(double x)\n{\n    return acosh(x);\n}\nstatic inline double futrts_asinh64(double x)\n{\n    return asinh(x);\n}\nstatic inline double futrts_atanh64(double x)\n{\n    return atanh(x);\n}\nstatic inline double futrts_atan2_64(double x, double y)\n{\n    return atan2(x, y);\n}\nstatic inline double futrts_gamma64(double x)\n{\n    return tgamma(x);\n}\nstatic inline double futrts_lgamma64(double x)\n{\n    return lgamma(x);\n}\nstatic inline double futrts_fma64(double a, double b, double c)\n{\n    return fma(a, b, c);\n}\nstatic inline double futrts_round64(double x)\n{\n    return rint(x);\n}\nstatic inline double futrts_ceil64(double x)\n{\n    return ceil(x);\n}\nstatic inline double futrts_floor64(double x)\n{\n    return floor(x);\n}\nstatic inline bool futrts_isnan64(double x)\n{\n    return isnan(x);\n}\nstatic inline bool futrts_isinf64(double x)\n{\n    return isinf(x);\n}\nstatic inline int64_t futrts_to_bits64(double x)\n{\n    union {\n        double f;\n        int64_t t;",
            "\n    } p;\n    \n    p.f = x;\n    return p.t;\n}\nstatic inline double futrts_from_bits64(int64_t x)\n{\n    union {\n        int64_t f;\n        double t;\n    } p;\n    \n    p.f = x;\n    return p.t;\n}\nstatic inline double fmod64(double x, double y)\n{\n    return fmod(x, y);\n}\n#ifdef __OPENCL_VERSION__\nstatic inline double futrts_lerp64(double v0, double v1, double t)\n{\n    return mix(v0, v1, t);\n}\nstatic inline double futrts_mad64(double a, double b, double c)\n{\n    return mad(a, b, c);\n}\n#else\nstatic inline double futrts_lerp64(double v0, double v1, double t)\n{\n    return v0 + (v1 - v0) * t;\n}\nstatic inline double futrts_mad64(double a, double b, double c)\n{\n    return a * b + c;\n}\n#endif\nstatic inline float fpconv_f32_f32(float x)\n{\n    return (float) x;\n}\nstatic inline double fpconv_f32_f64(float x)\n{\n    return (double) x;\n}\nstatic inline float fpconv_f64_f32(double x)\n{\n    return (float) x;\n}\nstatic inline double fpconv_f64_f64(double x)\n{\n    return (double) x;\n}\n// Start of atomics.h\n\ninline int32_t atomic_add_i32_global(volatile __global int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicAdd((int32_t*)p, x);\n#else\n  return atomic_add(p, x);\n#endif\n}\n\ninline int32_t atomic_add_i32_local(volatile __local int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicAdd((int32_t*)p, x);\n#else\n  return atomic_add(p, x);\n#endif\n}\n\ninline float atomic_fadd_f32_global(volatile __global float *p, float x) {\n#ifdef FUTHARK_CUDA\n  return atomicAdd((float*)p, x);\n#else\n  union { int32_t i; float f; } old;\n  union { int32_t i; float f; } assumed;\n  old.f = *p;\n  do {\n    assumed.f = old.f;\n    old.f = old.f + x;\n    old.i = atomic_cmpxchg((volatile __global int32_t*)p, assumed.i, old.i);\n  } while (assumed.i != old.i);\n  return old.f;\n#endif\n}\n\ninline float atomic_fadd_f32_local(volatile __local float *p, float x) {\n#ifdef FUTHARK_CUDA\n  return atomicAdd((float*)p, x);\n#else\n  union { int32_t i; float f; } old;\n  union { int32_t i; float f; } assumed;\n  old.f = *p;\n  do ",
            "{\n    assumed.f = old.f;\n    old.f = old.f + x;\n    old.i = atomic_cmpxchg((volatile __local int32_t*)p, assumed.i, old.i);\n  } while (assumed.i != old.i);\n  return old.f;\n#endif\n}\n\ninline int32_t atomic_smax_i32_global(volatile __global int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMax((int32_t*)p, x);\n#else\n  return atomic_max(p, x);\n#endif\n}\n\ninline int32_t atomic_smax_i32_local(volatile __local int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMax((int32_t*)p, x);\n#else\n  return atomic_max(p, x);\n#endif\n}\n\ninline int32_t atomic_smin_i32_global(volatile __global int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMin((int32_t*)p, x);\n#else\n  return atomic_min(p, x);\n#endif\n}\n\ninline int32_t atomic_smin_i32_local(volatile __local int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMin((int32_t*)p, x);\n#else\n  return atomic_min(p, x);\n#endif\n}\n\ninline uint32_t atomic_umax_i32_global(volatile __global uint32_t *p, uint32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMax((uint32_t*)p, x);\n#else\n  return atomic_max(p, x);\n#endif\n}\n\ninline uint32_t atomic_umax_i32_local(volatile __local uint32_t *p, uint32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMax((uint32_t*)p, x);\n#else\n  return atomic_max(p, x);\n#endif\n}\n\ninline uint32_t atomic_umin_i32_global(volatile __global uint32_t *p, uint32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMin((uint32_t*)p, x);\n#else\n  return atomic_min(p, x);\n#endif\n}\n\ninline uint32_t atomic_umin_i32_local(volatile __local uint32_t *p, uint32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicMin((uint32_t*)p, x);\n#else\n  return atomic_min(p, x);\n#endif\n}\n\ninline int32_t atomic_and_i32_global(volatile __global int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicAnd((int32_t*)p, x);\n#else\n  return atomic_and(p, x);\n#endif\n}\n\ninline int32_t atomic_and_i32_local(volatile __local int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicAnd((int32_t*)p, x);\n#else\n  return atomic_and(p, x);\n#endif\n}\n\ninline int32_t",
            " atomic_or_i32_global(volatile __global int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicOr((int32_t*)p, x);\n#else\n  return atomic_or(p, x);\n#endif\n}\n\ninline int32_t atomic_or_i32_local(volatile __local int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicOr((int32_t*)p, x);\n#else\n  return atomic_or(p, x);\n#endif\n}\n\ninline int32_t atomic_xor_i32_global(volatile __global int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicXor((int32_t*)p, x);\n#else\n  return atomic_xor(p, x);\n#endif\n}\n\ninline int32_t atomic_xor_i32_local(volatile __local int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicXor((int32_t*)p, x);\n#else\n  return atomic_xor(p, x);\n#endif\n}\n\ninline int32_t atomic_xchg_i32_global(volatile __global int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicExch((int32_t*)p, x);\n#else\n  return atomic_xor(p, x);\n#endif\n}\n\ninline int32_t atomic_xchg_i32_local(volatile __local int32_t *p, int32_t x) {\n#ifdef FUTHARK_CUDA\n  return atomicExch((int32_t*)p, x);\n#else\n  return atomic_xor(p, x);\n#endif\n}\n\ninline int32_t atomic_cmpxchg_i32_global(volatile __global int32_t *p,\n                                         int32_t cmp, int32_t val) {\n#ifdef FUTHARK_CUDA\n  return atomicCAS((int32_t*)p, cmp, val);\n#else\n  return atomic_cmpxchg(p, cmp, val);\n#endif\n}\n\ninline int32_t atomic_cmpxchg_i32_local(volatile __local int32_t *p,\n                                         int32_t cmp, int32_t val) {\n#ifdef FUTHARK_CUDA\n  return atomicCAS((int32_t*)p, cmp, val);\n#else\n  return atomic_cmpxchg(p, cmp, val);\n#endif\n}\n\n// End of atomics.h\n\n\n\n\n__kernel void builtinzhiota_i64ziiota_i64_29305(int32_t n_29301,\n                                                int64_t x_29302,\n                                                int64_t s_29303, __global\n                                                unsigned char *mem_29300)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    int32_t iota_gtid_29305;\n    int32_t i",
            "ota_ltid_29306;\n    int32_t iota_gid_29307;\n    \n    iota_gtid_29305 = get_global_id(0);\n    iota_ltid_29306 = get_local_id(0);\n    iota_gid_29307 = get_group_id(0);\n    if (slt64(iota_gtid_29305, n_29301)) {\n        ((__global int64_t *) mem_29300)[sext_i32_i64(iota_gtid_29305)] =\n            add64(mul64(sext_i32_i64(iota_gtid_29305), s_29303), x_29302);\n    }\n    \n  error_0:\n    return;\n}\n__kernel void builtinzhreplicate_f64zireplicate_29284(int32_t num_elems_29281,\n                                                      double val_29282, __global\n                                                      unsigned char *mem_29280)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    int32_t replicate_gtid_29284;\n    int32_t replicate_ltid_29285;\n    int32_t replicate_gid_29286;\n    \n    replicate_gtid_29284 = get_global_id(0);\n    replicate_ltid_29285 = get_local_id(0);\n    replicate_gid_29286 = get_group_id(0);\n    if (slt64(replicate_gtid_29284, num_elems_29281)) {\n        ((__global double *) mem_29280)[sext_i32_i64(replicate_gtid_29284)] =\n            val_29282;\n    }\n    \n  error_0:\n    return;\n}\n__kernel void builtinzhreplicate_i64zireplicate_29293(int32_t num_elems_29290,\n                                                      int64_t val_29291,\n                                                      __global\n                                                      unsigned char *mem_29289)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    int32_t replicate_gtid_29293;\n    int32_t replicate_ltid_29294;\n    int32_t replicate_gid_29295;\n    \n    replicate_gtid_29293 = get_global_id(0);\n    replicate_ltid_29294 = get_local_id(0);\n    replicate_gid_29295 = get_group_id(0);\n    if (slt64(replicate_gtid_29293, num_elems_29290)) {\n        ((__global int64_t *) mem_29289)[sext_i32_i64(replicate_gtid_29293)] =\n            val_29291;\n    }\n    \n  error_0:\n    return;\n}\n__kernel void builtinzhr",
            "eplicate_i8zireplicate_29185(int32_t num_elems_29182,\n                                                     int8_t val_29183, __global\n                                                     unsigned char *mem_29181)\n{\n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    int32_t replicate_gtid_29185;\n    int32_t replicate_ltid_29186;\n    int32_t replicate_gid_29187;\n    \n    replicate_gtid_29185 = get_global_id(0);\n    replicate_ltid_29186 = get_local_id(0);\n    replicate_gid_29187 = get_group_id(0);\n    if (slt64(replicate_gtid_29185, num_elems_29182)) {\n        ((__global int8_t *) mem_29181)[sext_i32_i64(replicate_gtid_29185)] =\n            val_29183;\n    }\n    \n  error_0:\n    return;\n}\n__kernel void eWiseAddEntryzisegmap_27547(__global int *global_failure,\n                                          int64_t conc_tmp_25517,\n                                          int64_t last_res_25611,\n                                          int64_t last_res_25612,\n                                          int64_t last_res_25613, __global\n                                          unsigned char *mem_param_28374,\n                                          __global\n                                          unsigned char *mem_param_28379,\n                                          __global unsigned char *mem_28386,\n                                          __global unsigned char *mem_28388,\n                                          __global unsigned char *mem_28390,\n                                          __global unsigned char *mem_28392,\n                                          __global unsigned char *mem_28394,\n                                          __global unsigned char *mem_28396,\n                                          __global unsigned char *mem_28398)\n{\n    #define segmap_group_sizze_27550 (eWiseAddEntryzisegmap_group_sizze_27549)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n",
            "    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29530;\n    int32_t local_tid_29531;\n    int64_t group_sizze_29534;\n    int32_t wave_sizze_29533;\n    int32_t group_tid_29532;\n    \n    global_tid_29530 = get_global_id(0);\n    local_tid_29531 = get_local_id(0);\n    group_sizze_29534 = get_local_size(0);\n    wave_sizze_29533 = LOCKSTEP_WIDTH;\n    group_tid_29532 = get_group_id(0);\n    \n    int32_t phys_tid_27547;\n    \n    phys_tid_27547 = global_tid_29530;\n    \n    int64_t write_i_27546;\n    \n    write_i_27546 = sext_i32_i64(group_tid_29532) * segmap_group_sizze_27550 +\n        sext_i32_i64(local_tid_29531);\n    if (slt64(write_i_27546, conc_tmp_25517)) {\n        int32_t x_25618 = ((__global int32_t *) mem_28394)[write_i_27546];\n        int64_t write_value_25623 = ((__global\n                                      int64_t *) mem_param_28374)[write_i_27546];\n        int64_t write_value_25624 = ((__global\n                                      int64_t *) mem_param_28379)[write_i_27546];\n        bool match_lit_25625 = 0 == x_25618;\n        int64_t defunc_1_f_res_25626;\n        \n        if (match_lit_25625) {\n            int64_t x_25619 = ((__global int64_t *) mem_28386)[write_i_27546];\n            int64_t case_res_25627 = sub64(x_25619, (int64_t) 1);\n            \n            defunc_1_f_res_25626 = case_res_25627;\n        } else {\n            int64_t x_25620 = ((__global int64_t *) mem_28388)[write_i_27546];\n            int64_t x_25621 = ((__global int64_t *) mem_28390)[write_i_27546];\n            int64_t x_25622 = ((__global int64_t *) mem_28392)[write_i_27546];\n            bool match_lit_25628 = 1 == x_25618;\n            int64_t x_25629;\n            \n            if (match_lit_25628) {\n                int64_t x_25630 = add64(last_res_25611, x_25620);\n                int64_t case_res_25631 = sub64(x_25630, (int64_t) 1);\n                \n                x_25629 = case_res_25631;\n            } else {\n                bool match_lit_25632 = 2 == x_25618;\n",
            "                int64_t x_25633;\n                \n                if (match_lit_25632) {\n                    int64_t x_25634 = add64(last_res_25611, last_res_25612);\n                    int64_t x_25635 = add64(x_25621, x_25634);\n                    int64_t case_res_25636 = sub64(x_25635, (int64_t) 1);\n                    \n                    x_25633 = case_res_25636;\n                } else {\n                    int64_t x_25637 = add64(last_res_25611, last_res_25612);\n                    int64_t x_25638 = add64(last_res_25613, x_25637);\n                    int64_t x_25639 = add64(x_25622, x_25638);\n                    int64_t defunc_1_f_res_res_25640 = sub64(x_25639,\n                                                             (int64_t) 1);\n                    \n                    x_25633 = defunc_1_f_res_res_25640;\n                }\n                x_25629 = x_25633;\n            }\n            defunc_1_f_res_25626 = x_25629;\n        }\n        if (sle64((int64_t) 0, defunc_1_f_res_25626) &&\n            slt64(defunc_1_f_res_25626, conc_tmp_25517)) {\n            ((__global int64_t *) mem_28396)[defunc_1_f_res_25626] =\n                write_value_25623;\n        }\n        if (sle64((int64_t) 0, defunc_1_f_res_25626) &&\n            slt64(defunc_1_f_res_25626, conc_tmp_25517)) {\n            ((__global int64_t *) mem_28398)[defunc_1_f_res_25626] =\n                write_value_25624;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_27550\n}\n__kernel void eWiseAddEntryzisegmap_27606(__global int *global_failure,\n                                          int failure_is_an_option, __global\n                                          int64_t *global_failure_args,\n                                          int64_t i_25475, int64_t i_25497,\n                                          int64_t j_m_i_25499,\n                                          int64_t conc_tmp_25517, __global\n                                          unsigned char *leftColumns_mem_28232,\n       ",
            "                                   __global\n                                          unsigned char *rightColumns_mem_28235,\n                                          __global\n                                          unsigned char *defunc_0_f_res_mem_28413,\n                                          __global unsigned char *mem_28416,\n                                          __global unsigned char *mem_28418,\n                                          __global unsigned char *mem_28420,\n                                          __global unsigned char *mem_28422)\n{\n    #define segmap_group_sizze_27631 (eWiseAddEntryzisegmap_group_sizze_27608)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29535;\n    int32_t local_tid_29536;\n    int64_t group_sizze_29539;\n    int32_t wave_sizze_29538;\n    int32_t group_tid_29537;\n    \n    global_tid_29535 = get_global_id(0);\n    local_tid_29536 = get_local_id(0);\n    group_sizze_29539 = get_local_size(0);\n    wave_sizze_29538 = LOCKSTEP_WIDTH;\n    group_tid_29537 = get_group_id(0);\n    \n    int32_t phys_tid_27606;\n    \n    phys_tid_27606 = global_tid_29535;\n    \n    int64_t gtid_27605;\n    \n    gtid_27605 = sext_i32_i64(group_tid_29537) * segmap_group_sizze_27631 +\n        sext_i32_i64(local_tid_29536);\n    if (slt64(gtid_27605, conc_tmp_25517)) {\n        int64_t x_27637 = ((__global\n                            int64_t *) defunc_0_f_res_mem_28413)[gtid_27605];\n        bool x_27638 = sle64((int64_t) 0, x_27637);\n        bool y_27639 = slt64(x_27637, conc_tmp_25517);\n        bool bounds_check_27640 = x_27638 && y_27639;\n        bool index_certs_27641;\n        \n        if (!bounds_check_27640) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 9) == -1) {\n                    global_failure_args[0] = x_27637;\n                    global_failure_args[1] = conc_tmp_25517;\n                ",
            "    ;\n                }\n                return;\n            }\n        }\n        \n        bool index_concat_cmp_27642 = sle64(j_m_i_25499, x_27637);\n        int64_t index_concat_branch_27643;\n        \n        if (index_concat_cmp_27642) {\n            int64_t index_concat_i_27644 = sub64(x_27637, j_m_i_25499);\n            int64_t slice_27645 = i_25475 + index_concat_i_27644;\n            int64_t index_concat_27646 = ((__global\n                                           int64_t *) rightColumns_mem_28235)[slice_27645];\n            \n            index_concat_branch_27643 = index_concat_27646;\n        } else {\n            int64_t slice_27647 = i_25497 + x_27637;\n            int64_t index_concat_27648 = ((__global\n                                           int64_t *) leftColumns_mem_28232)[slice_27647];\n            \n            index_concat_branch_27643 = index_concat_27648;\n        }\n        \n        int64_t defunc_0_f_res_27649 = index_concat_branch_27643;\n        int64_t index_concat_branch_27650 =\n                btoi_bool_i64(index_concat_cmp_27642);\n        int64_t defunc_0_f_res_27651 = index_concat_branch_27650;\n        int64_t index_concat_branch_27652;\n        \n        if (index_concat_cmp_27642) {\n            int64_t index_concat_i_27653 = sub64(x_27637, j_m_i_25499);\n            \n            index_concat_branch_27652 = index_concat_i_27653;\n        } else {\n            index_concat_branch_27652 = x_27637;\n        }\n        \n        int64_t defunc_0_f_res_27654 = index_concat_branch_27652;\n        int64_t defunc_0_f_res_27655 = (int64_t) 0;\n        \n        ((__global int64_t *) mem_28416)[gtid_27605] = defunc_0_f_res_27649;\n        ((__global int64_t *) mem_28418)[gtid_27605] = defunc_0_f_res_27651;\n        ((__global int64_t *) mem_28420)[gtid_27605] = defunc_0_f_res_27654;\n        ((__global int64_t *) mem_28422)[gtid_27605] = defunc_0_f_res_27655;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_27631\n}\n__kernel void eWiseAddEntryzisegmap_27665(",
            "__global int *global_failure,\n                                          int64_t conc_tmp_25517, __global\n                                          unsigned char *mem_28425, __global\n                                          unsigned char *mem_28427, __global\n                                          unsigned char *mem_28429, __global\n                                          unsigned char *mem_28431, __global\n                                          unsigned char *mem_28433, __global\n                                          unsigned char *mem_28435, __global\n                                          unsigned char *mem_28437, __global\n                                          unsigned char *mem_28439, __global\n                                          unsigned char *mem_28441, __global\n                                          unsigned char *mem_28443)\n{\n    #define segmap_group_sizze_27668 (eWiseAddEntryzisegmap_group_sizze_27667)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29621;\n    int32_t local_tid_29622;\n    int64_t group_sizze_29625;\n    int32_t wave_sizze_29624;\n    int32_t group_tid_29623;\n    \n    global_tid_29621 = get_global_id(0);\n    local_tid_29622 = get_local_id(0);\n    group_sizze_29625 = get_local_size(0);\n    wave_sizze_29624 = LOCKSTEP_WIDTH;\n    group_tid_29623 = get_group_id(0);\n    \n    int32_t phys_tid_27665;\n    \n    phys_tid_27665 = global_tid_29621;\n    \n    int64_t write_i_27664;\n    \n    write_i_27664 = sext_i32_i64(group_tid_29623) * segmap_group_sizze_27668 +\n        sext_i32_i64(local_tid_29622);\n    if (slt64(write_i_27664, conc_tmp_25517)) {\n        int64_t c_25796 = ((__global int64_t *) mem_28427)[write_i_27664];\n        int64_t offset_25797 = ((__global int64_t *) mem_28425)[write_i_27664];\n        int64_t v_25798 = ((__global int64_t *) mem_28429)[write_i_27664];\n        int64_t v_25799 = ((__global ",
            "int64_t *) mem_28431)[write_i_27664];\n        int64_t v_25800 = ((__global int64_t *) mem_28433)[write_i_27664];\n        int64_t v_25801 = ((__global int64_t *) mem_28435)[write_i_27664];\n        bool is_this_one_25802 = c_25796 == (int64_t) 0;\n        int64_t this_offset_25803 = (int64_t) -1 + offset_25797;\n        int64_t total_res_25804;\n        \n        if (is_this_one_25802) {\n            total_res_25804 = this_offset_25803;\n        } else {\n            total_res_25804 = (int64_t) -1;\n        }\n        if (sle64((int64_t) 0, total_res_25804) && slt64(total_res_25804,\n                                                         conc_tmp_25517)) {\n            ((__global int64_t *) mem_28437)[total_res_25804] = v_25798;\n        }\n        if (sle64((int64_t) 0, total_res_25804) && slt64(total_res_25804,\n                                                         conc_tmp_25517)) {\n            ((__global int64_t *) mem_28439)[total_res_25804] = v_25799;\n        }\n        if (sle64((int64_t) 0, total_res_25804) && slt64(total_res_25804,\n                                                         conc_tmp_25517)) {\n            ((__global int64_t *) mem_28441)[total_res_25804] = v_25800;\n        }\n        if (sle64((int64_t) 0, total_res_25804) && slt64(total_res_25804,\n                                                         conc_tmp_25517)) {\n            ((__global int64_t *) mem_28443)[total_res_25804] = v_25801;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_27668\n}\n__kernel void eWiseAddEntryzisegmap_27671(__global int *global_failure,\n                                          int failure_is_an_option, __global\n                                          int64_t *global_failure_args,\n                                          int64_t n_25269, int64_t k_25271,\n                                          int64_t eWiseAddOffsets_res_25462,\n                                          int64_t i_25475, int64_t i_25497,\n                                         ",
            " int64_t sizze_25518, int64_t y_25825,\n                                          int64_t indxs_25826,\n                                          int64_t unionArrays_res_ixfn_28460,\n                                          __global\n                                          unsigned char *leftValues_mem_28231,\n                                          __global\n                                          unsigned char *rightValues_mem_28234,\n                                          __global unsigned char *mem_28339,\n                                          __global unsigned char *mem_28341,\n                                          __global\n                                          unsigned char *unionArrays_res_mem_28461,\n                                          __global\n                                          unsigned char *unionArrays_res_mem_28464,\n                                          __global\n                                          unsigned char *unionArrays_res_mem_28467,\n                                          __global\n                                          unsigned char *unionArrays_res_mem_28470)\n{\n    #define segmap_group_sizze_27674 (eWiseAddEntryzisegmap_group_sizze_27673)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29626;\n    int32_t local_tid_29627;\n    int64_t group_sizze_29630;\n    int32_t wave_sizze_29629;\n    int32_t group_tid_29628;\n    \n    global_tid_29626 = get_global_id(0);\n    local_tid_29627 = get_local_id(0);\n    group_sizze_29630 = get_local_size(0);\n    wave_sizze_29629 = LOCKSTEP_WIDTH;\n    group_tid_29628 = get_group_id(0);\n    \n    int32_t phys_tid_27671;\n    \n    phys_tid_27671 = global_tid_29626;\n    \n    int64_t write_i_27670;\n    \n    write_i_27670 = sext_i32_i64(group_tid_29628) * segmap_group_sizze_27674 +\n        sext_i32_i64(local_tid_29627);\n    if (slt64(write_i_27670, indxs_25826)) {\n ",
            "       int64_t index_primexp_28112 = add64(y_25825, write_i_27670);\n        int64_t write_value_25839 = ((__global\n                                      int64_t *) unionArrays_res_mem_28461)[unionArrays_res_ixfn_28460 +\n                                                                            write_i_27670];\n        bool y_25843 = slt64(write_i_27670, sizze_25518);\n        bool index_certs_25845;\n        \n        if (!y_25843) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 14) == -1) {\n                    global_failure_args[0] = write_i_27670;\n                    global_failure_args[1] = sizze_25518;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        int64_t x_25846 = ((__global\n                            int64_t *) unionArrays_res_mem_28464)[write_i_27670];\n        bool cond_25847 = x_25846 == (int64_t) 2;\n        double defunc_0_f_res_25848;\n        \n        if (cond_25847) {\n            int64_t y_25849 = ((__global\n                                int64_t *) unionArrays_res_mem_28470)[write_i_27670];\n            int64_t i_25850 = add64(i_25475, y_25849);\n            bool x_25851 = sle64((int64_t) 0, i_25850);\n            bool y_25852 = slt64(i_25850, k_25271);\n            bool bounds_check_25853 = x_25851 && y_25852;\n            bool index_certs_25854;\n            \n            if (!bounds_check_25853) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 15) ==\n                        -1) {\n                        global_failure_args[0] = i_25850;\n                        global_failure_args[1] = k_25271;\n                        ;\n                    }\n                    return;\n                }\n            }\n            \n            double defunc_1_add_arg_25855 = ((__global\n                                              double *) rightValues_mem_28234)[i_25850];\n            int64_t y_25856 = ((__global\n                                i",
            "nt64_t *) unionArrays_res_mem_28467)[write_i_27670];\n            int64_t i_25857 = add64(i_25497, y_25856);\n            bool x_25858 = sle64((int64_t) 0, i_25857);\n            bool y_25859 = slt64(i_25857, n_25269);\n            bool bounds_check_25860 = x_25858 && y_25859;\n            bool index_certs_25861;\n            \n            if (!bounds_check_25860) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 16) ==\n                        -1) {\n                        global_failure_args[0] = i_25857;\n                        global_failure_args[1] = n_25269;\n                        ;\n                    }\n                    return;\n                }\n            }\n            \n            double defunc_0_add_arg_25862 = ((__global\n                                              double *) leftValues_mem_28231)[i_25857];\n            double defunc_1_add_res_25863 = defunc_1_add_arg_25855 +\n                   defunc_0_add_arg_25862;\n            \n            defunc_0_f_res_25848 = defunc_1_add_res_25863;\n        } else {\n            bool cond_25864 = x_25846 == (int64_t) 0;\n            double defunc_0_f_res_f_res_25865;\n            \n            if (cond_25864) {\n                int64_t y_25866 = ((__global\n                                    int64_t *) unionArrays_res_mem_28467)[write_i_27670];\n                int64_t i_25867 = add64(i_25497, y_25866);\n                bool x_25868 = sle64((int64_t) 0, i_25867);\n                bool y_25869 = slt64(i_25867, n_25269);\n                bool bounds_check_25870 = x_25868 && y_25869;\n                bool index_certs_25871;\n                \n                if (!bounds_check_25870) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 17) ==\n                            -1) {\n                            global_failure_args[0] = i_25867;\n                            global_failure_args[1] = n_25269;\n                            ;\n                        }",
            "\n                        return;\n                    }\n                }\n                \n                double defunc_0_f_res_f_res_t_res_25872 = ((__global\n                                                            double *) leftValues_mem_28231)[i_25867];\n                \n                defunc_0_f_res_f_res_25865 = defunc_0_f_res_f_res_t_res_25872;\n            } else {\n                int64_t y_25873 = ((__global\n                                    int64_t *) unionArrays_res_mem_28467)[write_i_27670];\n                int64_t i_25874 = add64(i_25475, y_25873);\n                bool x_25875 = sle64((int64_t) 0, i_25874);\n                bool y_25876 = slt64(i_25874, k_25271);\n                bool bounds_check_25877 = x_25875 && y_25876;\n                bool index_certs_25878;\n                \n                if (!bounds_check_25877) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 18) ==\n                            -1) {\n                            global_failure_args[0] = i_25874;\n                            global_failure_args[1] = k_25271;\n                            ;\n                        }\n                        return;\n                    }\n                }\n                \n                double defunc_0_f_res_f_res_f_res_25879 = ((__global\n                                                            double *) rightValues_mem_28234)[i_25874];\n                \n                defunc_0_f_res_f_res_25865 = defunc_0_f_res_f_res_f_res_25879;\n            }\n            defunc_0_f_res_25848 = defunc_0_f_res_f_res_25865;\n        }\n        if (sle64((int64_t) 0, index_primexp_28112) &&\n            slt64(index_primexp_28112, eWiseAddOffsets_res_25462)) {\n            ((__global double *) mem_28339)[index_primexp_28112] =\n                defunc_0_f_res_25848;\n        }\n        if (sle64((int64_t) 0, index_primexp_28112) &&\n            slt64(index_primexp_28112, eWiseAddOffsets_res_25462)) {\n            ((__global int",
            "64_t *) mem_28341)[index_primexp_28112] =\n                write_value_25839;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_27674\n}\n__kernel void eWiseAddEntryzisegred_nonseg_28815(__global int *global_failure,\n                                                 int failure_is_an_option,\n                                                 __global\n                                                 int64_t *global_failure_args,\n                                                 uint red_arr_mem_29145_backing_offset_0,\n                                                 uint red_arr_mem_29143_backing_offset_1,\n                                                 uint red_arr_mem_29141_backing_offset_2,\n                                                 uint sync_arr_mem_29139_backing_offset_3,\n                                                 int64_t m_25270,\n                                                 int64_t num_threads_29133,\n                                                 __global\n                                                 unsigned char *leftOffsets_mem_28233,\n                                                 __global\n                                                 unsigned char *rightOffsets_mem_28236,\n                                                 __global\n                                                 unsigned char *mem_28856,\n                                                 __global\n                                                 unsigned char *mem_28858,\n                                                 __global\n                                                 unsigned char *mem_28860,\n                                                 __global\n                                                 unsigned char *eWiseAddEntryzicounter_mem_29125,\n                                                 __global\n                                                 unsigned char *group_res_arr_mem_29127,\n                                                 __glo",
            "bal\n                                                 unsigned char *group_res_arr_mem_29129,\n                                                 __global\n                                                 unsigned char *group_res_arr_mem_29131)\n{\n    #define segred_num_groups_28807 (eWiseAddEntryzisegred_num_groups_28806)\n    #define segred_group_sizze_28809 (eWiseAddEntryzisegred_group_sizze_28808)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *red_arr_mem_29145_backing_3 =\n                  &shared_mem[red_arr_mem_29145_backing_offset_0];\n    volatile char *red_arr_mem_29143_backing_2 =\n                  &shared_mem[red_arr_mem_29143_backing_offset_1];\n    volatile char *red_arr_mem_29141_backing_1 =\n                  &shared_mem[red_arr_mem_29141_backing_offset_2];\n    volatile char *sync_arr_mem_29139_backing_0 =\n                  &shared_mem[sync_arr_mem_29139_backing_offset_3];\n    volatile __local bool local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = false;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t global_tid_29134;\n    int32_t local_tid_29135;\n    int64_t group_sizze_29138;\n    int32_t wave_sizze_29137;\n    int32_t group_tid_29136;\n    \n    global_tid_29134 = get_global_id(0);\n    local_tid_29135 = get_local_id(0);\n    group_sizze_29138 = get_local_size(0);\n    wave_sizze_29137 = LOCKSTEP_WIDTH;\n    group_tid_29136 = get_group_id(0);\n    \n    int32_t phys_tid_28815;\n    \n    phys_tid_28815 = global_tid_29134;\n    \n    __local char *sync_arr_mem_29139;\n    \n    sync_arr_mem_29139 = (__local char *) sync_arr_mem_29139_backing_0;\n    \n    __local char *red_arr_mem_29141;\n    \n    red_arr_mem_29141 = (__local char *) red_arr_mem_29141_backing_1;\n    \n    __local char *red_arr_mem_29143;\n    \n    red_arr_mem_29143 = (__local char *) red_arr_mem_29143_backing_2;\n    \n    __lo",
            "cal char *red_arr_mem_29145;\n    \n    red_arr_mem_29145 = (__local char *) red_arr_mem_29145_backing_3;\n    \n    int64_t dummy_28813;\n    \n    dummy_28813 = (int64_t) 0;\n    \n    int64_t gtid_28814;\n    \n    gtid_28814 = (int64_t) 0;\n    \n    int64_t x_acc_29147;\n    int64_t x_acc_29148;\n    int64_t x_acc_29149;\n    int64_t chunk_sizze_29150;\n    \n    chunk_sizze_29150 = smin64(sdiv_up64(m_25270,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_28809 *\n                                         segred_num_groups_28807))),\n                               sdiv_up64(m_25270 - sext_i32_i64(phys_tid_28815),\n                                         num_threads_29133));\n    \n    int64_t x_28816;\n    int64_t x_28817;\n    int64_t x_28818;\n    int64_t y_28819;\n    int64_t y_28820;\n    int64_t y_28821;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_29147 = (int64_t) 0;\n        x_acc_29148 = (int64_t) 0;\n        x_acc_29149 = (int64_t) 0;\n    }\n    for (int64_t i_29160 = 0; i_29160 < chunk_sizze_29150; i_29160++) {\n        gtid_28814 = sext_i32_i64(phys_tid_28815) + num_threads_29133 * i_29160;\n        // apply map function\n        {\n            int64_t x_28826 = ((__global\n                                int64_t *) leftOffsets_mem_28233)[gtid_28814];\n            int64_t x_28827 = ((__global\n                                int64_t *) rightOffsets_mem_28236)[gtid_28814];\n            bool cond_28828 = gtid_28814 == (int64_t) 0;\n            int64_t prevx2_28829;\n            \n            if (cond_28828) {\n                prevx2_28829 = gtid_28814;\n            } else {\n                int64_t prevx2_f_res_28830 = sub64(gtid_28814, (int64_t) 1);\n                \n                prevx2_28829 = prevx2_f_res_28830;\n            }\n            \n            int64_t prevy2_28831;\n            \n            if (cond_28828) {\n                prevy2_28831 = gtid_28814;\n            } else {\n                int64_t prevy2_f_res_28832 = sub64(gt",
            "id_28814, (int64_t) 1);\n                \n                prevy2_28831 = prevy2_f_res_28832;\n            }\n            \n            bool x_28833 = sle64((int64_t) 0, prevy2_28831);\n            bool y_28834 = slt64(prevy2_28831, m_25270);\n            bool bounds_check_28835 = x_28833 && y_28834;\n            bool index_certs_28836;\n            \n            if (!bounds_check_28835) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 0) ==\n                        -1) {\n                        global_failure_args[0] = prevy2_28831;\n                        global_failure_args[1] = m_25270;\n                        ;\n                    }\n                    local_failure = true;\n                    goto error_0;\n                }\n            }\n            \n            int64_t i_28837 = ((__global\n                                int64_t *) rightOffsets_mem_28236)[prevy2_28831];\n            int64_t j_m_i_28838 = sub64(x_28827, i_28837);\n            bool x_28839 = sle64((int64_t) 0, prevx2_28829);\n            bool y_28840 = slt64(prevx2_28829, m_25270);\n            bool bounds_check_28841 = x_28839 && y_28840;\n            bool index_certs_28842;\n            \n            if (!bounds_check_28841) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 1) ==\n                        -1) {\n                        global_failure_args[0] = prevx2_28829;\n                        global_failure_args[1] = m_25270;\n                        ;\n                    }\n                    local_failure = true;\n                    goto error_0;\n                }\n            }\n            \n            int64_t i_28843 = ((__global\n                                int64_t *) leftOffsets_mem_28233)[prevx2_28829];\n            int64_t j_m_i_28844 = sub64(x_28826, i_28843);\n            int64_t conc_tmp_28845 = j_m_i_28838 + j_m_i_28844;\n            int64_t bytes_28846 = (int64_t) 8 * conc_tmp_28845;\n            int64_t bytes_28847 = ",
            "(int64_t) 4 * conc_tmp_28845;\n            int64_t double_buffer_sizze_28848 = (int64_t) 8 * conc_tmp_28845;\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_28816 = x_acc_29147;\n                x_28817 = x_acc_29148;\n                x_28818 = x_acc_29149;\n            }\n            // load new values\n            {\n                y_28819 = bytes_28846;\n                y_28820 = bytes_28847;\n                y_28821 = double_buffer_sizze_28848;\n            }\n            // apply reduction operator\n            {\n                int64_t zz_28822 = smax64(x_28816, y_28819);\n                int64_t zz_28823 = smax64(x_28817, y_28820);\n                int64_t zz_28824 = smax64(x_28818, y_28821);\n                \n                // store in accumulator\n                {\n                    x_acc_29147 = zz_28822;\n                    x_acc_29148 = zz_28823;\n                    x_acc_29149 = zz_28824;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_28816 = x_acc_29147;\n        x_28817 = x_acc_29148;\n        x_28818 = x_acc_29149;\n        ((__local int64_t *) red_arr_mem_29141)[sext_i32_i64(local_tid_29135)] =\n            x_28816;\n        ((__local int64_t *) red_arr_mem_29143)[sext_i32_i64(local_tid_29135)] =\n            x_28817;\n        ((__local int64_t *) red_arr_mem_29145)[sext_i32_i64(local_tid_29135)] =\n            x_28818;\n    }\n    \n  error_0:\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (local_failure)\n        return;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_29161;\n    int32_t skip_waves_29162;\n    \n    skip_waves_29162 = 1;\n    \n    int64_t x_29151;\n    int64_t x_29152;\n    int64_t x_29153;\n    int64_t y_29154;\n    int64_t y_29155;\n    int64_t y_29156;\n    \n    offset_29161 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_29135, sext_i64_i32(segred_grou",
            "p_sizze_28809))) {\n            x_29151 = ((__local\n                        int64_t *) red_arr_mem_29141)[sext_i32_i64(local_tid_29135 +\n                                                      offset_29161)];\n            x_29152 = ((__local\n                        int64_t *) red_arr_mem_29143)[sext_i32_i64(local_tid_29135 +\n                                                      offset_29161)];\n            x_29153 = ((__local\n                        int64_t *) red_arr_mem_29145)[sext_i32_i64(local_tid_29135 +\n                                                      offset_29161)];\n        }\n    }\n    offset_29161 = 1;\n    while (slt32(offset_29161, wave_sizze_29137)) {\n        if (slt32(local_tid_29135 + offset_29161,\n                  sext_i64_i32(segred_group_sizze_28809)) && ((local_tid_29135 -\n                                                               squot32(local_tid_29135,\n                                                                       wave_sizze_29137) *\n                                                               wave_sizze_29137) &\n                                                              (2 *\n                                                               offset_29161 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                y_29154 = ((volatile __local\n                            int64_t *) red_arr_mem_29141)[sext_i32_i64(local_tid_29135 +\n                                                          offset_29161)];\n                y_29155 = ((volatile __local\n                            int64_t *) red_arr_mem_29143)[sext_i32_i64(local_tid_29135 +\n                                                          offset_29161)];\n                y_29156 = ((volatile __local\n                            int64_t *) red_arr_mem_29145)[sext_i32_i64(local_tid_29135 +\n                                                          offset_29161)];\n            }\n            // apply reduction ",
            "operation\n            {\n                int64_t zz_29157 = smax64(x_29151, y_29154);\n                int64_t zz_29158 = smax64(x_29152, y_29155);\n                int64_t zz_29159 = smax64(x_29153, y_29156);\n                \n                x_29151 = zz_29157;\n                x_29152 = zz_29158;\n                x_29153 = zz_29159;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  int64_t *) red_arr_mem_29141)[sext_i32_i64(local_tid_29135)] =\n                    x_29151;\n                ((volatile __local\n                  int64_t *) red_arr_mem_29143)[sext_i32_i64(local_tid_29135)] =\n                    x_29152;\n                ((volatile __local\n                  int64_t *) red_arr_mem_29145)[sext_i32_i64(local_tid_29135)] =\n                    x_29153;\n            }\n        }\n        offset_29161 *= 2;\n    }\n    while (slt32(skip_waves_29162,\n                 squot32(sext_i64_i32(segred_group_sizze_28809) +\n                         wave_sizze_29137 - 1, wave_sizze_29137))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_29161 = skip_waves_29162 * wave_sizze_29137;\n        if (slt32(local_tid_29135 + offset_29161,\n                  sext_i64_i32(segred_group_sizze_28809)) && ((local_tid_29135 -\n                                                               squot32(local_tid_29135,\n                                                                       wave_sizze_29137) *\n                                                               wave_sizze_29137) ==\n                                                              0 &&\n                                                              (squot32(local_tid_29135,\n                                                                       wave_sizze_29137) &\n                                                               (2 *\n                                                                skip_waves_29162 -\n                                                ",
            "                1)) == 0)) {\n            // read array element\n            {\n                y_29154 = ((__local\n                            int64_t *) red_arr_mem_29141)[sext_i32_i64(local_tid_29135 +\n                                                          offset_29161)];\n                y_29155 = ((__local\n                            int64_t *) red_arr_mem_29143)[sext_i32_i64(local_tid_29135 +\n                                                          offset_29161)];\n                y_29156 = ((__local\n                            int64_t *) red_arr_mem_29145)[sext_i32_i64(local_tid_29135 +\n                                                          offset_29161)];\n            }\n            // apply reduction operation\n            {\n                int64_t zz_29157 = smax64(x_29151, y_29154);\n                int64_t zz_29158 = smax64(x_29152, y_29155);\n                int64_t zz_29159 = smax64(x_29153, y_29156);\n                \n                x_29151 = zz_29157;\n                x_29152 = zz_29158;\n                x_29153 = zz_29159;\n            }\n            // write result of operation\n            {\n                ((__local\n                  int64_t *) red_arr_mem_29141)[sext_i32_i64(local_tid_29135)] =\n                    x_29151;\n                ((__local\n                  int64_t *) red_arr_mem_29143)[sext_i32_i64(local_tid_29135)] =\n                    x_29152;\n                ((__local\n                  int64_t *) red_arr_mem_29145)[sext_i32_i64(local_tid_29135)] =\n                    x_29153;\n            }\n        }\n        skip_waves_29162 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_29135) == (int64_t) 0) {\n            x_acc_29147 = x_29151;\n            x_acc_29148 = x_29152;\n            x_acc_29149 = x_29153;\n        }\n    }\n    \n    int32_t old_counter_29163;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_2913",
            "5 == 0) {\n            ((__global\n              int64_t *) group_res_arr_mem_29127)[sext_i32_i64(group_tid_29136) *\n                                                  segred_group_sizze_28809] =\n                x_acc_29147;\n            ((__global\n              int64_t *) group_res_arr_mem_29129)[sext_i32_i64(group_tid_29136) *\n                                                  segred_group_sizze_28809] =\n                x_acc_29148;\n            ((__global\n              int64_t *) group_res_arr_mem_29131)[sext_i32_i64(group_tid_29136) *\n                                                  segred_group_sizze_28809] =\n                x_acc_29149;\n            mem_fence_global();\n            old_counter_29163 = atomic_add_i32_global(&((volatile __global\n                                                         int *) eWiseAddEntryzicounter_mem_29125)[(int64_t) 0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_29139)[(int64_t) 0] =\n                old_counter_29163 == segred_num_groups_28807 - (int64_t) 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_29164;\n    \n    is_last_group_29164 = ((__local bool *) sync_arr_mem_29139)[(int64_t) 0];\n    if (is_last_group_29164) {\n        if (local_tid_29135 == 0) {\n            old_counter_29163 = atomic_add_i32_global(&((volatile __global\n                                                         int *) eWiseAddEntryzicounter_mem_29125)[(int64_t) 0],\n                                                      (int) ((int64_t) 0 -\n                                                             segred_num_groups_28807));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_29165 = sdiv_up64(segred_num_groups_28807,\n                                                      segred_group_sizze_28809);\n            \n            x_28816 = (int64_t) 0;\n            x_28817 = (int64_t) 0;\n            x_2881",
            "8 = (int64_t) 0;\n            for (int64_t i_29166 = 0; i_29166 < read_per_thread_29165;\n                 i_29166++) {\n                int64_t group_res_id_29167 = sext_i32_i64(local_tid_29135) *\n                        read_per_thread_29165 + i_29166;\n                int64_t index_of_group_res_29168 = group_res_id_29167;\n                \n                if (slt64(group_res_id_29167, segred_num_groups_28807)) {\n                    y_28819 = ((__global\n                                int64_t *) group_res_arr_mem_29127)[index_of_group_res_29168 *\n                                                                    segred_group_sizze_28809];\n                    y_28820 = ((__global\n                                int64_t *) group_res_arr_mem_29129)[index_of_group_res_29168 *\n                                                                    segred_group_sizze_28809];\n                    y_28821 = ((__global\n                                int64_t *) group_res_arr_mem_29131)[index_of_group_res_29168 *\n                                                                    segred_group_sizze_28809];\n                    \n                    int64_t zz_28822;\n                    \n                    zz_28822 = smax64(x_28816, y_28819);\n                    \n                    int64_t zz_28823 = smax64(x_28817, y_28820);\n                    int64_t zz_28824 = smax64(x_28818, y_28821);\n                    \n                    x_28816 = zz_28822;\n                    x_28817 = zz_28823;\n                    x_28818 = zz_28824;\n                }\n            }\n        }\n        ((__local int64_t *) red_arr_mem_29141)[sext_i32_i64(local_tid_29135)] =\n            x_28816;\n        ((__local int64_t *) red_arr_mem_29143)[sext_i32_i64(local_tid_29135)] =\n            x_28817;\n        ((__local int64_t *) red_arr_mem_29145)[sext_i32_i64(local_tid_29135)] =\n            x_28818;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_2",
            "9169;\n            int32_t skip_waves_29170;\n            \n            skip_waves_29170 = 1;\n            \n            int64_t x_29151;\n            int64_t x_29152;\n            int64_t x_29153;\n            int64_t y_29154;\n            int64_t y_29155;\n            int64_t y_29156;\n            \n            offset_29169 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_29135,\n                          sext_i64_i32(segred_group_sizze_28809))) {\n                    x_29151 = ((__local\n                                int64_t *) red_arr_mem_29141)[sext_i32_i64(local_tid_29135 +\n                                                              offset_29169)];\n                    x_29152 = ((__local\n                                int64_t *) red_arr_mem_29143)[sext_i32_i64(local_tid_29135 +\n                                                              offset_29169)];\n                    x_29153 = ((__local\n                                int64_t *) red_arr_mem_29145)[sext_i32_i64(local_tid_29135 +\n                                                              offset_29169)];\n                }\n            }\n            offset_29169 = 1;\n            while (slt32(offset_29169, wave_sizze_29137)) {\n                if (slt32(local_tid_29135 + offset_29169,\n                          sext_i64_i32(segred_group_sizze_28809)) &&\n                    ((local_tid_29135 - squot32(local_tid_29135,\n                                                wave_sizze_29137) *\n                      wave_sizze_29137) & (2 * offset_29169 - 1)) == 0) {\n                    // read array element\n                    {\n                        y_29154 = ((volatile __local\n                                    int64_t *) red_arr_mem_29141)[sext_i32_i64(local_tid_29135 +\n                                                                  offset_29169)];\n                        y_29155 = ((volatile __local\n                                    int64_t *) red_ar",
            "r_mem_29143)[sext_i32_i64(local_tid_29135 +\n                                                                  offset_29169)];\n                        y_29156 = ((volatile __local\n                                    int64_t *) red_arr_mem_29145)[sext_i32_i64(local_tid_29135 +\n                                                                  offset_29169)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t zz_29157 = smax64(x_29151, y_29154);\n                        int64_t zz_29158 = smax64(x_29152, y_29155);\n                        int64_t zz_29159 = smax64(x_29153, y_29156);\n                        \n                        x_29151 = zz_29157;\n                        x_29152 = zz_29158;\n                        x_29153 = zz_29159;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          int64_t *) red_arr_mem_29141)[sext_i32_i64(local_tid_29135)] =\n                            x_29151;\n                        ((volatile __local\n                          int64_t *) red_arr_mem_29143)[sext_i32_i64(local_tid_29135)] =\n                            x_29152;\n                        ((volatile __local\n                          int64_t *) red_arr_mem_29145)[sext_i32_i64(local_tid_29135)] =\n                            x_29153;\n                    }\n                }\n                offset_29169 *= 2;\n            }\n            while (slt32(skip_waves_29170,\n                         squot32(sext_i64_i32(segred_group_sizze_28809) +\n                                 wave_sizze_29137 - 1, wave_sizze_29137))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_29169 = skip_waves_29170 * wave_sizze_29137;\n                if (slt32(local_tid_29135 + offset_29169,\n                          sext_i64_i32(segred_group_sizze_28809)) &&\n                    ((local_tid_29135 - squot32(local_tid_291",
            "35,\n                                                wave_sizze_29137) *\n                      wave_sizze_29137) == 0 && (squot32(local_tid_29135,\n                                                         wave_sizze_29137) &\n                                                 (2 * skip_waves_29170 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        y_29154 = ((__local\n                                    int64_t *) red_arr_mem_29141)[sext_i32_i64(local_tid_29135 +\n                                                                  offset_29169)];\n                        y_29155 = ((__local\n                                    int64_t *) red_arr_mem_29143)[sext_i32_i64(local_tid_29135 +\n                                                                  offset_29169)];\n                        y_29156 = ((__local\n                                    int64_t *) red_arr_mem_29145)[sext_i32_i64(local_tid_29135 +\n                                                                  offset_29169)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t zz_29157 = smax64(x_29151, y_29154);\n                        int64_t zz_29158 = smax64(x_29152, y_29155);\n                        int64_t zz_29159 = smax64(x_29153, y_29156);\n                        \n                        x_29151 = zz_29157;\n                        x_29152 = zz_29158;\n                        x_29153 = zz_29159;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          int64_t *) red_arr_mem_29141)[sext_i32_i64(local_tid_29135)] =\n                            x_29151;\n                        ((__local\n                          int64_t *) red_arr_mem_29143)[sext_i32_i64(local_tid_29135)] =\n                            x_29152;\n                        ((__local\n                          int64_t",
            " *) red_arr_mem_29145)[sext_i32_i64(local_tid_29135)] =\n                            x_29153;\n                    }\n                }\n                skip_waves_29170 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_29135 == 0) {\n                    ((__global int64_t *) mem_28856)[(int64_t) 0] = x_29151;\n                    ((__global int64_t *) mem_28858)[(int64_t) 0] = x_29152;\n                    ((__global int64_t *) mem_28860)[(int64_t) 0] = x_29153;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_num_groups_28807\n    #undef segred_group_sizze_28809\n}\n__kernel void eWiseAddEntryzisegscan_27537(__global int *global_failure,\n                                           int failure_is_an_option, __global\n                                           int64_t *global_failure_args,\n                                           uint local_mem_29199_backing_offset_0,\n                                           int64_t n_25269, int64_t m_25270,\n                                           int64_t k_25271,\n                                           int64_t num_threads_28787, __global\n                                           unsigned char *leftColumns_mem_28232,\n                                           __global\n                                           unsigned char *leftOffsets_mem_28233,\n                                           __global\n                                           unsigned char *rightColumns_mem_28235,\n                                           __global\n                                           unsigned char *rightOffsets_mem_28236,\n                                           __global unsigned char *mem_28239,\n                                           __global unsigned char *mem_28248,\n                                           __global unsigned char *mem_28250,\n                                           __global unsigned char *mem_28252,\n    ",
            "                                       __global unsigned char *mem_28254,\n                                           __global unsigned char *mem_28256,\n                                           __global unsigned char *mem_28318,\n                                           __global unsigned char *mem_28337,\n                                           __global\n                                           unsigned char *double_buffer_mem_28763,\n                                           __global\n                                           unsigned char *eWiseAddEntryziid_counter_mem_29173,\n                                           __global\n                                           unsigned char *status_flags_mem_29175,\n                                           __global\n                                           unsigned char *aggregates_mem_29177,\n                                           __global\n                                           unsigned char *incprefixes_mem_29179)\n{\n    #define segscan_group_sizze_27532 (eWiseAddEntryzisegscan_group_sizze_27531)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *local_mem_29199_backing_0 =\n                  &shared_mem[local_mem_29199_backing_offset_0];\n    volatile __local bool local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = false;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t global_tid_29190;\n    int32_t local_tid_29191;\n    int64_t group_sizze_29194;\n    int32_t wave_sizze_29193;\n    int32_t group_tid_29192;\n    \n    global_tid_29190 = get_global_id(0);\n    local_tid_29191 = get_local_id(0);\n    group_sizze_29194 = get_local_size(0);\n    wave_sizze_29193 = LOCKSTEP_WIDTH;\n    group_tid_29192 = get_group_id(0);\n    \n    int32_t phys_tid_27537;\n    \n    phys_tid_27537 = global_tid_29190;\n    \n    int64_t byte_offsets_29195;\n    \n    b",
            "yte_offsets_29195 = (int64_t) 0;\n    \n    int64_t byte_offsets_29196;\n    \n    byte_offsets_29196 = segscan_group_sizze_27532 * (int64_t) 8;\n    \n    int64_t warp_byte_offset_29197;\n    \n    warp_byte_offset_29197 = (int64_t) 32;\n    \n    int64_t warp_byte_offset_29198;\n    \n    warp_byte_offset_29198 = (int64_t) 288;\n    // Allocate reused shared memeory\n    { }\n    \n    __local char *local_mem_29199;\n    \n    local_mem_29199 = (__local char *) local_mem_29199_backing_0;\n    \n    int64_t trans_arr_len_29200;\n    \n    trans_arr_len_29200 = (int64_t) 9 * segscan_group_sizze_27532;\n    \n    int32_t dynamic_id_29207;\n    \n    if (local_tid_29191 == 0) {\n        dynamic_id_29207 = atomic_add_i32_global(&((volatile __global\n                                                    int *) eWiseAddEntryziid_counter_mem_29173)[(int64_t) 0],\n                                                 (int) 1);\n        ((__local int32_t *) local_mem_29199)[(int64_t) 0] = dynamic_id_29207;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    dynamic_id_29207 = ((__local int32_t *) local_mem_29199)[(int64_t) 0];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t blockOff_29208;\n    \n    blockOff_29208 = sext_i32_i64(dynamic_id_29207) * (int64_t) 9 *\n        segscan_group_sizze_27532;\n    \n    int64_t private_mem_29209[9];\n    \n    // Load and map\n    {\n        for (int64_t i_29211 = 0; i_29211 < (int64_t) 9; i_29211++) {\n            int64_t gtid_27536 = blockOff_29208 +\n                    sext_i32_i64(local_tid_29191) + i_29211 *\n                    segscan_group_sizze_27532;\n            \n            if (slt64(gtid_27536, m_25270)) {\n                int64_t x_25283 = ((__global\n                                    int64_t *) leftOffsets_mem_28233)[gtid_27536];\n                int64_t x_25285 = ((__global\n                                    int64_t *) rightOffsets_mem_28236)[gtid_27536];\n                bool cond_25286 = gtid_27536 == (int64_t) 0;\n                int64_t prevx2_25287;\n                \n  ",
            "              if (cond_25286) {\n                    prevx2_25287 = gtid_27536;\n                } else {\n                    int64_t prevx2_f_res_25288 = sub64(gtid_27536, (int64_t) 1);\n                    \n                    prevx2_25287 = prevx2_f_res_25288;\n                }\n                \n                int64_t prevy2_25289;\n                \n                if (cond_25286) {\n                    prevy2_25289 = gtid_27536;\n                } else {\n                    int64_t prevy2_f_res_25290 = sub64(gtid_27536, (int64_t) 1);\n                    \n                    prevy2_25289 = prevy2_f_res_25290;\n                }\n                \n                bool x_25291 = sle64((int64_t) 0, prevy2_25289);\n                bool y_25292 = slt64(prevy2_25289, m_25270);\n                bool bounds_check_25293 = x_25291 && y_25292;\n                bool index_certs_25294;\n                \n                if (!bounds_check_25293) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 2) ==\n                            -1) {\n                            global_failure_args[0] = prevy2_25289;\n                            global_failure_args[1] = m_25270;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                \n                int64_t i_25295 = ((__global\n                                    int64_t *) rightOffsets_mem_28236)[prevy2_25289];\n                int64_t j_m_i_25296 = sub64(x_25285, i_25295);\n                bool empty_slice_25297 = j_m_i_25296 == (int64_t) 0;\n                int64_t m_25298 = sub64(j_m_i_25296, (int64_t) 1);\n                int64_t i_p_m_t_s_25299 = add64(i_25295, m_25298);\n                bool zzero_leq_i_p_m_t_s_25300 = sle64((int64_t) 0,\n                                                       i_p_m_t_s_25299);\n                bool i_p_m_t_s_leq_w_25301 = slt64(i_p_m_t_s_25",
            "299, k_25271);\n                bool zzero_lte_i_25302 = sle64((int64_t) 0, i_25295);\n                bool i_lte_j_25303 = sle64(i_25295, x_25285);\n                bool y_25304 = i_p_m_t_s_leq_w_25301 && zzero_lte_i_25302;\n                bool y_25305 = zzero_leq_i_p_m_t_s_25300 && y_25304;\n                bool y_25306 = i_lte_j_25303 && y_25305;\n                bool forwards_ok_25307 = zzero_lte_i_25302 && y_25306;\n                bool ok_or_empty_25308 = empty_slice_25297 || forwards_ok_25307;\n                bool index_certs_25309;\n                \n                if (!ok_or_empty_25308) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 3) ==\n                            -1) {\n                            global_failure_args[0] = i_25295;\n                            global_failure_args[1] = x_25285;\n                            global_failure_args[2] = k_25271;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                \n                bool x_25311 = sle64((int64_t) 0, prevx2_25287);\n                bool y_25312 = slt64(prevx2_25287, m_25270);\n                bool bounds_check_25313 = x_25311 && y_25312;\n                bool index_certs_25314;\n                \n                if (!bounds_check_25313) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 4) ==\n                            -1) {\n                            global_failure_args[0] = prevx2_25287;\n                            global_failure_args[1] = m_25270;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                \n                int64_t i_25315 = ((__global\n                                    int64_t *) leftOffsets_mem_28233)[prevx2_25287];\n  ",
            "              int64_t j_m_i_25316 = sub64(x_25283, i_25315);\n                bool empty_slice_25317 = j_m_i_25316 == (int64_t) 0;\n                int64_t m_25318 = sub64(j_m_i_25316, (int64_t) 1);\n                int64_t i_p_m_t_s_25319 = add64(i_25315, m_25318);\n                bool zzero_leq_i_p_m_t_s_25320 = sle64((int64_t) 0,\n                                                       i_p_m_t_s_25319);\n                bool i_p_m_t_s_leq_w_25321 = slt64(i_p_m_t_s_25319, n_25269);\n                bool zzero_lte_i_25322 = sle64((int64_t) 0, i_25315);\n                bool i_lte_j_25323 = sle64(i_25315, x_25283);\n                bool y_25324 = i_p_m_t_s_leq_w_25321 && zzero_lte_i_25322;\n                bool y_25325 = zzero_leq_i_p_m_t_s_25320 && y_25324;\n                bool y_25326 = i_lte_j_25323 && y_25325;\n                bool forwards_ok_25327 = zzero_lte_i_25322 && y_25326;\n                bool ok_or_empty_25328 = empty_slice_25317 || forwards_ok_25327;\n                bool index_certs_25329;\n                \n                if (!ok_or_empty_25328) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 5) ==\n                            -1) {\n                            global_failure_args[0] = i_25315;\n                            global_failure_args[1] = x_25283;\n                            global_failure_args[2] = n_25269;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                \n                int64_t conc_tmp_25332 = j_m_i_25296 + j_m_i_25316;\n                int64_t unionSizze_res_25331;\n                \n                if (empty_slice_25317) {\n                    unionSizze_res_25331 = j_m_i_25296;\n                } else {\n                    int64_t j_m_i_25333 = sub64(conc_tmp_25332, (int64_t) 1);\n                    int64_t unionSizze_res_f_res_25334;\n                    \n      ",
            "              if (empty_slice_25297) {\n                        unionSizze_res_f_res_25334 = j_m_i_25316;\n                    } else {\n                        int64_t tmp_offs_29212 = (int64_t) 0;\n                        \n                        for (int64_t i_29213 = 0; i_29213 < j_m_i_25316;\n                             i_29213++) {\n                            ((__global int64_t *) mem_28239)[phys_tid_27537 +\n                                                             (tmp_offs_29212 +\n                                                              i_29213) *\n                                                             num_threads_28787] =\n                                ((__global\n                                  int64_t *) leftColumns_mem_28232)[i_25315 +\n                                                                    i_29213];\n                        }\n                        tmp_offs_29212 += j_m_i_25316;\n                        for (int64_t i_29214 = 0; i_29214 < j_m_i_25296;\n                             i_29214++) {\n                            ((__global int64_t *) mem_28239)[phys_tid_27537 +\n                                                             (tmp_offs_29212 +\n                                                              i_29214) *\n                                                             num_threads_28787] =\n                                ((__global\n                                  int64_t *) rightColumns_mem_28235)[i_25295 +\n                                                                     i_29214];\n                        }\n                        tmp_offs_29212 += j_m_i_25296;\n                        \n                        bool cond_25336 = conc_tmp_25332 == (int64_t) 0;\n                        int32_t iters_25337;\n                        \n                        if (cond_25336) {\n                            iters_25337 = 0;\n                        } else {\n                            iters_25337 = 32;\n                        }\n   ",
            "                     \n                        bool loop_nonempty_25338 = slt32(0, iters_25337);\n                        bool x_25339 = sle64((int64_t) 0, j_m_i_25333);\n                        bool y_25340 = slt64(j_m_i_25333, conc_tmp_25332);\n                        bool bounds_check_25341 = x_25339 && y_25340;\n                        bool loop_not_taken_25342 = !loop_nonempty_25338;\n                        bool protect_assert_disj_25343 = bounds_check_25341 ||\n                             loop_not_taken_25342;\n                        bool index_certs_25344;\n                        \n                        if (!protect_assert_disj_25343) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure,\n                                                              -1, 6) == -1) {\n                                    global_failure_args[0] = j_m_i_25333;\n                                    global_failure_args[1] = conc_tmp_25332;\n                                    ;\n                                }\n                                local_failure = true;\n                                goto error_0;\n                            }\n                        }\n                        for (int64_t i_29215 = 0; i_29215 < conc_tmp_25332;\n                             i_29215++) {\n                            ((__global\n                              int64_t *) double_buffer_mem_28763)[phys_tid_27537 +\n                                                                  i_29215 *\n                                                                  num_threads_28787] =\n                                ((__global\n                                  int64_t *) mem_28239)[phys_tid_27537 +\n                                                        i_29215 *\n                                                        num_threads_28787];\n                        }\n                        for (int32_t i_25346 = 0; i_25346 < iters_25337;\n                           ",
            "  i_25346++) {\n                            int32_t defunc_2_radix_sort_step_arg_25348 =\n                                    mul32(2, i_25346);\n                            int32_t defunc_0_get_bit_arg_25349 = add32(1,\n                                                                       defunc_2_radix_sort_step_arg_25348);\n                            int64_t i32_res_25350 =\n                                    sext_i32_i64(defunc_0_get_bit_arg_25349);\n                            int64_t i32_res_25351 =\n                                    sext_i32_i64(defunc_2_radix_sort_step_arg_25348);\n                            int64_t discard_28161;\n                            int64_t discard_28162;\n                            int64_t discard_28163;\n                            int64_t discard_28164;\n                            int64_t scanacc_28146;\n                            int64_t scanacc_28147;\n                            int64_t scanacc_28148;\n                            int64_t scanacc_28149;\n                            \n                            scanacc_28146 = (int64_t) 0;\n                            scanacc_28147 = (int64_t) 0;\n                            scanacc_28148 = (int64_t) 0;\n                            scanacc_28149 = (int64_t) 0;\n                            for (int64_t i_28155 = 0; i_28155 < conc_tmp_25332;\n                                 i_28155++) {\n                                int64_t x_25379 = ((__global\n                                                    int64_t *) double_buffer_mem_28763)[phys_tid_27537 +\n                                                                                        i_28155 *\n                                                                                        num_threads_28787];\n                                int64_t zgzg_res_25380 = ashr64(x_25379,\n                                                                i32_res_25350);\n                                int64_t za_res_25381 = (int64_t) 1 &\n                      ",
            "                  zgzg_res_25380;\n                                int32_t to_i32_res_25382 =\n                                        sext_i64_i32(za_res_25381);\n                                int32_t x_25383 = mul32(2, to_i32_res_25382);\n                                int64_t zgzg_res_25384 = ashr64(x_25379,\n                                                                i32_res_25351);\n                                int64_t za_res_25385 = (int64_t) 1 &\n                                        zgzg_res_25384;\n                                int32_t to_i32_res_25386 =\n                                        sext_i64_i32(za_res_25385);\n                                int32_t defunc_0_f_res_25387 = add32(x_25383,\n                                                                     to_i32_res_25386);\n                                bool cond_25388 = defunc_0_f_res_25387 == 0;\n                                int64_t defunc_0_f_res_25389 =\n                                        btoi_bool_i64(cond_25388);\n                                int64_t defunc_0_f_res_25390;\n                                int64_t defunc_0_f_res_25391;\n                                int64_t defunc_0_f_res_25392;\n                                \n                                if (cond_25388) {\n                                    defunc_0_f_res_25390 = (int64_t) 0;\n                                    defunc_0_f_res_25391 = (int64_t) 0;\n                                    defunc_0_f_res_25392 = (int64_t) 0;\n                                } else {\n                                    bool cond_25393 = defunc_0_f_res_25387 == 1;\n                                    int64_t defunc_0_f_res_f_res_25394 =\n                                            btoi_bool_i64(cond_25393);\n                                    int64_t defunc_0_f_res_f_res_25395;\n                                    int64_t defunc_0_f_res_f_res_25396;\n                                    \n                                    if (cond_25393)",
            " {\n                                        defunc_0_f_res_f_res_25395 =\n                                            (int64_t) 0;\n                                        defunc_0_f_res_f_res_25396 =\n                                            (int64_t) 0;\n                                    } else {\n                                        bool cond_25397 =\n                                             defunc_0_f_res_25387 == 2;\n                                        int64_t defunc_0_f_res_f_res_f_res_25398\n                                                = btoi_bool_i64(cond_25397);\n                                        bool cond_neg_25399 = !cond_25397;\n                                        int64_t defunc_0_f_res_f_res_f_res_25400\n                                                = btoi_bool_i64(cond_neg_25399);\n                                        \n                                        defunc_0_f_res_f_res_25395 =\n                                            defunc_0_f_res_f_res_f_res_25398;\n                                        defunc_0_f_res_f_res_25396 =\n                                            defunc_0_f_res_f_res_f_res_25400;\n                                    }\n                                    defunc_0_f_res_25390 =\n                                        defunc_0_f_res_f_res_25394;\n                                    defunc_0_f_res_25391 =\n                                        defunc_0_f_res_f_res_25395;\n                                    defunc_0_f_res_25392 =\n                                        defunc_0_f_res_f_res_25396;\n                                }\n                                \n                                int64_t defunc_1_op_res_25375 =\n                                        add64(defunc_0_f_res_25389,\n                                              scanacc_28146);\n                                int64_t defunc_1_op_res_25376 =\n                                        add64(defunc_0_f_res_25390,\n                            ",
            "                  scanacc_28147);\n                                int64_t defunc_1_op_res_25377 =\n                                        add64(defunc_0_f_res_25391,\n                                              scanacc_28148);\n                                int64_t defunc_1_op_res_25378 =\n                                        add64(defunc_0_f_res_25392,\n                                              scanacc_28149);\n                                \n                                ((__global\n                                  int64_t *) mem_28248)[phys_tid_27537 +\n                                                        i_28155 *\n                                                        num_threads_28787] =\n                                    defunc_1_op_res_25375;\n                                ((__global\n                                  int64_t *) mem_28250)[phys_tid_27537 +\n                                                        i_28155 *\n                                                        num_threads_28787] =\n                                    defunc_1_op_res_25376;\n                                ((__global\n                                  int64_t *) mem_28252)[phys_tid_27537 +\n                                                        i_28155 *\n                                                        num_threads_28787] =\n                                    defunc_1_op_res_25377;\n                                ((__global\n                                  int64_t *) mem_28254)[phys_tid_27537 +\n                                                        i_28155 *\n                                                        num_threads_28787] =\n                                    defunc_1_op_res_25378;\n                                ((__global\n                                  int32_t *) mem_28256)[phys_tid_27537 +\n                                                        i_28155 *\n                                                        num_threads_28787] =\n              ",
            "                      defunc_0_f_res_25387;\n                                \n                                int64_t scanacc_tmp_29217 =\n                                        defunc_1_op_res_25375;\n                                int64_t scanacc_tmp_29218 =\n                                        defunc_1_op_res_25376;\n                                int64_t scanacc_tmp_29219 =\n                                        defunc_1_op_res_25377;\n                                int64_t scanacc_tmp_29220 =\n                                        defunc_1_op_res_25378;\n                                \n                                scanacc_28146 = scanacc_tmp_29217;\n                                scanacc_28147 = scanacc_tmp_29218;\n                                scanacc_28148 = scanacc_tmp_29219;\n                                scanacc_28149 = scanacc_tmp_29220;\n                            }\n                            discard_28161 = scanacc_28146;\n                            discard_28162 = scanacc_28147;\n                            discard_28163 = scanacc_28148;\n                            discard_28164 = scanacc_28149;\n                            \n                            int64_t last_res_25406 = ((__global\n                                                       int64_t *) mem_28248)[phys_tid_27537 +\n                                                                             j_m_i_25333 *\n                                                                             num_threads_28787];\n                            int64_t last_res_25407 = ((__global\n                                                       int64_t *) mem_28250)[phys_tid_27537 +\n                                                                             j_m_i_25333 *\n                                                                             num_threads_28787];\n                            int64_t last_res_25408 = ((__global\n                                                       int64_t *) mem_28252)[ph",
            "ys_tid_27537 +\n                                                                             j_m_i_25333 *\n                                                                             num_threads_28787];\n                            \n                            for (int64_t i_29226 = 0; i_29226 < conc_tmp_25332;\n                                 i_29226++) {\n                                ((__global\n                                  int64_t *) mem_28318)[phys_tid_27537 +\n                                                        i_29226 *\n                                                        num_threads_28787] =\n                                    ((__global\n                                      int64_t *) double_buffer_mem_28763)[phys_tid_27537 +\n                                                                          i_29226 *\n                                                                          num_threads_28787];\n                            }\n                            for (int64_t write_iter_28165 = 0;\n                                 write_iter_28165 < conc_tmp_25332;\n                                 write_iter_28165++) {\n                                int32_t write_iv_28167 = ((__global\n                                                           int32_t *) mem_28256)[phys_tid_27537 +\n                                                                                 write_iter_28165 *\n                                                                                 num_threads_28787];\n                                bool match_lit_25417 = 0 == write_iv_28167;\n                                int64_t defunc_1_f_res_25418;\n                                \n                                if (match_lit_25417) {\n                                    int64_t write_iv_28168 = ((__global\n                                                               int64_t *) mem_28248)[phys_tid_27537 +\n                                                                                    ",
            " write_iter_28165 *\n                                                                                     num_threads_28787];\n                                    int64_t case_res_25419 =\n                                            sub64(write_iv_28168, (int64_t) 1);\n                                    \n                                    defunc_1_f_res_25418 = case_res_25419;\n                                } else {\n                                    int64_t write_iv_28169 = ((__global\n                                                               int64_t *) mem_28250)[phys_tid_27537 +\n                                                                                     write_iter_28165 *\n                                                                                     num_threads_28787];\n                                    int64_t write_iv_28170 = ((__global\n                                                               int64_t *) mem_28252)[phys_tid_27537 +\n                                                                                     write_iter_28165 *\n                                                                                     num_threads_28787];\n                                    int64_t write_iv_28171 = ((__global\n                                                               int64_t *) mem_28254)[phys_tid_27537 +\n                                                                                     write_iter_28165 *\n                                                                                     num_threads_28787];\n                                    bool match_lit_25420 = 1 == write_iv_28167;\n                                    int64_t x_25421;\n                                    \n                                    if (match_lit_25420) {\n                                        int64_t x_25422 = add64(last_res_25406,\n                                                                write_iv_28169);\n                                        in",
            "t64_t case_res_25423 = sub64(x_25422,\n                                                                       (int64_t) 1);\n                                        \n                                        x_25421 = case_res_25423;\n                                    } else {\n                                        bool match_lit_25424 = 2 ==\n                                             write_iv_28167;\n                                        int64_t x_25425;\n                                        \n                                        if (match_lit_25424) {\n                                            int64_t x_25426 =\n                                                    add64(last_res_25406,\n                                                          last_res_25407);\n                                            int64_t x_25427 = add64(x_25426,\n                                                                    write_iv_28170);\n                                            int64_t case_res_25428 =\n                                                    sub64(x_25427, (int64_t) 1);\n                                            \n                                            x_25425 = case_res_25428;\n                                        } else {\n                                            int64_t x_25429 =\n                                                    add64(last_res_25406,\n                                                          last_res_25407);\n                                            int64_t x_25430 =\n                                                    add64(last_res_25408,\n                                                          x_25429);\n                                            int64_t x_25431 = add64(x_25430,\n                                                                    write_iv_28171);\n                                            int64_t defunc_1_f_res_res_25432 =\n                                                    sub64(x_25431, (int64_t) 1);\n           ",
            "                                 \n                                            x_25425 = defunc_1_f_res_res_25432;\n                                        }\n                                        x_25421 = x_25425;\n                                    }\n                                    defunc_1_f_res_25418 = x_25421;\n                                }\n                                \n                                bool less_than_zzero_28173 =\n                                     slt64(defunc_1_f_res_25418, (int64_t) 0);\n                                bool greater_than_sizze_28174 =\n                                     sle64(conc_tmp_25332,\n                                           defunc_1_f_res_25418);\n                                bool outside_bounds_dim_28175 =\n                                     less_than_zzero_28173 ||\n                                     greater_than_sizze_28174;\n                                \n                                if (!outside_bounds_dim_28175) {\n                                    for (int64_t i_29228 = 0; i_29228 <\n                                         (int64_t) 1; i_29228++) {\n                                        ((__global\n                                          int64_t *) mem_28318)[phys_tid_27537 +\n                                                                (defunc_1_f_res_25418 +\n                                                                 i_29228) *\n                                                                num_threads_28787] =\n                                            ((__global\n                                              int64_t *) double_buffer_mem_28763)[phys_tid_27537 +\n                                                                                  num_threads_28787 *\n                                                                                  write_iter_28165 +\n                                                                                  i_29228 *\n                           ",
            "                                                       num_threads_28787];\n                                    }\n                                }\n                            }\n                            for (int64_t i_29229 = 0; i_29229 < conc_tmp_25332;\n                                 i_29229++) {\n                                ((__global\n                                  int64_t *) double_buffer_mem_28763)[phys_tid_27537 +\n                                                                      i_29229 *\n                                                                      num_threads_28787] =\n                                    ((__global\n                                      int64_t *) mem_28318)[phys_tid_27537 +\n                                                            i_29229 *\n                                                            num_threads_28787];\n                            }\n                        }\n                        \n                        bool empty_slice_25433 = j_m_i_25333 == (int64_t) 0;\n                        bool i_lte_j_25434 = sle64((int64_t) 1, conc_tmp_25332);\n                        bool y_25435 = bounds_check_25341 && i_lte_j_25434;\n                        bool ok_or_empty_25436 = empty_slice_25433 || y_25435;\n                        bool index_certs_25437;\n                        \n                        if (!ok_or_empty_25436) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure,\n                                                              -1, 7) == -1) {\n                                    global_failure_args[0] = (int64_t) 1;\n                                    global_failure_args[1] = conc_tmp_25332;\n                                    ;\n                                }\n                                local_failure = true;\n                                goto error_0;\n                            }\n                        }\n                        \n               ",
            "         int64_t defunc_2_reduce_res_25440;\n                        int64_t redout_28179 = (int64_t) 1;\n                        \n                        for (int64_t i_28181 = 0; i_28181 < j_m_i_25333;\n                             i_28181++) {\n                            int64_t slice_28226 = (int64_t) 1 + i_28181;\n                            int64_t x_25455 = ((__global\n                                                int64_t *) double_buffer_mem_28763)[phys_tid_27537 +\n                                                                                    slice_28226 *\n                                                                                    num_threads_28787];\n                            bool y_25448 = slt64(i_28181, conc_tmp_25332);\n                            bool index_certs_25450;\n                            \n                            if (!y_25448) {\n                                {\n                                    if (atomic_cmpxchg_i32_global(global_failure,\n                                                                  -1, 8) ==\n                                        -1) {\n                                        global_failure_args[0] = i_28181;\n                                        global_failure_args[1] = conc_tmp_25332;\n                                        ;\n                                    }\n                                    local_failure = true;\n                                    goto error_0;\n                                }\n                            }\n                            \n                            int64_t y_25451 = ((__global\n                                                int64_t *) double_buffer_mem_28763)[phys_tid_27537 +\n                                                                                    i_28181 *\n                                                                                    num_threads_28787];\n                            bool cond_25452 = x_25455 == y_25451;\n                           ",
            " int64_t defunc_1_op_res_25453;\n                            \n                            if (cond_25452) {\n                                defunc_1_op_res_25453 = redout_28179;\n                            } else {\n                                int64_t defunc_1_op_res_f_res_25454 =\n                                        add64((int64_t) 1, redout_28179);\n                                \n                                defunc_1_op_res_25453 =\n                                    defunc_1_op_res_f_res_25454;\n                            }\n                            \n                            int64_t redout_tmp_29230 = defunc_1_op_res_25453;\n                            \n                            redout_28179 = redout_tmp_29230;\n                        }\n                        defunc_2_reduce_res_25440 = redout_28179;\n                        unionSizze_res_f_res_25334 = defunc_2_reduce_res_25440;\n                    }\n                    unionSizze_res_25331 = unionSizze_res_f_res_25334;\n                }\n                private_mem_29209[i_29211] = unionSizze_res_25331;\n            } else {\n                private_mem_29209[i_29211] = (int64_t) 0;\n            }\n        }\n    }\n    // Transpose scan inputs\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29231 = 0; i_29231 < (int64_t) 9; i_29231++) {\n            int64_t sharedIdx_29232 = sext_i32_i64(local_tid_29191) + i_29231 *\n                    segscan_group_sizze_27532;\n            \n            ((__local int64_t *) local_mem_29199)[sharedIdx_29232] =\n                private_mem_29209[i_29231];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_29233 = 0; i_29233 < 9; i_29233++) {\n            int32_t sharedIdx_29234 = local_tid_29191 * 9 + i_29233;\n            \n            private_mem_29209[sext_i32_i64(i_29233)] = ((__local\n                                                         int64_t *) local_mem_29199)[sext_i32_i64(sharedIdx_29234)];\n        }\n        barrier(CLK_LOCA",
            "L_MEM_FENCE);\n    }\n    // Per thread scan\n    {\n        for (int64_t i_29235 = 0; i_29235 < (int64_t) 8; i_29235++) {\n            int64_t x_25280;\n            int64_t x_25281;\n            \n            x_25280 = private_mem_29209[i_29235];\n            x_25281 = private_mem_29209[i_29235 + (int64_t) 1];\n            \n            int64_t defunc_1_op_res_25282;\n            \n            defunc_1_op_res_25282 = add64(x_25280, x_25281);\n            private_mem_29209[i_29235 + (int64_t) 1] = defunc_1_op_res_25282;\n        }\n    }\n    // Publish results in shared memory\n    {\n        ((__local int64_t *) local_mem_29199)[squot64(byte_offsets_29195,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_29191)] =\n            private_mem_29209[(int64_t) 8];\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t acc_29239;\n    \n    // Scan results (with warp scan)\n    {\n        int64_t x_29236;\n        int64_t x_29237;\n        int64_t x_29240;\n        int64_t x_29241;\n        bool ltid_in_bounds_29243;\n        \n        ltid_in_bounds_29243 = slt64(sext_i32_i64(local_tid_29191),\n                                     segscan_group_sizze_27532);\n        \n        int32_t skip_threads_29244;\n        \n        // read input for in-block scan\n        {\n            if (ltid_in_bounds_29243) {\n                x_29237 = ((volatile __local\n                            int64_t *) local_mem_29199)[squot64(byte_offsets_29195,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_29191)];\n                if ((local_tid_29191 - squot32(local_tid_29191, 32) * 32) ==\n                    0) {\n                    x_29236 = x_29237;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_29244 = 1;\n            while (slt32(skip_threads_",
            "29244, 32)) {\n                if (sle32(skip_threads_29244, local_tid_29191 -\n                          squot32(local_tid_29191, 32) * 32) &&\n                    ltid_in_bounds_29243) {\n                    // read operands\n                    {\n                        x_29236 = ((volatile __local\n                                    int64_t *) local_mem_29199)[squot64(byte_offsets_29195,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_29191) -\n                                                                 sext_i32_i64(skip_threads_29244))];\n                    }\n                    // perform operation\n                    {\n                        int64_t defunc_1_op_res_29238 = add64(x_29236, x_29237);\n                        \n                        x_29236 = defunc_1_op_res_29238;\n                    }\n                }\n                if (sle32(wave_sizze_29193, skip_threads_29244)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_29244, local_tid_29191 -\n                          squot32(local_tid_29191, 32) * 32) &&\n                    ltid_in_bounds_29243) {\n                    // write result\n                    {\n                        ((volatile __local\n                          int64_t *) local_mem_29199)[squot64(byte_offsets_29195,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_29191)] =\n                            x_29236;\n                        x_29237 = x_29236;\n                    }\n                }\n                if (sle32(wave_sizze_29193, skip_threads_29244)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_29244 *= 2;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // last thread of",
            " block 'i' writes its result to offset 'i'\n        {\n            if ((local_tid_29191 - squot32(local_tid_29191, 32) * 32) == 31 &&\n                ltid_in_bounds_29243) {\n                ((volatile __local\n                  int64_t *) local_mem_29199)[squot64(byte_offsets_29195,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_29191,\n                                                                   32))] =\n                    x_29236;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n        {\n            int32_t skip_threads_29245;\n            \n            // read input for in-block scan\n            {\n                if (squot32(local_tid_29191, 32) == 0 && ltid_in_bounds_29243) {\n                    x_29241 = ((volatile __local\n                                int64_t *) local_mem_29199)[squot64(byte_offsets_29195,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_29191)];\n                    if ((local_tid_29191 - squot32(local_tid_29191, 32) * 32) ==\n                        0) {\n                        x_29240 = x_29241;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_29245 = 1;\n                while (slt32(skip_threads_29245, 32)) {\n                    if (sle32(skip_threads_29245, local_tid_29191 -\n                              squot32(local_tid_29191, 32) * 32) &&\n                        (squot32(local_tid_29191, 32) == 0 &&\n                         ltid_in_bounds_29243)) {\n                        // read operands\n                        {\n                            x_29240 = ((volatile __local\n                                        int64_t",
            " *) local_mem_29199)[squot64(byte_offsets_29195,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_29191) -\n                                                                     sext_i32_i64(skip_threads_29245))];\n                        }\n                        // perform operation\n                        {\n                            int64_t defunc_1_op_res_29242 = add64(x_29240,\n                                                                  x_29241);\n                            \n                            x_29240 = defunc_1_op_res_29242;\n                        }\n                    }\n                    if (sle32(wave_sizze_29193, skip_threads_29245)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_29245, local_tid_29191 -\n                              squot32(local_tid_29191, 32) * 32) &&\n                        (squot32(local_tid_29191, 32) == 0 &&\n                         ltid_in_bounds_29243)) {\n                        // write result\n                        {\n                            ((volatile __local\n                              int64_t *) local_mem_29199)[squot64(byte_offsets_29195,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_29191)] =\n                                x_29240;\n                            x_29241 = x_29240;\n                        }\n                    }\n                    if (sle32(wave_sizze_29193, skip_threads_29245)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_29245 *= 2;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // carry-in for every block except the first\n        {\n            if (!(squot32(local",
            "_tid_29191, 32) == 0 || !ltid_in_bounds_29243)) {\n                // read operands\n                {\n                    x_29237 = x_29236;\n                    x_29236 = ((__local\n                                int64_t *) local_mem_29199)[squot64(byte_offsets_29195,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_29191,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                }\n                // perform operation\n                {\n                    int64_t defunc_1_op_res_29238 = add64(x_29236, x_29237);\n                    \n                    x_29236 = defunc_1_op_res_29238;\n                }\n                // write final result\n                {\n                    ((__local\n                      int64_t *) local_mem_29199)[squot64(byte_offsets_29195,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_29191)] =\n                        x_29236;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // restore correct values for first block\n        {\n            if (squot32(local_tid_29191, 32) == 0) {\n                ((__local\n                  int64_t *) local_mem_29199)[squot64(byte_offsets_29195,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_29191)] =\n                    x_29237;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_tid_29191 == 0) {\n            acc_29239 = ((__local\n                          int64_t *) local_mem_29199)[squot64(byte_offsets_29195,\n                                                              (int64",
            "_t) 8) +\n                                                      (segscan_group_sizze_27532 -\n                                                       (int64_t) 1)];\n        } else {\n            acc_29239 = ((__local\n                          int64_t *) local_mem_29199)[squot64(byte_offsets_29195,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_29191) -\n                                                       (int64_t) 1)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t prefix_29246;\n    \n    prefix_29246 = (int64_t) 0;\n    // Perform lookback\n    {\n        if (dynamic_id_29207 == (int64_t) 0 && local_tid_29191 == 0) {\n            ((volatile __global\n              int64_t *) incprefixes_mem_29179)[dynamic_id_29207] = acc_29239;\n            mem_fence_global();\n            ((volatile __global\n              int8_t *) status_flags_mem_29175)[dynamic_id_29207] = (int8_t) 2;\n            acc_29239 = (int64_t) 0;\n        }\n        if (!(dynamic_id_29207 == (int64_t) 0) && slt32(local_tid_29191,\n                                                        wave_sizze_29193)) {\n            if (local_tid_29191 == 0) {\n                ((volatile __global\n                  int64_t *) aggregates_mem_29177)[dynamic_id_29207] =\n                    acc_29239;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_29175)[dynamic_id_29207] =\n                    (int8_t) 1;\n                ((__local int8_t *) local_mem_29199)[(int64_t) 0] = ((__global\n                                                                      int8_t *) status_flags_mem_29175)[dynamic_id_29207 -\n                                                                                                        (int64_t) 1];\n            }\n            mem_fence_local();\n            \n            int8_t status_29247;\n            \n            status",
            "_29247 = ((__local int8_t *) local_mem_29199)[(int64_t) 0];\n            if (status_29247 == (int8_t) 2) {\n                if (local_tid_29191 == 0) {\n                    prefix_29246 = ((volatile __global\n                                     int64_t *) incprefixes_mem_29179)[dynamic_id_29207 -\n                                                                       (int64_t) 1];\n                }\n            } else {\n                int32_t readOffset_29248 = dynamic_id_29207 -\n                        sext_i32_i64(wave_sizze_29193);\n                \n                while (slt32(wave_sizze_29193 * -1, readOffset_29248)) {\n                    int32_t read_i_29249 = readOffset_29248 + local_tid_29191;\n                    int64_t aggr_29250 = (int64_t) 0;\n                    int8_t flag_29251 = (int8_t) 0;\n                    int8_t used_29252 = (int8_t) 0;\n                    \n                    if (sle32(0, read_i_29249)) {\n                        flag_29251 = ((volatile __global\n                                       int8_t *) status_flags_mem_29175)[sext_i32_i64(read_i_29249)];\n                        if (flag_29251 == (int8_t) 2) {\n                            aggr_29250 = ((volatile __global\n                                           int64_t *) incprefixes_mem_29179)[sext_i32_i64(read_i_29249)];\n                        } else {\n                            if (flag_29251 == (int8_t) 1) {\n                                aggr_29250 = ((volatile __global\n                                               int64_t *) aggregates_mem_29177)[sext_i32_i64(read_i_29249)];\n                                used_29252 = (int8_t) 1;\n                            }\n                        }\n                    }\n                    ((__local\n                      int64_t *) local_mem_29199)[squot64(warp_byte_offset_29197,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_29191)] =\n             ",
            "           aggr_29250;\n                    \n                    int8_t tmp_29253;\n                    \n                    tmp_29253 = flag_29251 | used_29252 << (int8_t) 2;\n                    ((__local\n                      int8_t *) local_mem_29199)[sext_i32_i64(local_tid_29191)] =\n                        tmp_29253;\n                    mem_fence_local();\n                    flag_29251 = ((volatile __local\n                                   int8_t *) local_mem_29199)[sext_i32_i64(wave_sizze_29193) -\n                                                              (int64_t) 1];\n                    if (local_tid_29191 == 0) {\n                        if (!(flag_29251 == (int8_t) 2)) {\n                            int64_t x_29254 = (int64_t) 0;\n                            int64_t x_29255;\n                            int8_t flag1_29257;\n                            \n                            flag1_29257 = (int8_t) 0;\n                            \n                            int8_t flag2_29258;\n                            int8_t used1_29259;\n                            \n                            used1_29259 = (int8_t) 0;\n                            \n                            int8_t used2_29260;\n                            \n                            for (int32_t i_29261 = 0; i_29261 <\n                                 wave_sizze_29193; i_29261++) {\n                                flag2_29258 = ((__local\n                                                int8_t *) local_mem_29199)[sext_i32_i64(i_29261)];\n                                used2_29260 = lshr8(flag2_29258, (int8_t) 2);\n                                flag2_29258 = flag2_29258 & (int8_t) 3;\n                                x_29255 = ((__local\n                                            int64_t *) local_mem_29199)[squot64(warp_byte_offset_29197,\n                                                                                (int64_t) 8) +\n                                                                        sext_",
            "i32_i64(i_29261)];\n                                if (!(flag2_29258 == (int8_t) 1)) {\n                                    flag1_29257 = flag2_29258;\n                                    used1_29259 = used2_29260;\n                                    x_29254 = x_29255;\n                                } else {\n                                    used1_29259 += used2_29260;\n                                    \n                                    int64_t defunc_1_op_res_29256;\n                                    \n                                    defunc_1_op_res_29256 = add64(x_29254,\n                                                                  x_29255);\n                                    x_29254 = defunc_1_op_res_29256;\n                                }\n                            }\n                            flag_29251 = flag1_29257;\n                            used_29252 = used1_29259;\n                            aggr_29250 = x_29254;\n                        } else {\n                            aggr_29250 = ((__local\n                                           int64_t *) local_mem_29199)[squot64(warp_byte_offset_29197,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_29193) -\n                                                                        (int64_t) 1)];\n                        }\n                        if (flag_29251 == (int8_t) 2) {\n                            readOffset_29248 = wave_sizze_29193 * -1;\n                        } else {\n                            readOffset_29248 -= zext_i8_i32(used_29252);\n                        }\n                        ((__local int32_t *) local_mem_29199)[(int64_t) 0] =\n                            readOffset_29248;\n                        \n                        int64_t x_29262;\n                        \n                        x_29262 = aggr_29250;\n                        \n  ",
            "                      int64_t x_29263;\n                        \n                        x_29263 = prefix_29246;\n                        \n                        int64_t defunc_1_op_res_29264;\n                        \n                        defunc_1_op_res_29264 = add64(x_29262, x_29263);\n                        prefix_29246 = defunc_1_op_res_29264;\n                    }\n                    mem_fence_local();\n                    readOffset_29248 = ((__local\n                                         int32_t *) local_mem_29199)[(int64_t) 0];\n                }\n            }\n            if (local_tid_29191 == 0) {\n                int64_t x_29265 = prefix_29246;\n                int64_t x_29266 = acc_29239;\n                int64_t defunc_1_op_res_29267 = add64(x_29265, x_29266);\n                \n                ((volatile __global\n                  int64_t *) incprefixes_mem_29179)[dynamic_id_29207] =\n                    defunc_1_op_res_29267;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_29175)[dynamic_id_29207] =\n                    (int8_t) 2;\n                ((__local\n                  int64_t *) local_mem_29199)[squot64(warp_byte_offset_29197,\n                                                      (int64_t) 8)] =\n                    prefix_29246;\n                acc_29239 = (int64_t) 0;\n            }\n        }\n        if (!(dynamic_id_29207 == (int64_t) 0)) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            prefix_29246 = ((__local\n                             int64_t *) local_mem_29199)[squot64(warp_byte_offset_29197,\n                                                                 (int64_t) 8)];\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    // Distribute results\n    {\n        int64_t x_29268;\n        int64_t x_29269;\n        int64_t x_29271;\n        \n        x_29271 = prefix_29246;\n        \n        int64_t x_29272;\n        \n        x_29272 = acc_29239;\n        \n        int64_t",
            " defunc_1_op_res_29273;\n        \n        defunc_1_op_res_29273 = add64(x_29271, x_29272);\n        x_29268 = defunc_1_op_res_29273;\n        for (int64_t i_29274 = 0; i_29274 < (int64_t) 9; i_29274++) {\n            x_29269 = private_mem_29209[i_29274];\n            \n            int64_t defunc_1_op_res_29270;\n            \n            defunc_1_op_res_29270 = add64(x_29268, x_29269);\n            private_mem_29209[i_29274] = defunc_1_op_res_29270;\n        }\n    }\n    // Transpose scan output\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29275 = 0; i_29275 < (int64_t) 9; i_29275++) {\n            int64_t sharedIdx_29276 = sext_i32_i64(local_tid_29191 * 9) +\n                    i_29275;\n            \n            ((__local int64_t *) local_mem_29199)[sharedIdx_29276] =\n                private_mem_29209[i_29275];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29277 = 0; i_29277 < (int64_t) 9; i_29277++) {\n            int32_t sharedIdx_29278 = local_tid_29191 +\n                    sext_i64_i32(segscan_group_sizze_27532 * i_29277);\n            \n            private_mem_29209[i_29277] = ((__local\n                                           int64_t *) local_mem_29199)[sext_i32_i64(sharedIdx_29278)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Write block scan results to global memory\n    {\n        for (int64_t i_29279 = 0; i_29279 < (int64_t) 9; i_29279++) {\n            int64_t gtid_27536 = blockOff_29208 + segscan_group_sizze_27532 *\n                    i_29279 + sext_i32_i64(local_tid_29191);\n            \n            if (slt64(gtid_27536, m_25270)) {\n                ((__global int64_t *) mem_28337)[gtid_27536] =\n                    private_mem_29209[i_29279];\n            }\n        }\n    }\n    // If this is the last block, reset the dynamicId\n    {\n        if (dynamic_id_29207 == sdiv_up64(m_25270, segscan_group_sizze_27532 *\n                                          (int64_t) 9) - (int64_t) 1) {\n            ((__global\n   ",
            "           int32_t *) eWiseAddEntryziid_counter_mem_29173)[(int64_t) 0] = 0;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_27532\n}\n__kernel void eWiseAddEntryzisegscan_27545(__global int *global_failure,\n                                           uint local_mem_29354_backing_offset_0,\n                                           int64_t conc_tmp_25517,\n                                           int64_t i32_res_25555,\n                                           int64_t i32_res_25556, __global\n                                           unsigned char *mem_param_28374,\n                                           __global unsigned char *mem_28386,\n                                           __global unsigned char *mem_28388,\n                                           __global unsigned char *mem_28390,\n                                           __global unsigned char *mem_28392,\n                                           __global unsigned char *mem_28394,\n                                           __global\n                                           unsigned char *eWiseAddEntryziid_counter_mem_29319,\n                                           __global\n                                           unsigned char *status_flags_mem_29321,\n                                           __global\n                                           unsigned char *aggregates_mem_29323,\n                                           __global\n                                           unsigned char *incprefixes_mem_29325,\n                                           __global\n                                           unsigned char *aggregates_mem_29327,\n                                           __global\n                                           unsigned char *incprefixes_mem_29329,\n                                           __global\n                                           unsigned char *aggregates_mem_29331,\n                                           __global\n                 ",
            "                          unsigned char *incprefixes_mem_29333,\n                                           __global\n                                           unsigned char *aggregates_mem_29335,\n                                           __global\n                                           unsigned char *incprefixes_mem_29337)\n{\n    #define segscan_group_sizze_27540 (eWiseAddEntryzisegscan_group_sizze_27539)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *local_mem_29354_backing_0 =\n                  &shared_mem[local_mem_29354_backing_offset_0];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29339;\n    int32_t local_tid_29340;\n    int64_t group_sizze_29343;\n    int32_t wave_sizze_29342;\n    int32_t group_tid_29341;\n    \n    global_tid_29339 = get_global_id(0);\n    local_tid_29340 = get_local_id(0);\n    group_sizze_29343 = get_local_size(0);\n    wave_sizze_29342 = LOCKSTEP_WIDTH;\n    group_tid_29341 = get_group_id(0);\n    \n    int32_t phys_tid_27545;\n    \n    phys_tid_27545 = global_tid_29339;\n    \n    int64_t byte_offsets_29344;\n    \n    byte_offsets_29344 = (int64_t) 0;\n    \n    int64_t byte_offsets_29345;\n    \n    byte_offsets_29345 = segscan_group_sizze_27540 * (int64_t) 8;\n    \n    int64_t byte_offsets_29346;\n    \n    byte_offsets_29346 = sdiv_up64(segscan_group_sizze_27540 * (int64_t) 8,\n                                   (int64_t) 8) * (int64_t) 8 +\n        segscan_group_sizze_27540 * (int64_t) 8;\n    \n    int64_t byte_offsets_29347;\n    \n    byte_offsets_29347 = sdiv_up64(sdiv_up64(segscan_group_sizze_27540 *\n                                             (int64_t) 8, (int64_t) 8) *\n                                   (int64_t) 8 + segscan_group_sizze_27540 *\n                                   (int64_t) 8, (int64_t) 8) * (int64_t) 8 +\n        segscan_group_sizze_27540 * (int64_t) 8;\n    \n    int64_t byte_offsets_29348;\n    \n    byte_offsets_29348 =\n        sdiv_up6",
            "4(sdiv_up64(sdiv_up64(segscan_group_sizze_27540 * (int64_t) 8,\n                                      (int64_t) 8) * (int64_t) 8 +\n                            segscan_group_sizze_27540 * (int64_t) 8,\n                            (int64_t) 8) * (int64_t) 8 +\n                  segscan_group_sizze_27540 * (int64_t) 8, (int64_t) 8) *\n        (int64_t) 8 + segscan_group_sizze_27540 * (int64_t) 8;\n    \n    int64_t warp_byte_offset_29349;\n    \n    warp_byte_offset_29349 = (int64_t) 32;\n    \n    int64_t warp_byte_offset_29350;\n    \n    warp_byte_offset_29350 = (int64_t) 288;\n    \n    int64_t warp_byte_offset_29351;\n    \n    warp_byte_offset_29351 = (int64_t) 544;\n    \n    int64_t warp_byte_offset_29352;\n    \n    warp_byte_offset_29352 = (int64_t) 800;\n    \n    int64_t warp_byte_offset_29353;\n    \n    warp_byte_offset_29353 = (int64_t) 1056;\n    // Allocate reused shared memeory\n    { }\n    \n    __local char *local_mem_29354;\n    \n    local_mem_29354 = (__local char *) local_mem_29354_backing_0;\n    \n    int64_t trans_arr_len_29355;\n    \n    trans_arr_len_29355 = (int64_t) 9 * segscan_group_sizze_27540;\n    \n    int32_t dynamic_id_29371;\n    \n    if (local_tid_29340 == 0) {\n        dynamic_id_29371 = atomic_add_i32_global(&((volatile __global\n                                                    int *) eWiseAddEntryziid_counter_mem_29319)[(int64_t) 0],\n                                                 (int) 1);\n        ((__local int32_t *) local_mem_29354)[(int64_t) 0] = dynamic_id_29371;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    dynamic_id_29371 = ((__local int32_t *) local_mem_29354)[(int64_t) 0];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t blockOff_29372;\n    \n    blockOff_29372 = sext_i32_i64(dynamic_id_29371) * (int64_t) 9 *\n        segscan_group_sizze_27540;\n    \n    int64_t private_mem_29373[9];\n    int64_t private_mem_29375[9];\n    int64_t private_mem_29377[9];\n    int64_t private_mem_29379[9];\n    \n    // Load and map\n    {\n        for (int64_t i_29381 = 0; i_29",
            "381 < (int64_t) 9; i_29381++) {\n            int64_t gtid_27544 = blockOff_29372 +\n                    sext_i32_i64(local_tid_29340) + i_29381 *\n                    segscan_group_sizze_27540;\n            \n            if (slt64(gtid_27544, conc_tmp_25517)) {\n                int64_t x_25584 = ((__global\n                                    int64_t *) mem_param_28374)[gtid_27544];\n                int64_t zgzg_res_25585 = ashr64(x_25584, i32_res_25555);\n                int64_t za_res_25586 = (int64_t) 1 & zgzg_res_25585;\n                int32_t to_i32_res_25587 = sext_i64_i32(za_res_25586);\n                int32_t x_25588 = mul32(2, to_i32_res_25587);\n                int64_t zgzg_res_25589 = ashr64(x_25584, i32_res_25556);\n                int64_t za_res_25590 = (int64_t) 1 & zgzg_res_25589;\n                int32_t to_i32_res_25591 = sext_i64_i32(za_res_25590);\n                int32_t defunc_0_f_res_25592 = add32(x_25588, to_i32_res_25591);\n                bool cond_25593 = defunc_0_f_res_25592 == 0;\n                int64_t defunc_0_f_res_25594 = btoi_bool_i64(cond_25593);\n                int64_t defunc_0_f_res_25595;\n                int64_t defunc_0_f_res_25596;\n                int64_t defunc_0_f_res_25597;\n                \n                if (cond_25593) {\n                    defunc_0_f_res_25595 = (int64_t) 0;\n                    defunc_0_f_res_25596 = (int64_t) 0;\n                    defunc_0_f_res_25597 = (int64_t) 0;\n                } else {\n                    bool cond_25598 = defunc_0_f_res_25592 == 1;\n                    int64_t defunc_0_f_res_f_res_25599 =\n                            btoi_bool_i64(cond_25598);\n                    int64_t defunc_0_f_res_f_res_25600;\n                    int64_t defunc_0_f_res_f_res_25601;\n                    \n                    if (cond_25598) {\n                        defunc_0_f_res_f_res_25600 = (int64_t) 0;\n                        defunc_0_f_res_f_res_25601 = (int64_t) 0;\n                    } else {\n                        bo",
            "ol cond_25602 = defunc_0_f_res_25592 == 2;\n                        int64_t defunc_0_f_res_f_res_f_res_25603 =\n                                btoi_bool_i64(cond_25602);\n                        bool cond_neg_25604 = !cond_25602;\n                        int64_t defunc_0_f_res_f_res_f_res_25605 =\n                                btoi_bool_i64(cond_neg_25604);\n                        \n                        defunc_0_f_res_f_res_25600 =\n                            defunc_0_f_res_f_res_f_res_25603;\n                        defunc_0_f_res_f_res_25601 =\n                            defunc_0_f_res_f_res_f_res_25605;\n                    }\n                    defunc_0_f_res_25595 = defunc_0_f_res_f_res_25599;\n                    defunc_0_f_res_25596 = defunc_0_f_res_f_res_25600;\n                    defunc_0_f_res_25597 = defunc_0_f_res_f_res_25601;\n                }\n                ((__global int32_t *) mem_28394)[gtid_27544] =\n                    defunc_0_f_res_25592;\n                private_mem_29373[i_29381] = defunc_0_f_res_25594;\n                private_mem_29375[i_29381] = defunc_0_f_res_25595;\n                private_mem_29377[i_29381] = defunc_0_f_res_25596;\n                private_mem_29379[i_29381] = defunc_0_f_res_25597;\n            } else {\n                private_mem_29373[i_29381] = (int64_t) 0;\n                private_mem_29375[i_29381] = (int64_t) 0;\n                private_mem_29377[i_29381] = (int64_t) 0;\n                private_mem_29379[i_29381] = (int64_t) 0;\n            }\n        }\n    }\n    // Transpose scan inputs\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29382 = 0; i_29382 < (int64_t) 9; i_29382++) {\n            int64_t sharedIdx_29383 = sext_i32_i64(local_tid_29340) + i_29382 *\n                    segscan_group_sizze_27540;\n            \n            ((__local int64_t *) local_mem_29354)[sharedIdx_29383] =\n                private_mem_29373[i_29382];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_29384 = 0; ",
            "i_29384 < 9; i_29384++) {\n            int32_t sharedIdx_29385 = local_tid_29340 * 9 + i_29384;\n            \n            private_mem_29373[sext_i32_i64(i_29384)] = ((__local\n                                                         int64_t *) local_mem_29354)[sext_i32_i64(sharedIdx_29385)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29386 = 0; i_29386 < (int64_t) 9; i_29386++) {\n            int64_t sharedIdx_29387 = sext_i32_i64(local_tid_29340) + i_29386 *\n                    segscan_group_sizze_27540;\n            \n            ((__local int64_t *) local_mem_29354)[sharedIdx_29387] =\n                private_mem_29375[i_29386];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_29388 = 0; i_29388 < 9; i_29388++) {\n            int32_t sharedIdx_29389 = local_tid_29340 * 9 + i_29388;\n            \n            private_mem_29375[sext_i32_i64(i_29388)] = ((__local\n                                                         int64_t *) local_mem_29354)[sext_i32_i64(sharedIdx_29389)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29390 = 0; i_29390 < (int64_t) 9; i_29390++) {\n            int64_t sharedIdx_29391 = sext_i32_i64(local_tid_29340) + i_29390 *\n                    segscan_group_sizze_27540;\n            \n            ((__local int64_t *) local_mem_29354)[sharedIdx_29391] =\n                private_mem_29377[i_29390];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_29392 = 0; i_29392 < 9; i_29392++) {\n            int32_t sharedIdx_29393 = local_tid_29340 * 9 + i_29392;\n            \n            private_mem_29377[sext_i32_i64(i_29392)] = ((__local\n                                                         int64_t *) local_mem_29354)[sext_i32_i64(sharedIdx_29393)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29394 = 0; i_29394 < (int64_t) 9; i_29394++) {\n            int64_t sharedIdx_29395 = sext_i32_i64(local_tid_29340) + i_29394 *\n                    segsca",
            "n_group_sizze_27540;\n            \n            ((__local int64_t *) local_mem_29354)[sharedIdx_29395] =\n                private_mem_29379[i_29394];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_29396 = 0; i_29396 < 9; i_29396++) {\n            int32_t sharedIdx_29397 = local_tid_29340 * 9 + i_29396;\n            \n            private_mem_29379[sext_i32_i64(i_29396)] = ((__local\n                                                         int64_t *) local_mem_29354)[sext_i32_i64(sharedIdx_29397)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Per thread scan\n    {\n        for (int64_t i_29398 = 0; i_29398 < (int64_t) 8; i_29398++) {\n            int64_t x_25572;\n            int64_t x_25576;\n            \n            x_25572 = private_mem_29373[i_29398];\n            x_25576 = private_mem_29373[i_29398 + (int64_t) 1];\n            \n            int64_t x_25573;\n            int64_t x_25577;\n            \n            x_25573 = private_mem_29375[i_29398];\n            x_25577 = private_mem_29375[i_29398 + (int64_t) 1];\n            \n            int64_t x_25574;\n            int64_t x_25578;\n            \n            x_25574 = private_mem_29377[i_29398];\n            x_25578 = private_mem_29377[i_29398 + (int64_t) 1];\n            \n            int64_t x_25575;\n            int64_t x_25579;\n            \n            x_25575 = private_mem_29379[i_29398];\n            x_25579 = private_mem_29379[i_29398 + (int64_t) 1];\n            \n            int64_t defunc_1_op_res_25580;\n            \n            defunc_1_op_res_25580 = add64(x_25572, x_25576);\n            \n            int64_t defunc_1_op_res_25581 = add64(x_25573, x_25577);\n            int64_t defunc_1_op_res_25582 = add64(x_25574, x_25578);\n            int64_t defunc_1_op_res_25583 = add64(x_25575, x_25579);\n            \n            private_mem_29373[i_29398 + (int64_t) 1] = defunc_1_op_res_25580;\n            private_mem_29375[i_29398 + (int64_t) 1] = defunc_1_op_res_25581;\n            private_mem_29377[",
            "i_29398 + (int64_t) 1] = defunc_1_op_res_25582;\n            private_mem_29379[i_29398 + (int64_t) 1] = defunc_1_op_res_25583;\n        }\n    }\n    // Publish results in shared memory\n    {\n        ((__local int64_t *) local_mem_29354)[squot64(byte_offsets_29344,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_29340)] =\n            private_mem_29373[(int64_t) 8];\n        ((__local int64_t *) local_mem_29354)[squot64(byte_offsets_29345,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_29340)] =\n            private_mem_29375[(int64_t) 8];\n        ((__local int64_t *) local_mem_29354)[squot64(byte_offsets_29346,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_29340)] =\n            private_mem_29377[(int64_t) 8];\n        ((__local int64_t *) local_mem_29354)[squot64(byte_offsets_29347,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_29340)] =\n            private_mem_29379[(int64_t) 8];\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t acc_29411;\n    int64_t acc_29412;\n    int64_t acc_29413;\n    int64_t acc_29414;\n    \n    // Scan results (with warp scan)\n    {\n        int64_t x_29399;\n        int64_t x_29400;\n        int64_t x_29401;\n        int64_t x_29402;\n        int64_t x_29403;\n        int64_t x_29404;\n        int64_t x_29405;\n        int64_t x_29406;\n        int64_t x_29415;\n        int64_t x_29416;\n        int64_t x_29417;\n        int64_t x_29418;\n        int64_t x_29419;\n        int64_t x_29420;\n        int64_t x_29421;\n        int64_t x_29422;\n        bool ltid_in_bounds_29427;\n        \n        ltid_in_bounds_29427 = slt64(sext_i32_i64(local_tid_29340),\n                                     segscan_gr",
            "oup_sizze_27540);\n        \n        int32_t skip_threads_29428;\n        \n        // read input for in-block scan\n        {\n            if (ltid_in_bounds_29427) {\n                x_29403 = ((volatile __local\n                            int64_t *) local_mem_29354)[squot64(byte_offsets_29344,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_29340)];\n                x_29404 = ((volatile __local\n                            int64_t *) local_mem_29354)[squot64(byte_offsets_29345,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_29340)];\n                x_29405 = ((volatile __local\n                            int64_t *) local_mem_29354)[squot64(byte_offsets_29346,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_29340)];\n                x_29406 = ((volatile __local\n                            int64_t *) local_mem_29354)[squot64(byte_offsets_29347,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_29340)];\n                if ((local_tid_29340 - squot32(local_tid_29340, 32) * 32) ==\n                    0) {\n                    x_29399 = x_29403;\n                    x_29400 = x_29404;\n                    x_29401 = x_29405;\n                    x_29402 = x_29406;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_29428 = 1;\n            while (slt32(skip_threads_29428, 32)) {\n                if (sle32(skip_threads_29428, local_tid_29340 -\n                          squot32(local_tid_29340, 32) * 32) &&\n                    ltid_in_bounds_29427) {\n                    // read ",
            "operands\n                    {\n                        x_29399 = ((volatile __local\n                                    int64_t *) local_mem_29354)[squot64(byte_offsets_29344,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_29340) -\n                                                                 sext_i32_i64(skip_threads_29428))];\n                        x_29400 = ((volatile __local\n                                    int64_t *) local_mem_29354)[squot64(byte_offsets_29345,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_29340) -\n                                                                 sext_i32_i64(skip_threads_29428))];\n                        x_29401 = ((volatile __local\n                                    int64_t *) local_mem_29354)[squot64(byte_offsets_29346,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_29340) -\n                                                                 sext_i32_i64(skip_threads_29428))];\n                        x_29402 = ((volatile __local\n                                    int64_t *) local_mem_29354)[squot64(byte_offsets_29347,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_29340) -\n                                                                 sext_i32_i64(skip_threads_29428))];\n                    }\n                    // perform operation\n                    {\n                        int64_t defunc_1_op_res_29407 = add64(x_29399, x_29403);\n                        int64_t defunc_1_op_res_29408 = add64(x_29400, x_29404);\n  ",
            "                      int64_t defunc_1_op_res_29409 = add64(x_29401, x_29405);\n                        int64_t defunc_1_op_res_29410 = add64(x_29402, x_29406);\n                        \n                        x_29399 = defunc_1_op_res_29407;\n                        x_29400 = defunc_1_op_res_29408;\n                        x_29401 = defunc_1_op_res_29409;\n                        x_29402 = defunc_1_op_res_29410;\n                    }\n                }\n                if (sle32(wave_sizze_29342, skip_threads_29428)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_29428, local_tid_29340 -\n                          squot32(local_tid_29340, 32) * 32) &&\n                    ltid_in_bounds_29427) {\n                    // write result\n                    {\n                        ((volatile __local\n                          int64_t *) local_mem_29354)[squot64(byte_offsets_29344,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_29340)] =\n                            x_29399;\n                        x_29403 = x_29399;\n                        ((volatile __local\n                          int64_t *) local_mem_29354)[squot64(byte_offsets_29345,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_29340)] =\n                            x_29400;\n                        x_29404 = x_29400;\n                        ((volatile __local\n                          int64_t *) local_mem_29354)[squot64(byte_offsets_29346,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_29340)] =\n                            x_29401;\n                        x_29405 = x_29401;\n                        ((volatile __local\n                          int64_",
            "t *) local_mem_29354)[squot64(byte_offsets_29347,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_29340)] =\n                            x_29402;\n                        x_29406 = x_29402;\n                    }\n                }\n                if (sle32(wave_sizze_29342, skip_threads_29428)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_29428 *= 2;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // last thread of block 'i' writes its result to offset 'i'\n        {\n            if ((local_tid_29340 - squot32(local_tid_29340, 32) * 32) == 31 &&\n                ltid_in_bounds_29427) {\n                ((volatile __local\n                  int64_t *) local_mem_29354)[squot64(byte_offsets_29344,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_29340,\n                                                                   32))] =\n                    x_29399;\n                ((volatile __local\n                  int64_t *) local_mem_29354)[squot64(byte_offsets_29345,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_29340,\n                                                                   32))] =\n                    x_29400;\n                ((volatile __local\n                  int64_t *) local_mem_29354)[squot64(byte_offsets_29346,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_29340,\n                                                                   32))] =\n                    x_29401;\n                ((volatile __local\n                  int64_t *) local_mem_29354)[squot64(byte_offsets_29347,\n                        ",
            "                              (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_29340,\n                                                                   32))] =\n                    x_29402;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n        {\n            int32_t skip_threads_29429;\n            \n            // read input for in-block scan\n            {\n                if (squot32(local_tid_29340, 32) == 0 && ltid_in_bounds_29427) {\n                    x_29419 = ((volatile __local\n                                int64_t *) local_mem_29354)[squot64(byte_offsets_29344,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_29340)];\n                    x_29420 = ((volatile __local\n                                int64_t *) local_mem_29354)[squot64(byte_offsets_29345,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_29340)];\n                    x_29421 = ((volatile __local\n                                int64_t *) local_mem_29354)[squot64(byte_offsets_29346,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_29340)];\n                    x_29422 = ((volatile __local\n                                int64_t *) local_mem_29354)[squot64(byte_offsets_29347,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_29340)];\n                    if ((local_tid_29340 - squot32(local_tid_29340, 32) * 32) ==\n                        0) {\n                        x_29415 = x_29419;\n            ",
            "            x_29416 = x_29420;\n                        x_29417 = x_29421;\n                        x_29418 = x_29422;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_29429 = 1;\n                while (slt32(skip_threads_29429, 32)) {\n                    if (sle32(skip_threads_29429, local_tid_29340 -\n                              squot32(local_tid_29340, 32) * 32) &&\n                        (squot32(local_tid_29340, 32) == 0 &&\n                         ltid_in_bounds_29427)) {\n                        // read operands\n                        {\n                            x_29415 = ((volatile __local\n                                        int64_t *) local_mem_29354)[squot64(byte_offsets_29344,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_29340) -\n                                                                     sext_i32_i64(skip_threads_29429))];\n                            x_29416 = ((volatile __local\n                                        int64_t *) local_mem_29354)[squot64(byte_offsets_29345,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_29340) -\n                                                                     sext_i32_i64(skip_threads_29429))];\n                            x_29417 = ((volatile __local\n                                        int64_t *) local_mem_29354)[squot64(byte_offsets_29346,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_29340) -\n                                                                     sext_i32_i64(skip_threads_2942",
            "9))];\n                            x_29418 = ((volatile __local\n                                        int64_t *) local_mem_29354)[squot64(byte_offsets_29347,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_29340) -\n                                                                     sext_i32_i64(skip_threads_29429))];\n                        }\n                        // perform operation\n                        {\n                            int64_t defunc_1_op_res_29423 = add64(x_29415,\n                                                                  x_29419);\n                            int64_t defunc_1_op_res_29424 = add64(x_29416,\n                                                                  x_29420);\n                            int64_t defunc_1_op_res_29425 = add64(x_29417,\n                                                                  x_29421);\n                            int64_t defunc_1_op_res_29426 = add64(x_29418,\n                                                                  x_29422);\n                            \n                            x_29415 = defunc_1_op_res_29423;\n                            x_29416 = defunc_1_op_res_29424;\n                            x_29417 = defunc_1_op_res_29425;\n                            x_29418 = defunc_1_op_res_29426;\n                        }\n                    }\n                    if (sle32(wave_sizze_29342, skip_threads_29429)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_29429, local_tid_29340 -\n                              squot32(local_tid_29340, 32) * 32) &&\n                        (squot32(local_tid_29340, 32) == 0 &&\n                         ltid_in_bounds_29427)) {\n                        // write result\n                        {\n                            ((volatile __local\n              ",
            "                int64_t *) local_mem_29354)[squot64(byte_offsets_29344,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_29340)] =\n                                x_29415;\n                            x_29419 = x_29415;\n                            ((volatile __local\n                              int64_t *) local_mem_29354)[squot64(byte_offsets_29345,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_29340)] =\n                                x_29416;\n                            x_29420 = x_29416;\n                            ((volatile __local\n                              int64_t *) local_mem_29354)[squot64(byte_offsets_29346,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_29340)] =\n                                x_29417;\n                            x_29421 = x_29417;\n                            ((volatile __local\n                              int64_t *) local_mem_29354)[squot64(byte_offsets_29347,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_29340)] =\n                                x_29418;\n                            x_29422 = x_29418;\n                        }\n                    }\n                    if (sle32(wave_sizze_29342, skip_threads_29429)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_29429 *= 2;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // carry-in for every block except the first\n        {\n            if (!(squot32(local_tid_29340, 32) == 0 || !ltid_in_bounds_29427)) {\n                // read o",
            "perands\n                {\n                    x_29403 = x_29399;\n                    x_29404 = x_29400;\n                    x_29405 = x_29401;\n                    x_29406 = x_29402;\n                    x_29399 = ((__local\n                                int64_t *) local_mem_29354)[squot64(byte_offsets_29344,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_29340,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                    x_29400 = ((__local\n                                int64_t *) local_mem_29354)[squot64(byte_offsets_29345,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_29340,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                    x_29401 = ((__local\n                                int64_t *) local_mem_29354)[squot64(byte_offsets_29346,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_29340,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                    x_29402 = ((__local\n                                int64_t *) local_mem_29354)[squot64(byte_offsets_29347,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_29340,\n                                                                                  3",
            "2)) -\n                                                             (int64_t) 1)];\n                }\n                // perform operation\n                {\n                    int64_t defunc_1_op_res_29407 = add64(x_29399, x_29403);\n                    int64_t defunc_1_op_res_29408 = add64(x_29400, x_29404);\n                    int64_t defunc_1_op_res_29409 = add64(x_29401, x_29405);\n                    int64_t defunc_1_op_res_29410 = add64(x_29402, x_29406);\n                    \n                    x_29399 = defunc_1_op_res_29407;\n                    x_29400 = defunc_1_op_res_29408;\n                    x_29401 = defunc_1_op_res_29409;\n                    x_29402 = defunc_1_op_res_29410;\n                }\n                // write final result\n                {\n                    ((__local\n                      int64_t *) local_mem_29354)[squot64(byte_offsets_29344,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_29340)] =\n                        x_29399;\n                    ((__local\n                      int64_t *) local_mem_29354)[squot64(byte_offsets_29345,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_29340)] =\n                        x_29400;\n                    ((__local\n                      int64_t *) local_mem_29354)[squot64(byte_offsets_29346,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_29340)] =\n                        x_29401;\n                    ((__local\n                      int64_t *) local_mem_29354)[squot64(byte_offsets_29347,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_29340)] =\n                        x_29402;\n                }\n            }\n        }\n",
            "        barrier(CLK_LOCAL_MEM_FENCE);\n        // restore correct values for first block\n        {\n            if (squot32(local_tid_29340, 32) == 0) {\n                ((__local\n                  int64_t *) local_mem_29354)[squot64(byte_offsets_29344,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_29340)] =\n                    x_29403;\n                ((__local\n                  int64_t *) local_mem_29354)[squot64(byte_offsets_29345,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_29340)] =\n                    x_29404;\n                ((__local\n                  int64_t *) local_mem_29354)[squot64(byte_offsets_29346,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_29340)] =\n                    x_29405;\n                ((__local\n                  int64_t *) local_mem_29354)[squot64(byte_offsets_29347,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_29340)] =\n                    x_29406;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_tid_29340 == 0) {\n            acc_29411 = ((__local\n                          int64_t *) local_mem_29354)[squot64(byte_offsets_29344,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_27540 -\n                                                       (int64_t) 1)];\n            acc_29412 = ((__local\n                          int64_t *) local_mem_29354)[squot64(byte_offsets_29345,\n                                                              (int64_t) 8) +\n                                                      (segscan_gro",
            "up_sizze_27540 -\n                                                       (int64_t) 1)];\n            acc_29413 = ((__local\n                          int64_t *) local_mem_29354)[squot64(byte_offsets_29346,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_27540 -\n                                                       (int64_t) 1)];\n            acc_29414 = ((__local\n                          int64_t *) local_mem_29354)[squot64(byte_offsets_29347,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_27540 -\n                                                       (int64_t) 1)];\n        } else {\n            acc_29411 = ((__local\n                          int64_t *) local_mem_29354)[squot64(byte_offsets_29344,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_29340) -\n                                                       (int64_t) 1)];\n            acc_29412 = ((__local\n                          int64_t *) local_mem_29354)[squot64(byte_offsets_29345,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_29340) -\n                                                       (int64_t) 1)];\n            acc_29413 = ((__local\n                          int64_t *) local_mem_29354)[squot64(byte_offsets_29346,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_29340) -\n                                                       (int64_t) 1)];\n            acc_29414 = ((__local\n                          int64_t *) local_mem_29354)[squot64(byte_offsets_29347,\n                                      ",
            "                        (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_29340) -\n                                                       (int64_t) 1)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t prefix_29430;\n    \n    prefix_29430 = (int64_t) 0;\n    \n    int64_t prefix_29431;\n    \n    prefix_29431 = (int64_t) 0;\n    \n    int64_t prefix_29432;\n    \n    prefix_29432 = (int64_t) 0;\n    \n    int64_t prefix_29433;\n    \n    prefix_29433 = (int64_t) 0;\n    // Perform lookback\n    {\n        if (dynamic_id_29371 == (int64_t) 0 && local_tid_29340 == 0) {\n            ((volatile __global\n              int64_t *) incprefixes_mem_29325)[dynamic_id_29371] = acc_29411;\n            ((volatile __global\n              int64_t *) incprefixes_mem_29329)[dynamic_id_29371] = acc_29412;\n            ((volatile __global\n              int64_t *) incprefixes_mem_29333)[dynamic_id_29371] = acc_29413;\n            ((volatile __global\n              int64_t *) incprefixes_mem_29337)[dynamic_id_29371] = acc_29414;\n            mem_fence_global();\n            ((volatile __global\n              int8_t *) status_flags_mem_29321)[dynamic_id_29371] = (int8_t) 2;\n            acc_29411 = (int64_t) 0;\n            acc_29412 = (int64_t) 0;\n            acc_29413 = (int64_t) 0;\n            acc_29414 = (int64_t) 0;\n        }\n        if (!(dynamic_id_29371 == (int64_t) 0) && slt32(local_tid_29340,\n                                                        wave_sizze_29342)) {\n            if (local_tid_29340 == 0) {\n                ((volatile __global\n                  int64_t *) aggregates_mem_29323)[dynamic_id_29371] =\n                    acc_29411;\n                ((volatile __global\n                  int64_t *) aggregates_mem_29327)[dynamic_id_29371] =\n                    acc_29412;\n                ((volatile __global\n                  int64_t *) aggregates_mem_29331)[dynamic_id_29371] =\n                    acc_29413;\n                ((volatile ",
            "__global\n                  int64_t *) aggregates_mem_29335)[dynamic_id_29371] =\n                    acc_29414;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_29321)[dynamic_id_29371] =\n                    (int8_t) 1;\n                ((__local int8_t *) local_mem_29354)[(int64_t) 0] = ((__global\n                                                                      int8_t *) status_flags_mem_29321)[dynamic_id_29371 -\n                                                                                                        (int64_t) 1];\n            }\n            mem_fence_local();\n            \n            int8_t status_29434;\n            \n            status_29434 = ((__local int8_t *) local_mem_29354)[(int64_t) 0];\n            if (status_29434 == (int8_t) 2) {\n                if (local_tid_29340 == 0) {\n                    prefix_29430 = ((volatile __global\n                                     int64_t *) incprefixes_mem_29325)[dynamic_id_29371 -\n                                                                       (int64_t) 1];\n                    prefix_29431 = ((volatile __global\n                                     int64_t *) incprefixes_mem_29329)[dynamic_id_29371 -\n                                                                       (int64_t) 1];\n                    prefix_29432 = ((volatile __global\n                                     int64_t *) incprefixes_mem_29333)[dynamic_id_29371 -\n                                                                       (int64_t) 1];\n                    prefix_29433 = ((volatile __global\n                                     int64_t *) incprefixes_mem_29337)[dynamic_id_29371 -\n                                                                       (int64_t) 1];\n                }\n            } else {\n                int32_t readOffset_29435 = dynamic_id_29371 -\n                        sext_i32_i64(wave_sizze_29342);\n                \n                while (slt3",
            "2(wave_sizze_29342 * -1, readOffset_29435)) {\n                    int32_t read_i_29436 = readOffset_29435 + local_tid_29340;\n                    int64_t aggr_29437 = (int64_t) 0;\n                    int64_t aggr_29438 = (int64_t) 0;\n                    int64_t aggr_29439 = (int64_t) 0;\n                    int64_t aggr_29440 = (int64_t) 0;\n                    int8_t flag_29441 = (int8_t) 0;\n                    int8_t used_29442 = (int8_t) 0;\n                    \n                    if (sle32(0, read_i_29436)) {\n                        flag_29441 = ((volatile __global\n                                       int8_t *) status_flags_mem_29321)[sext_i32_i64(read_i_29436)];\n                        if (flag_29441 == (int8_t) 2) {\n                            aggr_29437 = ((volatile __global\n                                           int64_t *) incprefixes_mem_29325)[sext_i32_i64(read_i_29436)];\n                            aggr_29438 = ((volatile __global\n                                           int64_t *) incprefixes_mem_29329)[sext_i32_i64(read_i_29436)];\n                            aggr_29439 = ((volatile __global\n                                           int64_t *) incprefixes_mem_29333)[sext_i32_i64(read_i_29436)];\n                            aggr_29440 = ((volatile __global\n                                           int64_t *) incprefixes_mem_29337)[sext_i32_i64(read_i_29436)];\n                        } else {\n                            if (flag_29441 == (int8_t) 1) {\n                                aggr_29437 = ((volatile __global\n                                               int64_t *) aggregates_mem_29323)[sext_i32_i64(read_i_29436)];\n                                aggr_29438 = ((volatile __global\n                                               int64_t *) aggregates_mem_29327)[sext_i32_i64(read_i_29436)];\n                                aggr_29439 = ((volatile __global\n                                               int64_t *) aggregates_mem_29331)[sext_i32_i64(re",
            "ad_i_29436)];\n                                aggr_29440 = ((volatile __global\n                                               int64_t *) aggregates_mem_29335)[sext_i32_i64(read_i_29436)];\n                                used_29442 = (int8_t) 1;\n                            }\n                        }\n                    }\n                    ((__local\n                      int64_t *) local_mem_29354)[squot64(warp_byte_offset_29349,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_29340)] =\n                        aggr_29437;\n                    ((__local\n                      int64_t *) local_mem_29354)[squot64(warp_byte_offset_29350,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_29340)] =\n                        aggr_29438;\n                    ((__local\n                      int64_t *) local_mem_29354)[squot64(warp_byte_offset_29351,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_29340)] =\n                        aggr_29439;\n                    ((__local\n                      int64_t *) local_mem_29354)[squot64(warp_byte_offset_29352,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_29340)] =\n                        aggr_29440;\n                    \n                    int8_t tmp_29443;\n                    \n                    tmp_29443 = flag_29441 | used_29442 << (int8_t) 2;\n                    ((__local\n                      int8_t *) local_mem_29354)[sext_i32_i64(local_tid_29340)] =\n                        tmp_29443;\n                    mem_fence_local();\n                    flag_29441 = ((volatile __local\n                                   int8_t *) local_mem_29354)[sext_i32_i",
            "64(wave_sizze_29342) -\n                                                              (int64_t) 1];\n                    if (local_tid_29340 == 0) {\n                        if (!(flag_29441 == (int8_t) 2)) {\n                            int64_t x_29444 = (int64_t) 0;\n                            int64_t x_29445 = (int64_t) 0;\n                            int64_t x_29446 = (int64_t) 0;\n                            int64_t x_29447 = (int64_t) 0;\n                            int64_t x_29448;\n                            int64_t x_29449;\n                            int64_t x_29450;\n                            int64_t x_29451;\n                            int8_t flag1_29456;\n                            \n                            flag1_29456 = (int8_t) 0;\n                            \n                            int8_t flag2_29457;\n                            int8_t used1_29458;\n                            \n                            used1_29458 = (int8_t) 0;\n                            \n                            int8_t used2_29459;\n                            \n                            for (int32_t i_29460 = 0; i_29460 <\n                                 wave_sizze_29342; i_29460++) {\n                                flag2_29457 = ((__local\n                                                int8_t *) local_mem_29354)[sext_i32_i64(i_29460)];\n                                used2_29459 = lshr8(flag2_29457, (int8_t) 2);\n                                flag2_29457 = flag2_29457 & (int8_t) 3;\n                                x_29448 = ((__local\n                                            int64_t *) local_mem_29354)[squot64(warp_byte_offset_29349,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_29460)];\n                                x_29449 = ((__local\n                                            int64_t *) local_mem_29354)[squot64(warp_byte_offset_2935",
            "0,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_29460)];\n                                x_29450 = ((__local\n                                            int64_t *) local_mem_29354)[squot64(warp_byte_offset_29351,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_29460)];\n                                x_29451 = ((__local\n                                            int64_t *) local_mem_29354)[squot64(warp_byte_offset_29352,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_29460)];\n                                if (!(flag2_29457 == (int8_t) 1)) {\n                                    flag1_29456 = flag2_29457;\n                                    used1_29458 = used2_29459;\n                                    x_29444 = x_29448;\n                                    x_29445 = x_29449;\n                                    x_29446 = x_29450;\n                                    x_29447 = x_29451;\n                                } else {\n                                    used1_29458 += used2_29459;\n                                    \n                                    int64_t defunc_1_op_res_29452;\n                                    \n                                    defunc_1_op_res_29452 = add64(x_29444,\n                                                                  x_29448);\n                                    \n                                    int64_t defunc_1_op_res_29453 =\n                                            add64(x_29445, x_29449);\n                                    int64_t defunc_1_op_res_29454 =\n                                            add64(x_29446, ",
            "x_29450);\n                                    int64_t defunc_1_op_res_29455 =\n                                            add64(x_29447, x_29451);\n                                    \n                                    x_29444 = defunc_1_op_res_29452;\n                                    x_29445 = defunc_1_op_res_29453;\n                                    x_29446 = defunc_1_op_res_29454;\n                                    x_29447 = defunc_1_op_res_29455;\n                                }\n                            }\n                            flag_29441 = flag1_29456;\n                            used_29442 = used1_29458;\n                            aggr_29437 = x_29444;\n                            aggr_29438 = x_29445;\n                            aggr_29439 = x_29446;\n                            aggr_29440 = x_29447;\n                        } else {\n                            aggr_29437 = ((__local\n                                           int64_t *) local_mem_29354)[squot64(warp_byte_offset_29349,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_29342) -\n                                                                        (int64_t) 1)];\n                            aggr_29438 = ((__local\n                                           int64_t *) local_mem_29354)[squot64(warp_byte_offset_29350,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_29342) -\n                                                                        (int64_t) 1)];\n                            aggr_29439 = ((__local\n                                           int64_t *) local_mem_29354)[squot64(warp_byte_offset_29351,\n                                                                               (int64_t) 8) +\n       ",
            "                                                                (sext_i32_i64(wave_sizze_29342) -\n                                                                        (int64_t) 1)];\n                            aggr_29440 = ((__local\n                                           int64_t *) local_mem_29354)[squot64(warp_byte_offset_29352,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_29342) -\n                                                                        (int64_t) 1)];\n                        }\n                        if (flag_29441 == (int8_t) 2) {\n                            readOffset_29435 = wave_sizze_29342 * -1;\n                        } else {\n                            readOffset_29435 -= zext_i8_i32(used_29442);\n                        }\n                        ((__local int32_t *) local_mem_29354)[(int64_t) 0] =\n                            readOffset_29435;\n                        \n                        int64_t x_29461;\n                        \n                        x_29461 = aggr_29437;\n                        \n                        int64_t x_29462;\n                        \n                        x_29462 = aggr_29438;\n                        \n                        int64_t x_29463;\n                        \n                        x_29463 = aggr_29439;\n                        \n                        int64_t x_29464;\n                        \n                        x_29464 = aggr_29440;\n                        \n                        int64_t x_29465;\n                        \n                        x_29465 = prefix_29430;\n                        \n                        int64_t x_29466;\n                        \n                        x_29466 = prefix_29431;\n                        \n                        int64_t x_29467;\n                        \n                        x_29467 = prefix_29432;\n   ",
            "                     \n                        int64_t x_29468;\n                        \n                        x_29468 = prefix_29433;\n                        \n                        int64_t defunc_1_op_res_29469;\n                        \n                        defunc_1_op_res_29469 = add64(x_29461, x_29465);\n                        \n                        int64_t defunc_1_op_res_29470 = add64(x_29462, x_29466);\n                        int64_t defunc_1_op_res_29471 = add64(x_29463, x_29467);\n                        int64_t defunc_1_op_res_29472 = add64(x_29464, x_29468);\n                        \n                        prefix_29430 = defunc_1_op_res_29469;\n                        prefix_29431 = defunc_1_op_res_29470;\n                        prefix_29432 = defunc_1_op_res_29471;\n                        prefix_29433 = defunc_1_op_res_29472;\n                    }\n                    mem_fence_local();\n                    readOffset_29435 = ((__local\n                                         int32_t *) local_mem_29354)[(int64_t) 0];\n                }\n            }\n            if (local_tid_29340 == 0) {\n                int64_t x_29473 = prefix_29430;\n                int64_t x_29474 = prefix_29431;\n                int64_t x_29475 = prefix_29432;\n                int64_t x_29476 = prefix_29433;\n                int64_t x_29477 = acc_29411;\n                int64_t x_29478 = acc_29412;\n                int64_t x_29479 = acc_29413;\n                int64_t x_29480 = acc_29414;\n                int64_t defunc_1_op_res_29481 = add64(x_29473, x_29477);\n                int64_t defunc_1_op_res_29482 = add64(x_29474, x_29478);\n                int64_t defunc_1_op_res_29483 = add64(x_29475, x_29479);\n                int64_t defunc_1_op_res_29484 = add64(x_29476, x_29480);\n                \n                ((volatile __global\n                  int64_t *) incprefixes_mem_29325)[dynamic_id_29371] =\n                    defunc_1_op_res_29481;\n                ((volatile __global\n            ",
            "      int64_t *) incprefixes_mem_29329)[dynamic_id_29371] =\n                    defunc_1_op_res_29482;\n                ((volatile __global\n                  int64_t *) incprefixes_mem_29333)[dynamic_id_29371] =\n                    defunc_1_op_res_29483;\n                ((volatile __global\n                  int64_t *) incprefixes_mem_29337)[dynamic_id_29371] =\n                    defunc_1_op_res_29484;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_29321)[dynamic_id_29371] =\n                    (int8_t) 2;\n                ((__local\n                  int64_t *) local_mem_29354)[squot64(warp_byte_offset_29349,\n                                                      (int64_t) 8)] =\n                    prefix_29430;\n                ((__local\n                  int64_t *) local_mem_29354)[squot64(warp_byte_offset_29350,\n                                                      (int64_t) 8)] =\n                    prefix_29431;\n                ((__local\n                  int64_t *) local_mem_29354)[squot64(warp_byte_offset_29351,\n                                                      (int64_t) 8)] =\n                    prefix_29432;\n                ((__local\n                  int64_t *) local_mem_29354)[squot64(warp_byte_offset_29352,\n                                                      (int64_t) 8)] =\n                    prefix_29433;\n                acc_29411 = (int64_t) 0;\n                acc_29412 = (int64_t) 0;\n                acc_29413 = (int64_t) 0;\n                acc_29414 = (int64_t) 0;\n            }\n        }\n        if (!(dynamic_id_29371 == (int64_t) 0)) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            prefix_29430 = ((__local\n                             int64_t *) local_mem_29354)[squot64(warp_byte_offset_29349,\n                                                                 (int64_t) 8)];\n            prefix_29431 = ((__local\n                             int64_t *) local_mem_29354)[squot64",
            "(warp_byte_offset_29350,\n                                                                 (int64_t) 8)];\n            prefix_29432 = ((__local\n                             int64_t *) local_mem_29354)[squot64(warp_byte_offset_29351,\n                                                                 (int64_t) 8)];\n            prefix_29433 = ((__local\n                             int64_t *) local_mem_29354)[squot64(warp_byte_offset_29352,\n                                                                 (int64_t) 8)];\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    // Distribute results\n    {\n        int64_t x_29485;\n        int64_t x_29489;\n        int64_t x_29497;\n        \n        x_29497 = prefix_29430;\n        \n        int64_t x_29501;\n        \n        x_29501 = acc_29411;\n        \n        int64_t x_29486;\n        int64_t x_29490;\n        int64_t x_29498;\n        \n        x_29498 = prefix_29431;\n        \n        int64_t x_29502;\n        \n        x_29502 = acc_29412;\n        \n        int64_t x_29487;\n        int64_t x_29491;\n        int64_t x_29499;\n        \n        x_29499 = prefix_29432;\n        \n        int64_t x_29503;\n        \n        x_29503 = acc_29413;\n        \n        int64_t x_29488;\n        int64_t x_29492;\n        int64_t x_29500;\n        \n        x_29500 = prefix_29433;\n        \n        int64_t x_29504;\n        \n        x_29504 = acc_29414;\n        \n        int64_t defunc_1_op_res_29505;\n        \n        defunc_1_op_res_29505 = add64(x_29497, x_29501);\n        \n        int64_t defunc_1_op_res_29506 = add64(x_29498, x_29502);\n        int64_t defunc_1_op_res_29507 = add64(x_29499, x_29503);\n        int64_t defunc_1_op_res_29508 = add64(x_29500, x_29504);\n        \n        x_29485 = defunc_1_op_res_29505;\n        x_29486 = defunc_1_op_res_29506;\n        x_29487 = defunc_1_op_res_29507;\n        x_29488 = defunc_1_op_res_29508;\n        for (int64_t i_29509 = 0; i_29509 < (int64_t) 9; i_29509++) {\n            x_29489 = private_mem_29373[i_29509];\n   ",
            "         x_29490 = private_mem_29375[i_29509];\n            x_29491 = private_mem_29377[i_29509];\n            x_29492 = private_mem_29379[i_29509];\n            \n            int64_t defunc_1_op_res_29493;\n            \n            defunc_1_op_res_29493 = add64(x_29485, x_29489);\n            \n            int64_t defunc_1_op_res_29494 = add64(x_29486, x_29490);\n            int64_t defunc_1_op_res_29495 = add64(x_29487, x_29491);\n            int64_t defunc_1_op_res_29496 = add64(x_29488, x_29492);\n            \n            private_mem_29373[i_29509] = defunc_1_op_res_29493;\n            private_mem_29375[i_29509] = defunc_1_op_res_29494;\n            private_mem_29377[i_29509] = defunc_1_op_res_29495;\n            private_mem_29379[i_29509] = defunc_1_op_res_29496;\n        }\n    }\n    // Transpose scan output\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29510 = 0; i_29510 < (int64_t) 9; i_29510++) {\n            int64_t sharedIdx_29511 = sext_i32_i64(local_tid_29340 * 9) +\n                    i_29510;\n            \n            ((__local int64_t *) local_mem_29354)[sharedIdx_29511] =\n                private_mem_29373[i_29510];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29512 = 0; i_29512 < (int64_t) 9; i_29512++) {\n            int32_t sharedIdx_29513 = local_tid_29340 +\n                    sext_i64_i32(segscan_group_sizze_27540 * i_29512);\n            \n            private_mem_29373[i_29512] = ((__local\n                                           int64_t *) local_mem_29354)[sext_i32_i64(sharedIdx_29513)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29514 = 0; i_29514 < (int64_t) 9; i_29514++) {\n            int64_t sharedIdx_29515 = sext_i32_i64(local_tid_29340 * 9) +\n                    i_29514;\n            \n            ((__local int64_t *) local_mem_29354)[sharedIdx_29515] =\n                private_mem_29375[i_29514];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29516 = 0; i_295",
            "16 < (int64_t) 9; i_29516++) {\n            int32_t sharedIdx_29517 = local_tid_29340 +\n                    sext_i64_i32(segscan_group_sizze_27540 * i_29516);\n            \n            private_mem_29375[i_29516] = ((__local\n                                           int64_t *) local_mem_29354)[sext_i32_i64(sharedIdx_29517)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29518 = 0; i_29518 < (int64_t) 9; i_29518++) {\n            int64_t sharedIdx_29519 = sext_i32_i64(local_tid_29340 * 9) +\n                    i_29518;\n            \n            ((__local int64_t *) local_mem_29354)[sharedIdx_29519] =\n                private_mem_29377[i_29518];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29520 = 0; i_29520 < (int64_t) 9; i_29520++) {\n            int32_t sharedIdx_29521 = local_tid_29340 +\n                    sext_i64_i32(segscan_group_sizze_27540 * i_29520);\n            \n            private_mem_29377[i_29520] = ((__local\n                                           int64_t *) local_mem_29354)[sext_i32_i64(sharedIdx_29521)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29522 = 0; i_29522 < (int64_t) 9; i_29522++) {\n            int64_t sharedIdx_29523 = sext_i32_i64(local_tid_29340 * 9) +\n                    i_29522;\n            \n            ((__local int64_t *) local_mem_29354)[sharedIdx_29523] =\n                private_mem_29379[i_29522];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29524 = 0; i_29524 < (int64_t) 9; i_29524++) {\n            int32_t sharedIdx_29525 = local_tid_29340 +\n                    sext_i64_i32(segscan_group_sizze_27540 * i_29524);\n            \n            private_mem_29379[i_29524] = ((__local\n                                           int64_t *) local_mem_29354)[sext_i32_i64(sharedIdx_29525)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Write block scan results to global memory\n    {\n        for (int64_t i_29526 = 0; i_29526 < (int",
            "64_t) 9; i_29526++) {\n            int64_t gtid_27544 = blockOff_29372 + segscan_group_sizze_27540 *\n                    i_29526 + sext_i32_i64(local_tid_29340);\n            \n            if (slt64(gtid_27544, conc_tmp_25517)) {\n                ((__global int64_t *) mem_28386)[gtid_27544] =\n                    private_mem_29373[i_29526];\n            }\n        }\n        for (int64_t i_29527 = 0; i_29527 < (int64_t) 9; i_29527++) {\n            int64_t gtid_27544 = blockOff_29372 + segscan_group_sizze_27540 *\n                    i_29527 + sext_i32_i64(local_tid_29340);\n            \n            if (slt64(gtid_27544, conc_tmp_25517)) {\n                ((__global int64_t *) mem_28388)[gtid_27544] =\n                    private_mem_29375[i_29527];\n            }\n        }\n        for (int64_t i_29528 = 0; i_29528 < (int64_t) 9; i_29528++) {\n            int64_t gtid_27544 = blockOff_29372 + segscan_group_sizze_27540 *\n                    i_29528 + sext_i32_i64(local_tid_29340);\n            \n            if (slt64(gtid_27544, conc_tmp_25517)) {\n                ((__global int64_t *) mem_28390)[gtid_27544] =\n                    private_mem_29377[i_29528];\n            }\n        }\n        for (int64_t i_29529 = 0; i_29529 < (int64_t) 9; i_29529++) {\n            int64_t gtid_27544 = blockOff_29372 + segscan_group_sizze_27540 *\n                    i_29529 + sext_i32_i64(local_tid_29340);\n            \n            if (slt64(gtid_27544, conc_tmp_25517)) {\n                ((__global int64_t *) mem_28392)[gtid_27544] =\n                    private_mem_29379[i_29529];\n            }\n        }\n    }\n    // If this is the last block, reset the dynamicId\n    {\n        if (dynamic_id_29371 == sdiv_up64(conc_tmp_25517,\n                                          segscan_group_sizze_27540 *\n                                          (int64_t) 9) - (int64_t) 1) {\n            ((__global\n              int32_t *) eWiseAddEntryziid_counter_mem_29319)[(int64_t) 0] = 0;\n        }\n    }\n    \n  error_0:\n    ret",
            "urn;\n    #undef segscan_group_sizze_27540\n}\n__kernel void eWiseAddEntryzisegscan_27663(__global int *global_failure,\n                                           int failure_is_an_option, __global\n                                           int64_t *global_failure_args,\n                                           uint local_mem_29559_backing_offset_0,\n                                           int64_t conc_tmp_25517,\n                                           int64_t i_25533, __global\n                                           unsigned char *mem_28416, __global\n                                           unsigned char *mem_28418, __global\n                                           unsigned char *mem_28420, __global\n                                           unsigned char *mem_28422, __global\n                                           unsigned char *mem_28425, __global\n                                           unsigned char *mem_28427, __global\n                                           unsigned char *mem_28429, __global\n                                           unsigned char *mem_28431, __global\n                                           unsigned char *mem_28433, __global\n                                           unsigned char *mem_28435, __global\n                                           unsigned char *eWiseAddEntryziid_counter_mem_29542,\n                                           __global\n                                           unsigned char *status_flags_mem_29544,\n                                           __global\n                                           unsigned char *aggregates_mem_29546,\n                                           __global\n                                           unsigned char *incprefixes_mem_29548)\n{\n    #define segscan_group_sizze_27658 (eWiseAddEntryzisegscan_group_sizze_27657)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *local_mem_29559_backing_0 =\n               ",
            "   &shared_mem[local_mem_29559_backing_offset_0];\n    volatile __local bool local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = false;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t global_tid_29550;\n    int32_t local_tid_29551;\n    int64_t group_sizze_29554;\n    int32_t wave_sizze_29553;\n    int32_t group_tid_29552;\n    \n    global_tid_29550 = get_global_id(0);\n    local_tid_29551 = get_local_id(0);\n    group_sizze_29554 = get_local_size(0);\n    wave_sizze_29553 = LOCKSTEP_WIDTH;\n    group_tid_29552 = get_group_id(0);\n    \n    int32_t phys_tid_27663;\n    \n    phys_tid_27663 = global_tid_29550;\n    \n    int64_t byte_offsets_29555;\n    \n    byte_offsets_29555 = (int64_t) 0;\n    \n    int64_t byte_offsets_29556;\n    \n    byte_offsets_29556 = segscan_group_sizze_27658 * (int64_t) 8;\n    \n    int64_t warp_byte_offset_29557;\n    \n    warp_byte_offset_29557 = (int64_t) 32;\n    \n    int64_t warp_byte_offset_29558;\n    \n    warp_byte_offset_29558 = (int64_t) 288;\n    // Allocate reused shared memeory\n    { }\n    \n    __local char *local_mem_29559;\n    \n    local_mem_29559 = (__local char *) local_mem_29559_backing_0;\n    \n    int64_t trans_arr_len_29560;\n    \n    trans_arr_len_29560 = (int64_t) 9 * segscan_group_sizze_27658;\n    \n    int32_t dynamic_id_29567;\n    \n    if (local_tid_29551 == 0) {\n        dynamic_id_29567 = atomic_add_i32_global(&((volatile __global\n                                                    int *) eWiseAddEntryziid_counter_mem_29542)[(int64_t) 0],\n                                                 (int) 1);\n        ((__local int32_t *) local_mem_29559)[(int64_t) 0] = dynamic_id_29567;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    dynamic_id_29567 = ((__local int32_t *) local_mem_29559)[(int64_t) 0];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t blockOff_29568;\n    \n    blockOff_29568 = sext_i32_i64(dynamic_id_29567) * (int64_t) 9",
            " *\n        segscan_group_sizze_27658;\n    \n    int64_t private_mem_29569[9];\n    \n    // Load and map\n    {\n        for (int64_t i_29571 = 0; i_29571 < (int64_t) 9; i_29571++) {\n            int64_t gtid_27662 = blockOff_29568 +\n                    sext_i32_i64(local_tid_29551) + i_29571 *\n                    segscan_group_sizze_27658;\n            \n            if (slt64(gtid_27662, conc_tmp_25517)) {\n                int64_t x_25724 = ((__global int64_t *) mem_28416)[gtid_27662];\n                bool cond_25729 = gtid_27662 == i_25533;\n                bool cond_25730 = !cond_25729;\n                bool cond_25731;\n                \n                if (cond_25730) {\n                    int64_t i_25732 = add64((int64_t) 1, gtid_27662);\n                    bool x_25733 = sle64((int64_t) 0, i_25732);\n                    bool y_25734 = slt64(i_25732, conc_tmp_25517);\n                    bool bounds_check_25735 = x_25733 && y_25734;\n                    bool index_certs_25736;\n                    \n                    if (!bounds_check_25735) {\n                        {\n                            if (atomic_cmpxchg_i32_global(global_failure, -1,\n                                                          10) == -1) {\n                                global_failure_args[0] = i_25732;\n                                global_failure_args[1] = conc_tmp_25517;\n                                ;\n                            }\n                            local_failure = true;\n                            goto error_0;\n                        }\n                    }\n                    \n                    int64_t y_25737 = ((__global int64_t *) mem_28416)[i_25732];\n                    bool cond_t_res_25738 = x_25724 == y_25737;\n                    \n                    cond_25731 = cond_t_res_25738;\n                } else {\n                    cond_25731 = 0;\n                }\n                \n                int64_t defunc_0_f_res_25739;\n                \n                if (cond_25731) {\n ",
            "                   defunc_0_f_res_25739 = (int64_t) -1;\n                } else {\n                    defunc_0_f_res_25739 = x_25724;\n                }\n                \n                int64_t defunc_0_f_res_25740;\n                int64_t defunc_0_f_res_25741;\n                int64_t defunc_0_f_res_25742;\n                \n                if (cond_25731) {\n                    defunc_0_f_res_25740 = (int64_t) 0;\n                    defunc_0_f_res_25741 = (int64_t) 0;\n                    defunc_0_f_res_25742 = (int64_t) 0;\n                } else {\n                    int64_t x_25725 = ((__global\n                                        int64_t *) mem_28418)[gtid_27662];\n                    int64_t x_25726 = ((__global\n                                        int64_t *) mem_28420)[gtid_27662];\n                    int64_t x_25727 = ((__global\n                                        int64_t *) mem_28422)[gtid_27662];\n                    bool cond_25743 = gtid_27662 == (int64_t) 0;\n                    bool cond_25744 = !cond_25743;\n                    bool cond_25745;\n                    \n                    if (cond_25744) {\n                        int64_t i_25746 = sub64(gtid_27662, (int64_t) 1);\n                        bool x_25747 = sle64((int64_t) 0, i_25746);\n                        bool y_25748 = slt64(i_25746, conc_tmp_25517);\n                        bool bounds_check_25749 = x_25747 && y_25748;\n                        bool index_certs_25750;\n                        \n                        if (!bounds_check_25749) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure,\n                                                              -1, 11) == -1) {\n                                    global_failure_args[0] = i_25746;\n                                    global_failure_args[1] = conc_tmp_25517;\n                                    ;\n                                }\n                                local_failure = true;",
            "\n                                goto error_0;\n                            }\n                        }\n                        \n                        int64_t y_25751 = ((__global\n                                            int64_t *) mem_28416)[i_25746];\n                        bool cond_t_res_25752 = x_25724 == y_25751;\n                        \n                        cond_25745 = cond_t_res_25752;\n                    } else {\n                        cond_25745 = 0;\n                    }\n                    \n                    int64_t defunc_0_f_res_f_res_25753;\n                    \n                    if (cond_25745) {\n                        defunc_0_f_res_f_res_25753 = (int64_t) 2;\n                    } else {\n                        defunc_0_f_res_f_res_25753 = x_25725;\n                    }\n                    \n                    int64_t defunc_0_f_res_f_res_25754;\n                    int64_t defunc_0_f_res_f_res_25755;\n                    \n                    if (cond_25745) {\n                        bool cond_25756 = x_25725 == (int64_t) 0;\n                        int64_t defunc_0_f_res_f_res_t_res_25757;\n                        int64_t defunc_0_f_res_f_res_t_res_25758;\n                        \n                        if (cond_25756) {\n                            int64_t i_25759 = sub64(gtid_27662, (int64_t) 1);\n                            bool x_25760 = sle64((int64_t) 0, i_25759);\n                            bool y_25761 = slt64(i_25759, conc_tmp_25517);\n                            bool bounds_check_25762 = x_25760 && y_25761;\n                            bool index_certs_25763;\n                            \n                            if (!bounds_check_25762) {\n                                {\n                                    if (atomic_cmpxchg_i32_global(global_failure,\n                                                                  -1, 12) ==\n                                        -1) {\n                                        global_failure_arg",
            "s[0] = i_25759;\n                                        global_failure_args[1] = conc_tmp_25517;\n                                        ;\n                                    }\n                                    local_failure = true;\n                                    goto error_0;\n                                }\n                            }\n                            \n                            int64_t defunc_0_f_res_f_res_t_res_t_res_25764 =\n                                    ((__global int64_t *) mem_28420)[i_25759];\n                            \n                            defunc_0_f_res_f_res_t_res_25757 = x_25726;\n                            defunc_0_f_res_f_res_t_res_25758 =\n                                defunc_0_f_res_f_res_t_res_t_res_25764;\n                        } else {\n                            int64_t i_25765 = sub64(gtid_27662, (int64_t) 1);\n                            bool x_25766 = sle64((int64_t) 0, i_25765);\n                            bool y_25767 = slt64(i_25765, conc_tmp_25517);\n                            bool bounds_check_25768 = x_25766 && y_25767;\n                            bool index_certs_25769;\n                            \n                            if (!bounds_check_25768) {\n                                {\n                                    if (atomic_cmpxchg_i32_global(global_failure,\n                                                                  -1, 13) ==\n                                        -1) {\n                                        global_failure_args[0] = i_25765;\n                                        global_failure_args[1] = conc_tmp_25517;\n                                        ;\n                                    }\n                                    local_failure = true;\n                                    goto error_0;\n                                }\n                            }\n                            \n                            int64_t defunc_0_f_res_f_res_t_res_f_res_25770 =\n          ",
            "                          ((__global int64_t *) mem_28420)[i_25765];\n                            \n                            defunc_0_f_res_f_res_t_res_25757 =\n                                defunc_0_f_res_f_res_t_res_f_res_25770;\n                            defunc_0_f_res_f_res_t_res_25758 = x_25726;\n                        }\n                        defunc_0_f_res_f_res_25754 =\n                            defunc_0_f_res_f_res_t_res_25757;\n                        defunc_0_f_res_f_res_25755 =\n                            defunc_0_f_res_f_res_t_res_25758;\n                    } else {\n                        defunc_0_f_res_f_res_25754 = x_25726;\n                        defunc_0_f_res_f_res_25755 = x_25727;\n                    }\n                    defunc_0_f_res_25740 = defunc_0_f_res_f_res_25753;\n                    defunc_0_f_res_25741 = defunc_0_f_res_f_res_25754;\n                    defunc_0_f_res_25742 = defunc_0_f_res_f_res_25755;\n                }\n                \n                bool eq_x_zz_25771 = (int64_t) -1 == x_25724;\n                bool not_p_25772 = !cond_25731;\n                bool p_and_eq_x_y_25773 = eq_x_zz_25771 && not_p_25772;\n                bool defunc_0_p_res_25774 = cond_25731 || p_and_eq_x_y_25773;\n                int64_t defunc_1_lifted_lambda_res_25775 =\n                        btoi_bool_i64(defunc_0_p_res_25774);\n                bool is_i_25776 = defunc_1_lifted_lambda_res_25775 ==\n                     (int64_t) 0;\n                bool cond_neg_25777 = !is_i_25776;\n                int64_t part_res_25778 = btoi_bool_i64(cond_neg_25777);\n                int64_t part_res_25779 = btoi_bool_i64(is_i_25776);\n                \n                ((__global int64_t *) mem_28427)[gtid_27662] = part_res_25778;\n                ((__global int64_t *) mem_28429)[gtid_27662] =\n                    defunc_0_f_res_25739;\n                ((__global int64_t *) mem_28431)[gtid_27662] =\n                    defunc_0_f_res_25740;\n                ((__global int64_t ",
            "*) mem_28433)[gtid_27662] =\n                    defunc_0_f_res_25741;\n                ((__global int64_t *) mem_28435)[gtid_27662] =\n                    defunc_0_f_res_25742;\n                private_mem_29569[i_29571] = part_res_25779;\n            } else {\n                private_mem_29569[i_29571] = (int64_t) 0;\n            }\n        }\n    }\n    // Transpose scan inputs\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29572 = 0; i_29572 < (int64_t) 9; i_29572++) {\n            int64_t sharedIdx_29573 = sext_i32_i64(local_tid_29551) + i_29572 *\n                    segscan_group_sizze_27658;\n            \n            ((__local int64_t *) local_mem_29559)[sharedIdx_29573] =\n                private_mem_29569[i_29572];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_29574 = 0; i_29574 < 9; i_29574++) {\n            int32_t sharedIdx_29575 = local_tid_29551 * 9 + i_29574;\n            \n            private_mem_29569[sext_i32_i64(i_29574)] = ((__local\n                                                         int64_t *) local_mem_29559)[sext_i32_i64(sharedIdx_29575)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Per thread scan\n    {\n        for (int64_t i_29576 = 0; i_29576 < (int64_t) 8; i_29576++) {\n            int64_t x_25721;\n            int64_t y_25722;\n            \n            x_25721 = private_mem_29569[i_29576];\n            y_25722 = private_mem_29569[i_29576 + (int64_t) 1];\n            \n            int64_t zz_25723;\n            \n            zz_25723 = x_25721 + y_25722;\n            private_mem_29569[i_29576 + (int64_t) 1] = zz_25723;\n        }\n    }\n    // Publish results in shared memory\n    {\n        ((__local int64_t *) local_mem_29559)[squot64(byte_offsets_29555,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_29551)] =\n            private_mem_29569[(int64_t) 8];\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64",
            "_t acc_29580;\n    \n    // Scan results (with warp scan)\n    {\n        int64_t x_29577;\n        int64_t y_29578;\n        int64_t x_29581;\n        int64_t y_29582;\n        bool ltid_in_bounds_29584;\n        \n        ltid_in_bounds_29584 = slt64(sext_i32_i64(local_tid_29551),\n                                     segscan_group_sizze_27658);\n        \n        int32_t skip_threads_29585;\n        \n        // read input for in-block scan\n        {\n            if (ltid_in_bounds_29584) {\n                y_29578 = ((volatile __local\n                            int64_t *) local_mem_29559)[squot64(byte_offsets_29555,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_29551)];\n                if ((local_tid_29551 - squot32(local_tid_29551, 32) * 32) ==\n                    0) {\n                    x_29577 = y_29578;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_29585 = 1;\n            while (slt32(skip_threads_29585, 32)) {\n                if (sle32(skip_threads_29585, local_tid_29551 -\n                          squot32(local_tid_29551, 32) * 32) &&\n                    ltid_in_bounds_29584) {\n                    // read operands\n                    {\n                        x_29577 = ((volatile __local\n                                    int64_t *) local_mem_29559)[squot64(byte_offsets_29555,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_29551) -\n                                                                 sext_i32_i64(skip_threads_29585))];\n                    }\n                    // perform operation\n                    {\n                        int64_t zz_29579 = x_29577 + y_29578;\n                        \n                        x_29577 = zz_29579;\n       ",
            "             }\n                }\n                if (sle32(wave_sizze_29553, skip_threads_29585)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_29585, local_tid_29551 -\n                          squot32(local_tid_29551, 32) * 32) &&\n                    ltid_in_bounds_29584) {\n                    // write result\n                    {\n                        ((volatile __local\n                          int64_t *) local_mem_29559)[squot64(byte_offsets_29555,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_29551)] =\n                            x_29577;\n                        y_29578 = x_29577;\n                    }\n                }\n                if (sle32(wave_sizze_29553, skip_threads_29585)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_29585 *= 2;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // last thread of block 'i' writes its result to offset 'i'\n        {\n            if ((local_tid_29551 - squot32(local_tid_29551, 32) * 32) == 31 &&\n                ltid_in_bounds_29584) {\n                ((volatile __local\n                  int64_t *) local_mem_29559)[squot64(byte_offsets_29555,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_29551,\n                                                                   32))] =\n                    x_29577;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n        {\n            int32_t skip_threads_29586;\n            \n            // read input for in-block scan\n            {\n                if (squot32(local_tid_29551, 32) == 0 && ltid_in_bounds_29584) {\n                    y_29582 = ((volati",
            "le __local\n                                int64_t *) local_mem_29559)[squot64(byte_offsets_29555,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_29551)];\n                    if ((local_tid_29551 - squot32(local_tid_29551, 32) * 32) ==\n                        0) {\n                        x_29581 = y_29582;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_29586 = 1;\n                while (slt32(skip_threads_29586, 32)) {\n                    if (sle32(skip_threads_29586, local_tid_29551 -\n                              squot32(local_tid_29551, 32) * 32) &&\n                        (squot32(local_tid_29551, 32) == 0 &&\n                         ltid_in_bounds_29584)) {\n                        // read operands\n                        {\n                            x_29581 = ((volatile __local\n                                        int64_t *) local_mem_29559)[squot64(byte_offsets_29555,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_29551) -\n                                                                     sext_i32_i64(skip_threads_29586))];\n                        }\n                        // perform operation\n                        {\n                            int64_t zz_29583 = x_29581 + y_29582;\n                            \n                            x_29581 = zz_29583;\n                        }\n                    }\n                    if (sle32(wave_sizze_29553, skip_threads_29586)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_29586, local_tid_29551 -\n                              squot32(local_tid_29551, 32) * 32) &&\n             ",
            "           (squot32(local_tid_29551, 32) == 0 &&\n                         ltid_in_bounds_29584)) {\n                        // write result\n                        {\n                            ((volatile __local\n                              int64_t *) local_mem_29559)[squot64(byte_offsets_29555,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_29551)] =\n                                x_29581;\n                            y_29582 = x_29581;\n                        }\n                    }\n                    if (sle32(wave_sizze_29553, skip_threads_29586)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_29586 *= 2;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // carry-in for every block except the first\n        {\n            if (!(squot32(local_tid_29551, 32) == 0 || !ltid_in_bounds_29584)) {\n                // read operands\n                {\n                    y_29578 = x_29577;\n                    x_29577 = ((__local\n                                int64_t *) local_mem_29559)[squot64(byte_offsets_29555,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_29551,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                }\n                // perform operation\n                {\n                    int64_t zz_29579 = x_29577 + y_29578;\n                    \n                    x_29577 = zz_29579;\n                }\n                // write final result\n                {\n                    ((__local\n                      int64_t *) local_mem_29559)[squot64(byte_offsets_29555,\n                                       ",
            "                   (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_29551)] =\n                        x_29577;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // restore correct values for first block\n        {\n            if (squot32(local_tid_29551, 32) == 0) {\n                ((__local\n                  int64_t *) local_mem_29559)[squot64(byte_offsets_29555,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_29551)] =\n                    y_29578;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_tid_29551 == 0) {\n            acc_29580 = ((__local\n                          int64_t *) local_mem_29559)[squot64(byte_offsets_29555,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_27658 -\n                                                       (int64_t) 1)];\n        } else {\n            acc_29580 = ((__local\n                          int64_t *) local_mem_29559)[squot64(byte_offsets_29555,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_29551) -\n                                                       (int64_t) 1)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t prefix_29587;\n    \n    prefix_29587 = (int64_t) 0;\n    // Perform lookback\n    {\n        if (dynamic_id_29567 == (int64_t) 0 && local_tid_29551 == 0) {\n            ((volatile __global\n              int64_t *) incprefixes_mem_29548)[dynamic_id_29567] = acc_29580;\n            mem_fence_global();\n            ((volatile __global\n              int8_t *) status_flags_mem_29544)[dynamic_id_29567] = (int8_t) 2;\n            acc_29580 = (int64_t) 0;\n        }\n      ",
            "  if (!(dynamic_id_29567 == (int64_t) 0) && slt32(local_tid_29551,\n                                                        wave_sizze_29553)) {\n            if (local_tid_29551 == 0) {\n                ((volatile __global\n                  int64_t *) aggregates_mem_29546)[dynamic_id_29567] =\n                    acc_29580;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_29544)[dynamic_id_29567] =\n                    (int8_t) 1;\n                ((__local int8_t *) local_mem_29559)[(int64_t) 0] = ((__global\n                                                                      int8_t *) status_flags_mem_29544)[dynamic_id_29567 -\n                                                                                                        (int64_t) 1];\n            }\n            mem_fence_local();\n            \n            int8_t status_29588;\n            \n            status_29588 = ((__local int8_t *) local_mem_29559)[(int64_t) 0];\n            if (status_29588 == (int8_t) 2) {\n                if (local_tid_29551 == 0) {\n                    prefix_29587 = ((volatile __global\n                                     int64_t *) incprefixes_mem_29548)[dynamic_id_29567 -\n                                                                       (int64_t) 1];\n                }\n            } else {\n                int32_t readOffset_29589 = dynamic_id_29567 -\n                        sext_i32_i64(wave_sizze_29553);\n                \n                while (slt32(wave_sizze_29553 * -1, readOffset_29589)) {\n                    int32_t read_i_29590 = readOffset_29589 + local_tid_29551;\n                    int64_t aggr_29591 = (int64_t) 0;\n                    int8_t flag_29592 = (int8_t) 0;\n                    int8_t used_29593 = (int8_t) 0;\n                    \n                    if (sle32(0, read_i_29590)) {\n                        flag_29592 = ((volatile __global\n                                       int8_t *) status_flags_mem_29",
            "544)[sext_i32_i64(read_i_29590)];\n                        if (flag_29592 == (int8_t) 2) {\n                            aggr_29591 = ((volatile __global\n                                           int64_t *) incprefixes_mem_29548)[sext_i32_i64(read_i_29590)];\n                        } else {\n                            if (flag_29592 == (int8_t) 1) {\n                                aggr_29591 = ((volatile __global\n                                               int64_t *) aggregates_mem_29546)[sext_i32_i64(read_i_29590)];\n                                used_29593 = (int8_t) 1;\n                            }\n                        }\n                    }\n                    ((__local\n                      int64_t *) local_mem_29559)[squot64(warp_byte_offset_29557,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_29551)] =\n                        aggr_29591;\n                    \n                    int8_t tmp_29594;\n                    \n                    tmp_29594 = flag_29592 | used_29593 << (int8_t) 2;\n                    ((__local\n                      int8_t *) local_mem_29559)[sext_i32_i64(local_tid_29551)] =\n                        tmp_29594;\n                    mem_fence_local();\n                    flag_29592 = ((volatile __local\n                                   int8_t *) local_mem_29559)[sext_i32_i64(wave_sizze_29553) -\n                                                              (int64_t) 1];\n                    if (local_tid_29551 == 0) {\n                        if (!(flag_29592 == (int8_t) 2)) {\n                            int64_t x_29595 = (int64_t) 0;\n                            int64_t y_29596;\n                            int8_t flag1_29598;\n                            \n                            flag1_29598 = (int8_t) 0;\n                            \n                            int8_t flag2_29599;\n                            int8_t used1_29600;\n          ",
            "                  \n                            used1_29600 = (int8_t) 0;\n                            \n                            int8_t used2_29601;\n                            \n                            for (int32_t i_29602 = 0; i_29602 <\n                                 wave_sizze_29553; i_29602++) {\n                                flag2_29599 = ((__local\n                                                int8_t *) local_mem_29559)[sext_i32_i64(i_29602)];\n                                used2_29601 = lshr8(flag2_29599, (int8_t) 2);\n                                flag2_29599 = flag2_29599 & (int8_t) 3;\n                                y_29596 = ((__local\n                                            int64_t *) local_mem_29559)[squot64(warp_byte_offset_29557,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_29602)];\n                                if (!(flag2_29599 == (int8_t) 1)) {\n                                    flag1_29598 = flag2_29599;\n                                    used1_29600 = used2_29601;\n                                    x_29595 = y_29596;\n                                } else {\n                                    used1_29600 += used2_29601;\n                                    \n                                    int64_t zz_29597;\n                                    \n                                    zz_29597 = x_29595 + y_29596;\n                                    x_29595 = zz_29597;\n                                }\n                            }\n                            flag_29592 = flag1_29598;\n                            used_29593 = used1_29600;\n                            aggr_29591 = x_29595;\n                        } else {\n                            aggr_29591 = ((__local\n                                           int64_t *) local_mem_29559)[squot64(warp_byte_offset_29557,\n                            ",
            "                                                   (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_29553) -\n                                                                        (int64_t) 1)];\n                        }\n                        if (flag_29592 == (int8_t) 2) {\n                            readOffset_29589 = wave_sizze_29553 * -1;\n                        } else {\n                            readOffset_29589 -= zext_i8_i32(used_29593);\n                        }\n                        ((__local int32_t *) local_mem_29559)[(int64_t) 0] =\n                            readOffset_29589;\n                        \n                        int64_t x_29603;\n                        \n                        x_29603 = aggr_29591;\n                        \n                        int64_t y_29604;\n                        \n                        y_29604 = prefix_29587;\n                        \n                        int64_t zz_29605;\n                        \n                        zz_29605 = x_29603 + y_29604;\n                        prefix_29587 = zz_29605;\n                    }\n                    mem_fence_local();\n                    readOffset_29589 = ((__local\n                                         int32_t *) local_mem_29559)[(int64_t) 0];\n                }\n            }\n            if (local_tid_29551 == 0) {\n                int64_t x_29606 = prefix_29587;\n                int64_t y_29607 = acc_29580;\n                int64_t zz_29608 = x_29606 + y_29607;\n                \n                ((volatile __global\n                  int64_t *) incprefixes_mem_29548)[dynamic_id_29567] =\n                    zz_29608;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_29544)[dynamic_id_29567] =\n                    (int8_t) 2;\n                ((__local\n                  int64_t *) local_mem_29559)[squot64(warp_byte_offset_29557,\n                 ",
            "                                     (int64_t) 8)] =\n                    prefix_29587;\n                acc_29580 = (int64_t) 0;\n            }\n        }\n        if (!(dynamic_id_29567 == (int64_t) 0)) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            prefix_29587 = ((__local\n                             int64_t *) local_mem_29559)[squot64(warp_byte_offset_29557,\n                                                                 (int64_t) 8)];\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    // Distribute results\n    {\n        int64_t x_29609;\n        int64_t y_29610;\n        int64_t x_29612;\n        \n        x_29612 = prefix_29587;\n        \n        int64_t y_29613;\n        \n        y_29613 = acc_29580;\n        \n        int64_t zz_29614;\n        \n        zz_29614 = x_29612 + y_29613;\n        x_29609 = zz_29614;\n        for (int64_t i_29615 = 0; i_29615 < (int64_t) 9; i_29615++) {\n            y_29610 = private_mem_29569[i_29615];\n            \n            int64_t zz_29611;\n            \n            zz_29611 = x_29609 + y_29610;\n            private_mem_29569[i_29615] = zz_29611;\n        }\n    }\n    // Transpose scan output\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29616 = 0; i_29616 < (int64_t) 9; i_29616++) {\n            int64_t sharedIdx_29617 = sext_i32_i64(local_tid_29551 * 9) +\n                    i_29616;\n            \n            ((__local int64_t *) local_mem_29559)[sharedIdx_29617] =\n                private_mem_29569[i_29616];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29618 = 0; i_29618 < (int64_t) 9; i_29618++) {\n            int32_t sharedIdx_29619 = local_tid_29551 +\n                    sext_i64_i32(segscan_group_sizze_27658 * i_29618);\n            \n            private_mem_29569[i_29618] = ((__local\n                                           int64_t *) local_mem_29559)[sext_i32_i64(sharedIdx_29619)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Write block scan results to glob",
            "al memory\n    {\n        for (int64_t i_29620 = 0; i_29620 < (int64_t) 9; i_29620++) {\n            int64_t gtid_27662 = blockOff_29568 + segscan_group_sizze_27658 *\n                    i_29620 + sext_i32_i64(local_tid_29551);\n            \n            if (slt64(gtid_27662, conc_tmp_25517)) {\n                ((__global int64_t *) mem_28425)[gtid_27662] =\n                    private_mem_29569[i_29620];\n            }\n        }\n    }\n    // If this is the last block, reset the dynamicId\n    {\n        if (dynamic_id_29567 == sdiv_up64(conc_tmp_25517,\n                                          segscan_group_sizze_27658 *\n                                          (int64_t) 9) - (int64_t) 1) {\n            ((__global\n              int32_t *) eWiseAddEntryziid_counter_mem_29542)[(int64_t) 0] = 0;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_27658\n}\n__kernel void eWiseAddMultEntryzisegmap_27833(__global int *global_failure,\n                                              int64_t conc_tmp_26655,\n                                              int64_t last_res_26749,\n                                              int64_t last_res_26750,\n                                              int64_t last_res_26751, __global\n                                              unsigned char *mem_param_28374,\n                                              __global\n                                              unsigned char *mem_param_28379,\n                                              __global unsigned char *mem_28386,\n                                              __global unsigned char *mem_28388,\n                                              __global unsigned char *mem_28390,\n                                              __global unsigned char *mem_28392,\n                                              __global unsigned char *mem_28394,\n                                              __global unsigned char *mem_28396,\n                                              __global unsig",
            "ned char *mem_28398)\n{\n    #define segmap_group_sizze_27836 (eWiseAddMultEntryzisegmap_group_sizze_27835)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29530;\n    int32_t local_tid_29531;\n    int64_t group_sizze_29534;\n    int32_t wave_sizze_29533;\n    int32_t group_tid_29532;\n    \n    global_tid_29530 = get_global_id(0);\n    local_tid_29531 = get_local_id(0);\n    group_sizze_29534 = get_local_size(0);\n    wave_sizze_29533 = LOCKSTEP_WIDTH;\n    group_tid_29532 = get_group_id(0);\n    \n    int32_t phys_tid_27833;\n    \n    phys_tid_27833 = global_tid_29530;\n    \n    int64_t write_i_27832;\n    \n    write_i_27832 = sext_i32_i64(group_tid_29532) * segmap_group_sizze_27836 +\n        sext_i32_i64(local_tid_29531);\n    if (slt64(write_i_27832, conc_tmp_26655)) {\n        int32_t x_26756 = ((__global int32_t *) mem_28394)[write_i_27832];\n        int64_t write_value_26761 = ((__global\n                                      int64_t *) mem_param_28374)[write_i_27832];\n        int64_t write_value_26762 = ((__global\n                                      int64_t *) mem_param_28379)[write_i_27832];\n        bool match_lit_26763 = 0 == x_26756;\n        int64_t defunc_1_f_res_26764;\n        \n        if (match_lit_26763) {\n            int64_t x_26757 = ((__global int64_t *) mem_28386)[write_i_27832];\n            int64_t case_res_26765 = sub64(x_26757, (int64_t) 1);\n            \n            defunc_1_f_res_26764 = case_res_26765;\n        } else {\n            int64_t x_26758 = ((__global int64_t *) mem_28388)[write_i_27832];\n            int64_t x_26759 = ((__global int64_t *) mem_28390)[write_i_27832];\n            int64_t x_26760 = ((__global int64_t *) mem_28392)[write_i_27832];\n            bool match_lit_26766 = 1 == x_26756;\n            int64_t x_26767;\n            \n            if (match_lit_26766) {\n                int64_t x_26768 = add64(last_res_26749, x_26758",
            ");\n                int64_t case_res_26769 = sub64(x_26768, (int64_t) 1);\n                \n                x_26767 = case_res_26769;\n            } else {\n                bool match_lit_26770 = 2 == x_26756;\n                int64_t x_26771;\n                \n                if (match_lit_26770) {\n                    int64_t x_26772 = add64(last_res_26749, last_res_26750);\n                    int64_t x_26773 = add64(x_26759, x_26772);\n                    int64_t case_res_26774 = sub64(x_26773, (int64_t) 1);\n                    \n                    x_26771 = case_res_26774;\n                } else {\n                    int64_t x_26775 = add64(last_res_26749, last_res_26750);\n                    int64_t x_26776 = add64(last_res_26751, x_26775);\n                    int64_t x_26777 = add64(x_26760, x_26776);\n                    int64_t defunc_1_f_res_res_26778 = sub64(x_26777,\n                                                             (int64_t) 1);\n                    \n                    x_26771 = defunc_1_f_res_res_26778;\n                }\n                x_26767 = x_26771;\n            }\n            defunc_1_f_res_26764 = x_26767;\n        }\n        if (sle64((int64_t) 0, defunc_1_f_res_26764) &&\n            slt64(defunc_1_f_res_26764, conc_tmp_26655)) {\n            ((__global int64_t *) mem_28396)[defunc_1_f_res_26764] =\n                write_value_26761;\n        }\n        if (sle64((int64_t) 0, defunc_1_f_res_26764) &&\n            slt64(defunc_1_f_res_26764, conc_tmp_26655)) {\n            ((__global int64_t *) mem_28398)[defunc_1_f_res_26764] =\n                write_value_26762;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_27836\n}\n__kernel void eWiseAddMultEntryzisegmap_27892(__global int *global_failure,\n                                              int failure_is_an_option, __global\n                                              int64_t *global_failure_args,\n                                              int64_t i_26613, int64_t i_26635,\n   ",
            "                                           int64_t j_m_i_26637,\n                                              int64_t conc_tmp_26655, __global\n                                              unsigned char *leftColumns_mem_28232,\n                                              __global\n                                              unsigned char *rightColumns_mem_28235,\n                                              __global\n                                              unsigned char *defunc_0_f_res_mem_28413,\n                                              __global unsigned char *mem_28416,\n                                              __global unsigned char *mem_28418,\n                                              __global unsigned char *mem_28420,\n                                              __global unsigned char *mem_28422)\n{\n    #define segmap_group_sizze_27917 (eWiseAddMultEntryzisegmap_group_sizze_27894)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29535;\n    int32_t local_tid_29536;\n    int64_t group_sizze_29539;\n    int32_t wave_sizze_29538;\n    int32_t group_tid_29537;\n    \n    global_tid_29535 = get_global_id(0);\n    local_tid_29536 = get_local_id(0);\n    group_sizze_29539 = get_local_size(0);\n    wave_sizze_29538 = LOCKSTEP_WIDTH;\n    group_tid_29537 = get_group_id(0);\n    \n    int32_t phys_tid_27892;\n    \n    phys_tid_27892 = global_tid_29535;\n    \n    int64_t gtid_27891;\n    \n    gtid_27891 = sext_i32_i64(group_tid_29537) * segmap_group_sizze_27917 +\n        sext_i32_i64(local_tid_29536);\n    if (slt64(gtid_27891, conc_tmp_26655)) {\n        int64_t x_27923 = ((__global\n                            int64_t *) defunc_0_f_res_mem_28413)[gtid_27891];\n        bool x_27924 = sle64((int64_t) 0, x_27923);\n        bool y_27925 = slt64(x_27923, conc_tmp_26655);\n        bool bounds_check_27926 = x_27924 && y_27925;\n        bool index_certs_2792",
            "7;\n        \n        if (!bounds_check_27926) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 28) == -1) {\n                    global_failure_args[0] = x_27923;\n                    global_failure_args[1] = conc_tmp_26655;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        bool index_concat_cmp_27928 = sle64(j_m_i_26637, x_27923);\n        int64_t index_concat_branch_27929;\n        \n        if (index_concat_cmp_27928) {\n            int64_t index_concat_i_27930 = sub64(x_27923, j_m_i_26637);\n            int64_t slice_27931 = i_26613 + index_concat_i_27930;\n            int64_t index_concat_27932 = ((__global\n                                           int64_t *) rightColumns_mem_28235)[slice_27931];\n            \n            index_concat_branch_27929 = index_concat_27932;\n        } else {\n            int64_t slice_27933 = i_26635 + x_27923;\n            int64_t index_concat_27934 = ((__global\n                                           int64_t *) leftColumns_mem_28232)[slice_27933];\n            \n            index_concat_branch_27929 = index_concat_27934;\n        }\n        \n        int64_t defunc_0_f_res_27935 = index_concat_branch_27929;\n        int64_t index_concat_branch_27936 =\n                btoi_bool_i64(index_concat_cmp_27928);\n        int64_t defunc_0_f_res_27937 = index_concat_branch_27936;\n        int64_t index_concat_branch_27938;\n        \n        if (index_concat_cmp_27928) {\n            int64_t index_concat_i_27939 = sub64(x_27923, j_m_i_26637);\n            \n            index_concat_branch_27938 = index_concat_i_27939;\n        } else {\n            index_concat_branch_27938 = x_27923;\n        }\n        \n        int64_t defunc_0_f_res_27940 = index_concat_branch_27938;\n        int64_t defunc_0_f_res_27941 = (int64_t) 0;\n        \n        ((__global int64_t *) mem_28416)[gtid_27891] = defunc_0_f_res_27935;\n        ((__global int64_t *) mem_28418)[gtid_27891] = defunc_0_f_res_2793",
            "7;\n        ((__global int64_t *) mem_28420)[gtid_27891] = defunc_0_f_res_27940;\n        ((__global int64_t *) mem_28422)[gtid_27891] = defunc_0_f_res_27941;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_27917\n}\n__kernel void eWiseAddMultEntryzisegmap_27951(__global int *global_failure,\n                                              int64_t conc_tmp_26655, __global\n                                              unsigned char *mem_28425, __global\n                                              unsigned char *mem_28427, __global\n                                              unsigned char *mem_28429, __global\n                                              unsigned char *mem_28431, __global\n                                              unsigned char *mem_28433, __global\n                                              unsigned char *mem_28435, __global\n                                              unsigned char *mem_28437, __global\n                                              unsigned char *mem_28439, __global\n                                              unsigned char *mem_28441, __global\n                                              unsigned char *mem_28443)\n{\n    #define segmap_group_sizze_27954 (eWiseAddMultEntryzisegmap_group_sizze_27953)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29621;\n    int32_t local_tid_29622;\n    int64_t group_sizze_29625;\n    int32_t wave_sizze_29624;\n    int32_t group_tid_29623;\n    \n    global_tid_29621 = get_global_id(0);\n    local_tid_29622 = get_local_id(0);\n    group_sizze_29625 = get_local_size(0);\n    wave_sizze_29624 = LOCKSTEP_WIDTH;\n    group_tid_29623 = get_group_id(0);\n    \n    int32_t phys_tid_27951;\n    \n    phys_tid_27951 = global_tid_29621;\n    \n    int64_t write_i_27950;\n    \n    write_i_27950 = sext_i32_i64(group_tid_29623) * segmap_group_sizze_27954 +\n        sext_i32_i64(local_tid_",
            "29622);\n    if (slt64(write_i_27950, conc_tmp_26655)) {\n        int64_t c_26934 = ((__global int64_t *) mem_28427)[write_i_27950];\n        int64_t offset_26935 = ((__global int64_t *) mem_28425)[write_i_27950];\n        int64_t v_26936 = ((__global int64_t *) mem_28429)[write_i_27950];\n        int64_t v_26937 = ((__global int64_t *) mem_28431)[write_i_27950];\n        int64_t v_26938 = ((__global int64_t *) mem_28433)[write_i_27950];\n        int64_t v_26939 = ((__global int64_t *) mem_28435)[write_i_27950];\n        bool is_this_one_26940 = c_26934 == (int64_t) 0;\n        int64_t this_offset_26941 = (int64_t) -1 + offset_26935;\n        int64_t total_res_26942;\n        \n        if (is_this_one_26940) {\n            total_res_26942 = this_offset_26941;\n        } else {\n            total_res_26942 = (int64_t) -1;\n        }\n        if (sle64((int64_t) 0, total_res_26942) && slt64(total_res_26942,\n                                                         conc_tmp_26655)) {\n            ((__global int64_t *) mem_28437)[total_res_26942] = v_26936;\n        }\n        if (sle64((int64_t) 0, total_res_26942) && slt64(total_res_26942,\n                                                         conc_tmp_26655)) {\n            ((__global int64_t *) mem_28439)[total_res_26942] = v_26937;\n        }\n        if (sle64((int64_t) 0, total_res_26942) && slt64(total_res_26942,\n                                                         conc_tmp_26655)) {\n            ((__global int64_t *) mem_28441)[total_res_26942] = v_26938;\n        }\n        if (sle64((int64_t) 0, total_res_26942) && slt64(total_res_26942,\n                                                         conc_tmp_26655)) {\n            ((__global int64_t *) mem_28443)[total_res_26942] = v_26939;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_27954\n}\n__kernel void eWiseAddMultEntryzisegmap_27957(__global int *global_failure,\n                                              int failure_is_an_option, __global\n           ",
            "                                   int64_t *global_failure_args,\n                                              int64_t n_26407, int64_t k_26409,\n                                              int64_t eWiseAddOffsets_res_26600,\n                                              int64_t i_26613, int64_t i_26635,\n                                              int64_t sizze_26656,\n                                              int64_t y_26963,\n                                              int64_t indxs_26964,\n                                              int64_t unionArrays_res_ixfn_28460,\n                                              __global\n                                              unsigned char *leftValues_mem_28231,\n                                              __global\n                                              unsigned char *rightValues_mem_28234,\n                                              __global unsigned char *mem_28339,\n                                              __global unsigned char *mem_28341,\n                                              __global\n                                              unsigned char *unionArrays_res_mem_28461,\n                                              __global\n                                              unsigned char *unionArrays_res_mem_28464,\n                                              __global\n                                              unsigned char *unionArrays_res_mem_28467,\n                                              __global\n                                              unsigned char *unionArrays_res_mem_28470)\n{\n    #define segmap_group_sizze_27960 (eWiseAddMultEntryzisegmap_group_sizze_27959)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29626;\n    int32_t local_tid_29627;\n    int64_t group_sizze_29630;\n    int32_t wave_sizze_29629;\n    int32_t group_tid_29628;\n    \n    global_tid",
            "_29626 = get_global_id(0);\n    local_tid_29627 = get_local_id(0);\n    group_sizze_29630 = get_local_size(0);\n    wave_sizze_29629 = LOCKSTEP_WIDTH;\n    group_tid_29628 = get_group_id(0);\n    \n    int32_t phys_tid_27957;\n    \n    phys_tid_27957 = global_tid_29626;\n    \n    int64_t write_i_27956;\n    \n    write_i_27956 = sext_i32_i64(group_tid_29628) * segmap_group_sizze_27960 +\n        sext_i32_i64(local_tid_29627);\n    if (slt64(write_i_27956, indxs_26964)) {\n        int64_t index_primexp_28112 = add64(y_26963, write_i_27956);\n        int64_t write_value_26977 = ((__global\n                                      int64_t *) unionArrays_res_mem_28461)[unionArrays_res_ixfn_28460 +\n                                                                            write_i_27956];\n        bool y_26981 = slt64(write_i_27956, sizze_26656);\n        bool index_certs_26983;\n        \n        if (!y_26981) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 33) == -1) {\n                    global_failure_args[0] = write_i_27956;\n                    global_failure_args[1] = sizze_26656;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        int64_t x_26984 = ((__global\n                            int64_t *) unionArrays_res_mem_28464)[write_i_27956];\n        bool cond_26985 = x_26984 == (int64_t) 2;\n        double defunc_0_f_res_26986;\n        \n        if (cond_26985) {\n            int64_t y_26987 = ((__global\n                                int64_t *) unionArrays_res_mem_28470)[write_i_27956];\n            int64_t i_26988 = add64(i_26613, y_26987);\n            bool x_26989 = sle64((int64_t) 0, i_26988);\n            bool y_26990 = slt64(i_26988, k_26409);\n            bool bounds_check_26991 = x_26989 && y_26990;\n            bool index_certs_26992;\n            \n            if (!bounds_check_26991) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 34) ==\n                    ",
            "    -1) {\n                        global_failure_args[0] = i_26988;\n                        global_failure_args[1] = k_26409;\n                        ;\n                    }\n                    return;\n                }\n            }\n            \n            double defunc_1_add_arg_26993 = ((__global\n                                              double *) rightValues_mem_28234)[i_26988];\n            int64_t y_26994 = ((__global\n                                int64_t *) unionArrays_res_mem_28467)[write_i_27956];\n            int64_t i_26995 = add64(i_26635, y_26994);\n            bool x_26996 = sle64((int64_t) 0, i_26995);\n            bool y_26997 = slt64(i_26995, n_26407);\n            bool bounds_check_26998 = x_26996 && y_26997;\n            bool index_certs_26999;\n            \n            if (!bounds_check_26998) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 35) ==\n                        -1) {\n                        global_failure_args[0] = i_26995;\n                        global_failure_args[1] = n_26407;\n                        ;\n                    }\n                    return;\n                }\n            }\n            \n            double defunc_0_add_arg_27000 = ((__global\n                                              double *) leftValues_mem_28231)[i_26995];\n            double defunc_1_add_res_27001 = defunc_1_add_arg_26993 +\n                   defunc_0_add_arg_27000;\n            \n            defunc_0_f_res_26986 = defunc_1_add_res_27001;\n        } else {\n            bool cond_27002 = x_26984 == (int64_t) 0;\n            double defunc_0_f_res_f_res_27003;\n            \n            if (cond_27002) {\n                int64_t y_27004 = ((__global\n                                    int64_t *) unionArrays_res_mem_28467)[write_i_27956];\n                int64_t i_27005 = add64(i_26635, y_27004);\n                bool x_27006 = sle64((int64_t) 0, i_27005);\n                bool y_27007 = slt64(i_27005, n_26407);\n             ",
            "   bool bounds_check_27008 = x_27006 && y_27007;\n                bool index_certs_27009;\n                \n                if (!bounds_check_27008) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 36) ==\n                            -1) {\n                            global_failure_args[0] = i_27005;\n                            global_failure_args[1] = n_26407;\n                            ;\n                        }\n                        return;\n                    }\n                }\n                \n                double defunc_0_f_res_f_res_t_res_27010 = ((__global\n                                                            double *) leftValues_mem_28231)[i_27005];\n                \n                defunc_0_f_res_f_res_27003 = defunc_0_f_res_f_res_t_res_27010;\n            } else {\n                int64_t y_27011 = ((__global\n                                    int64_t *) unionArrays_res_mem_28467)[write_i_27956];\n                int64_t i_27012 = add64(i_26613, y_27011);\n                bool x_27013 = sle64((int64_t) 0, i_27012);\n                bool y_27014 = slt64(i_27012, k_26409);\n                bool bounds_check_27015 = x_27013 && y_27014;\n                bool index_certs_27016;\n                \n                if (!bounds_check_27015) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 37) ==\n                            -1) {\n                            global_failure_args[0] = i_27012;\n                            global_failure_args[1] = k_26409;\n                            ;\n                        }\n                        return;\n                    }\n                }\n                \n                double defunc_0_f_res_f_res_f_res_27017 = ((__global\n                                                            double *) rightValues_mem_28234)[i_27012];\n                \n                defunc_0_f_res_f_res_27003 = defunc_0_f_res_f_res_f_res_27017;\n           ",
            " }\n            defunc_0_f_res_26986 = defunc_0_f_res_f_res_27003;\n        }\n        if (sle64((int64_t) 0, index_primexp_28112) &&\n            slt64(index_primexp_28112, eWiseAddOffsets_res_26600)) {\n            ((__global double *) mem_28339)[index_primexp_28112] =\n                defunc_0_f_res_26986;\n        }\n        if (sle64((int64_t) 0, index_primexp_28112) &&\n            slt64(index_primexp_28112, eWiseAddOffsets_res_26600)) {\n            ((__global int64_t *) mem_28341)[index_primexp_28112] =\n                write_value_26977;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_27960\n}\n__kernel void eWiseAddMultEntryzisegmap_27979(__global int *global_failure,\n                                              int64_t conc_tmp_27249,\n                                              int64_t last_res_27340,\n                                              int64_t last_res_27341,\n                                              int64_t last_res_27342, __global\n                                              unsigned char *mem_param_28611,\n                                              __global\n                                              unsigned char *mem_param_28616,\n                                              __global unsigned char *mem_28623,\n                                              __global unsigned char *mem_28625,\n                                              __global unsigned char *mem_28627,\n                                              __global unsigned char *mem_28629,\n                                              __global unsigned char *mem_28631,\n                                              __global unsigned char *mem_28633,\n                                              __global unsigned char *mem_28635)\n{\n    #define segmap_group_sizze_27982 (eWiseAddMultEntryzisegmap_group_sizze_27981)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n  ",
            "  \n    int32_t global_tid_30000;\n    int32_t local_tid_30001;\n    int64_t group_sizze_30004;\n    int32_t wave_sizze_30003;\n    int32_t group_tid_30002;\n    \n    global_tid_30000 = get_global_id(0);\n    local_tid_30001 = get_local_id(0);\n    group_sizze_30004 = get_local_size(0);\n    wave_sizze_30003 = LOCKSTEP_WIDTH;\n    group_tid_30002 = get_group_id(0);\n    \n    int32_t phys_tid_27979;\n    \n    phys_tid_27979 = global_tid_30000;\n    \n    int64_t write_i_27978;\n    \n    write_i_27978 = sext_i32_i64(group_tid_30002) * segmap_group_sizze_27982 +\n        sext_i32_i64(local_tid_30001);\n    if (slt64(write_i_27978, conc_tmp_27249)) {\n        int32_t x_27347 = ((__global int32_t *) mem_28631)[write_i_27978];\n        int64_t write_value_27352 = ((__global\n                                      int64_t *) mem_param_28611)[write_i_27978];\n        int64_t write_value_27353 = ((__global\n                                      int64_t *) mem_param_28616)[write_i_27978];\n        bool match_lit_27354 = 0 == x_27347;\n        int64_t defunc_1_f_res_27355;\n        \n        if (match_lit_27354) {\n            int64_t x_27348 = ((__global int64_t *) mem_28623)[write_i_27978];\n            int64_t case_res_27356 = sub64(x_27348, (int64_t) 1);\n            \n            defunc_1_f_res_27355 = case_res_27356;\n        } else {\n            int64_t x_27349 = ((__global int64_t *) mem_28625)[write_i_27978];\n            int64_t x_27350 = ((__global int64_t *) mem_28627)[write_i_27978];\n            int64_t x_27351 = ((__global int64_t *) mem_28629)[write_i_27978];\n            bool match_lit_27357 = 1 == x_27347;\n            int64_t x_27358;\n            \n            if (match_lit_27357) {\n                int64_t x_27359 = add64(last_res_27340, x_27349);\n                int64_t case_res_27360 = sub64(x_27359, (int64_t) 1);\n                \n                x_27358 = case_res_27360;\n            } else {\n                bool match_lit_27361 = 2 == x_27347;\n                int64_t x_27362;\n               ",
            " \n                if (match_lit_27361) {\n                    int64_t x_27363 = add64(last_res_27340, last_res_27341);\n                    int64_t x_27364 = add64(x_27350, x_27363);\n                    int64_t case_res_27365 = sub64(x_27364, (int64_t) 1);\n                    \n                    x_27362 = case_res_27365;\n                } else {\n                    int64_t x_27366 = add64(last_res_27340, last_res_27341);\n                    int64_t x_27367 = add64(last_res_27342, x_27366);\n                    int64_t x_27368 = add64(x_27351, x_27367);\n                    int64_t defunc_1_f_res_res_27369 = sub64(x_27368,\n                                                             (int64_t) 1);\n                    \n                    x_27362 = defunc_1_f_res_res_27369;\n                }\n                x_27358 = x_27362;\n            }\n            defunc_1_f_res_27355 = x_27358;\n        }\n        if (sle64((int64_t) 0, defunc_1_f_res_27355) &&\n            slt64(defunc_1_f_res_27355, conc_tmp_27249)) {\n            ((__global int64_t *) mem_28633)[defunc_1_f_res_27355] =\n                write_value_27352;\n        }\n        if (sle64((int64_t) 0, defunc_1_f_res_27355) &&\n            slt64(defunc_1_f_res_27355, conc_tmp_27249)) {\n            ((__global int64_t *) mem_28635)[defunc_1_f_res_27355] =\n                write_value_27353;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_27982\n}\n__kernel void eWiseAddMultEntryzisegmap_28035(__global int *global_failure,\n                                              int failure_is_an_option, __global\n                                              int64_t *global_failure_args,\n                                              int64_t i_27210, int64_t i_27232,\n                                              int64_t j_m_i_27234,\n                                              int64_t conc_tmp_27249, __global\n                                              unsigned char *rightColumns_mem_28235,\n                          ",
            "                    __global unsigned char *mem_28341,\n                                              __global\n                                              unsigned char *defunc_0_f_res_mem_28650,\n                                              __global unsigned char *mem_28653,\n                                              __global unsigned char *mem_28655,\n                                              __global unsigned char *mem_28657)\n{\n    #define segmap_group_sizze_28059 (eWiseAddMultEntryzisegmap_group_sizze_28037)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_30005;\n    int32_t local_tid_30006;\n    int64_t group_sizze_30009;\n    int32_t wave_sizze_30008;\n    int32_t group_tid_30007;\n    \n    global_tid_30005 = get_global_id(0);\n    local_tid_30006 = get_local_id(0);\n    group_sizze_30009 = get_local_size(0);\n    wave_sizze_30008 = LOCKSTEP_WIDTH;\n    group_tid_30007 = get_group_id(0);\n    \n    int32_t phys_tid_28035;\n    \n    phys_tid_28035 = global_tid_30005;\n    \n    int64_t gtid_28034;\n    \n    gtid_28034 = sext_i32_i64(group_tid_30007) * segmap_group_sizze_28059 +\n        sext_i32_i64(local_tid_30006);\n    if (slt64(gtid_28034, conc_tmp_27249)) {\n        int64_t x_28064 = ((__global\n                            int64_t *) defunc_0_f_res_mem_28650)[gtid_28034];\n        bool x_28065 = sle64((int64_t) 0, x_28064);\n        bool y_28066 = slt64(x_28064, conc_tmp_27249);\n        bool bounds_check_28067 = x_28065 && y_28066;\n        bool index_certs_28068;\n        \n        if (!bounds_check_28067) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 47) == -1) {\n                    global_failure_args[0] = x_28064;\n                    global_failure_args[1] = conc_tmp_27249;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        bool index_concat_cmp_28069 = sle",
            "64(j_m_i_27234, x_28064);\n        int64_t index_concat_branch_28070;\n        \n        if (index_concat_cmp_28069) {\n            int64_t index_concat_i_28071 = sub64(x_28064, j_m_i_27234);\n            int64_t slice_28072 = i_27210 + index_concat_i_28071;\n            int64_t index_concat_28073 = ((__global\n                                           int64_t *) rightColumns_mem_28235)[slice_28072];\n            \n            index_concat_branch_28070 = index_concat_28073;\n        } else {\n            int64_t slice_28074 = i_27232 + x_28064;\n            int64_t index_concat_28075 = ((__global\n                                           int64_t *) mem_28341)[slice_28074];\n            \n            index_concat_branch_28070 = index_concat_28075;\n        }\n        \n        int64_t defunc_0_f_res_28076 = index_concat_branch_28070;\n        int64_t index_concat_branch_28077 =\n                btoi_bool_i64(index_concat_cmp_28069);\n        int64_t defunc_0_f_res_28078 = index_concat_branch_28077;\n        int64_t index_concat_branch_28079;\n        \n        if (index_concat_cmp_28069) {\n            int64_t index_concat_i_28080 = sub64(x_28064, j_m_i_27234);\n            \n            index_concat_branch_28079 = index_concat_i_28080;\n        } else {\n            index_concat_branch_28079 = x_28064;\n        }\n        \n        int64_t defunc_0_f_res_28081 = index_concat_branch_28079;\n        \n        ((__global int64_t *) mem_28653)[gtid_28034] = defunc_0_f_res_28076;\n        ((__global int64_t *) mem_28655)[gtid_28034] = defunc_0_f_res_28078;\n        ((__global int64_t *) mem_28657)[gtid_28034] = defunc_0_f_res_28081;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_28059\n}\n__kernel void eWiseAddMultEntryzisegmap_28091(__global int *global_failure,\n                                              int64_t j_m_i_27250, __global\n                                              unsigned char *mem_28660, __global\n                                              unsigned char *mem_28662, ",
            "__global\n                                              unsigned char *mem_28664, __global\n                                              unsigned char *mem_28666, __global\n                                              unsigned char *mem_28668, __global\n                                              unsigned char *mem_28670, __global\n                                              unsigned char *mem_28672, __global\n                                              unsigned char *mem_28674)\n{\n    #define segmap_group_sizze_28094 (eWiseAddMultEntryzisegmap_group_sizze_28093)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_30091;\n    int32_t local_tid_30092;\n    int64_t group_sizze_30095;\n    int32_t wave_sizze_30094;\n    int32_t group_tid_30093;\n    \n    global_tid_30091 = get_global_id(0);\n    local_tid_30092 = get_local_id(0);\n    group_sizze_30095 = get_local_size(0);\n    wave_sizze_30094 = LOCKSTEP_WIDTH;\n    group_tid_30093 = get_group_id(0);\n    \n    int32_t phys_tid_28091;\n    \n    phys_tid_28091 = global_tid_30091;\n    \n    int64_t write_i_28090;\n    \n    write_i_28090 = sext_i32_i64(group_tid_30093) * segmap_group_sizze_28094 +\n        sext_i32_i64(local_tid_30092);\n    if (slt64(write_i_28090, j_m_i_27250)) {\n        int64_t c_27469 = ((__global int64_t *) mem_28662)[write_i_28090];\n        int64_t offset_27470 = ((__global int64_t *) mem_28660)[write_i_28090];\n        int64_t v_27471 = ((__global int64_t *) mem_28664)[write_i_28090];\n        int64_t v_27472 = ((__global int64_t *) mem_28666)[write_i_28090];\n        int64_t v_27473 = ((__global int64_t *) mem_28668)[write_i_28090];\n        bool is_this_one_27474 = c_27469 == (int64_t) 0;\n        int64_t this_offset_27475 = (int64_t) -1 + offset_27470;\n        int64_t total_res_27476;\n        \n        if (is_this_one_27474) {\n            total_res_27476 = this_offset_27475;\n        } else {\n   ",
            "         total_res_27476 = (int64_t) -1;\n        }\n        if (sle64((int64_t) 0, total_res_27476) && slt64(total_res_27476,\n                                                         j_m_i_27250)) {\n            ((__global int64_t *) mem_28670)[total_res_27476] = v_27471;\n        }\n        if (sle64((int64_t) 0, total_res_27476) && slt64(total_res_27476,\n                                                         j_m_i_27250)) {\n            ((__global int64_t *) mem_28672)[total_res_27476] = v_27472;\n        }\n        if (sle64((int64_t) 0, total_res_27476) && slt64(total_res_27476,\n                                                         j_m_i_27250)) {\n            ((__global int64_t *) mem_28674)[total_res_27476] = v_27473;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_28094\n}\n__kernel void eWiseAddMultEntryzisegmap_28097(__global int *global_failure,\n                                              int failure_is_an_option, __global\n                                              int64_t *global_failure_args,\n                                              int64_t k_26409,\n                                              int64_t eWiseAddOffsets_res_26600,\n                                              int64_t eWiseMultOffsets_res_27196,\n                                              int64_t i_27210, int64_t i_27232,\n                                              int64_t sizze_27251,\n                                              int64_t y_27494,\n                                              int64_t indxs_27495, __global\n                                              unsigned char *rightValues_mem_28234,\n                                              __global unsigned char *mem_28339,\n                                              __global unsigned char *mem_28584,\n                                              __global unsigned char *mem_28586,\n                                              __global\n                                              unsigned char ",
            "*intersectArrays_res_mem_28687,\n                                              __global\n                                              unsigned char *intersectArrays_res_mem_28690,\n                                              __global\n                                              unsigned char *intersectArrays_res_mem_28693)\n{\n    #define segmap_group_sizze_28100 (eWiseAddMultEntryzisegmap_group_sizze_28099)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_30096;\n    int32_t local_tid_30097;\n    int64_t group_sizze_30100;\n    int32_t wave_sizze_30099;\n    int32_t group_tid_30098;\n    \n    global_tid_30096 = get_global_id(0);\n    local_tid_30097 = get_local_id(0);\n    group_sizze_30100 = get_local_size(0);\n    wave_sizze_30099 = LOCKSTEP_WIDTH;\n    group_tid_30098 = get_group_id(0);\n    \n    int32_t phys_tid_28097;\n    \n    phys_tid_28097 = global_tid_30096;\n    \n    int64_t write_i_28096;\n    \n    write_i_28096 = sext_i32_i64(group_tid_30098) * segmap_group_sizze_28100 +\n        sext_i32_i64(local_tid_30097);\n    if (slt64(write_i_28096, indxs_27495)) {\n        int64_t index_primexp_28126 = add64(y_27494, write_i_28096);\n        int64_t write_value_27508 = ((__global\n                                      int64_t *) intersectArrays_res_mem_28687)[write_i_28096];\n        bool y_27512 = slt64(write_i_28096, sizze_27251);\n        bool index_certs_27514;\n        \n        if (!y_27512) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 49) == -1) {\n                    global_failure_args[0] = write_i_28096;\n                    global_failure_args[1] = sizze_27251;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        int64_t y_27515 = ((__global\n                            int64_t *) intersectArrays_res_mem_28693)[write_i_28096];\n        int64_t i_27516 = add64(i_27210,",
            " y_27515);\n        bool x_27517 = sle64((int64_t) 0, i_27516);\n        bool y_27518 = slt64(i_27516, k_26409);\n        bool bounds_check_27519 = x_27517 && y_27518;\n        bool index_certs_27520;\n        \n        if (!bounds_check_27519) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 50) == -1) {\n                    global_failure_args[0] = i_27516;\n                    global_failure_args[1] = k_26409;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        double defunc_1_mult_arg_27521 = ((__global\n                                           double *) rightValues_mem_28234)[i_27516];\n        int64_t y_27522 = ((__global\n                            int64_t *) intersectArrays_res_mem_28690)[write_i_28096];\n        int64_t i_27523 = add64(i_27232, y_27522);\n        bool x_27524 = sle64((int64_t) 0, i_27523);\n        bool y_27525 = slt64(i_27523, eWiseAddOffsets_res_26600);\n        bool bounds_check_27526 = x_27524 && y_27525;\n        bool index_certs_27527;\n        \n        if (!bounds_check_27526) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 51) == -1) {\n                    global_failure_args[0] = i_27523;\n                    global_failure_args[1] = eWiseAddOffsets_res_26600;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        double defunc_0_mult_arg_27528 = ((__global\n                                           double *) mem_28339)[i_27523];\n        double defunc_1_mult_res_27529 = defunc_1_mult_arg_27521 *\n               defunc_0_mult_arg_27528;\n        \n        if (sle64((int64_t) 0, index_primexp_28126) &&\n            slt64(index_primexp_28126, eWiseMultOffsets_res_27196)) {\n            ((__global double *) mem_28584)[index_primexp_28126] =\n                defunc_1_mult_res_27529;\n        }\n        if (sle64((int64_t) 0, index_primexp_28126) &&\n            slt64(index_primexp_28126, eWiseM",
            "ultOffsets_res_27196)) {\n            ((__global int64_t *) mem_28586)[index_primexp_28126] =\n                write_value_27508;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_28100\n}\n__kernel void eWiseAddMultEntryzisegred_nonseg_28981(__global\n                                                     int *global_failure,\n                                                     int failure_is_an_option,\n                                                     __global\n                                                     int64_t *global_failure_args,\n                                                     uint red_arr_mem_29145_backing_offset_0,\n                                                     uint red_arr_mem_29143_backing_offset_1,\n                                                     uint red_arr_mem_29141_backing_offset_2,\n                                                     uint sync_arr_mem_29139_backing_offset_3,\n                                                     int64_t m_26408,\n                                                     int64_t num_threads_29133,\n                                                     __global\n                                                     unsigned char *leftOffsets_mem_28233,\n                                                     __global\n                                                     unsigned char *rightOffsets_mem_28236,\n                                                     __global\n                                                     unsigned char *mem_29022,\n                                                     __global\n                                                     unsigned char *mem_29024,\n                                                     __global\n                                                     unsigned char *mem_29026,\n                                                     __global\n                                                     unsigned char *eWiseAddMultEntryzicounter_mem_29125,\n     ",
            "                                                __global\n                                                     unsigned char *group_res_arr_mem_29127,\n                                                     __global\n                                                     unsigned char *group_res_arr_mem_29129,\n                                                     __global\n                                                     unsigned char *group_res_arr_mem_29131)\n{\n    #define segred_num_groups_28973 (eWiseAddMultEntryzisegred_num_groups_28972)\n    #define segred_group_sizze_28975 (eWiseAddMultEntryzisegred_group_sizze_28974)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *red_arr_mem_29145_backing_3 =\n                  &shared_mem[red_arr_mem_29145_backing_offset_0];\n    volatile char *red_arr_mem_29143_backing_2 =\n                  &shared_mem[red_arr_mem_29143_backing_offset_1];\n    volatile char *red_arr_mem_29141_backing_1 =\n                  &shared_mem[red_arr_mem_29141_backing_offset_2];\n    volatile char *sync_arr_mem_29139_backing_0 =\n                  &shared_mem[sync_arr_mem_29139_backing_offset_3];\n    volatile __local bool local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = false;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t global_tid_29134;\n    int32_t local_tid_29135;\n    int64_t group_sizze_29138;\n    int32_t wave_sizze_29137;\n    int32_t group_tid_29136;\n    \n    global_tid_29134 = get_global_id(0);\n    local_tid_29135 = get_local_id(0);\n    group_sizze_29138 = get_local_size(0);\n    wave_sizze_29137 = LOCKSTEP_WIDTH;\n    group_tid_29136 = get_group_id(0);\n    \n    int32_t phys_tid_28981;\n    \n    phys_tid_28981 = global_tid_29134;\n    \n    __local char *sync_arr_mem_29139;\n    \n    sync_arr_mem_29139 = (__local char *) sync_arr_mem_29139_backing_0;\n    \n    __local ch",
            "ar *red_arr_mem_29141;\n    \n    red_arr_mem_29141 = (__local char *) red_arr_mem_29141_backing_1;\n    \n    __local char *red_arr_mem_29143;\n    \n    red_arr_mem_29143 = (__local char *) red_arr_mem_29143_backing_2;\n    \n    __local char *red_arr_mem_29145;\n    \n    red_arr_mem_29145 = (__local char *) red_arr_mem_29145_backing_3;\n    \n    int64_t dummy_28979;\n    \n    dummy_28979 = (int64_t) 0;\n    \n    int64_t gtid_28980;\n    \n    gtid_28980 = (int64_t) 0;\n    \n    int64_t x_acc_29147;\n    int64_t x_acc_29148;\n    int64_t x_acc_29149;\n    int64_t chunk_sizze_29150;\n    \n    chunk_sizze_29150 = smin64(sdiv_up64(m_26408,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_28975 *\n                                         segred_num_groups_28973))),\n                               sdiv_up64(m_26408 - sext_i32_i64(phys_tid_28981),\n                                         num_threads_29133));\n    \n    int64_t x_28982;\n    int64_t x_28983;\n    int64_t x_28984;\n    int64_t y_28985;\n    int64_t y_28986;\n    int64_t y_28987;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_29147 = (int64_t) 0;\n        x_acc_29148 = (int64_t) 0;\n        x_acc_29149 = (int64_t) 0;\n    }\n    for (int64_t i_29160 = 0; i_29160 < chunk_sizze_29150; i_29160++) {\n        gtid_28980 = sext_i32_i64(phys_tid_28981) + num_threads_29133 * i_29160;\n        // apply map function\n        {\n            int64_t x_28992 = ((__global\n                                int64_t *) leftOffsets_mem_28233)[gtid_28980];\n            int64_t x_28993 = ((__global\n                                int64_t *) rightOffsets_mem_28236)[gtid_28980];\n            bool cond_28994 = gtid_28980 == (int64_t) 0;\n            int64_t prevx2_28995;\n            \n            if (cond_28994) {\n                prevx2_28995 = gtid_28980;\n            } else {\n                int64_t prevx2_f_res_28996 = sub64(gtid_28980, (int64_t) 1);\n                \n                prevx2_28995 = prevx2_f_res_",
            "28996;\n            }\n            \n            int64_t prevy2_28997;\n            \n            if (cond_28994) {\n                prevy2_28997 = gtid_28980;\n            } else {\n                int64_t prevy2_f_res_28998 = sub64(gtid_28980, (int64_t) 1);\n                \n                prevy2_28997 = prevy2_f_res_28998;\n            }\n            \n            bool x_28999 = sle64((int64_t) 0, prevy2_28997);\n            bool y_29000 = slt64(prevy2_28997, m_26408);\n            bool bounds_check_29001 = x_28999 && y_29000;\n            bool index_certs_29002;\n            \n            if (!bounds_check_29001) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 19) ==\n                        -1) {\n                        global_failure_args[0] = prevy2_28997;\n                        global_failure_args[1] = m_26408;\n                        ;\n                    }\n                    local_failure = true;\n                    goto error_0;\n                }\n            }\n            \n            int64_t i_29003 = ((__global\n                                int64_t *) rightOffsets_mem_28236)[prevy2_28997];\n            int64_t j_m_i_29004 = sub64(x_28993, i_29003);\n            bool x_29005 = sle64((int64_t) 0, prevx2_28995);\n            bool y_29006 = slt64(prevx2_28995, m_26408);\n            bool bounds_check_29007 = x_29005 && y_29006;\n            bool index_certs_29008;\n            \n            if (!bounds_check_29007) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 20) ==\n                        -1) {\n                        global_failure_args[0] = prevx2_28995;\n                        global_failure_args[1] = m_26408;\n                        ;\n                    }\n                    local_failure = true;\n                    goto error_0;\n                }\n            }\n            \n            int64_t i_29009 = ((__global\n                                int64_t *) leftOffsets_mem_28233)[prevx2",
            "_28995];\n            int64_t j_m_i_29010 = sub64(x_28992, i_29009);\n            int64_t conc_tmp_29011 = j_m_i_29004 + j_m_i_29010;\n            int64_t bytes_29012 = (int64_t) 8 * conc_tmp_29011;\n            int64_t bytes_29013 = (int64_t) 4 * conc_tmp_29011;\n            int64_t double_buffer_sizze_29014 = (int64_t) 8 * conc_tmp_29011;\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_28982 = x_acc_29147;\n                x_28983 = x_acc_29148;\n                x_28984 = x_acc_29149;\n            }\n            // load new values\n            {\n                y_28985 = bytes_29012;\n                y_28986 = bytes_29013;\n                y_28987 = double_buffer_sizze_29014;\n            }\n            // apply reduction operator\n            {\n                int64_t zz_28988 = smax64(x_28982, y_28985);\n                int64_t zz_28989 = smax64(x_28983, y_28986);\n                int64_t zz_28990 = smax64(x_28984, y_28987);\n                \n                // store in accumulator\n                {\n                    x_acc_29147 = zz_28988;\n                    x_acc_29148 = zz_28989;\n                    x_acc_29149 = zz_28990;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_28982 = x_acc_29147;\n        x_28983 = x_acc_29148;\n        x_28984 = x_acc_29149;\n        ((__local int64_t *) red_arr_mem_29141)[sext_i32_i64(local_tid_29135)] =\n            x_28982;\n        ((__local int64_t *) red_arr_mem_29143)[sext_i32_i64(local_tid_29135)] =\n            x_28983;\n        ((__local int64_t *) red_arr_mem_29145)[sext_i32_i64(local_tid_29135)] =\n            x_28984;\n    }\n    \n  error_0:\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (local_failure)\n        return;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_29161;\n    int32_t skip_waves_29162;\n    \n    skip_waves_29162 = 1;\n    \n    int64_t x_29151;\n    int64_t x_29152;\n",
            "    int64_t x_29153;\n    int64_t y_29154;\n    int64_t y_29155;\n    int64_t y_29156;\n    \n    offset_29161 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_29135, sext_i64_i32(segred_group_sizze_28975))) {\n            x_29151 = ((__local\n                        int64_t *) red_arr_mem_29141)[sext_i32_i64(local_tid_29135 +\n                                                      offset_29161)];\n            x_29152 = ((__local\n                        int64_t *) red_arr_mem_29143)[sext_i32_i64(local_tid_29135 +\n                                                      offset_29161)];\n            x_29153 = ((__local\n                        int64_t *) red_arr_mem_29145)[sext_i32_i64(local_tid_29135 +\n                                                      offset_29161)];\n        }\n    }\n    offset_29161 = 1;\n    while (slt32(offset_29161, wave_sizze_29137)) {\n        if (slt32(local_tid_29135 + offset_29161,\n                  sext_i64_i32(segred_group_sizze_28975)) && ((local_tid_29135 -\n                                                               squot32(local_tid_29135,\n                                                                       wave_sizze_29137) *\n                                                               wave_sizze_29137) &\n                                                              (2 *\n                                                               offset_29161 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                y_29154 = ((volatile __local\n                            int64_t *) red_arr_mem_29141)[sext_i32_i64(local_tid_29135 +\n                                                          offset_29161)];\n                y_29155 = ((volatile __local\n                            int64_t *) red_arr_mem_29143)[sext_i32_i64(local_tid_29135 +\n                                                          offset_29161)];\n                y_29156",
            " = ((volatile __local\n                            int64_t *) red_arr_mem_29145)[sext_i32_i64(local_tid_29135 +\n                                                          offset_29161)];\n            }\n            // apply reduction operation\n            {\n                int64_t zz_29157 = smax64(x_29151, y_29154);\n                int64_t zz_29158 = smax64(x_29152, y_29155);\n                int64_t zz_29159 = smax64(x_29153, y_29156);\n                \n                x_29151 = zz_29157;\n                x_29152 = zz_29158;\n                x_29153 = zz_29159;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  int64_t *) red_arr_mem_29141)[sext_i32_i64(local_tid_29135)] =\n                    x_29151;\n                ((volatile __local\n                  int64_t *) red_arr_mem_29143)[sext_i32_i64(local_tid_29135)] =\n                    x_29152;\n                ((volatile __local\n                  int64_t *) red_arr_mem_29145)[sext_i32_i64(local_tid_29135)] =\n                    x_29153;\n            }\n        }\n        offset_29161 *= 2;\n    }\n    while (slt32(skip_waves_29162,\n                 squot32(sext_i64_i32(segred_group_sizze_28975) +\n                         wave_sizze_29137 - 1, wave_sizze_29137))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_29161 = skip_waves_29162 * wave_sizze_29137;\n        if (slt32(local_tid_29135 + offset_29161,\n                  sext_i64_i32(segred_group_sizze_28975)) && ((local_tid_29135 -\n                                                               squot32(local_tid_29135,\n                                                                       wave_sizze_29137) *\n                                                               wave_sizze_29137) ==\n                                                              0 &&\n                                                              (squot32(local_tid_29135,\n                                                            ",
            "           wave_sizze_29137) &\n                                                               (2 *\n                                                                skip_waves_29162 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                y_29154 = ((__local\n                            int64_t *) red_arr_mem_29141)[sext_i32_i64(local_tid_29135 +\n                                                          offset_29161)];\n                y_29155 = ((__local\n                            int64_t *) red_arr_mem_29143)[sext_i32_i64(local_tid_29135 +\n                                                          offset_29161)];\n                y_29156 = ((__local\n                            int64_t *) red_arr_mem_29145)[sext_i32_i64(local_tid_29135 +\n                                                          offset_29161)];\n            }\n            // apply reduction operation\n            {\n                int64_t zz_29157 = smax64(x_29151, y_29154);\n                int64_t zz_29158 = smax64(x_29152, y_29155);\n                int64_t zz_29159 = smax64(x_29153, y_29156);\n                \n                x_29151 = zz_29157;\n                x_29152 = zz_29158;\n                x_29153 = zz_29159;\n            }\n            // write result of operation\n            {\n                ((__local\n                  int64_t *) red_arr_mem_29141)[sext_i32_i64(local_tid_29135)] =\n                    x_29151;\n                ((__local\n                  int64_t *) red_arr_mem_29143)[sext_i32_i64(local_tid_29135)] =\n                    x_29152;\n                ((__local\n                  int64_t *) red_arr_mem_29145)[sext_i32_i64(local_tid_29135)] =\n                    x_29153;\n            }\n        }\n        skip_waves_29162 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_29135) == (int64_t) 0) {\n            x_acc_29147 = x_2",
            "9151;\n            x_acc_29148 = x_29152;\n            x_acc_29149 = x_29153;\n        }\n    }\n    \n    int32_t old_counter_29163;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_29135 == 0) {\n            ((__global\n              int64_t *) group_res_arr_mem_29127)[sext_i32_i64(group_tid_29136) *\n                                                  segred_group_sizze_28975] =\n                x_acc_29147;\n            ((__global\n              int64_t *) group_res_arr_mem_29129)[sext_i32_i64(group_tid_29136) *\n                                                  segred_group_sizze_28975] =\n                x_acc_29148;\n            ((__global\n              int64_t *) group_res_arr_mem_29131)[sext_i32_i64(group_tid_29136) *\n                                                  segred_group_sizze_28975] =\n                x_acc_29149;\n            mem_fence_global();\n            old_counter_29163 = atomic_add_i32_global(&((volatile __global\n                                                         int *) eWiseAddMultEntryzicounter_mem_29125)[(int64_t) 0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_29139)[(int64_t) 0] =\n                old_counter_29163 == segred_num_groups_28973 - (int64_t) 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_29164;\n    \n    is_last_group_29164 = ((__local bool *) sync_arr_mem_29139)[(int64_t) 0];\n    if (is_last_group_29164) {\n        if (local_tid_29135 == 0) {\n            old_counter_29163 = atomic_add_i32_global(&((volatile __global\n                                                         int *) eWiseAddMultEntryzicounter_mem_29125)[(int64_t) 0],\n                                                      (int) ((int64_t) 0 -\n                                                             segred_num_groups_28973));\n        }\n        // read in the per-group-results\n        {\n            int64_t rea",
            "d_per_thread_29165 = sdiv_up64(segred_num_groups_28973,\n                                                      segred_group_sizze_28975);\n            \n            x_28982 = (int64_t) 0;\n            x_28983 = (int64_t) 0;\n            x_28984 = (int64_t) 0;\n            for (int64_t i_29166 = 0; i_29166 < read_per_thread_29165;\n                 i_29166++) {\n                int64_t group_res_id_29167 = sext_i32_i64(local_tid_29135) *\n                        read_per_thread_29165 + i_29166;\n                int64_t index_of_group_res_29168 = group_res_id_29167;\n                \n                if (slt64(group_res_id_29167, segred_num_groups_28973)) {\n                    y_28985 = ((__global\n                                int64_t *) group_res_arr_mem_29127)[index_of_group_res_29168 *\n                                                                    segred_group_sizze_28975];\n                    y_28986 = ((__global\n                                int64_t *) group_res_arr_mem_29129)[index_of_group_res_29168 *\n                                                                    segred_group_sizze_28975];\n                    y_28987 = ((__global\n                                int64_t *) group_res_arr_mem_29131)[index_of_group_res_29168 *\n                                                                    segred_group_sizze_28975];\n                    \n                    int64_t zz_28988;\n                    \n                    zz_28988 = smax64(x_28982, y_28985);\n                    \n                    int64_t zz_28989 = smax64(x_28983, y_28986);\n                    int64_t zz_28990 = smax64(x_28984, y_28987);\n                    \n                    x_28982 = zz_28988;\n                    x_28983 = zz_28989;\n                    x_28984 = zz_28990;\n                }\n            }\n        }\n        ((__local int64_t *) red_arr_mem_29141)[sext_i32_i64(local_tid_29135)] =\n            x_28982;\n        ((__local int64_t *) red_arr_mem_29143)[sext_i32_i64(local_tid_29135)] =\n ",
            "           x_28983;\n        ((__local int64_t *) red_arr_mem_29145)[sext_i32_i64(local_tid_29135)] =\n            x_28984;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_29169;\n            int32_t skip_waves_29170;\n            \n            skip_waves_29170 = 1;\n            \n            int64_t x_29151;\n            int64_t x_29152;\n            int64_t x_29153;\n            int64_t y_29154;\n            int64_t y_29155;\n            int64_t y_29156;\n            \n            offset_29169 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_29135,\n                          sext_i64_i32(segred_group_sizze_28975))) {\n                    x_29151 = ((__local\n                                int64_t *) red_arr_mem_29141)[sext_i32_i64(local_tid_29135 +\n                                                              offset_29169)];\n                    x_29152 = ((__local\n                                int64_t *) red_arr_mem_29143)[sext_i32_i64(local_tid_29135 +\n                                                              offset_29169)];\n                    x_29153 = ((__local\n                                int64_t *) red_arr_mem_29145)[sext_i32_i64(local_tid_29135 +\n                                                              offset_29169)];\n                }\n            }\n            offset_29169 = 1;\n            while (slt32(offset_29169, wave_sizze_29137)) {\n                if (slt32(local_tid_29135 + offset_29169,\n                          sext_i64_i32(segred_group_sizze_28975)) &&\n                    ((local_tid_29135 - squot32(local_tid_29135,\n                                                wave_sizze_29137) *\n                      wave_sizze_29137) & (2 * offset_29169 - 1)) == 0) {\n                    // read array element\n                    {\n                        y_29154 = ((volatile __local\n                                    int64_t *) ",
            "red_arr_mem_29141)[sext_i32_i64(local_tid_29135 +\n                                                                  offset_29169)];\n                        y_29155 = ((volatile __local\n                                    int64_t *) red_arr_mem_29143)[sext_i32_i64(local_tid_29135 +\n                                                                  offset_29169)];\n                        y_29156 = ((volatile __local\n                                    int64_t *) red_arr_mem_29145)[sext_i32_i64(local_tid_29135 +\n                                                                  offset_29169)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t zz_29157 = smax64(x_29151, y_29154);\n                        int64_t zz_29158 = smax64(x_29152, y_29155);\n                        int64_t zz_29159 = smax64(x_29153, y_29156);\n                        \n                        x_29151 = zz_29157;\n                        x_29152 = zz_29158;\n                        x_29153 = zz_29159;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          int64_t *) red_arr_mem_29141)[sext_i32_i64(local_tid_29135)] =\n                            x_29151;\n                        ((volatile __local\n                          int64_t *) red_arr_mem_29143)[sext_i32_i64(local_tid_29135)] =\n                            x_29152;\n                        ((volatile __local\n                          int64_t *) red_arr_mem_29145)[sext_i32_i64(local_tid_29135)] =\n                            x_29153;\n                    }\n                }\n                offset_29169 *= 2;\n            }\n            while (slt32(skip_waves_29170,\n                         squot32(sext_i64_i32(segred_group_sizze_28975) +\n                                 wave_sizze_29137 - 1, wave_sizze_29137))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                of",
            "fset_29169 = skip_waves_29170 * wave_sizze_29137;\n                if (slt32(local_tid_29135 + offset_29169,\n                          sext_i64_i32(segred_group_sizze_28975)) &&\n                    ((local_tid_29135 - squot32(local_tid_29135,\n                                                wave_sizze_29137) *\n                      wave_sizze_29137) == 0 && (squot32(local_tid_29135,\n                                                         wave_sizze_29137) &\n                                                 (2 * skip_waves_29170 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        y_29154 = ((__local\n                                    int64_t *) red_arr_mem_29141)[sext_i32_i64(local_tid_29135 +\n                                                                  offset_29169)];\n                        y_29155 = ((__local\n                                    int64_t *) red_arr_mem_29143)[sext_i32_i64(local_tid_29135 +\n                                                                  offset_29169)];\n                        y_29156 = ((__local\n                                    int64_t *) red_arr_mem_29145)[sext_i32_i64(local_tid_29135 +\n                                                                  offset_29169)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t zz_29157 = smax64(x_29151, y_29154);\n                        int64_t zz_29158 = smax64(x_29152, y_29155);\n                        int64_t zz_29159 = smax64(x_29153, y_29156);\n                        \n                        x_29151 = zz_29157;\n                        x_29152 = zz_29158;\n                        x_29153 = zz_29159;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          int64_t *) red_arr_mem_29141)[sext_i32_i64(local_tid_29135)] =\n                          ",
            "  x_29151;\n                        ((__local\n                          int64_t *) red_arr_mem_29143)[sext_i32_i64(local_tid_29135)] =\n                            x_29152;\n                        ((__local\n                          int64_t *) red_arr_mem_29145)[sext_i32_i64(local_tid_29135)] =\n                            x_29153;\n                    }\n                }\n                skip_waves_29170 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_29135 == 0) {\n                    ((__global int64_t *) mem_29022)[(int64_t) 0] = x_29151;\n                    ((__global int64_t *) mem_29024)[(int64_t) 0] = x_29152;\n                    ((__global int64_t *) mem_29026)[(int64_t) 0] = x_29153;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_num_groups_28973\n    #undef segred_group_sizze_28975\n}\n__kernel void eWiseAddMultEntryzisegred_nonseg_29064(__global\n                                                     int *global_failure,\n                                                     int failure_is_an_option,\n                                                     __global\n                                                     int64_t *global_failure_args,\n                                                     uint red_arr_mem_29652_backing_offset_0,\n                                                     uint red_arr_mem_29650_backing_offset_1,\n                                                     uint red_arr_mem_29648_backing_offset_2,\n                                                     uint sync_arr_mem_29646_backing_offset_3,\n                                                     int64_t m_26408,\n                                                     int64_t num_threads_29640,\n                                                     __global\n                                                     unsigned char *rightOffsets_mem_28236,\n                                         ",
            "            __global\n                                                     unsigned char *mem_28337,\n                                                     __global\n                                                     unsigned char *mem_29105,\n                                                     __global\n                                                     unsigned char *mem_29107,\n                                                     __global\n                                                     unsigned char *mem_29109,\n                                                     __global\n                                                     unsigned char *eWiseAddMultEntryzicounter_mem_29632,\n                                                     __global\n                                                     unsigned char *group_res_arr_mem_29634,\n                                                     __global\n                                                     unsigned char *group_res_arr_mem_29636,\n                                                     __global\n                                                     unsigned char *group_res_arr_mem_29638)\n{\n    #define segred_num_groups_29056 (eWiseAddMultEntryzisegred_num_groups_29055)\n    #define segred_group_sizze_29058 (eWiseAddMultEntryzisegred_group_sizze_29057)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *red_arr_mem_29652_backing_3 =\n                  &shared_mem[red_arr_mem_29652_backing_offset_0];\n    volatile char *red_arr_mem_29650_backing_2 =\n                  &shared_mem[red_arr_mem_29650_backing_offset_1];\n    volatile char *red_arr_mem_29648_backing_1 =\n                  &shared_mem[red_arr_mem_29648_backing_offset_2];\n    volatile char *sync_arr_mem_29646_backing_0 =\n                  &shared_mem[sync_arr_mem_29646_backing_offset_3];\n    volatile __local bool local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >=",
            " 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = false;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t global_tid_29641;\n    int32_t local_tid_29642;\n    int64_t group_sizze_29645;\n    int32_t wave_sizze_29644;\n    int32_t group_tid_29643;\n    \n    global_tid_29641 = get_global_id(0);\n    local_tid_29642 = get_local_id(0);\n    group_sizze_29645 = get_local_size(0);\n    wave_sizze_29644 = LOCKSTEP_WIDTH;\n    group_tid_29643 = get_group_id(0);\n    \n    int32_t phys_tid_29064;\n    \n    phys_tid_29064 = global_tid_29641;\n    \n    __local char *sync_arr_mem_29646;\n    \n    sync_arr_mem_29646 = (__local char *) sync_arr_mem_29646_backing_0;\n    \n    __local char *red_arr_mem_29648;\n    \n    red_arr_mem_29648 = (__local char *) red_arr_mem_29648_backing_1;\n    \n    __local char *red_arr_mem_29650;\n    \n    red_arr_mem_29650 = (__local char *) red_arr_mem_29650_backing_2;\n    \n    __local char *red_arr_mem_29652;\n    \n    red_arr_mem_29652 = (__local char *) red_arr_mem_29652_backing_3;\n    \n    int64_t dummy_29062;\n    \n    dummy_29062 = (int64_t) 0;\n    \n    int64_t gtid_29063;\n    \n    gtid_29063 = (int64_t) 0;\n    \n    int64_t x_acc_29654;\n    int64_t x_acc_29655;\n    int64_t x_acc_29656;\n    int64_t chunk_sizze_29657;\n    \n    chunk_sizze_29657 = smin64(sdiv_up64(m_26408,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_29058 *\n                                         segred_num_groups_29056))),\n                               sdiv_up64(m_26408 - sext_i32_i64(phys_tid_29064),\n                                         num_threads_29640));\n    \n    int64_t x_29065;\n    int64_t x_29066;\n    int64_t x_29067;\n    int64_t y_29068;\n    int64_t y_29069;\n    int64_t y_29070;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_29654 = (int64_t) 0;\n        x_acc_29655 = (int64_t) 0;\n        x_acc_29656 = (int64_t) 0;\n    }\n    for (int64_t i_29667 = 0; i_29667 < chunk_sizze_29657; i_29667++) {\n  ",
            "      gtid_29063 = sext_i32_i64(phys_tid_29064) + num_threads_29640 * i_29667;\n        // apply map function\n        {\n            int64_t x_29075 = ((__global int64_t *) mem_28337)[gtid_29063];\n            int64_t x_29076 = ((__global\n                                int64_t *) rightOffsets_mem_28236)[gtid_29063];\n            bool cond_29077 = gtid_29063 == (int64_t) 0;\n            int64_t prevx2_29078;\n            \n            if (cond_29077) {\n                prevx2_29078 = gtid_29063;\n            } else {\n                int64_t prevx2_f_res_29079 = sub64(gtid_29063, (int64_t) 1);\n                \n                prevx2_29078 = prevx2_f_res_29079;\n            }\n            \n            int64_t prevy2_29080;\n            \n            if (cond_29077) {\n                prevy2_29080 = gtid_29063;\n            } else {\n                int64_t prevy2_f_res_29081 = sub64(gtid_29063, (int64_t) 1);\n                \n                prevy2_29080 = prevy2_f_res_29081;\n            }\n            \n            bool x_29082 = sle64((int64_t) 0, prevy2_29080);\n            bool y_29083 = slt64(prevy2_29080, m_26408);\n            bool bounds_check_29084 = x_29082 && y_29083;\n            bool index_certs_29085;\n            \n            if (!bounds_check_29084) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 38) ==\n                        -1) {\n                        global_failure_args[0] = prevy2_29080;\n                        global_failure_args[1] = m_26408;\n                        ;\n                    }\n                    local_failure = true;\n                    goto error_0;\n                }\n            }\n            \n            int64_t i_29086 = ((__global\n                                int64_t *) rightOffsets_mem_28236)[prevy2_29080];\n            int64_t j_m_i_29087 = sub64(x_29076, i_29086);\n            bool x_29088 = sle64((int64_t) 0, prevx2_29078);\n            bool y_29089 = slt64(prevx2_29078, m_26408);\n            bool bound",
            "s_check_29090 = x_29088 && y_29089;\n            bool index_certs_29091;\n            \n            if (!bounds_check_29090) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 39) ==\n                        -1) {\n                        global_failure_args[0] = prevx2_29078;\n                        global_failure_args[1] = m_26408;\n                        ;\n                    }\n                    local_failure = true;\n                    goto error_0;\n                }\n            }\n            \n            int64_t i_29092 = ((__global int64_t *) mem_28337)[prevx2_29078];\n            int64_t j_m_i_29093 = sub64(x_29075, i_29092);\n            int64_t conc_tmp_29094 = j_m_i_29087 + j_m_i_29093;\n            int64_t bytes_29095 = (int64_t) 8 * conc_tmp_29094;\n            int64_t bytes_29096 = (int64_t) 4 * conc_tmp_29094;\n            int64_t double_buffer_sizze_29097 = (int64_t) 8 * conc_tmp_29094;\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_29065 = x_acc_29654;\n                x_29066 = x_acc_29655;\n                x_29067 = x_acc_29656;\n            }\n            // load new values\n            {\n                y_29068 = bytes_29095;\n                y_29069 = bytes_29096;\n                y_29070 = double_buffer_sizze_29097;\n            }\n            // apply reduction operator\n            {\n                int64_t zz_29071 = smax64(x_29065, y_29068);\n                int64_t zz_29072 = smax64(x_29066, y_29069);\n                int64_t zz_29073 = smax64(x_29067, y_29070);\n                \n                // store in accumulator\n                {\n                    x_acc_29654 = zz_29071;\n                    x_acc_29655 = zz_29072;\n                    x_acc_29656 = zz_29073;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_29065 = x_acc_29654;\n        x_29066 = x_acc_2965",
            "5;\n        x_29067 = x_acc_29656;\n        ((__local int64_t *) red_arr_mem_29648)[sext_i32_i64(local_tid_29642)] =\n            x_29065;\n        ((__local int64_t *) red_arr_mem_29650)[sext_i32_i64(local_tid_29642)] =\n            x_29066;\n        ((__local int64_t *) red_arr_mem_29652)[sext_i32_i64(local_tid_29642)] =\n            x_29067;\n    }\n    \n  error_0:\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (local_failure)\n        return;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_29668;\n    int32_t skip_waves_29669;\n    \n    skip_waves_29669 = 1;\n    \n    int64_t x_29658;\n    int64_t x_29659;\n    int64_t x_29660;\n    int64_t y_29661;\n    int64_t y_29662;\n    int64_t y_29663;\n    \n    offset_29668 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_29642, sext_i64_i32(segred_group_sizze_29058))) {\n            x_29658 = ((__local\n                        int64_t *) red_arr_mem_29648)[sext_i32_i64(local_tid_29642 +\n                                                      offset_29668)];\n            x_29659 = ((__local\n                        int64_t *) red_arr_mem_29650)[sext_i32_i64(local_tid_29642 +\n                                                      offset_29668)];\n            x_29660 = ((__local\n                        int64_t *) red_arr_mem_29652)[sext_i32_i64(local_tid_29642 +\n                                                      offset_29668)];\n        }\n    }\n    offset_29668 = 1;\n    while (slt32(offset_29668, wave_sizze_29644)) {\n        if (slt32(local_tid_29642 + offset_29668,\n                  sext_i64_i32(segred_group_sizze_29058)) && ((local_tid_29642 -\n                                                               squot32(local_tid_29642,\n                                                                       wave_sizze_29644) *\n                                                               wave_sizze_29644) &\n                                                              (2 *\n                                ",
            "                               offset_29668 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                y_29661 = ((volatile __local\n                            int64_t *) red_arr_mem_29648)[sext_i32_i64(local_tid_29642 +\n                                                          offset_29668)];\n                y_29662 = ((volatile __local\n                            int64_t *) red_arr_mem_29650)[sext_i32_i64(local_tid_29642 +\n                                                          offset_29668)];\n                y_29663 = ((volatile __local\n                            int64_t *) red_arr_mem_29652)[sext_i32_i64(local_tid_29642 +\n                                                          offset_29668)];\n            }\n            // apply reduction operation\n            {\n                int64_t zz_29664 = smax64(x_29658, y_29661);\n                int64_t zz_29665 = smax64(x_29659, y_29662);\n                int64_t zz_29666 = smax64(x_29660, y_29663);\n                \n                x_29658 = zz_29664;\n                x_29659 = zz_29665;\n                x_29660 = zz_29666;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  int64_t *) red_arr_mem_29648)[sext_i32_i64(local_tid_29642)] =\n                    x_29658;\n                ((volatile __local\n                  int64_t *) red_arr_mem_29650)[sext_i32_i64(local_tid_29642)] =\n                    x_29659;\n                ((volatile __local\n                  int64_t *) red_arr_mem_29652)[sext_i32_i64(local_tid_29642)] =\n                    x_29660;\n            }\n        }\n        offset_29668 *= 2;\n    }\n    while (slt32(skip_waves_29669,\n                 squot32(sext_i64_i32(segred_group_sizze_29058) +\n                         wave_sizze_29644 - 1, wave_sizze_29644))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_29668 = skip_waves_29669 * wave_sizze_29644;\n ",
            "       if (slt32(local_tid_29642 + offset_29668,\n                  sext_i64_i32(segred_group_sizze_29058)) && ((local_tid_29642 -\n                                                               squot32(local_tid_29642,\n                                                                       wave_sizze_29644) *\n                                                               wave_sizze_29644) ==\n                                                              0 &&\n                                                              (squot32(local_tid_29642,\n                                                                       wave_sizze_29644) &\n                                                               (2 *\n                                                                skip_waves_29669 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                y_29661 = ((__local\n                            int64_t *) red_arr_mem_29648)[sext_i32_i64(local_tid_29642 +\n                                                          offset_29668)];\n                y_29662 = ((__local\n                            int64_t *) red_arr_mem_29650)[sext_i32_i64(local_tid_29642 +\n                                                          offset_29668)];\n                y_29663 = ((__local\n                            int64_t *) red_arr_mem_29652)[sext_i32_i64(local_tid_29642 +\n                                                          offset_29668)];\n            }\n            // apply reduction operation\n            {\n                int64_t zz_29664 = smax64(x_29658, y_29661);\n                int64_t zz_29665 = smax64(x_29659, y_29662);\n                int64_t zz_29666 = smax64(x_29660, y_29663);\n                \n                x_29658 = zz_29664;\n                x_29659 = zz_29665;\n                x_29660 = zz_29666;\n            }\n            // write result of operation\n            {\n                ((__local\n                ",
            "  int64_t *) red_arr_mem_29648)[sext_i32_i64(local_tid_29642)] =\n                    x_29658;\n                ((__local\n                  int64_t *) red_arr_mem_29650)[sext_i32_i64(local_tid_29642)] =\n                    x_29659;\n                ((__local\n                  int64_t *) red_arr_mem_29652)[sext_i32_i64(local_tid_29642)] =\n                    x_29660;\n            }\n        }\n        skip_waves_29669 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_29642) == (int64_t) 0) {\n            x_acc_29654 = x_29658;\n            x_acc_29655 = x_29659;\n            x_acc_29656 = x_29660;\n        }\n    }\n    \n    int32_t old_counter_29670;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_29642 == 0) {\n            ((__global\n              int64_t *) group_res_arr_mem_29634)[sext_i32_i64(group_tid_29643) *\n                                                  segred_group_sizze_29058] =\n                x_acc_29654;\n            ((__global\n              int64_t *) group_res_arr_mem_29636)[sext_i32_i64(group_tid_29643) *\n                                                  segred_group_sizze_29058] =\n                x_acc_29655;\n            ((__global\n              int64_t *) group_res_arr_mem_29638)[sext_i32_i64(group_tid_29643) *\n                                                  segred_group_sizze_29058] =\n                x_acc_29656;\n            mem_fence_global();\n            old_counter_29670 = atomic_add_i32_global(&((volatile __global\n                                                         int *) eWiseAddMultEntryzicounter_mem_29632)[(int64_t) 0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_29646)[(int64_t) 0] =\n                old_counter_29670 == segred_num_groups_29056 - (int64_t) 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool i",
            "s_last_group_29671;\n    \n    is_last_group_29671 = ((__local bool *) sync_arr_mem_29646)[(int64_t) 0];\n    if (is_last_group_29671) {\n        if (local_tid_29642 == 0) {\n            old_counter_29670 = atomic_add_i32_global(&((volatile __global\n                                                         int *) eWiseAddMultEntryzicounter_mem_29632)[(int64_t) 0],\n                                                      (int) ((int64_t) 0 -\n                                                             segred_num_groups_29056));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_29672 = sdiv_up64(segred_num_groups_29056,\n                                                      segred_group_sizze_29058);\n            \n            x_29065 = (int64_t) 0;\n            x_29066 = (int64_t) 0;\n            x_29067 = (int64_t) 0;\n            for (int64_t i_29673 = 0; i_29673 < read_per_thread_29672;\n                 i_29673++) {\n                int64_t group_res_id_29674 = sext_i32_i64(local_tid_29642) *\n                        read_per_thread_29672 + i_29673;\n                int64_t index_of_group_res_29675 = group_res_id_29674;\n                \n                if (slt64(group_res_id_29674, segred_num_groups_29056)) {\n                    y_29068 = ((__global\n                                int64_t *) group_res_arr_mem_29634)[index_of_group_res_29675 *\n                                                                    segred_group_sizze_29058];\n                    y_29069 = ((__global\n                                int64_t *) group_res_arr_mem_29636)[index_of_group_res_29675 *\n                                                                    segred_group_sizze_29058];\n                    y_29070 = ((__global\n                                int64_t *) group_res_arr_mem_29638)[index_of_group_res_29675 *\n                                                                    segred_group_sizze_29058];\n                    \n                    int64_",
            "t zz_29071;\n                    \n                    zz_29071 = smax64(x_29065, y_29068);\n                    \n                    int64_t zz_29072 = smax64(x_29066, y_29069);\n                    int64_t zz_29073 = smax64(x_29067, y_29070);\n                    \n                    x_29065 = zz_29071;\n                    x_29066 = zz_29072;\n                    x_29067 = zz_29073;\n                }\n            }\n        }\n        ((__local int64_t *) red_arr_mem_29648)[sext_i32_i64(local_tid_29642)] =\n            x_29065;\n        ((__local int64_t *) red_arr_mem_29650)[sext_i32_i64(local_tid_29642)] =\n            x_29066;\n        ((__local int64_t *) red_arr_mem_29652)[sext_i32_i64(local_tid_29642)] =\n            x_29067;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_29676;\n            int32_t skip_waves_29677;\n            \n            skip_waves_29677 = 1;\n            \n            int64_t x_29658;\n            int64_t x_29659;\n            int64_t x_29660;\n            int64_t y_29661;\n            int64_t y_29662;\n            int64_t y_29663;\n            \n            offset_29676 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_29642,\n                          sext_i64_i32(segred_group_sizze_29058))) {\n                    x_29658 = ((__local\n                                int64_t *) red_arr_mem_29648)[sext_i32_i64(local_tid_29642 +\n                                                              offset_29676)];\n                    x_29659 = ((__local\n                                int64_t *) red_arr_mem_29650)[sext_i32_i64(local_tid_29642 +\n                                                              offset_29676)];\n                    x_29660 = ((__local\n                                int64_t *) red_arr_mem_29652)[sext_i32_i64(local_tid_29642 +\n                                                              offset_29676)];\n            ",
            "    }\n            }\n            offset_29676 = 1;\n            while (slt32(offset_29676, wave_sizze_29644)) {\n                if (slt32(local_tid_29642 + offset_29676,\n                          sext_i64_i32(segred_group_sizze_29058)) &&\n                    ((local_tid_29642 - squot32(local_tid_29642,\n                                                wave_sizze_29644) *\n                      wave_sizze_29644) & (2 * offset_29676 - 1)) == 0) {\n                    // read array element\n                    {\n                        y_29661 = ((volatile __local\n                                    int64_t *) red_arr_mem_29648)[sext_i32_i64(local_tid_29642 +\n                                                                  offset_29676)];\n                        y_29662 = ((volatile __local\n                                    int64_t *) red_arr_mem_29650)[sext_i32_i64(local_tid_29642 +\n                                                                  offset_29676)];\n                        y_29663 = ((volatile __local\n                                    int64_t *) red_arr_mem_29652)[sext_i32_i64(local_tid_29642 +\n                                                                  offset_29676)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t zz_29664 = smax64(x_29658, y_29661);\n                        int64_t zz_29665 = smax64(x_29659, y_29662);\n                        int64_t zz_29666 = smax64(x_29660, y_29663);\n                        \n                        x_29658 = zz_29664;\n                        x_29659 = zz_29665;\n                        x_29660 = zz_29666;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          int64_t *) red_arr_mem_29648)[sext_i32_i64(local_tid_29642)] =\n                            x_29658;\n                        ((volatile __local\n                          int64_t ",
            "*) red_arr_mem_29650)[sext_i32_i64(local_tid_29642)] =\n                            x_29659;\n                        ((volatile __local\n                          int64_t *) red_arr_mem_29652)[sext_i32_i64(local_tid_29642)] =\n                            x_29660;\n                    }\n                }\n                offset_29676 *= 2;\n            }\n            while (slt32(skip_waves_29677,\n                         squot32(sext_i64_i32(segred_group_sizze_29058) +\n                                 wave_sizze_29644 - 1, wave_sizze_29644))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_29676 = skip_waves_29677 * wave_sizze_29644;\n                if (slt32(local_tid_29642 + offset_29676,\n                          sext_i64_i32(segred_group_sizze_29058)) &&\n                    ((local_tid_29642 - squot32(local_tid_29642,\n                                                wave_sizze_29644) *\n                      wave_sizze_29644) == 0 && (squot32(local_tid_29642,\n                                                         wave_sizze_29644) &\n                                                 (2 * skip_waves_29677 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        y_29661 = ((__local\n                                    int64_t *) red_arr_mem_29648)[sext_i32_i64(local_tid_29642 +\n                                                                  offset_29676)];\n                        y_29662 = ((__local\n                                    int64_t *) red_arr_mem_29650)[sext_i32_i64(local_tid_29642 +\n                                                                  offset_29676)];\n                        y_29663 = ((__local\n                                    int64_t *) red_arr_mem_29652)[sext_i32_i64(local_tid_29642 +\n                                                                  offset_29676)];\n                    }\n                    // apply reduction operation\n                    ",
            "{\n                        int64_t zz_29664 = smax64(x_29658, y_29661);\n                        int64_t zz_29665 = smax64(x_29659, y_29662);\n                        int64_t zz_29666 = smax64(x_29660, y_29663);\n                        \n                        x_29658 = zz_29664;\n                        x_29659 = zz_29665;\n                        x_29660 = zz_29666;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          int64_t *) red_arr_mem_29648)[sext_i32_i64(local_tid_29642)] =\n                            x_29658;\n                        ((__local\n                          int64_t *) red_arr_mem_29650)[sext_i32_i64(local_tid_29642)] =\n                            x_29659;\n                        ((__local\n                          int64_t *) red_arr_mem_29652)[sext_i32_i64(local_tid_29642)] =\n                            x_29660;\n                    }\n                }\n                skip_waves_29677 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_29642 == 0) {\n                    ((__global int64_t *) mem_29105)[(int64_t) 0] = x_29658;\n                    ((__global int64_t *) mem_29107)[(int64_t) 0] = x_29659;\n                    ((__global int64_t *) mem_29109)[(int64_t) 0] = x_29660;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_num_groups_29056\n    #undef segred_group_sizze_29058\n}\n__kernel void eWiseAddMultEntryzisegscan_27823(__global int *global_failure,\n                                               int failure_is_an_option,\n                                               __global\n                                               int64_t *global_failure_args,\n                                               uint local_mem_29199_backing_offset_0,\n                                               int64_t n_26407, int64_t m_26408,\n                        ",
            "                       int64_t k_26409,\n                                               int64_t num_threads_28953,\n                                               __global\n                                               unsigned char *leftColumns_mem_28232,\n                                               __global\n                                               unsigned char *leftOffsets_mem_28233,\n                                               __global\n                                               unsigned char *rightColumns_mem_28235,\n                                               __global\n                                               unsigned char *rightOffsets_mem_28236,\n                                               __global\n                                               unsigned char *mem_28239,\n                                               __global\n                                               unsigned char *mem_28248,\n                                               __global\n                                               unsigned char *mem_28250,\n                                               __global\n                                               unsigned char *mem_28252,\n                                               __global\n                                               unsigned char *mem_28254,\n                                               __global\n                                               unsigned char *mem_28256,\n                                               __global\n                                               unsigned char *mem_28318,\n                                               __global\n                                               unsigned char *mem_28337,\n                                               __global\n                                               unsigned char *double_buffer_mem_28763,\n                                               __global\n                                               unsigned char *eWiseAddMultEntryziid_count",
            "er_mem_29173,\n                                               __global\n                                               unsigned char *status_flags_mem_29175,\n                                               __global\n                                               unsigned char *aggregates_mem_29177,\n                                               __global\n                                               unsigned char *incprefixes_mem_29179)\n{\n    #define segscan_group_sizze_27818 (eWiseAddMultEntryzisegscan_group_sizze_27817)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *local_mem_29199_backing_0 =\n                  &shared_mem[local_mem_29199_backing_offset_0];\n    volatile __local bool local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = false;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t global_tid_29190;\n    int32_t local_tid_29191;\n    int64_t group_sizze_29194;\n    int32_t wave_sizze_29193;\n    int32_t group_tid_29192;\n    \n    global_tid_29190 = get_global_id(0);\n    local_tid_29191 = get_local_id(0);\n    group_sizze_29194 = get_local_size(0);\n    wave_sizze_29193 = LOCKSTEP_WIDTH;\n    group_tid_29192 = get_group_id(0);\n    \n    int32_t phys_tid_27823;\n    \n    phys_tid_27823 = global_tid_29190;\n    \n    int64_t byte_offsets_29195;\n    \n    byte_offsets_29195 = (int64_t) 0;\n    \n    int64_t byte_offsets_29196;\n    \n    byte_offsets_29196 = segscan_group_sizze_27818 * (int64_t) 8;\n    \n    int64_t warp_byte_offset_29197;\n    \n    warp_byte_offset_29197 = (int64_t) 32;\n    \n    int64_t warp_byte_offset_29198;\n    \n    warp_byte_offset_29198 = (int64_t) 288;\n    // Allocate reused shared memeory\n    { }\n    \n    __local char *local_mem_29199;\n    \n    local_mem_29199 = (__local char *) local_mem_29199_backing_0;\n    \n    int64_t trans_arr_len_29200;\n    \n    trans_arr_len_29200 = (i",
            "nt64_t) 9 * segscan_group_sizze_27818;\n    \n    int32_t dynamic_id_29207;\n    \n    if (local_tid_29191 == 0) {\n        dynamic_id_29207 = atomic_add_i32_global(&((volatile __global\n                                                    int *) eWiseAddMultEntryziid_counter_mem_29173)[(int64_t) 0],\n                                                 (int) 1);\n        ((__local int32_t *) local_mem_29199)[(int64_t) 0] = dynamic_id_29207;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    dynamic_id_29207 = ((__local int32_t *) local_mem_29199)[(int64_t) 0];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t blockOff_29208;\n    \n    blockOff_29208 = sext_i32_i64(dynamic_id_29207) * (int64_t) 9 *\n        segscan_group_sizze_27818;\n    \n    int64_t private_mem_29209[9];\n    \n    // Load and map\n    {\n        for (int64_t i_29211 = 0; i_29211 < (int64_t) 9; i_29211++) {\n            int64_t gtid_27822 = blockOff_29208 +\n                    sext_i32_i64(local_tid_29191) + i_29211 *\n                    segscan_group_sizze_27818;\n            \n            if (slt64(gtid_27822, m_26408)) {\n                int64_t x_26421 = ((__global\n                                    int64_t *) leftOffsets_mem_28233)[gtid_27822];\n                int64_t x_26423 = ((__global\n                                    int64_t *) rightOffsets_mem_28236)[gtid_27822];\n                bool cond_26424 = gtid_27822 == (int64_t) 0;\n                int64_t prevx2_26425;\n                \n                if (cond_26424) {\n                    prevx2_26425 = gtid_27822;\n                } else {\n                    int64_t prevx2_f_res_26426 = sub64(gtid_27822, (int64_t) 1);\n                    \n                    prevx2_26425 = prevx2_f_res_26426;\n                }\n                \n                int64_t prevy2_26427;\n                \n                if (cond_26424) {\n                    prevy2_26427 = gtid_27822;\n                } else {\n                    int64_t prevy2_f_res_26428 = sub64(gtid_27822, (int64_t) 1);\n      ",
            "              \n                    prevy2_26427 = prevy2_f_res_26428;\n                }\n                \n                bool x_26429 = sle64((int64_t) 0, prevy2_26427);\n                bool y_26430 = slt64(prevy2_26427, m_26408);\n                bool bounds_check_26431 = x_26429 && y_26430;\n                bool index_certs_26432;\n                \n                if (!bounds_check_26431) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 21) ==\n                            -1) {\n                            global_failure_args[0] = prevy2_26427;\n                            global_failure_args[1] = m_26408;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                \n                int64_t i_26433 = ((__global\n                                    int64_t *) rightOffsets_mem_28236)[prevy2_26427];\n                int64_t j_m_i_26434 = sub64(x_26423, i_26433);\n                bool empty_slice_26435 = j_m_i_26434 == (int64_t) 0;\n                int64_t m_26436 = sub64(j_m_i_26434, (int64_t) 1);\n                int64_t i_p_m_t_s_26437 = add64(i_26433, m_26436);\n                bool zzero_leq_i_p_m_t_s_26438 = sle64((int64_t) 0,\n                                                       i_p_m_t_s_26437);\n                bool i_p_m_t_s_leq_w_26439 = slt64(i_p_m_t_s_26437, k_26409);\n                bool zzero_lte_i_26440 = sle64((int64_t) 0, i_26433);\n                bool i_lte_j_26441 = sle64(i_26433, x_26423);\n                bool y_26442 = i_p_m_t_s_leq_w_26439 && zzero_lte_i_26440;\n                bool y_26443 = zzero_leq_i_p_m_t_s_26438 && y_26442;\n                bool y_26444 = i_lte_j_26441 && y_26443;\n                bool forwards_ok_26445 = zzero_lte_i_26440 && y_26444;\n                bool ok_or_empty_26446 = empty_slice_26435 || forwards_ok_26445;\n                bool index_certs_26447;\n   ",
            "             \n                if (!ok_or_empty_26446) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 22) ==\n                            -1) {\n                            global_failure_args[0] = i_26433;\n                            global_failure_args[1] = x_26423;\n                            global_failure_args[2] = k_26409;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                \n                bool x_26449 = sle64((int64_t) 0, prevx2_26425);\n                bool y_26450 = slt64(prevx2_26425, m_26408);\n                bool bounds_check_26451 = x_26449 && y_26450;\n                bool index_certs_26452;\n                \n                if (!bounds_check_26451) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 23) ==\n                            -1) {\n                            global_failure_args[0] = prevx2_26425;\n                            global_failure_args[1] = m_26408;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                \n                int64_t i_26453 = ((__global\n                                    int64_t *) leftOffsets_mem_28233)[prevx2_26425];\n                int64_t j_m_i_26454 = sub64(x_26421, i_26453);\n                bool empty_slice_26455 = j_m_i_26454 == (int64_t) 0;\n                int64_t m_26456 = sub64(j_m_i_26454, (int64_t) 1);\n                int64_t i_p_m_t_s_26457 = add64(i_26453, m_26456);\n                bool zzero_leq_i_p_m_t_s_26458 = sle64((int64_t) 0,\n                                                       i_p_m_t_s_26457);\n                bool i_p_m_t_s_leq_w_26459 = slt64(i_p_m_t_s_26457, n_26407);\n                bool zzero_lte_i_26460 = sle64((int64_t) 0",
            ", i_26453);\n                bool i_lte_j_26461 = sle64(i_26453, x_26421);\n                bool y_26462 = i_p_m_t_s_leq_w_26459 && zzero_lte_i_26460;\n                bool y_26463 = zzero_leq_i_p_m_t_s_26458 && y_26462;\n                bool y_26464 = i_lte_j_26461 && y_26463;\n                bool forwards_ok_26465 = zzero_lte_i_26460 && y_26464;\n                bool ok_or_empty_26466 = empty_slice_26455 || forwards_ok_26465;\n                bool index_certs_26467;\n                \n                if (!ok_or_empty_26466) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 24) ==\n                            -1) {\n                            global_failure_args[0] = i_26453;\n                            global_failure_args[1] = x_26421;\n                            global_failure_args[2] = n_26407;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                \n                int64_t conc_tmp_26470 = j_m_i_26434 + j_m_i_26454;\n                int64_t unionSizze_res_26469;\n                \n                if (empty_slice_26455) {\n                    unionSizze_res_26469 = j_m_i_26434;\n                } else {\n                    int64_t j_m_i_26471 = sub64(conc_tmp_26470, (int64_t) 1);\n                    int64_t unionSizze_res_f_res_26472;\n                    \n                    if (empty_slice_26435) {\n                        unionSizze_res_f_res_26472 = j_m_i_26454;\n                    } else {\n                        int64_t tmp_offs_29212 = (int64_t) 0;\n                        \n                        for (int64_t i_29213 = 0; i_29213 < j_m_i_26454;\n                             i_29213++) {\n                            ((__global int64_t *) mem_28239)[phys_tid_27823 +\n                                                             (tmp_offs_29212 +\n                                               ",
            "               i_29213) *\n                                                             num_threads_28953] =\n                                ((__global\n                                  int64_t *) leftColumns_mem_28232)[i_26453 +\n                                                                    i_29213];\n                        }\n                        tmp_offs_29212 += j_m_i_26454;\n                        for (int64_t i_29214 = 0; i_29214 < j_m_i_26434;\n                             i_29214++) {\n                            ((__global int64_t *) mem_28239)[phys_tid_27823 +\n                                                             (tmp_offs_29212 +\n                                                              i_29214) *\n                                                             num_threads_28953] =\n                                ((__global\n                                  int64_t *) rightColumns_mem_28235)[i_26433 +\n                                                                     i_29214];\n                        }\n                        tmp_offs_29212 += j_m_i_26434;\n                        \n                        bool cond_26474 = conc_tmp_26470 == (int64_t) 0;\n                        int32_t iters_26475;\n                        \n                        if (cond_26474) {\n                            iters_26475 = 0;\n                        } else {\n                            iters_26475 = 32;\n                        }\n                        \n                        bool loop_nonempty_26476 = slt32(0, iters_26475);\n                        bool x_26477 = sle64((int64_t) 0, j_m_i_26471);\n                        bool y_26478 = slt64(j_m_i_26471, conc_tmp_26470);\n                        bool bounds_check_26479 = x_26477 && y_26478;\n                        bool loop_not_taken_26480 = !loop_nonempty_26476;\n                        bool protect_assert_disj_26481 = bounds_check_26479 ||\n                             loop_not_taken_26480;\n                       ",
            " bool index_certs_26482;\n                        \n                        if (!protect_assert_disj_26481) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure,\n                                                              -1, 25) == -1) {\n                                    global_failure_args[0] = j_m_i_26471;\n                                    global_failure_args[1] = conc_tmp_26470;\n                                    ;\n                                }\n                                local_failure = true;\n                                goto error_0;\n                            }\n                        }\n                        for (int64_t i_29215 = 0; i_29215 < conc_tmp_26470;\n                             i_29215++) {\n                            ((__global\n                              int64_t *) double_buffer_mem_28763)[phys_tid_27823 +\n                                                                  i_29215 *\n                                                                  num_threads_28953] =\n                                ((__global\n                                  int64_t *) mem_28239)[phys_tid_27823 +\n                                                        i_29215 *\n                                                        num_threads_28953];\n                        }\n                        for (int32_t i_26484 = 0; i_26484 < iters_26475;\n                             i_26484++) {\n                            int32_t defunc_2_radix_sort_step_arg_26486 =\n                                    mul32(2, i_26484);\n                            int32_t defunc_0_get_bit_arg_26487 = add32(1,\n                                                                       defunc_2_radix_sort_step_arg_26486);\n                            int64_t i32_res_26488 =\n                                    sext_i32_i64(defunc_0_get_bit_arg_26487);\n                            int64_t i32_res_26489 =\n                                ",
            "    sext_i32_i64(defunc_2_radix_sort_step_arg_26486);\n                            int64_t discard_28161;\n                            int64_t discard_28162;\n                            int64_t discard_28163;\n                            int64_t discard_28164;\n                            int64_t scanacc_28146;\n                            int64_t scanacc_28147;\n                            int64_t scanacc_28148;\n                            int64_t scanacc_28149;\n                            \n                            scanacc_28146 = (int64_t) 0;\n                            scanacc_28147 = (int64_t) 0;\n                            scanacc_28148 = (int64_t) 0;\n                            scanacc_28149 = (int64_t) 0;\n                            for (int64_t i_28155 = 0; i_28155 < conc_tmp_26470;\n                                 i_28155++) {\n                                int64_t x_26517 = ((__global\n                                                    int64_t *) double_buffer_mem_28763)[phys_tid_27823 +\n                                                                                        i_28155 *\n                                                                                        num_threads_28953];\n                                int64_t zgzg_res_26518 = ashr64(x_26517,\n                                                                i32_res_26488);\n                                int64_t za_res_26519 = (int64_t) 1 &\n                                        zgzg_res_26518;\n                                int32_t to_i32_res_26520 =\n                                        sext_i64_i32(za_res_26519);\n                                int32_t x_26521 = mul32(2, to_i32_res_26520);\n                                int64_t zgzg_res_26522 = ashr64(x_26517,\n                                                                i32_res_26489);\n                                int64_t za_res_26523 = (int64_t) 1 &\n                                        zgzg_res_26522;\n                      ",
            "          int32_t to_i32_res_26524 =\n                                        sext_i64_i32(za_res_26523);\n                                int32_t defunc_0_f_res_26525 = add32(x_26521,\n                                                                     to_i32_res_26524);\n                                bool cond_26526 = defunc_0_f_res_26525 == 0;\n                                int64_t defunc_0_f_res_26527 =\n                                        btoi_bool_i64(cond_26526);\n                                int64_t defunc_0_f_res_26528;\n                                int64_t defunc_0_f_res_26529;\n                                int64_t defunc_0_f_res_26530;\n                                \n                                if (cond_26526) {\n                                    defunc_0_f_res_26528 = (int64_t) 0;\n                                    defunc_0_f_res_26529 = (int64_t) 0;\n                                    defunc_0_f_res_26530 = (int64_t) 0;\n                                } else {\n                                    bool cond_26531 = defunc_0_f_res_26525 == 1;\n                                    int64_t defunc_0_f_res_f_res_26532 =\n                                            btoi_bool_i64(cond_26531);\n                                    int64_t defunc_0_f_res_f_res_26533;\n                                    int64_t defunc_0_f_res_f_res_26534;\n                                    \n                                    if (cond_26531) {\n                                        defunc_0_f_res_f_res_26533 =\n                                            (int64_t) 0;\n                                        defunc_0_f_res_f_res_26534 =\n                                            (int64_t) 0;\n                                    } else {\n                                        bool cond_26535 =\n                                             defunc_0_f_res_26525 == 2;\n                                        int64_t defunc_0_f_res_f_res_f_res_26536\n                            ",
            "                    = btoi_bool_i64(cond_26535);\n                                        bool cond_neg_26537 = !cond_26535;\n                                        int64_t defunc_0_f_res_f_res_f_res_26538\n                                                = btoi_bool_i64(cond_neg_26537);\n                                        \n                                        defunc_0_f_res_f_res_26533 =\n                                            defunc_0_f_res_f_res_f_res_26536;\n                                        defunc_0_f_res_f_res_26534 =\n                                            defunc_0_f_res_f_res_f_res_26538;\n                                    }\n                                    defunc_0_f_res_26528 =\n                                        defunc_0_f_res_f_res_26532;\n                                    defunc_0_f_res_26529 =\n                                        defunc_0_f_res_f_res_26533;\n                                    defunc_0_f_res_26530 =\n                                        defunc_0_f_res_f_res_26534;\n                                }\n                                \n                                int64_t defunc_1_op_res_26513 =\n                                        add64(defunc_0_f_res_26527,\n                                              scanacc_28146);\n                                int64_t defunc_1_op_res_26514 =\n                                        add64(defunc_0_f_res_26528,\n                                              scanacc_28147);\n                                int64_t defunc_1_op_res_26515 =\n                                        add64(defunc_0_f_res_26529,\n                                              scanacc_28148);\n                                int64_t defunc_1_op_res_26516 =\n                                        add64(defunc_0_f_res_26530,\n                                              scanacc_28149);\n                                \n                                ((__global\n                                  int64_t",
            " *) mem_28248)[phys_tid_27823 +\n                                                        i_28155 *\n                                                        num_threads_28953] =\n                                    defunc_1_op_res_26513;\n                                ((__global\n                                  int64_t *) mem_28250)[phys_tid_27823 +\n                                                        i_28155 *\n                                                        num_threads_28953] =\n                                    defunc_1_op_res_26514;\n                                ((__global\n                                  int64_t *) mem_28252)[phys_tid_27823 +\n                                                        i_28155 *\n                                                        num_threads_28953] =\n                                    defunc_1_op_res_26515;\n                                ((__global\n                                  int64_t *) mem_28254)[phys_tid_27823 +\n                                                        i_28155 *\n                                                        num_threads_28953] =\n                                    defunc_1_op_res_26516;\n                                ((__global\n                                  int32_t *) mem_28256)[phys_tid_27823 +\n                                                        i_28155 *\n                                                        num_threads_28953] =\n                                    defunc_0_f_res_26525;\n                                \n                                int64_t scanacc_tmp_29217 =\n                                        defunc_1_op_res_26513;\n                                int64_t scanacc_tmp_29218 =\n                                        defunc_1_op_res_26514;\n                                int64_t scanacc_tmp_29219 =\n                                        defunc_1_op_res_26515;\n                                int64_t scanacc_tmp_29220 =\n                                 ",
            "       defunc_1_op_res_26516;\n                                \n                                scanacc_28146 = scanacc_tmp_29217;\n                                scanacc_28147 = scanacc_tmp_29218;\n                                scanacc_28148 = scanacc_tmp_29219;\n                                scanacc_28149 = scanacc_tmp_29220;\n                            }\n                            discard_28161 = scanacc_28146;\n                            discard_28162 = scanacc_28147;\n                            discard_28163 = scanacc_28148;\n                            discard_28164 = scanacc_28149;\n                            \n                            int64_t last_res_26544 = ((__global\n                                                       int64_t *) mem_28248)[phys_tid_27823 +\n                                                                             j_m_i_26471 *\n                                                                             num_threads_28953];\n                            int64_t last_res_26545 = ((__global\n                                                       int64_t *) mem_28250)[phys_tid_27823 +\n                                                                             j_m_i_26471 *\n                                                                             num_threads_28953];\n                            int64_t last_res_26546 = ((__global\n                                                       int64_t *) mem_28252)[phys_tid_27823 +\n                                                                             j_m_i_26471 *\n                                                                             num_threads_28953];\n                            \n                            for (int64_t i_29226 = 0; i_29226 < conc_tmp_26470;\n                                 i_29226++) {\n                                ((__global\n                                  int64_t *) mem_28318)[phys_tid_27823 +\n                                                        i_29226 *",
            "\n                                                        num_threads_28953] =\n                                    ((__global\n                                      int64_t *) double_buffer_mem_28763)[phys_tid_27823 +\n                                                                          i_29226 *\n                                                                          num_threads_28953];\n                            }\n                            for (int64_t write_iter_28165 = 0;\n                                 write_iter_28165 < conc_tmp_26470;\n                                 write_iter_28165++) {\n                                int32_t write_iv_28167 = ((__global\n                                                           int32_t *) mem_28256)[phys_tid_27823 +\n                                                                                 write_iter_28165 *\n                                                                                 num_threads_28953];\n                                bool match_lit_26555 = 0 == write_iv_28167;\n                                int64_t defunc_1_f_res_26556;\n                                \n                                if (match_lit_26555) {\n                                    int64_t write_iv_28168 = ((__global\n                                                               int64_t *) mem_28248)[phys_tid_27823 +\n                                                                                     write_iter_28165 *\n                                                                                     num_threads_28953];\n                                    int64_t case_res_26557 =\n                                            sub64(write_iv_28168, (int64_t) 1);\n                                    \n                                    defunc_1_f_res_26556 = case_res_26557;\n                                } else {\n                                    int64_t write_iv_28169 = ((__global\n                                                ",
            "               int64_t *) mem_28250)[phys_tid_27823 +\n                                                                                     write_iter_28165 *\n                                                                                     num_threads_28953];\n                                    int64_t write_iv_28170 = ((__global\n                                                               int64_t *) mem_28252)[phys_tid_27823 +\n                                                                                     write_iter_28165 *\n                                                                                     num_threads_28953];\n                                    int64_t write_iv_28171 = ((__global\n                                                               int64_t *) mem_28254)[phys_tid_27823 +\n                                                                                     write_iter_28165 *\n                                                                                     num_threads_28953];\n                                    bool match_lit_26558 = 1 == write_iv_28167;\n                                    int64_t x_26559;\n                                    \n                                    if (match_lit_26558) {\n                                        int64_t x_26560 = add64(last_res_26544,\n                                                                write_iv_28169);\n                                        int64_t case_res_26561 = sub64(x_26560,\n                                                                       (int64_t) 1);\n                                        \n                                        x_26559 = case_res_26561;\n                                    } else {\n                                        bool match_lit_26562 = 2 ==\n                                             write_iv_28167;\n                                        int64_t x_26563;\n                                        \n                                     ",
            "   if (match_lit_26562) {\n                                            int64_t x_26564 =\n                                                    add64(last_res_26544,\n                                                          last_res_26545);\n                                            int64_t x_26565 = add64(x_26564,\n                                                                    write_iv_28170);\n                                            int64_t case_res_26566 =\n                                                    sub64(x_26565, (int64_t) 1);\n                                            \n                                            x_26563 = case_res_26566;\n                                        } else {\n                                            int64_t x_26567 =\n                                                    add64(last_res_26544,\n                                                          last_res_26545);\n                                            int64_t x_26568 =\n                                                    add64(last_res_26546,\n                                                          x_26567);\n                                            int64_t x_26569 = add64(x_26568,\n                                                                    write_iv_28171);\n                                            int64_t defunc_1_f_res_res_26570 =\n                                                    sub64(x_26569, (int64_t) 1);\n                                            \n                                            x_26563 = defunc_1_f_res_res_26570;\n                                        }\n                                        x_26559 = x_26563;\n                                    }\n                                    defunc_1_f_res_26556 = x_26559;\n                                }\n                                \n                                bool less_than_zzero_28173 =\n                                     slt64(defunc_1_f_res_26556, (int64_t) 0);\n           ",
            "                     bool greater_than_sizze_28174 =\n                                     sle64(conc_tmp_26470,\n                                           defunc_1_f_res_26556);\n                                bool outside_bounds_dim_28175 =\n                                     less_than_zzero_28173 ||\n                                     greater_than_sizze_28174;\n                                \n                                if (!outside_bounds_dim_28175) {\n                                    for (int64_t i_29228 = 0; i_29228 <\n                                         (int64_t) 1; i_29228++) {\n                                        ((__global\n                                          int64_t *) mem_28318)[phys_tid_27823 +\n                                                                (defunc_1_f_res_26556 +\n                                                                 i_29228) *\n                                                                num_threads_28953] =\n                                            ((__global\n                                              int64_t *) double_buffer_mem_28763)[phys_tid_27823 +\n                                                                                  num_threads_28953 *\n                                                                                  write_iter_28165 +\n                                                                                  i_29228 *\n                                                                                  num_threads_28953];\n                                    }\n                                }\n                            }\n                            for (int64_t i_29229 = 0; i_29229 < conc_tmp_26470;\n                                 i_29229++) {\n                                ((__global\n                                  int64_t *) double_buffer_mem_28763)[phys_tid_27823 +\n                                                                      i_29229 *\n                          ",
            "                                            num_threads_28953] =\n                                    ((__global\n                                      int64_t *) mem_28318)[phys_tid_27823 +\n                                                            i_29229 *\n                                                            num_threads_28953];\n                            }\n                        }\n                        \n                        bool empty_slice_26571 = j_m_i_26471 == (int64_t) 0;\n                        bool i_lte_j_26572 = sle64((int64_t) 1, conc_tmp_26470);\n                        bool y_26573 = bounds_check_26479 && i_lte_j_26572;\n                        bool ok_or_empty_26574 = empty_slice_26571 || y_26573;\n                        bool index_certs_26575;\n                        \n                        if (!ok_or_empty_26574) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure,\n                                                              -1, 26) == -1) {\n                                    global_failure_args[0] = (int64_t) 1;\n                                    global_failure_args[1] = conc_tmp_26470;\n                                    ;\n                                }\n                                local_failure = true;\n                                goto error_0;\n                            }\n                        }\n                        \n                        int64_t defunc_2_reduce_res_26578;\n                        int64_t redout_28179 = (int64_t) 1;\n                        \n                        for (int64_t i_28181 = 0; i_28181 < j_m_i_26471;\n                             i_28181++) {\n                            int64_t slice_28226 = (int64_t) 1 + i_28181;\n                            int64_t x_26593 = ((__global\n                                                int64_t *) double_buffer_mem_28763)[phys_tid_27823 +\n                                                               ",
            "                     slice_28226 *\n                                                                                    num_threads_28953];\n                            bool y_26586 = slt64(i_28181, conc_tmp_26470);\n                            bool index_certs_26588;\n                            \n                            if (!y_26586) {\n                                {\n                                    if (atomic_cmpxchg_i32_global(global_failure,\n                                                                  -1, 27) ==\n                                        -1) {\n                                        global_failure_args[0] = i_28181;\n                                        global_failure_args[1] = conc_tmp_26470;\n                                        ;\n                                    }\n                                    local_failure = true;\n                                    goto error_0;\n                                }\n                            }\n                            \n                            int64_t y_26589 = ((__global\n                                                int64_t *) double_buffer_mem_28763)[phys_tid_27823 +\n                                                                                    i_28181 *\n                                                                                    num_threads_28953];\n                            bool cond_26590 = x_26593 == y_26589;\n                            int64_t defunc_1_op_res_26591;\n                            \n                            if (cond_26590) {\n                                defunc_1_op_res_26591 = redout_28179;\n                            } else {\n                                int64_t defunc_1_op_res_f_res_26592 =\n                                        add64((int64_t) 1, redout_28179);\n                                \n                                defunc_1_op_res_26591 =\n                                    defunc_1_op_res_f_res_26592;\n                         ",
            "   }\n                            \n                            int64_t redout_tmp_29230 = defunc_1_op_res_26591;\n                            \n                            redout_28179 = redout_tmp_29230;\n                        }\n                        defunc_2_reduce_res_26578 = redout_28179;\n                        unionSizze_res_f_res_26472 = defunc_2_reduce_res_26578;\n                    }\n                    unionSizze_res_26469 = unionSizze_res_f_res_26472;\n                }\n                private_mem_29209[i_29211] = unionSizze_res_26469;\n            } else {\n                private_mem_29209[i_29211] = (int64_t) 0;\n            }\n        }\n    }\n    // Transpose scan inputs\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29231 = 0; i_29231 < (int64_t) 9; i_29231++) {\n            int64_t sharedIdx_29232 = sext_i32_i64(local_tid_29191) + i_29231 *\n                    segscan_group_sizze_27818;\n            \n            ((__local int64_t *) local_mem_29199)[sharedIdx_29232] =\n                private_mem_29209[i_29231];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_29233 = 0; i_29233 < 9; i_29233++) {\n            int32_t sharedIdx_29234 = local_tid_29191 * 9 + i_29233;\n            \n            private_mem_29209[sext_i32_i64(i_29233)] = ((__local\n                                                         int64_t *) local_mem_29199)[sext_i32_i64(sharedIdx_29234)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Per thread scan\n    {\n        for (int64_t i_29235 = 0; i_29235 < (int64_t) 8; i_29235++) {\n            int64_t x_26418;\n            int64_t x_26419;\n            \n            x_26418 = private_mem_29209[i_29235];\n            x_26419 = private_mem_29209[i_29235 + (int64_t) 1];\n            \n            int64_t defunc_1_op_res_26420;\n            \n            defunc_1_op_res_26420 = add64(x_26418, x_26419);\n            private_mem_29209[i_29235 + (int64_t) 1] = defunc_1_op_res_26420;\n        }\n    }\n    // Pu",
            "blish results in shared memory\n    {\n        ((__local int64_t *) local_mem_29199)[squot64(byte_offsets_29195,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_29191)] =\n            private_mem_29209[(int64_t) 8];\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t acc_29239;\n    \n    // Scan results (with warp scan)\n    {\n        int64_t x_29236;\n        int64_t x_29237;\n        int64_t x_29240;\n        int64_t x_29241;\n        bool ltid_in_bounds_29243;\n        \n        ltid_in_bounds_29243 = slt64(sext_i32_i64(local_tid_29191),\n                                     segscan_group_sizze_27818);\n        \n        int32_t skip_threads_29244;\n        \n        // read input for in-block scan\n        {\n            if (ltid_in_bounds_29243) {\n                x_29237 = ((volatile __local\n                            int64_t *) local_mem_29199)[squot64(byte_offsets_29195,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_29191)];\n                if ((local_tid_29191 - squot32(local_tid_29191, 32) * 32) ==\n                    0) {\n                    x_29236 = x_29237;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_29244 = 1;\n            while (slt32(skip_threads_29244, 32)) {\n                if (sle32(skip_threads_29244, local_tid_29191 -\n                          squot32(local_tid_29191, 32) * 32) &&\n                    ltid_in_bounds_29243) {\n                    // read operands\n                    {\n                        x_29236 = ((volatile __local\n                                    int64_t *) local_mem_29199)[squot64(byte_offsets_29195,\n                                                                        (int64_t) 8) +\n                                                            ",
            "    (sext_i32_i64(local_tid_29191) -\n                                                                 sext_i32_i64(skip_threads_29244))];\n                    }\n                    // perform operation\n                    {\n                        int64_t defunc_1_op_res_29238 = add64(x_29236, x_29237);\n                        \n                        x_29236 = defunc_1_op_res_29238;\n                    }\n                }\n                if (sle32(wave_sizze_29193, skip_threads_29244)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_29244, local_tid_29191 -\n                          squot32(local_tid_29191, 32) * 32) &&\n                    ltid_in_bounds_29243) {\n                    // write result\n                    {\n                        ((volatile __local\n                          int64_t *) local_mem_29199)[squot64(byte_offsets_29195,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_29191)] =\n                            x_29236;\n                        x_29237 = x_29236;\n                    }\n                }\n                if (sle32(wave_sizze_29193, skip_threads_29244)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_29244 *= 2;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // last thread of block 'i' writes its result to offset 'i'\n        {\n            if ((local_tid_29191 - squot32(local_tid_29191, 32) * 32) == 31 &&\n                ltid_in_bounds_29243) {\n                ((volatile __local\n                  int64_t *) local_mem_29199)[squot64(byte_offsets_29195,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_29191,\n                                                                   32))] =\n                    x_29236;",
            "\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n        {\n            int32_t skip_threads_29245;\n            \n            // read input for in-block scan\n            {\n                if (squot32(local_tid_29191, 32) == 0 && ltid_in_bounds_29243) {\n                    x_29241 = ((volatile __local\n                                int64_t *) local_mem_29199)[squot64(byte_offsets_29195,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_29191)];\n                    if ((local_tid_29191 - squot32(local_tid_29191, 32) * 32) ==\n                        0) {\n                        x_29240 = x_29241;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_29245 = 1;\n                while (slt32(skip_threads_29245, 32)) {\n                    if (sle32(skip_threads_29245, local_tid_29191 -\n                              squot32(local_tid_29191, 32) * 32) &&\n                        (squot32(local_tid_29191, 32) == 0 &&\n                         ltid_in_bounds_29243)) {\n                        // read operands\n                        {\n                            x_29240 = ((volatile __local\n                                        int64_t *) local_mem_29199)[squot64(byte_offsets_29195,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_29191) -\n                                                                     sext_i32_i64(skip_threads_29245))];\n                        }\n                        // perform operation\n                        {\n                            int64_t defunc_1_op_res_29242 = add64(x_29240,\n                   ",
            "                                               x_29241);\n                            \n                            x_29240 = defunc_1_op_res_29242;\n                        }\n                    }\n                    if (sle32(wave_sizze_29193, skip_threads_29245)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_29245, local_tid_29191 -\n                              squot32(local_tid_29191, 32) * 32) &&\n                        (squot32(local_tid_29191, 32) == 0 &&\n                         ltid_in_bounds_29243)) {\n                        // write result\n                        {\n                            ((volatile __local\n                              int64_t *) local_mem_29199)[squot64(byte_offsets_29195,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_29191)] =\n                                x_29240;\n                            x_29241 = x_29240;\n                        }\n                    }\n                    if (sle32(wave_sizze_29193, skip_threads_29245)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_29245 *= 2;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // carry-in for every block except the first\n        {\n            if (!(squot32(local_tid_29191, 32) == 0 || !ltid_in_bounds_29243)) {\n                // read operands\n                {\n                    x_29237 = x_29236;\n                    x_29236 = ((__local\n                                int64_t *) local_mem_29199)[squot64(byte_offsets_29195,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_29191,\n                                                                                  32)) ",
            "-\n                                                             (int64_t) 1)];\n                }\n                // perform operation\n                {\n                    int64_t defunc_1_op_res_29238 = add64(x_29236, x_29237);\n                    \n                    x_29236 = defunc_1_op_res_29238;\n                }\n                // write final result\n                {\n                    ((__local\n                      int64_t *) local_mem_29199)[squot64(byte_offsets_29195,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_29191)] =\n                        x_29236;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // restore correct values for first block\n        {\n            if (squot32(local_tid_29191, 32) == 0) {\n                ((__local\n                  int64_t *) local_mem_29199)[squot64(byte_offsets_29195,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_29191)] =\n                    x_29237;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_tid_29191 == 0) {\n            acc_29239 = ((__local\n                          int64_t *) local_mem_29199)[squot64(byte_offsets_29195,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_27818 -\n                                                       (int64_t) 1)];\n        } else {\n            acc_29239 = ((__local\n                          int64_t *) local_mem_29199)[squot64(byte_offsets_29195,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_29191) -\n                                                       (int64_t) 1)];\n        ",
            "}\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t prefix_29246;\n    \n    prefix_29246 = (int64_t) 0;\n    // Perform lookback\n    {\n        if (dynamic_id_29207 == (int64_t) 0 && local_tid_29191 == 0) {\n            ((volatile __global\n              int64_t *) incprefixes_mem_29179)[dynamic_id_29207] = acc_29239;\n            mem_fence_global();\n            ((volatile __global\n              int8_t *) status_flags_mem_29175)[dynamic_id_29207] = (int8_t) 2;\n            acc_29239 = (int64_t) 0;\n        }\n        if (!(dynamic_id_29207 == (int64_t) 0) && slt32(local_tid_29191,\n                                                        wave_sizze_29193)) {\n            if (local_tid_29191 == 0) {\n                ((volatile __global\n                  int64_t *) aggregates_mem_29177)[dynamic_id_29207] =\n                    acc_29239;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_29175)[dynamic_id_29207] =\n                    (int8_t) 1;\n                ((__local int8_t *) local_mem_29199)[(int64_t) 0] = ((__global\n                                                                      int8_t *) status_flags_mem_29175)[dynamic_id_29207 -\n                                                                                                        (int64_t) 1];\n            }\n            mem_fence_local();\n            \n            int8_t status_29247;\n            \n            status_29247 = ((__local int8_t *) local_mem_29199)[(int64_t) 0];\n            if (status_29247 == (int8_t) 2) {\n                if (local_tid_29191 == 0) {\n                    prefix_29246 = ((volatile __global\n                                     int64_t *) incprefixes_mem_29179)[dynamic_id_29207 -\n                                                                       (int64_t) 1];\n                }\n            } else {\n                int32_t readOffset_29248 = dynamic_id_29207 -\n                        sext_i32_i64(wave_sizze_29193);\n",
            "                \n                while (slt32(wave_sizze_29193 * -1, readOffset_29248)) {\n                    int32_t read_i_29249 = readOffset_29248 + local_tid_29191;\n                    int64_t aggr_29250 = (int64_t) 0;\n                    int8_t flag_29251 = (int8_t) 0;\n                    int8_t used_29252 = (int8_t) 0;\n                    \n                    if (sle32(0, read_i_29249)) {\n                        flag_29251 = ((volatile __global\n                                       int8_t *) status_flags_mem_29175)[sext_i32_i64(read_i_29249)];\n                        if (flag_29251 == (int8_t) 2) {\n                            aggr_29250 = ((volatile __global\n                                           int64_t *) incprefixes_mem_29179)[sext_i32_i64(read_i_29249)];\n                        } else {\n                            if (flag_29251 == (int8_t) 1) {\n                                aggr_29250 = ((volatile __global\n                                               int64_t *) aggregates_mem_29177)[sext_i32_i64(read_i_29249)];\n                                used_29252 = (int8_t) 1;\n                            }\n                        }\n                    }\n                    ((__local\n                      int64_t *) local_mem_29199)[squot64(warp_byte_offset_29197,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_29191)] =\n                        aggr_29250;\n                    \n                    int8_t tmp_29253;\n                    \n                    tmp_29253 = flag_29251 | used_29252 << (int8_t) 2;\n                    ((__local\n                      int8_t *) local_mem_29199)[sext_i32_i64(local_tid_29191)] =\n                        tmp_29253;\n                    mem_fence_local();\n                    flag_29251 = ((volatile __local\n                                   int8_t *) local_mem_29199)[sext_i32_i64(wave_sizze_29193) -\n                              ",
            "                                (int64_t) 1];\n                    if (local_tid_29191 == 0) {\n                        if (!(flag_29251 == (int8_t) 2)) {\n                            int64_t x_29254 = (int64_t) 0;\n                            int64_t x_29255;\n                            int8_t flag1_29257;\n                            \n                            flag1_29257 = (int8_t) 0;\n                            \n                            int8_t flag2_29258;\n                            int8_t used1_29259;\n                            \n                            used1_29259 = (int8_t) 0;\n                            \n                            int8_t used2_29260;\n                            \n                            for (int32_t i_29261 = 0; i_29261 <\n                                 wave_sizze_29193; i_29261++) {\n                                flag2_29258 = ((__local\n                                                int8_t *) local_mem_29199)[sext_i32_i64(i_29261)];\n                                used2_29260 = lshr8(flag2_29258, (int8_t) 2);\n                                flag2_29258 = flag2_29258 & (int8_t) 3;\n                                x_29255 = ((__local\n                                            int64_t *) local_mem_29199)[squot64(warp_byte_offset_29197,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_29261)];\n                                if (!(flag2_29258 == (int8_t) 1)) {\n                                    flag1_29257 = flag2_29258;\n                                    used1_29259 = used2_29260;\n                                    x_29254 = x_29255;\n                                } else {\n                                    used1_29259 += used2_29260;\n                                    \n                                    int64_t defunc_1_op_res_29256;\n                                    \n                       ",
            "             defunc_1_op_res_29256 = add64(x_29254,\n                                                                  x_29255);\n                                    x_29254 = defunc_1_op_res_29256;\n                                }\n                            }\n                            flag_29251 = flag1_29257;\n                            used_29252 = used1_29259;\n                            aggr_29250 = x_29254;\n                        } else {\n                            aggr_29250 = ((__local\n                                           int64_t *) local_mem_29199)[squot64(warp_byte_offset_29197,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_29193) -\n                                                                        (int64_t) 1)];\n                        }\n                        if (flag_29251 == (int8_t) 2) {\n                            readOffset_29248 = wave_sizze_29193 * -1;\n                        } else {\n                            readOffset_29248 -= zext_i8_i32(used_29252);\n                        }\n                        ((__local int32_t *) local_mem_29199)[(int64_t) 0] =\n                            readOffset_29248;\n                        \n                        int64_t x_29262;\n                        \n                        x_29262 = aggr_29250;\n                        \n                        int64_t x_29263;\n                        \n                        x_29263 = prefix_29246;\n                        \n                        int64_t defunc_1_op_res_29264;\n                        \n                        defunc_1_op_res_29264 = add64(x_29262, x_29263);\n                        prefix_29246 = defunc_1_op_res_29264;\n                    }\n                    mem_fence_local();\n                    readOffset_29248 = ((__local\n                                         int32_t *) local_mem_29199)[(int64",
            "_t) 0];\n                }\n            }\n            if (local_tid_29191 == 0) {\n                int64_t x_29265 = prefix_29246;\n                int64_t x_29266 = acc_29239;\n                int64_t defunc_1_op_res_29267 = add64(x_29265, x_29266);\n                \n                ((volatile __global\n                  int64_t *) incprefixes_mem_29179)[dynamic_id_29207] =\n                    defunc_1_op_res_29267;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_29175)[dynamic_id_29207] =\n                    (int8_t) 2;\n                ((__local\n                  int64_t *) local_mem_29199)[squot64(warp_byte_offset_29197,\n                                                      (int64_t) 8)] =\n                    prefix_29246;\n                acc_29239 = (int64_t) 0;\n            }\n        }\n        if (!(dynamic_id_29207 == (int64_t) 0)) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            prefix_29246 = ((__local\n                             int64_t *) local_mem_29199)[squot64(warp_byte_offset_29197,\n                                                                 (int64_t) 8)];\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    // Distribute results\n    {\n        int64_t x_29268;\n        int64_t x_29269;\n        int64_t x_29271;\n        \n        x_29271 = prefix_29246;\n        \n        int64_t x_29272;\n        \n        x_29272 = acc_29239;\n        \n        int64_t defunc_1_op_res_29273;\n        \n        defunc_1_op_res_29273 = add64(x_29271, x_29272);\n        x_29268 = defunc_1_op_res_29273;\n        for (int64_t i_29274 = 0; i_29274 < (int64_t) 9; i_29274++) {\n            x_29269 = private_mem_29209[i_29274];\n            \n            int64_t defunc_1_op_res_29270;\n            \n            defunc_1_op_res_29270 = add64(x_29268, x_29269);\n            private_mem_29209[i_29274] = defunc_1_op_res_29270;\n        }\n    }\n    // Transpose scan output\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n   ",
            "     for (int64_t i_29275 = 0; i_29275 < (int64_t) 9; i_29275++) {\n            int64_t sharedIdx_29276 = sext_i32_i64(local_tid_29191 * 9) +\n                    i_29275;\n            \n            ((__local int64_t *) local_mem_29199)[sharedIdx_29276] =\n                private_mem_29209[i_29275];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29277 = 0; i_29277 < (int64_t) 9; i_29277++) {\n            int32_t sharedIdx_29278 = local_tid_29191 +\n                    sext_i64_i32(segscan_group_sizze_27818 * i_29277);\n            \n            private_mem_29209[i_29277] = ((__local\n                                           int64_t *) local_mem_29199)[sext_i32_i64(sharedIdx_29278)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Write block scan results to global memory\n    {\n        for (int64_t i_29279 = 0; i_29279 < (int64_t) 9; i_29279++) {\n            int64_t gtid_27822 = blockOff_29208 + segscan_group_sizze_27818 *\n                    i_29279 + sext_i32_i64(local_tid_29191);\n            \n            if (slt64(gtid_27822, m_26408)) {\n                ((__global int64_t *) mem_28337)[gtid_27822] =\n                    private_mem_29209[i_29279];\n            }\n        }\n    }\n    // If this is the last block, reset the dynamicId\n    {\n        if (dynamic_id_29207 == sdiv_up64(m_26408, segscan_group_sizze_27818 *\n                                          (int64_t) 9) - (int64_t) 1) {\n            ((__global\n              int32_t *) eWiseAddMultEntryziid_counter_mem_29173)[(int64_t) 0] =\n                0;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_27818\n}\n__kernel void eWiseAddMultEntryzisegscan_27831(__global int *global_failure,\n                                               uint local_mem_29354_backing_offset_0,\n                                               int64_t conc_tmp_26655,\n                                               int64_t i32_res_26693,\n                                               int64_",
            "t i32_res_26694, __global\n                                               unsigned char *mem_param_28374,\n                                               __global\n                                               unsigned char *mem_28386,\n                                               __global\n                                               unsigned char *mem_28388,\n                                               __global\n                                               unsigned char *mem_28390,\n                                               __global\n                                               unsigned char *mem_28392,\n                                               __global\n                                               unsigned char *mem_28394,\n                                               __global\n                                               unsigned char *eWiseAddMultEntryziid_counter_mem_29319,\n                                               __global\n                                               unsigned char *status_flags_mem_29321,\n                                               __global\n                                               unsigned char *aggregates_mem_29323,\n                                               __global\n                                               unsigned char *incprefixes_mem_29325,\n                                               __global\n                                               unsigned char *aggregates_mem_29327,\n                                               __global\n                                               unsigned char *incprefixes_mem_29329,\n                                               __global\n                                               unsigned char *aggregates_mem_29331,\n                                               __global\n                                               unsigned char *incprefixes_mem_29333,\n                                               __global\n                                               uns",
            "igned char *aggregates_mem_29335,\n                                               __global\n                                               unsigned char *incprefixes_mem_29337)\n{\n    #define segscan_group_sizze_27826 (eWiseAddMultEntryzisegscan_group_sizze_27825)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *local_mem_29354_backing_0 =\n                  &shared_mem[local_mem_29354_backing_offset_0];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29339;\n    int32_t local_tid_29340;\n    int64_t group_sizze_29343;\n    int32_t wave_sizze_29342;\n    int32_t group_tid_29341;\n    \n    global_tid_29339 = get_global_id(0);\n    local_tid_29340 = get_local_id(0);\n    group_sizze_29343 = get_local_size(0);\n    wave_sizze_29342 = LOCKSTEP_WIDTH;\n    group_tid_29341 = get_group_id(0);\n    \n    int32_t phys_tid_27831;\n    \n    phys_tid_27831 = global_tid_29339;\n    \n    int64_t byte_offsets_29344;\n    \n    byte_offsets_29344 = (int64_t) 0;\n    \n    int64_t byte_offsets_29345;\n    \n    byte_offsets_29345 = segscan_group_sizze_27826 * (int64_t) 8;\n    \n    int64_t byte_offsets_29346;\n    \n    byte_offsets_29346 = sdiv_up64(segscan_group_sizze_27826 * (int64_t) 8,\n                                   (int64_t) 8) * (int64_t) 8 +\n        segscan_group_sizze_27826 * (int64_t) 8;\n    \n    int64_t byte_offsets_29347;\n    \n    byte_offsets_29347 = sdiv_up64(sdiv_up64(segscan_group_sizze_27826 *\n                                             (int64_t) 8, (int64_t) 8) *\n                                   (int64_t) 8 + segscan_group_sizze_27826 *\n                                   (int64_t) 8, (int64_t) 8) * (int64_t) 8 +\n        segscan_group_sizze_27826 * (int64_t) 8;\n    \n    int64_t byte_offsets_29348;\n    \n    byte_offsets_29348 =\n        sdiv_up64(sdiv_up64(sdiv_up64(segscan_group_sizze_27826 * (int64_t) 8,\n                                      (int64_t) 8) * (int64_t) 8 +\n                    ",
            "        segscan_group_sizze_27826 * (int64_t) 8,\n                            (int64_t) 8) * (int64_t) 8 +\n                  segscan_group_sizze_27826 * (int64_t) 8, (int64_t) 8) *\n        (int64_t) 8 + segscan_group_sizze_27826 * (int64_t) 8;\n    \n    int64_t warp_byte_offset_29349;\n    \n    warp_byte_offset_29349 = (int64_t) 32;\n    \n    int64_t warp_byte_offset_29350;\n    \n    warp_byte_offset_29350 = (int64_t) 288;\n    \n    int64_t warp_byte_offset_29351;\n    \n    warp_byte_offset_29351 = (int64_t) 544;\n    \n    int64_t warp_byte_offset_29352;\n    \n    warp_byte_offset_29352 = (int64_t) 800;\n    \n    int64_t warp_byte_offset_29353;\n    \n    warp_byte_offset_29353 = (int64_t) 1056;\n    // Allocate reused shared memeory\n    { }\n    \n    __local char *local_mem_29354;\n    \n    local_mem_29354 = (__local char *) local_mem_29354_backing_0;\n    \n    int64_t trans_arr_len_29355;\n    \n    trans_arr_len_29355 = (int64_t) 9 * segscan_group_sizze_27826;\n    \n    int32_t dynamic_id_29371;\n    \n    if (local_tid_29340 == 0) {\n        dynamic_id_29371 = atomic_add_i32_global(&((volatile __global\n                                                    int *) eWiseAddMultEntryziid_counter_mem_29319)[(int64_t) 0],\n                                                 (int) 1);\n        ((__local int32_t *) local_mem_29354)[(int64_t) 0] = dynamic_id_29371;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    dynamic_id_29371 = ((__local int32_t *) local_mem_29354)[(int64_t) 0];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t blockOff_29372;\n    \n    blockOff_29372 = sext_i32_i64(dynamic_id_29371) * (int64_t) 9 *\n        segscan_group_sizze_27826;\n    \n    int64_t private_mem_29373[9];\n    int64_t private_mem_29375[9];\n    int64_t private_mem_29377[9];\n    int64_t private_mem_29379[9];\n    \n    // Load and map\n    {\n        for (int64_t i_29381 = 0; i_29381 < (int64_t) 9; i_29381++) {\n            int64_t gtid_27830 = blockOff_29372 +\n                    sext_i32_i64(local_tid_29340) + i_29381 *\n  ",
            "                  segscan_group_sizze_27826;\n            \n            if (slt64(gtid_27830, conc_tmp_26655)) {\n                int64_t x_26722 = ((__global\n                                    int64_t *) mem_param_28374)[gtid_27830];\n                int64_t zgzg_res_26723 = ashr64(x_26722, i32_res_26693);\n                int64_t za_res_26724 = (int64_t) 1 & zgzg_res_26723;\n                int32_t to_i32_res_26725 = sext_i64_i32(za_res_26724);\n                int32_t x_26726 = mul32(2, to_i32_res_26725);\n                int64_t zgzg_res_26727 = ashr64(x_26722, i32_res_26694);\n                int64_t za_res_26728 = (int64_t) 1 & zgzg_res_26727;\n                int32_t to_i32_res_26729 = sext_i64_i32(za_res_26728);\n                int32_t defunc_0_f_res_26730 = add32(x_26726, to_i32_res_26729);\n                bool cond_26731 = defunc_0_f_res_26730 == 0;\n                int64_t defunc_0_f_res_26732 = btoi_bool_i64(cond_26731);\n                int64_t defunc_0_f_res_26733;\n                int64_t defunc_0_f_res_26734;\n                int64_t defunc_0_f_res_26735;\n                \n                if (cond_26731) {\n                    defunc_0_f_res_26733 = (int64_t) 0;\n                    defunc_0_f_res_26734 = (int64_t) 0;\n                    defunc_0_f_res_26735 = (int64_t) 0;\n                } else {\n                    bool cond_26736 = defunc_0_f_res_26730 == 1;\n                    int64_t defunc_0_f_res_f_res_26737 =\n                            btoi_bool_i64(cond_26736);\n                    int64_t defunc_0_f_res_f_res_26738;\n                    int64_t defunc_0_f_res_f_res_26739;\n                    \n                    if (cond_26736) {\n                        defunc_0_f_res_f_res_26738 = (int64_t) 0;\n                        defunc_0_f_res_f_res_26739 = (int64_t) 0;\n                    } else {\n                        bool cond_26740 = defunc_0_f_res_26730 == 2;\n                        int64_t defunc_0_f_res_f_res_f_res_26741 =\n                                btoi",
            "_bool_i64(cond_26740);\n                        bool cond_neg_26742 = !cond_26740;\n                        int64_t defunc_0_f_res_f_res_f_res_26743 =\n                                btoi_bool_i64(cond_neg_26742);\n                        \n                        defunc_0_f_res_f_res_26738 =\n                            defunc_0_f_res_f_res_f_res_26741;\n                        defunc_0_f_res_f_res_26739 =\n                            defunc_0_f_res_f_res_f_res_26743;\n                    }\n                    defunc_0_f_res_26733 = defunc_0_f_res_f_res_26737;\n                    defunc_0_f_res_26734 = defunc_0_f_res_f_res_26738;\n                    defunc_0_f_res_26735 = defunc_0_f_res_f_res_26739;\n                }\n                ((__global int32_t *) mem_28394)[gtid_27830] =\n                    defunc_0_f_res_26730;\n                private_mem_29373[i_29381] = defunc_0_f_res_26732;\n                private_mem_29375[i_29381] = defunc_0_f_res_26733;\n                private_mem_29377[i_29381] = defunc_0_f_res_26734;\n                private_mem_29379[i_29381] = defunc_0_f_res_26735;\n            } else {\n                private_mem_29373[i_29381] = (int64_t) 0;\n                private_mem_29375[i_29381] = (int64_t) 0;\n                private_mem_29377[i_29381] = (int64_t) 0;\n                private_mem_29379[i_29381] = (int64_t) 0;\n            }\n        }\n    }\n    // Transpose scan inputs\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29382 = 0; i_29382 < (int64_t) 9; i_29382++) {\n            int64_t sharedIdx_29383 = sext_i32_i64(local_tid_29340) + i_29382 *\n                    segscan_group_sizze_27826;\n            \n            ((__local int64_t *) local_mem_29354)[sharedIdx_29383] =\n                private_mem_29373[i_29382];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_29384 = 0; i_29384 < 9; i_29384++) {\n            int32_t sharedIdx_29385 = local_tid_29340 * 9 + i_29384;\n            \n            private_mem_29373[sext_i32",
            "_i64(i_29384)] = ((__local\n                                                         int64_t *) local_mem_29354)[sext_i32_i64(sharedIdx_29385)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29386 = 0; i_29386 < (int64_t) 9; i_29386++) {\n            int64_t sharedIdx_29387 = sext_i32_i64(local_tid_29340) + i_29386 *\n                    segscan_group_sizze_27826;\n            \n            ((__local int64_t *) local_mem_29354)[sharedIdx_29387] =\n                private_mem_29375[i_29386];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_29388 = 0; i_29388 < 9; i_29388++) {\n            int32_t sharedIdx_29389 = local_tid_29340 * 9 + i_29388;\n            \n            private_mem_29375[sext_i32_i64(i_29388)] = ((__local\n                                                         int64_t *) local_mem_29354)[sext_i32_i64(sharedIdx_29389)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29390 = 0; i_29390 < (int64_t) 9; i_29390++) {\n            int64_t sharedIdx_29391 = sext_i32_i64(local_tid_29340) + i_29390 *\n                    segscan_group_sizze_27826;\n            \n            ((__local int64_t *) local_mem_29354)[sharedIdx_29391] =\n                private_mem_29377[i_29390];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_29392 = 0; i_29392 < 9; i_29392++) {\n            int32_t sharedIdx_29393 = local_tid_29340 * 9 + i_29392;\n            \n            private_mem_29377[sext_i32_i64(i_29392)] = ((__local\n                                                         int64_t *) local_mem_29354)[sext_i32_i64(sharedIdx_29393)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29394 = 0; i_29394 < (int64_t) 9; i_29394++) {\n            int64_t sharedIdx_29395 = sext_i32_i64(local_tid_29340) + i_29394 *\n                    segscan_group_sizze_27826;\n            \n            ((__local int64_t *) local_mem_29354)[sharedIdx_29395] =\n                private_mem_29379[i_29394];",
            "\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_29396 = 0; i_29396 < 9; i_29396++) {\n            int32_t sharedIdx_29397 = local_tid_29340 * 9 + i_29396;\n            \n            private_mem_29379[sext_i32_i64(i_29396)] = ((__local\n                                                         int64_t *) local_mem_29354)[sext_i32_i64(sharedIdx_29397)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Per thread scan\n    {\n        for (int64_t i_29398 = 0; i_29398 < (int64_t) 8; i_29398++) {\n            int64_t x_26710;\n            int64_t x_26714;\n            \n            x_26710 = private_mem_29373[i_29398];\n            x_26714 = private_mem_29373[i_29398 + (int64_t) 1];\n            \n            int64_t x_26711;\n            int64_t x_26715;\n            \n            x_26711 = private_mem_29375[i_29398];\n            x_26715 = private_mem_29375[i_29398 + (int64_t) 1];\n            \n            int64_t x_26712;\n            int64_t x_26716;\n            \n            x_26712 = private_mem_29377[i_29398];\n            x_26716 = private_mem_29377[i_29398 + (int64_t) 1];\n            \n            int64_t x_26713;\n            int64_t x_26717;\n            \n            x_26713 = private_mem_29379[i_29398];\n            x_26717 = private_mem_29379[i_29398 + (int64_t) 1];\n            \n            int64_t defunc_1_op_res_26718;\n            \n            defunc_1_op_res_26718 = add64(x_26710, x_26714);\n            \n            int64_t defunc_1_op_res_26719 = add64(x_26711, x_26715);\n            int64_t defunc_1_op_res_26720 = add64(x_26712, x_26716);\n            int64_t defunc_1_op_res_26721 = add64(x_26713, x_26717);\n            \n            private_mem_29373[i_29398 + (int64_t) 1] = defunc_1_op_res_26718;\n            private_mem_29375[i_29398 + (int64_t) 1] = defunc_1_op_res_26719;\n            private_mem_29377[i_29398 + (int64_t) 1] = defunc_1_op_res_26720;\n            private_mem_29379[i_29398 + (int64_t) 1] = defunc_1_op_res_26721;\n        }\n    }\n    ",
            "// Publish results in shared memory\n    {\n        ((__local int64_t *) local_mem_29354)[squot64(byte_offsets_29344,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_29340)] =\n            private_mem_29373[(int64_t) 8];\n        ((__local int64_t *) local_mem_29354)[squot64(byte_offsets_29345,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_29340)] =\n            private_mem_29375[(int64_t) 8];\n        ((__local int64_t *) local_mem_29354)[squot64(byte_offsets_29346,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_29340)] =\n            private_mem_29377[(int64_t) 8];\n        ((__local int64_t *) local_mem_29354)[squot64(byte_offsets_29347,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_29340)] =\n            private_mem_29379[(int64_t) 8];\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t acc_29411;\n    int64_t acc_29412;\n    int64_t acc_29413;\n    int64_t acc_29414;\n    \n    // Scan results (with warp scan)\n    {\n        int64_t x_29399;\n        int64_t x_29400;\n        int64_t x_29401;\n        int64_t x_29402;\n        int64_t x_29403;\n        int64_t x_29404;\n        int64_t x_29405;\n        int64_t x_29406;\n        int64_t x_29415;\n        int64_t x_29416;\n        int64_t x_29417;\n        int64_t x_29418;\n        int64_t x_29419;\n        int64_t x_29420;\n        int64_t x_29421;\n        int64_t x_29422;\n        bool ltid_in_bounds_29427;\n        \n        ltid_in_bounds_29427 = slt64(sext_i32_i64(local_tid_29340),\n                                     segscan_group_sizze_27826);\n        \n        int32_t skip_threads_29428;\n        \n        // read input for in-block scan\n        {\n            if (ltid_in_",
            "bounds_29427) {\n                x_29403 = ((volatile __local\n                            int64_t *) local_mem_29354)[squot64(byte_offsets_29344,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_29340)];\n                x_29404 = ((volatile __local\n                            int64_t *) local_mem_29354)[squot64(byte_offsets_29345,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_29340)];\n                x_29405 = ((volatile __local\n                            int64_t *) local_mem_29354)[squot64(byte_offsets_29346,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_29340)];\n                x_29406 = ((volatile __local\n                            int64_t *) local_mem_29354)[squot64(byte_offsets_29347,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_29340)];\n                if ((local_tid_29340 - squot32(local_tid_29340, 32) * 32) ==\n                    0) {\n                    x_29399 = x_29403;\n                    x_29400 = x_29404;\n                    x_29401 = x_29405;\n                    x_29402 = x_29406;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_29428 = 1;\n            while (slt32(skip_threads_29428, 32)) {\n                if (sle32(skip_threads_29428, local_tid_29340 -\n                          squot32(local_tid_29340, 32) * 32) &&\n                    ltid_in_bounds_29427) {\n                    // read operands\n                    {\n                        x_29399 = ((volatile __local\n                                    int64_t *) local_mem_29354",
            ")[squot64(byte_offsets_29344,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_29340) -\n                                                                 sext_i32_i64(skip_threads_29428))];\n                        x_29400 = ((volatile __local\n                                    int64_t *) local_mem_29354)[squot64(byte_offsets_29345,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_29340) -\n                                                                 sext_i32_i64(skip_threads_29428))];\n                        x_29401 = ((volatile __local\n                                    int64_t *) local_mem_29354)[squot64(byte_offsets_29346,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_29340) -\n                                                                 sext_i32_i64(skip_threads_29428))];\n                        x_29402 = ((volatile __local\n                                    int64_t *) local_mem_29354)[squot64(byte_offsets_29347,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_29340) -\n                                                                 sext_i32_i64(skip_threads_29428))];\n                    }\n                    // perform operation\n                    {\n                        int64_t defunc_1_op_res_29407 = add64(x_29399, x_29403);\n                        int64_t defunc_1_op_res_29408 = add64(x_29400, x_29404);\n                        int64_t defunc_1_op_res_29409 = add64(x_29401, x_29405);\n                        int64_t defunc_1_op_res_29410 = add64(x_294",
            "02, x_29406);\n                        \n                        x_29399 = defunc_1_op_res_29407;\n                        x_29400 = defunc_1_op_res_29408;\n                        x_29401 = defunc_1_op_res_29409;\n                        x_29402 = defunc_1_op_res_29410;\n                    }\n                }\n                if (sle32(wave_sizze_29342, skip_threads_29428)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_29428, local_tid_29340 -\n                          squot32(local_tid_29340, 32) * 32) &&\n                    ltid_in_bounds_29427) {\n                    // write result\n                    {\n                        ((volatile __local\n                          int64_t *) local_mem_29354)[squot64(byte_offsets_29344,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_29340)] =\n                            x_29399;\n                        x_29403 = x_29399;\n                        ((volatile __local\n                          int64_t *) local_mem_29354)[squot64(byte_offsets_29345,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_29340)] =\n                            x_29400;\n                        x_29404 = x_29400;\n                        ((volatile __local\n                          int64_t *) local_mem_29354)[squot64(byte_offsets_29346,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_29340)] =\n                            x_29401;\n                        x_29405 = x_29401;\n                        ((volatile __local\n                          int64_t *) local_mem_29354)[squot64(byte_offsets_29347,\n                                                              (int64_t) 8) +\n                   ",
            "                                   sext_i32_i64(local_tid_29340)] =\n                            x_29402;\n                        x_29406 = x_29402;\n                    }\n                }\n                if (sle32(wave_sizze_29342, skip_threads_29428)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_29428 *= 2;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // last thread of block 'i' writes its result to offset 'i'\n        {\n            if ((local_tid_29340 - squot32(local_tid_29340, 32) * 32) == 31 &&\n                ltid_in_bounds_29427) {\n                ((volatile __local\n                  int64_t *) local_mem_29354)[squot64(byte_offsets_29344,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_29340,\n                                                                   32))] =\n                    x_29399;\n                ((volatile __local\n                  int64_t *) local_mem_29354)[squot64(byte_offsets_29345,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_29340,\n                                                                   32))] =\n                    x_29400;\n                ((volatile __local\n                  int64_t *) local_mem_29354)[squot64(byte_offsets_29346,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_29340,\n                                                                   32))] =\n                    x_29401;\n                ((volatile __local\n                  int64_t *) local_mem_29354)[squot64(byte_offsets_29347,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_29340,\n                 ",
            "                                                  32))] =\n                    x_29402;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n        {\n            int32_t skip_threads_29429;\n            \n            // read input for in-block scan\n            {\n                if (squot32(local_tid_29340, 32) == 0 && ltid_in_bounds_29427) {\n                    x_29419 = ((volatile __local\n                                int64_t *) local_mem_29354)[squot64(byte_offsets_29344,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_29340)];\n                    x_29420 = ((volatile __local\n                                int64_t *) local_mem_29354)[squot64(byte_offsets_29345,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_29340)];\n                    x_29421 = ((volatile __local\n                                int64_t *) local_mem_29354)[squot64(byte_offsets_29346,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_29340)];\n                    x_29422 = ((volatile __local\n                                int64_t *) local_mem_29354)[squot64(byte_offsets_29347,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_29340)];\n                    if ((local_tid_29340 - squot32(local_tid_29340, 32) * 32) ==\n                        0) {\n                        x_29415 = x_29419;\n                        x_29416 = x_29420;\n                        x_29417 = x_29421;\n                        x_29418 = x_29422;\n                    }\n       ",
            "         }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_29429 = 1;\n                while (slt32(skip_threads_29429, 32)) {\n                    if (sle32(skip_threads_29429, local_tid_29340 -\n                              squot32(local_tid_29340, 32) * 32) &&\n                        (squot32(local_tid_29340, 32) == 0 &&\n                         ltid_in_bounds_29427)) {\n                        // read operands\n                        {\n                            x_29415 = ((volatile __local\n                                        int64_t *) local_mem_29354)[squot64(byte_offsets_29344,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_29340) -\n                                                                     sext_i32_i64(skip_threads_29429))];\n                            x_29416 = ((volatile __local\n                                        int64_t *) local_mem_29354)[squot64(byte_offsets_29345,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_29340) -\n                                                                     sext_i32_i64(skip_threads_29429))];\n                            x_29417 = ((volatile __local\n                                        int64_t *) local_mem_29354)[squot64(byte_offsets_29346,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_29340) -\n                                                                     sext_i32_i64(skip_threads_29429))];\n                            x_29418 = ((volatile __local\n                                        int64_t *) local_mem_29354)[squot64(byte_of",
            "fsets_29347,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_29340) -\n                                                                     sext_i32_i64(skip_threads_29429))];\n                        }\n                        // perform operation\n                        {\n                            int64_t defunc_1_op_res_29423 = add64(x_29415,\n                                                                  x_29419);\n                            int64_t defunc_1_op_res_29424 = add64(x_29416,\n                                                                  x_29420);\n                            int64_t defunc_1_op_res_29425 = add64(x_29417,\n                                                                  x_29421);\n                            int64_t defunc_1_op_res_29426 = add64(x_29418,\n                                                                  x_29422);\n                            \n                            x_29415 = defunc_1_op_res_29423;\n                            x_29416 = defunc_1_op_res_29424;\n                            x_29417 = defunc_1_op_res_29425;\n                            x_29418 = defunc_1_op_res_29426;\n                        }\n                    }\n                    if (sle32(wave_sizze_29342, skip_threads_29429)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_29429, local_tid_29340 -\n                              squot32(local_tid_29340, 32) * 32) &&\n                        (squot32(local_tid_29340, 32) == 0 &&\n                         ltid_in_bounds_29427)) {\n                        // write result\n                        {\n                            ((volatile __local\n                              int64_t *) local_mem_29354)[squot64(byte_offsets_29344,\n                                                                  (int64_t",
            ") 8) +\n                                                          sext_i32_i64(local_tid_29340)] =\n                                x_29415;\n                            x_29419 = x_29415;\n                            ((volatile __local\n                              int64_t *) local_mem_29354)[squot64(byte_offsets_29345,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_29340)] =\n                                x_29416;\n                            x_29420 = x_29416;\n                            ((volatile __local\n                              int64_t *) local_mem_29354)[squot64(byte_offsets_29346,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_29340)] =\n                                x_29417;\n                            x_29421 = x_29417;\n                            ((volatile __local\n                              int64_t *) local_mem_29354)[squot64(byte_offsets_29347,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_29340)] =\n                                x_29418;\n                            x_29422 = x_29418;\n                        }\n                    }\n                    if (sle32(wave_sizze_29342, skip_threads_29429)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_29429 *= 2;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // carry-in for every block except the first\n        {\n            if (!(squot32(local_tid_29340, 32) == 0 || !ltid_in_bounds_29427)) {\n                // read operands\n                {\n                    x_29403 = x_29399;\n                    x_29404 = x_29400;\n                    x_29405 = x_29401;\n   ",
            "                 x_29406 = x_29402;\n                    x_29399 = ((__local\n                                int64_t *) local_mem_29354)[squot64(byte_offsets_29344,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_29340,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                    x_29400 = ((__local\n                                int64_t *) local_mem_29354)[squot64(byte_offsets_29345,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_29340,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                    x_29401 = ((__local\n                                int64_t *) local_mem_29354)[squot64(byte_offsets_29346,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_29340,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                    x_29402 = ((__local\n                                int64_t *) local_mem_29354)[squot64(byte_offsets_29347,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_29340,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                }\n                // perform operation\n         ",
            "       {\n                    int64_t defunc_1_op_res_29407 = add64(x_29399, x_29403);\n                    int64_t defunc_1_op_res_29408 = add64(x_29400, x_29404);\n                    int64_t defunc_1_op_res_29409 = add64(x_29401, x_29405);\n                    int64_t defunc_1_op_res_29410 = add64(x_29402, x_29406);\n                    \n                    x_29399 = defunc_1_op_res_29407;\n                    x_29400 = defunc_1_op_res_29408;\n                    x_29401 = defunc_1_op_res_29409;\n                    x_29402 = defunc_1_op_res_29410;\n                }\n                // write final result\n                {\n                    ((__local\n                      int64_t *) local_mem_29354)[squot64(byte_offsets_29344,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_29340)] =\n                        x_29399;\n                    ((__local\n                      int64_t *) local_mem_29354)[squot64(byte_offsets_29345,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_29340)] =\n                        x_29400;\n                    ((__local\n                      int64_t *) local_mem_29354)[squot64(byte_offsets_29346,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_29340)] =\n                        x_29401;\n                    ((__local\n                      int64_t *) local_mem_29354)[squot64(byte_offsets_29347,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_29340)] =\n                        x_29402;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // restore correct values for first block\n        {\n            if (squot32(local_tid_29340, 32) == ",
            "0) {\n                ((__local\n                  int64_t *) local_mem_29354)[squot64(byte_offsets_29344,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_29340)] =\n                    x_29403;\n                ((__local\n                  int64_t *) local_mem_29354)[squot64(byte_offsets_29345,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_29340)] =\n                    x_29404;\n                ((__local\n                  int64_t *) local_mem_29354)[squot64(byte_offsets_29346,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_29340)] =\n                    x_29405;\n                ((__local\n                  int64_t *) local_mem_29354)[squot64(byte_offsets_29347,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_29340)] =\n                    x_29406;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_tid_29340 == 0) {\n            acc_29411 = ((__local\n                          int64_t *) local_mem_29354)[squot64(byte_offsets_29344,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_27826 -\n                                                       (int64_t) 1)];\n            acc_29412 = ((__local\n                          int64_t *) local_mem_29354)[squot64(byte_offsets_29345,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_27826 -\n                                                       (int64_t) 1)];\n            acc_29413 = ((__local\n                         ",
            " int64_t *) local_mem_29354)[squot64(byte_offsets_29346,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_27826 -\n                                                       (int64_t) 1)];\n            acc_29414 = ((__local\n                          int64_t *) local_mem_29354)[squot64(byte_offsets_29347,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_27826 -\n                                                       (int64_t) 1)];\n        } else {\n            acc_29411 = ((__local\n                          int64_t *) local_mem_29354)[squot64(byte_offsets_29344,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_29340) -\n                                                       (int64_t) 1)];\n            acc_29412 = ((__local\n                          int64_t *) local_mem_29354)[squot64(byte_offsets_29345,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_29340) -\n                                                       (int64_t) 1)];\n            acc_29413 = ((__local\n                          int64_t *) local_mem_29354)[squot64(byte_offsets_29346,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_29340) -\n                                                       (int64_t) 1)];\n            acc_29414 = ((__local\n                          int64_t *) local_mem_29354)[squot64(byte_offsets_29347,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_29340) -\n                    ",
            "                                   (int64_t) 1)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t prefix_29430;\n    \n    prefix_29430 = (int64_t) 0;\n    \n    int64_t prefix_29431;\n    \n    prefix_29431 = (int64_t) 0;\n    \n    int64_t prefix_29432;\n    \n    prefix_29432 = (int64_t) 0;\n    \n    int64_t prefix_29433;\n    \n    prefix_29433 = (int64_t) 0;\n    // Perform lookback\n    {\n        if (dynamic_id_29371 == (int64_t) 0 && local_tid_29340 == 0) {\n            ((volatile __global\n              int64_t *) incprefixes_mem_29325)[dynamic_id_29371] = acc_29411;\n            ((volatile __global\n              int64_t *) incprefixes_mem_29329)[dynamic_id_29371] = acc_29412;\n            ((volatile __global\n              int64_t *) incprefixes_mem_29333)[dynamic_id_29371] = acc_29413;\n            ((volatile __global\n              int64_t *) incprefixes_mem_29337)[dynamic_id_29371] = acc_29414;\n            mem_fence_global();\n            ((volatile __global\n              int8_t *) status_flags_mem_29321)[dynamic_id_29371] = (int8_t) 2;\n            acc_29411 = (int64_t) 0;\n            acc_29412 = (int64_t) 0;\n            acc_29413 = (int64_t) 0;\n            acc_29414 = (int64_t) 0;\n        }\n        if (!(dynamic_id_29371 == (int64_t) 0) && slt32(local_tid_29340,\n                                                        wave_sizze_29342)) {\n            if (local_tid_29340 == 0) {\n                ((volatile __global\n                  int64_t *) aggregates_mem_29323)[dynamic_id_29371] =\n                    acc_29411;\n                ((volatile __global\n                  int64_t *) aggregates_mem_29327)[dynamic_id_29371] =\n                    acc_29412;\n                ((volatile __global\n                  int64_t *) aggregates_mem_29331)[dynamic_id_29371] =\n                    acc_29413;\n                ((volatile __global\n                  int64_t *) aggregates_mem_29335)[dynamic_id_29371] =\n                    acc_29414;\n                mem_fence_global();",
            "\n                ((volatile __global\n                  int8_t *) status_flags_mem_29321)[dynamic_id_29371] =\n                    (int8_t) 1;\n                ((__local int8_t *) local_mem_29354)[(int64_t) 0] = ((__global\n                                                                      int8_t *) status_flags_mem_29321)[dynamic_id_29371 -\n                                                                                                        (int64_t) 1];\n            }\n            mem_fence_local();\n            \n            int8_t status_29434;\n            \n            status_29434 = ((__local int8_t *) local_mem_29354)[(int64_t) 0];\n            if (status_29434 == (int8_t) 2) {\n                if (local_tid_29340 == 0) {\n                    prefix_29430 = ((volatile __global\n                                     int64_t *) incprefixes_mem_29325)[dynamic_id_29371 -\n                                                                       (int64_t) 1];\n                    prefix_29431 = ((volatile __global\n                                     int64_t *) incprefixes_mem_29329)[dynamic_id_29371 -\n                                                                       (int64_t) 1];\n                    prefix_29432 = ((volatile __global\n                                     int64_t *) incprefixes_mem_29333)[dynamic_id_29371 -\n                                                                       (int64_t) 1];\n                    prefix_29433 = ((volatile __global\n                                     int64_t *) incprefixes_mem_29337)[dynamic_id_29371 -\n                                                                       (int64_t) 1];\n                }\n            } else {\n                int32_t readOffset_29435 = dynamic_id_29371 -\n                        sext_i32_i64(wave_sizze_29342);\n                \n                while (slt32(wave_sizze_29342 * -1, readOffset_29435)) {\n                    int32_t read_i_29436 = readOffset_29435 + local_tid_29340;\n                    i",
            "nt64_t aggr_29437 = (int64_t) 0;\n                    int64_t aggr_29438 = (int64_t) 0;\n                    int64_t aggr_29439 = (int64_t) 0;\n                    int64_t aggr_29440 = (int64_t) 0;\n                    int8_t flag_29441 = (int8_t) 0;\n                    int8_t used_29442 = (int8_t) 0;\n                    \n                    if (sle32(0, read_i_29436)) {\n                        flag_29441 = ((volatile __global\n                                       int8_t *) status_flags_mem_29321)[sext_i32_i64(read_i_29436)];\n                        if (flag_29441 == (int8_t) 2) {\n                            aggr_29437 = ((volatile __global\n                                           int64_t *) incprefixes_mem_29325)[sext_i32_i64(read_i_29436)];\n                            aggr_29438 = ((volatile __global\n                                           int64_t *) incprefixes_mem_29329)[sext_i32_i64(read_i_29436)];\n                            aggr_29439 = ((volatile __global\n                                           int64_t *) incprefixes_mem_29333)[sext_i32_i64(read_i_29436)];\n                            aggr_29440 = ((volatile __global\n                                           int64_t *) incprefixes_mem_29337)[sext_i32_i64(read_i_29436)];\n                        } else {\n                            if (flag_29441 == (int8_t) 1) {\n                                aggr_29437 = ((volatile __global\n                                               int64_t *) aggregates_mem_29323)[sext_i32_i64(read_i_29436)];\n                                aggr_29438 = ((volatile __global\n                                               int64_t *) aggregates_mem_29327)[sext_i32_i64(read_i_29436)];\n                                aggr_29439 = ((volatile __global\n                                               int64_t *) aggregates_mem_29331)[sext_i32_i64(read_i_29436)];\n                                aggr_29440 = ((volatile __global\n                                               int64_t *) aggregate",
            "s_mem_29335)[sext_i32_i64(read_i_29436)];\n                                used_29442 = (int8_t) 1;\n                            }\n                        }\n                    }\n                    ((__local\n                      int64_t *) local_mem_29354)[squot64(warp_byte_offset_29349,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_29340)] =\n                        aggr_29437;\n                    ((__local\n                      int64_t *) local_mem_29354)[squot64(warp_byte_offset_29350,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_29340)] =\n                        aggr_29438;\n                    ((__local\n                      int64_t *) local_mem_29354)[squot64(warp_byte_offset_29351,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_29340)] =\n                        aggr_29439;\n                    ((__local\n                      int64_t *) local_mem_29354)[squot64(warp_byte_offset_29352,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_29340)] =\n                        aggr_29440;\n                    \n                    int8_t tmp_29443;\n                    \n                    tmp_29443 = flag_29441 | used_29442 << (int8_t) 2;\n                    ((__local\n                      int8_t *) local_mem_29354)[sext_i32_i64(local_tid_29340)] =\n                        tmp_29443;\n                    mem_fence_local();\n                    flag_29441 = ((volatile __local\n                                   int8_t *) local_mem_29354)[sext_i32_i64(wave_sizze_29342) -\n                                                              (int64_t) 1];\n                    if (local_tid_29340 == 0) {",
            "\n                        if (!(flag_29441 == (int8_t) 2)) {\n                            int64_t x_29444 = (int64_t) 0;\n                            int64_t x_29445 = (int64_t) 0;\n                            int64_t x_29446 = (int64_t) 0;\n                            int64_t x_29447 = (int64_t) 0;\n                            int64_t x_29448;\n                            int64_t x_29449;\n                            int64_t x_29450;\n                            int64_t x_29451;\n                            int8_t flag1_29456;\n                            \n                            flag1_29456 = (int8_t) 0;\n                            \n                            int8_t flag2_29457;\n                            int8_t used1_29458;\n                            \n                            used1_29458 = (int8_t) 0;\n                            \n                            int8_t used2_29459;\n                            \n                            for (int32_t i_29460 = 0; i_29460 <\n                                 wave_sizze_29342; i_29460++) {\n                                flag2_29457 = ((__local\n                                                int8_t *) local_mem_29354)[sext_i32_i64(i_29460)];\n                                used2_29459 = lshr8(flag2_29457, (int8_t) 2);\n                                flag2_29457 = flag2_29457 & (int8_t) 3;\n                                x_29448 = ((__local\n                                            int64_t *) local_mem_29354)[squot64(warp_byte_offset_29349,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_29460)];\n                                x_29449 = ((__local\n                                            int64_t *) local_mem_29354)[squot64(warp_byte_offset_29350,\n                                                                                (int64_t) 8) +\n                                                ",
            "                        sext_i32_i64(i_29460)];\n                                x_29450 = ((__local\n                                            int64_t *) local_mem_29354)[squot64(warp_byte_offset_29351,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_29460)];\n                                x_29451 = ((__local\n                                            int64_t *) local_mem_29354)[squot64(warp_byte_offset_29352,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_29460)];\n                                if (!(flag2_29457 == (int8_t) 1)) {\n                                    flag1_29456 = flag2_29457;\n                                    used1_29458 = used2_29459;\n                                    x_29444 = x_29448;\n                                    x_29445 = x_29449;\n                                    x_29446 = x_29450;\n                                    x_29447 = x_29451;\n                                } else {\n                                    used1_29458 += used2_29459;\n                                    \n                                    int64_t defunc_1_op_res_29452;\n                                    \n                                    defunc_1_op_res_29452 = add64(x_29444,\n                                                                  x_29448);\n                                    \n                                    int64_t defunc_1_op_res_29453 =\n                                            add64(x_29445, x_29449);\n                                    int64_t defunc_1_op_res_29454 =\n                                            add64(x_29446, x_29450);\n                                    int64_t defunc_1_op_res_29455 =\n                                            add64(x_29447, x_29451);",
            "\n                                    \n                                    x_29444 = defunc_1_op_res_29452;\n                                    x_29445 = defunc_1_op_res_29453;\n                                    x_29446 = defunc_1_op_res_29454;\n                                    x_29447 = defunc_1_op_res_29455;\n                                }\n                            }\n                            flag_29441 = flag1_29456;\n                            used_29442 = used1_29458;\n                            aggr_29437 = x_29444;\n                            aggr_29438 = x_29445;\n                            aggr_29439 = x_29446;\n                            aggr_29440 = x_29447;\n                        } else {\n                            aggr_29437 = ((__local\n                                           int64_t *) local_mem_29354)[squot64(warp_byte_offset_29349,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_29342) -\n                                                                        (int64_t) 1)];\n                            aggr_29438 = ((__local\n                                           int64_t *) local_mem_29354)[squot64(warp_byte_offset_29350,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_29342) -\n                                                                        (int64_t) 1)];\n                            aggr_29439 = ((__local\n                                           int64_t *) local_mem_29354)[squot64(warp_byte_offset_29351,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_29342) -\n                                                ",
            "                        (int64_t) 1)];\n                            aggr_29440 = ((__local\n                                           int64_t *) local_mem_29354)[squot64(warp_byte_offset_29352,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_29342) -\n                                                                        (int64_t) 1)];\n                        }\n                        if (flag_29441 == (int8_t) 2) {\n                            readOffset_29435 = wave_sizze_29342 * -1;\n                        } else {\n                            readOffset_29435 -= zext_i8_i32(used_29442);\n                        }\n                        ((__local int32_t *) local_mem_29354)[(int64_t) 0] =\n                            readOffset_29435;\n                        \n                        int64_t x_29461;\n                        \n                        x_29461 = aggr_29437;\n                        \n                        int64_t x_29462;\n                        \n                        x_29462 = aggr_29438;\n                        \n                        int64_t x_29463;\n                        \n                        x_29463 = aggr_29439;\n                        \n                        int64_t x_29464;\n                        \n                        x_29464 = aggr_29440;\n                        \n                        int64_t x_29465;\n                        \n                        x_29465 = prefix_29430;\n                        \n                        int64_t x_29466;\n                        \n                        x_29466 = prefix_29431;\n                        \n                        int64_t x_29467;\n                        \n                        x_29467 = prefix_29432;\n                        \n                        int64_t x_29468;\n                        \n                        x_29468 = prefix_29433;\n          ",
            "              \n                        int64_t defunc_1_op_res_29469;\n                        \n                        defunc_1_op_res_29469 = add64(x_29461, x_29465);\n                        \n                        int64_t defunc_1_op_res_29470 = add64(x_29462, x_29466);\n                        int64_t defunc_1_op_res_29471 = add64(x_29463, x_29467);\n                        int64_t defunc_1_op_res_29472 = add64(x_29464, x_29468);\n                        \n                        prefix_29430 = defunc_1_op_res_29469;\n                        prefix_29431 = defunc_1_op_res_29470;\n                        prefix_29432 = defunc_1_op_res_29471;\n                        prefix_29433 = defunc_1_op_res_29472;\n                    }\n                    mem_fence_local();\n                    readOffset_29435 = ((__local\n                                         int32_t *) local_mem_29354)[(int64_t) 0];\n                }\n            }\n            if (local_tid_29340 == 0) {\n                int64_t x_29473 = prefix_29430;\n                int64_t x_29474 = prefix_29431;\n                int64_t x_29475 = prefix_29432;\n                int64_t x_29476 = prefix_29433;\n                int64_t x_29477 = acc_29411;\n                int64_t x_29478 = acc_29412;\n                int64_t x_29479 = acc_29413;\n                int64_t x_29480 = acc_29414;\n                int64_t defunc_1_op_res_29481 = add64(x_29473, x_29477);\n                int64_t defunc_1_op_res_29482 = add64(x_29474, x_29478);\n                int64_t defunc_1_op_res_29483 = add64(x_29475, x_29479);\n                int64_t defunc_1_op_res_29484 = add64(x_29476, x_29480);\n                \n                ((volatile __global\n                  int64_t *) incprefixes_mem_29325)[dynamic_id_29371] =\n                    defunc_1_op_res_29481;\n                ((volatile __global\n                  int64_t *) incprefixes_mem_29329)[dynamic_id_29371] =\n                    defunc_1_op_res_29482;\n                ((volatile __global\n       ",
            "           int64_t *) incprefixes_mem_29333)[dynamic_id_29371] =\n                    defunc_1_op_res_29483;\n                ((volatile __global\n                  int64_t *) incprefixes_mem_29337)[dynamic_id_29371] =\n                    defunc_1_op_res_29484;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_29321)[dynamic_id_29371] =\n                    (int8_t) 2;\n                ((__local\n                  int64_t *) local_mem_29354)[squot64(warp_byte_offset_29349,\n                                                      (int64_t) 8)] =\n                    prefix_29430;\n                ((__local\n                  int64_t *) local_mem_29354)[squot64(warp_byte_offset_29350,\n                                                      (int64_t) 8)] =\n                    prefix_29431;\n                ((__local\n                  int64_t *) local_mem_29354)[squot64(warp_byte_offset_29351,\n                                                      (int64_t) 8)] =\n                    prefix_29432;\n                ((__local\n                  int64_t *) local_mem_29354)[squot64(warp_byte_offset_29352,\n                                                      (int64_t) 8)] =\n                    prefix_29433;\n                acc_29411 = (int64_t) 0;\n                acc_29412 = (int64_t) 0;\n                acc_29413 = (int64_t) 0;\n                acc_29414 = (int64_t) 0;\n            }\n        }\n        if (!(dynamic_id_29371 == (int64_t) 0)) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            prefix_29430 = ((__local\n                             int64_t *) local_mem_29354)[squot64(warp_byte_offset_29349,\n                                                                 (int64_t) 8)];\n            prefix_29431 = ((__local\n                             int64_t *) local_mem_29354)[squot64(warp_byte_offset_29350,\n                                                                 (int64_t) 8)];\n            prefix_29432 = ((__local\n    ",
            "                         int64_t *) local_mem_29354)[squot64(warp_byte_offset_29351,\n                                                                 (int64_t) 8)];\n            prefix_29433 = ((__local\n                             int64_t *) local_mem_29354)[squot64(warp_byte_offset_29352,\n                                                                 (int64_t) 8)];\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    // Distribute results\n    {\n        int64_t x_29485;\n        int64_t x_29489;\n        int64_t x_29497;\n        \n        x_29497 = prefix_29430;\n        \n        int64_t x_29501;\n        \n        x_29501 = acc_29411;\n        \n        int64_t x_29486;\n        int64_t x_29490;\n        int64_t x_29498;\n        \n        x_29498 = prefix_29431;\n        \n        int64_t x_29502;\n        \n        x_29502 = acc_29412;\n        \n        int64_t x_29487;\n        int64_t x_29491;\n        int64_t x_29499;\n        \n        x_29499 = prefix_29432;\n        \n        int64_t x_29503;\n        \n        x_29503 = acc_29413;\n        \n        int64_t x_29488;\n        int64_t x_29492;\n        int64_t x_29500;\n        \n        x_29500 = prefix_29433;\n        \n        int64_t x_29504;\n        \n        x_29504 = acc_29414;\n        \n        int64_t defunc_1_op_res_29505;\n        \n        defunc_1_op_res_29505 = add64(x_29497, x_29501);\n        \n        int64_t defunc_1_op_res_29506 = add64(x_29498, x_29502);\n        int64_t defunc_1_op_res_29507 = add64(x_29499, x_29503);\n        int64_t defunc_1_op_res_29508 = add64(x_29500, x_29504);\n        \n        x_29485 = defunc_1_op_res_29505;\n        x_29486 = defunc_1_op_res_29506;\n        x_29487 = defunc_1_op_res_29507;\n        x_29488 = defunc_1_op_res_29508;\n        for (int64_t i_29509 = 0; i_29509 < (int64_t) 9; i_29509++) {\n            x_29489 = private_mem_29373[i_29509];\n            x_29490 = private_mem_29375[i_29509];\n            x_29491 = private_mem_29377[i_29509];\n            x_29492 = private_mem_29379[i_29509];",
            "\n            \n            int64_t defunc_1_op_res_29493;\n            \n            defunc_1_op_res_29493 = add64(x_29485, x_29489);\n            \n            int64_t defunc_1_op_res_29494 = add64(x_29486, x_29490);\n            int64_t defunc_1_op_res_29495 = add64(x_29487, x_29491);\n            int64_t defunc_1_op_res_29496 = add64(x_29488, x_29492);\n            \n            private_mem_29373[i_29509] = defunc_1_op_res_29493;\n            private_mem_29375[i_29509] = defunc_1_op_res_29494;\n            private_mem_29377[i_29509] = defunc_1_op_res_29495;\n            private_mem_29379[i_29509] = defunc_1_op_res_29496;\n        }\n    }\n    // Transpose scan output\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29510 = 0; i_29510 < (int64_t) 9; i_29510++) {\n            int64_t sharedIdx_29511 = sext_i32_i64(local_tid_29340 * 9) +\n                    i_29510;\n            \n            ((__local int64_t *) local_mem_29354)[sharedIdx_29511] =\n                private_mem_29373[i_29510];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29512 = 0; i_29512 < (int64_t) 9; i_29512++) {\n            int32_t sharedIdx_29513 = local_tid_29340 +\n                    sext_i64_i32(segscan_group_sizze_27826 * i_29512);\n            \n            private_mem_29373[i_29512] = ((__local\n                                           int64_t *) local_mem_29354)[sext_i32_i64(sharedIdx_29513)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29514 = 0; i_29514 < (int64_t) 9; i_29514++) {\n            int64_t sharedIdx_29515 = sext_i32_i64(local_tid_29340 * 9) +\n                    i_29514;\n            \n            ((__local int64_t *) local_mem_29354)[sharedIdx_29515] =\n                private_mem_29375[i_29514];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29516 = 0; i_29516 < (int64_t) 9; i_29516++) {\n            int32_t sharedIdx_29517 = local_tid_29340 +\n                    sext_i64_i32(segscan_group_sizze_27826 ",
            "* i_29516);\n            \n            private_mem_29375[i_29516] = ((__local\n                                           int64_t *) local_mem_29354)[sext_i32_i64(sharedIdx_29517)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29518 = 0; i_29518 < (int64_t) 9; i_29518++) {\n            int64_t sharedIdx_29519 = sext_i32_i64(local_tid_29340 * 9) +\n                    i_29518;\n            \n            ((__local int64_t *) local_mem_29354)[sharedIdx_29519] =\n                private_mem_29377[i_29518];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29520 = 0; i_29520 < (int64_t) 9; i_29520++) {\n            int32_t sharedIdx_29521 = local_tid_29340 +\n                    sext_i64_i32(segscan_group_sizze_27826 * i_29520);\n            \n            private_mem_29377[i_29520] = ((__local\n                                           int64_t *) local_mem_29354)[sext_i32_i64(sharedIdx_29521)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29522 = 0; i_29522 < (int64_t) 9; i_29522++) {\n            int64_t sharedIdx_29523 = sext_i32_i64(local_tid_29340 * 9) +\n                    i_29522;\n            \n            ((__local int64_t *) local_mem_29354)[sharedIdx_29523] =\n                private_mem_29379[i_29522];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29524 = 0; i_29524 < (int64_t) 9; i_29524++) {\n            int32_t sharedIdx_29525 = local_tid_29340 +\n                    sext_i64_i32(segscan_group_sizze_27826 * i_29524);\n            \n            private_mem_29379[i_29524] = ((__local\n                                           int64_t *) local_mem_29354)[sext_i32_i64(sharedIdx_29525)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Write block scan results to global memory\n    {\n        for (int64_t i_29526 = 0; i_29526 < (int64_t) 9; i_29526++) {\n            int64_t gtid_27830 = blockOff_29372 + segscan_group_sizze_27826 *\n                    i_29526 + sext_i32_i64(loc",
            "al_tid_29340);\n            \n            if (slt64(gtid_27830, conc_tmp_26655)) {\n                ((__global int64_t *) mem_28386)[gtid_27830] =\n                    private_mem_29373[i_29526];\n            }\n        }\n        for (int64_t i_29527 = 0; i_29527 < (int64_t) 9; i_29527++) {\n            int64_t gtid_27830 = blockOff_29372 + segscan_group_sizze_27826 *\n                    i_29527 + sext_i32_i64(local_tid_29340);\n            \n            if (slt64(gtid_27830, conc_tmp_26655)) {\n                ((__global int64_t *) mem_28388)[gtid_27830] =\n                    private_mem_29375[i_29527];\n            }\n        }\n        for (int64_t i_29528 = 0; i_29528 < (int64_t) 9; i_29528++) {\n            int64_t gtid_27830 = blockOff_29372 + segscan_group_sizze_27826 *\n                    i_29528 + sext_i32_i64(local_tid_29340);\n            \n            if (slt64(gtid_27830, conc_tmp_26655)) {\n                ((__global int64_t *) mem_28390)[gtid_27830] =\n                    private_mem_29377[i_29528];\n            }\n        }\n        for (int64_t i_29529 = 0; i_29529 < (int64_t) 9; i_29529++) {\n            int64_t gtid_27830 = blockOff_29372 + segscan_group_sizze_27826 *\n                    i_29529 + sext_i32_i64(local_tid_29340);\n            \n            if (slt64(gtid_27830, conc_tmp_26655)) {\n                ((__global int64_t *) mem_28392)[gtid_27830] =\n                    private_mem_29379[i_29529];\n            }\n        }\n    }\n    // If this is the last block, reset the dynamicId\n    {\n        if (dynamic_id_29371 == sdiv_up64(conc_tmp_26655,\n                                          segscan_group_sizze_27826 *\n                                          (int64_t) 9) - (int64_t) 1) {\n            ((__global\n              int32_t *) eWiseAddMultEntryziid_counter_mem_29319)[(int64_t) 0] =\n                0;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_27826\n}\n__kernel void eWiseAddMultEntryzisegscan_27949(__global int *global_failure,\n     ",
            "                                          int failure_is_an_option,\n                                               __global\n                                               int64_t *global_failure_args,\n                                               uint local_mem_29559_backing_offset_0,\n                                               int64_t conc_tmp_26655,\n                                               int64_t i_26671, __global\n                                               unsigned char *mem_28416,\n                                               __global\n                                               unsigned char *mem_28418,\n                                               __global\n                                               unsigned char *mem_28420,\n                                               __global\n                                               unsigned char *mem_28422,\n                                               __global\n                                               unsigned char *mem_28425,\n                                               __global\n                                               unsigned char *mem_28427,\n                                               __global\n                                               unsigned char *mem_28429,\n                                               __global\n                                               unsigned char *mem_28431,\n                                               __global\n                                               unsigned char *mem_28433,\n                                               __global\n                                               unsigned char *mem_28435,\n                                               __global\n                                               unsigned char *eWiseAddMultEntryziid_counter_mem_29542,\n                                               __global\n                                               unsigned char *status_flags_mem_29544,\n                                  ",
            "             __global\n                                               unsigned char *aggregates_mem_29546,\n                                               __global\n                                               unsigned char *incprefixes_mem_29548)\n{\n    #define segscan_group_sizze_27944 (eWiseAddMultEntryzisegscan_group_sizze_27943)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *local_mem_29559_backing_0 =\n                  &shared_mem[local_mem_29559_backing_offset_0];\n    volatile __local bool local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = false;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t global_tid_29550;\n    int32_t local_tid_29551;\n    int64_t group_sizze_29554;\n    int32_t wave_sizze_29553;\n    int32_t group_tid_29552;\n    \n    global_tid_29550 = get_global_id(0);\n    local_tid_29551 = get_local_id(0);\n    group_sizze_29554 = get_local_size(0);\n    wave_sizze_29553 = LOCKSTEP_WIDTH;\n    group_tid_29552 = get_group_id(0);\n    \n    int32_t phys_tid_27949;\n    \n    phys_tid_27949 = global_tid_29550;\n    \n    int64_t byte_offsets_29555;\n    \n    byte_offsets_29555 = (int64_t) 0;\n    \n    int64_t byte_offsets_29556;\n    \n    byte_offsets_29556 = segscan_group_sizze_27944 * (int64_t) 8;\n    \n    int64_t warp_byte_offset_29557;\n    \n    warp_byte_offset_29557 = (int64_t) 32;\n    \n    int64_t warp_byte_offset_29558;\n    \n    warp_byte_offset_29558 = (int64_t) 288;\n    // Allocate reused shared memeory\n    { }\n    \n    __local char *local_mem_29559;\n    \n    local_mem_29559 = (__local char *) local_mem_29559_backing_0;\n    \n    int64_t trans_arr_len_29560;\n    \n    trans_arr_len_29560 = (int64_t) 9 * segscan_group_sizze_27944;\n    \n    int32_t dynamic_id_29567;\n    \n    if (local_tid_29551 == 0) {\n        dynamic_id_29567 = atomic_add_i32_global(&((volatile __global\n         ",
            "                                           int *) eWiseAddMultEntryziid_counter_mem_29542)[(int64_t) 0],\n                                                 (int) 1);\n        ((__local int32_t *) local_mem_29559)[(int64_t) 0] = dynamic_id_29567;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    dynamic_id_29567 = ((__local int32_t *) local_mem_29559)[(int64_t) 0];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t blockOff_29568;\n    \n    blockOff_29568 = sext_i32_i64(dynamic_id_29567) * (int64_t) 9 *\n        segscan_group_sizze_27944;\n    \n    int64_t private_mem_29569[9];\n    \n    // Load and map\n    {\n        for (int64_t i_29571 = 0; i_29571 < (int64_t) 9; i_29571++) {\n            int64_t gtid_27948 = blockOff_29568 +\n                    sext_i32_i64(local_tid_29551) + i_29571 *\n                    segscan_group_sizze_27944;\n            \n            if (slt64(gtid_27948, conc_tmp_26655)) {\n                int64_t x_26862 = ((__global int64_t *) mem_28416)[gtid_27948];\n                bool cond_26867 = gtid_27948 == i_26671;\n                bool cond_26868 = !cond_26867;\n                bool cond_26869;\n                \n                if (cond_26868) {\n                    int64_t i_26870 = add64((int64_t) 1, gtid_27948);\n                    bool x_26871 = sle64((int64_t) 0, i_26870);\n                    bool y_26872 = slt64(i_26870, conc_tmp_26655);\n                    bool bounds_check_26873 = x_26871 && y_26872;\n                    bool index_certs_26874;\n                    \n                    if (!bounds_check_26873) {\n                        {\n                            if (atomic_cmpxchg_i32_global(global_failure, -1,\n                                                          29) == -1) {\n                                global_failure_args[0] = i_26870;\n                                global_failure_args[1] = conc_tmp_26655;\n                                ;\n                            }\n                            local_failure = true;\n                           ",
            " goto error_0;\n                        }\n                    }\n                    \n                    int64_t y_26875 = ((__global int64_t *) mem_28416)[i_26870];\n                    bool cond_t_res_26876 = x_26862 == y_26875;\n                    \n                    cond_26869 = cond_t_res_26876;\n                } else {\n                    cond_26869 = 0;\n                }\n                \n                int64_t defunc_0_f_res_26877;\n                \n                if (cond_26869) {\n                    defunc_0_f_res_26877 = (int64_t) -1;\n                } else {\n                    defunc_0_f_res_26877 = x_26862;\n                }\n                \n                int64_t defunc_0_f_res_26878;\n                int64_t defunc_0_f_res_26879;\n                int64_t defunc_0_f_res_26880;\n                \n                if (cond_26869) {\n                    defunc_0_f_res_26878 = (int64_t) 0;\n                    defunc_0_f_res_26879 = (int64_t) 0;\n                    defunc_0_f_res_26880 = (int64_t) 0;\n                } else {\n                    int64_t x_26863 = ((__global\n                                        int64_t *) mem_28418)[gtid_27948];\n                    int64_t x_26864 = ((__global\n                                        int64_t *) mem_28420)[gtid_27948];\n                    int64_t x_26865 = ((__global\n                                        int64_t *) mem_28422)[gtid_27948];\n                    bool cond_26881 = gtid_27948 == (int64_t) 0;\n                    bool cond_26882 = !cond_26881;\n                    bool cond_26883;\n                    \n                    if (cond_26882) {\n                        int64_t i_26884 = sub64(gtid_27948, (int64_t) 1);\n                        bool x_26885 = sle64((int64_t) 0, i_26884);\n                        bool y_26886 = slt64(i_26884, conc_tmp_26655);\n                        bool bounds_check_26887 = x_26885 && y_26886;\n                        bool index_certs_26888;\n                        \n               ",
            "         if (!bounds_check_26887) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure,\n                                                              -1, 30) == -1) {\n                                    global_failure_args[0] = i_26884;\n                                    global_failure_args[1] = conc_tmp_26655;\n                                    ;\n                                }\n                                local_failure = true;\n                                goto error_0;\n                            }\n                        }\n                        \n                        int64_t y_26889 = ((__global\n                                            int64_t *) mem_28416)[i_26884];\n                        bool cond_t_res_26890 = x_26862 == y_26889;\n                        \n                        cond_26883 = cond_t_res_26890;\n                    } else {\n                        cond_26883 = 0;\n                    }\n                    \n                    int64_t defunc_0_f_res_f_res_26891;\n                    \n                    if (cond_26883) {\n                        defunc_0_f_res_f_res_26891 = (int64_t) 2;\n                    } else {\n                        defunc_0_f_res_f_res_26891 = x_26863;\n                    }\n                    \n                    int64_t defunc_0_f_res_f_res_26892;\n                    int64_t defunc_0_f_res_f_res_26893;\n                    \n                    if (cond_26883) {\n                        bool cond_26894 = x_26863 == (int64_t) 0;\n                        int64_t defunc_0_f_res_f_res_t_res_26895;\n                        int64_t defunc_0_f_res_f_res_t_res_26896;\n                        \n                        if (cond_26894) {\n                            int64_t i_26897 = sub64(gtid_27948, (int64_t) 1);\n                            bool x_26898 = sle64((int64_t) 0, i_26897);\n                            bool y_26899 = slt64(i_26897, conc_tmp_26655);\n            ",
            "                bool bounds_check_26900 = x_26898 && y_26899;\n                            bool index_certs_26901;\n                            \n                            if (!bounds_check_26900) {\n                                {\n                                    if (atomic_cmpxchg_i32_global(global_failure,\n                                                                  -1, 31) ==\n                                        -1) {\n                                        global_failure_args[0] = i_26897;\n                                        global_failure_args[1] = conc_tmp_26655;\n                                        ;\n                                    }\n                                    local_failure = true;\n                                    goto error_0;\n                                }\n                            }\n                            \n                            int64_t defunc_0_f_res_f_res_t_res_t_res_26902 =\n                                    ((__global int64_t *) mem_28420)[i_26897];\n                            \n                            defunc_0_f_res_f_res_t_res_26895 = x_26864;\n                            defunc_0_f_res_f_res_t_res_26896 =\n                                defunc_0_f_res_f_res_t_res_t_res_26902;\n                        } else {\n                            int64_t i_26903 = sub64(gtid_27948, (int64_t) 1);\n                            bool x_26904 = sle64((int64_t) 0, i_26903);\n                            bool y_26905 = slt64(i_26903, conc_tmp_26655);\n                            bool bounds_check_26906 = x_26904 && y_26905;\n                            bool index_certs_26907;\n                            \n                            if (!bounds_check_26906) {\n                                {\n                                    if (atomic_cmpxchg_i32_global(global_failure,\n                                                                  -1, 32) ==\n                                        -1) {\n                            ",
            "            global_failure_args[0] = i_26903;\n                                        global_failure_args[1] = conc_tmp_26655;\n                                        ;\n                                    }\n                                    local_failure = true;\n                                    goto error_0;\n                                }\n                            }\n                            \n                            int64_t defunc_0_f_res_f_res_t_res_f_res_26908 =\n                                    ((__global int64_t *) mem_28420)[i_26903];\n                            \n                            defunc_0_f_res_f_res_t_res_26895 =\n                                defunc_0_f_res_f_res_t_res_f_res_26908;\n                            defunc_0_f_res_f_res_t_res_26896 = x_26864;\n                        }\n                        defunc_0_f_res_f_res_26892 =\n                            defunc_0_f_res_f_res_t_res_26895;\n                        defunc_0_f_res_f_res_26893 =\n                            defunc_0_f_res_f_res_t_res_26896;\n                    } else {\n                        defunc_0_f_res_f_res_26892 = x_26864;\n                        defunc_0_f_res_f_res_26893 = x_26865;\n                    }\n                    defunc_0_f_res_26878 = defunc_0_f_res_f_res_26891;\n                    defunc_0_f_res_26879 = defunc_0_f_res_f_res_26892;\n                    defunc_0_f_res_26880 = defunc_0_f_res_f_res_26893;\n                }\n                \n                bool eq_x_zz_26909 = (int64_t) -1 == x_26862;\n                bool not_p_26910 = !cond_26869;\n                bool p_and_eq_x_y_26911 = eq_x_zz_26909 && not_p_26910;\n                bool defunc_0_p_res_26912 = cond_26869 || p_and_eq_x_y_26911;\n                int64_t defunc_1_lifted_lambda_res_26913 =\n                        btoi_bool_i64(defunc_0_p_res_26912);\n                bool is_i_26914 = defunc_1_lifted_lambda_res_26913 ==\n                     (int64_t) 0;\n                bool cond_neg_26915 =",
            " !is_i_26914;\n                int64_t part_res_26916 = btoi_bool_i64(cond_neg_26915);\n                int64_t part_res_26917 = btoi_bool_i64(is_i_26914);\n                \n                ((__global int64_t *) mem_28427)[gtid_27948] = part_res_26916;\n                ((__global int64_t *) mem_28429)[gtid_27948] =\n                    defunc_0_f_res_26877;\n                ((__global int64_t *) mem_28431)[gtid_27948] =\n                    defunc_0_f_res_26878;\n                ((__global int64_t *) mem_28433)[gtid_27948] =\n                    defunc_0_f_res_26879;\n                ((__global int64_t *) mem_28435)[gtid_27948] =\n                    defunc_0_f_res_26880;\n                private_mem_29569[i_29571] = part_res_26917;\n            } else {\n                private_mem_29569[i_29571] = (int64_t) 0;\n            }\n        }\n    }\n    // Transpose scan inputs\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29572 = 0; i_29572 < (int64_t) 9; i_29572++) {\n            int64_t sharedIdx_29573 = sext_i32_i64(local_tid_29551) + i_29572 *\n                    segscan_group_sizze_27944;\n            \n            ((__local int64_t *) local_mem_29559)[sharedIdx_29573] =\n                private_mem_29569[i_29572];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_29574 = 0; i_29574 < 9; i_29574++) {\n            int32_t sharedIdx_29575 = local_tid_29551 * 9 + i_29574;\n            \n            private_mem_29569[sext_i32_i64(i_29574)] = ((__local\n                                                         int64_t *) local_mem_29559)[sext_i32_i64(sharedIdx_29575)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Per thread scan\n    {\n        for (int64_t i_29576 = 0; i_29576 < (int64_t) 8; i_29576++) {\n            int64_t x_26859;\n            int64_t y_26860;\n            \n            x_26859 = private_mem_29569[i_29576];\n            y_26860 = private_mem_29569[i_29576 + (int64_t) 1];\n            \n            int64_t zz_26861;\n           ",
            " \n            zz_26861 = x_26859 + y_26860;\n            private_mem_29569[i_29576 + (int64_t) 1] = zz_26861;\n        }\n    }\n    // Publish results in shared memory\n    {\n        ((__local int64_t *) local_mem_29559)[squot64(byte_offsets_29555,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_29551)] =\n            private_mem_29569[(int64_t) 8];\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t acc_29580;\n    \n    // Scan results (with warp scan)\n    {\n        int64_t x_29577;\n        int64_t y_29578;\n        int64_t x_29581;\n        int64_t y_29582;\n        bool ltid_in_bounds_29584;\n        \n        ltid_in_bounds_29584 = slt64(sext_i32_i64(local_tid_29551),\n                                     segscan_group_sizze_27944);\n        \n        int32_t skip_threads_29585;\n        \n        // read input for in-block scan\n        {\n            if (ltid_in_bounds_29584) {\n                y_29578 = ((volatile __local\n                            int64_t *) local_mem_29559)[squot64(byte_offsets_29555,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_29551)];\n                if ((local_tid_29551 - squot32(local_tid_29551, 32) * 32) ==\n                    0) {\n                    x_29577 = y_29578;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_29585 = 1;\n            while (slt32(skip_threads_29585, 32)) {\n                if (sle32(skip_threads_29585, local_tid_29551 -\n                          squot32(local_tid_29551, 32) * 32) &&\n                    ltid_in_bounds_29584) {\n                    // read operands\n                    {\n                        x_29577 = ((volatile __local\n                                    int64_t *) local_mem_29559)[squot64(byte_offsets_29555,\n             ",
            "                                                           (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_29551) -\n                                                                 sext_i32_i64(skip_threads_29585))];\n                    }\n                    // perform operation\n                    {\n                        int64_t zz_29579 = x_29577 + y_29578;\n                        \n                        x_29577 = zz_29579;\n                    }\n                }\n                if (sle32(wave_sizze_29553, skip_threads_29585)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_29585, local_tid_29551 -\n                          squot32(local_tid_29551, 32) * 32) &&\n                    ltid_in_bounds_29584) {\n                    // write result\n                    {\n                        ((volatile __local\n                          int64_t *) local_mem_29559)[squot64(byte_offsets_29555,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_29551)] =\n                            x_29577;\n                        y_29578 = x_29577;\n                    }\n                }\n                if (sle32(wave_sizze_29553, skip_threads_29585)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_29585 *= 2;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // last thread of block 'i' writes its result to offset 'i'\n        {\n            if ((local_tid_29551 - squot32(local_tid_29551, 32) * 32) == 31 &&\n                ltid_in_bounds_29584) {\n                ((volatile __local\n                  int64_t *) local_mem_29559)[squot64(byte_offsets_29555,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_29551,\n ",
            "                                                                  32))] =\n                    x_29577;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n        {\n            int32_t skip_threads_29586;\n            \n            // read input for in-block scan\n            {\n                if (squot32(local_tid_29551, 32) == 0 && ltid_in_bounds_29584) {\n                    y_29582 = ((volatile __local\n                                int64_t *) local_mem_29559)[squot64(byte_offsets_29555,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_29551)];\n                    if ((local_tid_29551 - squot32(local_tid_29551, 32) * 32) ==\n                        0) {\n                        x_29581 = y_29582;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_29586 = 1;\n                while (slt32(skip_threads_29586, 32)) {\n                    if (sle32(skip_threads_29586, local_tid_29551 -\n                              squot32(local_tid_29551, 32) * 32) &&\n                        (squot32(local_tid_29551, 32) == 0 &&\n                         ltid_in_bounds_29584)) {\n                        // read operands\n                        {\n                            x_29581 = ((volatile __local\n                                        int64_t *) local_mem_29559)[squot64(byte_offsets_29555,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_29551) -\n                                                                     sext_i32_i64(skip_threads_29586))];\n                        }\n                        // perform operation\n                  ",
            "      {\n                            int64_t zz_29583 = x_29581 + y_29582;\n                            \n                            x_29581 = zz_29583;\n                        }\n                    }\n                    if (sle32(wave_sizze_29553, skip_threads_29586)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_29586, local_tid_29551 -\n                              squot32(local_tid_29551, 32) * 32) &&\n                        (squot32(local_tid_29551, 32) == 0 &&\n                         ltid_in_bounds_29584)) {\n                        // write result\n                        {\n                            ((volatile __local\n                              int64_t *) local_mem_29559)[squot64(byte_offsets_29555,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_29551)] =\n                                x_29581;\n                            y_29582 = x_29581;\n                        }\n                    }\n                    if (sle32(wave_sizze_29553, skip_threads_29586)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_29586 *= 2;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // carry-in for every block except the first\n        {\n            if (!(squot32(local_tid_29551, 32) == 0 || !ltid_in_bounds_29584)) {\n                // read operands\n                {\n                    y_29578 = x_29577;\n                    x_29577 = ((__local\n                                int64_t *) local_mem_29559)[squot64(byte_offsets_29555,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_29551,\n                                                                                  3",
            "2)) -\n                                                             (int64_t) 1)];\n                }\n                // perform operation\n                {\n                    int64_t zz_29579 = x_29577 + y_29578;\n                    \n                    x_29577 = zz_29579;\n                }\n                // write final result\n                {\n                    ((__local\n                      int64_t *) local_mem_29559)[squot64(byte_offsets_29555,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_29551)] =\n                        x_29577;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // restore correct values for first block\n        {\n            if (squot32(local_tid_29551, 32) == 0) {\n                ((__local\n                  int64_t *) local_mem_29559)[squot64(byte_offsets_29555,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_29551)] =\n                    y_29578;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_tid_29551 == 0) {\n            acc_29580 = ((__local\n                          int64_t *) local_mem_29559)[squot64(byte_offsets_29555,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_27944 -\n                                                       (int64_t) 1)];\n        } else {\n            acc_29580 = ((__local\n                          int64_t *) local_mem_29559)[squot64(byte_offsets_29555,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_29551) -\n                                                       (int64_t) 1)];\n        }\n        barrier(CLK_LOCAL_",
            "MEM_FENCE);\n    }\n    \n    int64_t prefix_29587;\n    \n    prefix_29587 = (int64_t) 0;\n    // Perform lookback\n    {\n        if (dynamic_id_29567 == (int64_t) 0 && local_tid_29551 == 0) {\n            ((volatile __global\n              int64_t *) incprefixes_mem_29548)[dynamic_id_29567] = acc_29580;\n            mem_fence_global();\n            ((volatile __global\n              int8_t *) status_flags_mem_29544)[dynamic_id_29567] = (int8_t) 2;\n            acc_29580 = (int64_t) 0;\n        }\n        if (!(dynamic_id_29567 == (int64_t) 0) && slt32(local_tid_29551,\n                                                        wave_sizze_29553)) {\n            if (local_tid_29551 == 0) {\n                ((volatile __global\n                  int64_t *) aggregates_mem_29546)[dynamic_id_29567] =\n                    acc_29580;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_29544)[dynamic_id_29567] =\n                    (int8_t) 1;\n                ((__local int8_t *) local_mem_29559)[(int64_t) 0] = ((__global\n                                                                      int8_t *) status_flags_mem_29544)[dynamic_id_29567 -\n                                                                                                        (int64_t) 1];\n            }\n            mem_fence_local();\n            \n            int8_t status_29588;\n            \n            status_29588 = ((__local int8_t *) local_mem_29559)[(int64_t) 0];\n            if (status_29588 == (int8_t) 2) {\n                if (local_tid_29551 == 0) {\n                    prefix_29587 = ((volatile __global\n                                     int64_t *) incprefixes_mem_29548)[dynamic_id_29567 -\n                                                                       (int64_t) 1];\n                }\n            } else {\n                int32_t readOffset_29589 = dynamic_id_29567 -\n                        sext_i32_i64(wave_sizze_29553);\n                \n           ",
            "     while (slt32(wave_sizze_29553 * -1, readOffset_29589)) {\n                    int32_t read_i_29590 = readOffset_29589 + local_tid_29551;\n                    int64_t aggr_29591 = (int64_t) 0;\n                    int8_t flag_29592 = (int8_t) 0;\n                    int8_t used_29593 = (int8_t) 0;\n                    \n                    if (sle32(0, read_i_29590)) {\n                        flag_29592 = ((volatile __global\n                                       int8_t *) status_flags_mem_29544)[sext_i32_i64(read_i_29590)];\n                        if (flag_29592 == (int8_t) 2) {\n                            aggr_29591 = ((volatile __global\n                                           int64_t *) incprefixes_mem_29548)[sext_i32_i64(read_i_29590)];\n                        } else {\n                            if (flag_29592 == (int8_t) 1) {\n                                aggr_29591 = ((volatile __global\n                                               int64_t *) aggregates_mem_29546)[sext_i32_i64(read_i_29590)];\n                                used_29593 = (int8_t) 1;\n                            }\n                        }\n                    }\n                    ((__local\n                      int64_t *) local_mem_29559)[squot64(warp_byte_offset_29557,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_29551)] =\n                        aggr_29591;\n                    \n                    int8_t tmp_29594;\n                    \n                    tmp_29594 = flag_29592 | used_29593 << (int8_t) 2;\n                    ((__local\n                      int8_t *) local_mem_29559)[sext_i32_i64(local_tid_29551)] =\n                        tmp_29594;\n                    mem_fence_local();\n                    flag_29592 = ((volatile __local\n                                   int8_t *) local_mem_29559)[sext_i32_i64(wave_sizze_29553) -\n                                                          ",
            "    (int64_t) 1];\n                    if (local_tid_29551 == 0) {\n                        if (!(flag_29592 == (int8_t) 2)) {\n                            int64_t x_29595 = (int64_t) 0;\n                            int64_t y_29596;\n                            int8_t flag1_29598;\n                            \n                            flag1_29598 = (int8_t) 0;\n                            \n                            int8_t flag2_29599;\n                            int8_t used1_29600;\n                            \n                            used1_29600 = (int8_t) 0;\n                            \n                            int8_t used2_29601;\n                            \n                            for (int32_t i_29602 = 0; i_29602 <\n                                 wave_sizze_29553; i_29602++) {\n                                flag2_29599 = ((__local\n                                                int8_t *) local_mem_29559)[sext_i32_i64(i_29602)];\n                                used2_29601 = lshr8(flag2_29599, (int8_t) 2);\n                                flag2_29599 = flag2_29599 & (int8_t) 3;\n                                y_29596 = ((__local\n                                            int64_t *) local_mem_29559)[squot64(warp_byte_offset_29557,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_29602)];\n                                if (!(flag2_29599 == (int8_t) 1)) {\n                                    flag1_29598 = flag2_29599;\n                                    used1_29600 = used2_29601;\n                                    x_29595 = y_29596;\n                                } else {\n                                    used1_29600 += used2_29601;\n                                    \n                                    int64_t zz_29597;\n                                    \n                                    zz_29597 = x_29595 + y_29596",
            ";\n                                    x_29595 = zz_29597;\n                                }\n                            }\n                            flag_29592 = flag1_29598;\n                            used_29593 = used1_29600;\n                            aggr_29591 = x_29595;\n                        } else {\n                            aggr_29591 = ((__local\n                                           int64_t *) local_mem_29559)[squot64(warp_byte_offset_29557,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_29553) -\n                                                                        (int64_t) 1)];\n                        }\n                        if (flag_29592 == (int8_t) 2) {\n                            readOffset_29589 = wave_sizze_29553 * -1;\n                        } else {\n                            readOffset_29589 -= zext_i8_i32(used_29593);\n                        }\n                        ((__local int32_t *) local_mem_29559)[(int64_t) 0] =\n                            readOffset_29589;\n                        \n                        int64_t x_29603;\n                        \n                        x_29603 = aggr_29591;\n                        \n                        int64_t y_29604;\n                        \n                        y_29604 = prefix_29587;\n                        \n                        int64_t zz_29605;\n                        \n                        zz_29605 = x_29603 + y_29604;\n                        prefix_29587 = zz_29605;\n                    }\n                    mem_fence_local();\n                    readOffset_29589 = ((__local\n                                         int32_t *) local_mem_29559)[(int64_t) 0];\n                }\n            }\n            if (local_tid_29551 == 0) {\n                int64_t x_29606 = prefix_29587;\n                int64_t y_29607 = acc_29580;\n           ",
            "     int64_t zz_29608 = x_29606 + y_29607;\n                \n                ((volatile __global\n                  int64_t *) incprefixes_mem_29548)[dynamic_id_29567] =\n                    zz_29608;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_29544)[dynamic_id_29567] =\n                    (int8_t) 2;\n                ((__local\n                  int64_t *) local_mem_29559)[squot64(warp_byte_offset_29557,\n                                                      (int64_t) 8)] =\n                    prefix_29587;\n                acc_29580 = (int64_t) 0;\n            }\n        }\n        if (!(dynamic_id_29567 == (int64_t) 0)) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            prefix_29587 = ((__local\n                             int64_t *) local_mem_29559)[squot64(warp_byte_offset_29557,\n                                                                 (int64_t) 8)];\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    // Distribute results\n    {\n        int64_t x_29609;\n        int64_t y_29610;\n        int64_t x_29612;\n        \n        x_29612 = prefix_29587;\n        \n        int64_t y_29613;\n        \n        y_29613 = acc_29580;\n        \n        int64_t zz_29614;\n        \n        zz_29614 = x_29612 + y_29613;\n        x_29609 = zz_29614;\n        for (int64_t i_29615 = 0; i_29615 < (int64_t) 9; i_29615++) {\n            y_29610 = private_mem_29569[i_29615];\n            \n            int64_t zz_29611;\n            \n            zz_29611 = x_29609 + y_29610;\n            private_mem_29569[i_29615] = zz_29611;\n        }\n    }\n    // Transpose scan output\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29616 = 0; i_29616 < (int64_t) 9; i_29616++) {\n            int64_t sharedIdx_29617 = sext_i32_i64(local_tid_29551 * 9) +\n                    i_29616;\n            \n            ((__local int64_t *) local_mem_29559)[sharedIdx_29617] =\n                private_mem_29569[i_29616];\n        }\n",
            "        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29618 = 0; i_29618 < (int64_t) 9; i_29618++) {\n            int32_t sharedIdx_29619 = local_tid_29551 +\n                    sext_i64_i32(segscan_group_sizze_27944 * i_29618);\n            \n            private_mem_29569[i_29618] = ((__local\n                                           int64_t *) local_mem_29559)[sext_i32_i64(sharedIdx_29619)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Write block scan results to global memory\n    {\n        for (int64_t i_29620 = 0; i_29620 < (int64_t) 9; i_29620++) {\n            int64_t gtid_27948 = blockOff_29568 + segscan_group_sizze_27944 *\n                    i_29620 + sext_i32_i64(local_tid_29551);\n            \n            if (slt64(gtid_27948, conc_tmp_26655)) {\n                ((__global int64_t *) mem_28425)[gtid_27948] =\n                    private_mem_29569[i_29620];\n            }\n        }\n    }\n    // If this is the last block, reset the dynamicId\n    {\n        if (dynamic_id_29567 == sdiv_up64(conc_tmp_26655,\n                                          segscan_group_sizze_27944 *\n                                          (int64_t) 9) - (int64_t) 1) {\n            ((__global\n              int32_t *) eWiseAddMultEntryziid_counter_mem_29542)[(int64_t) 0] =\n                0;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_27944\n}\n__kernel void eWiseAddMultEntryzisegscan_27969(__global int *global_failure,\n                                               int failure_is_an_option,\n                                               __global\n                                               int64_t *global_failure_args,\n                                               uint local_mem_29697_backing_offset_0,\n                                               int64_t m_26408, int64_t k_26409,\n                                               int64_t eWiseAddOffsets_res_26600,\n                                               int64_t num_threads_29036,\n ",
            "                                              __global\n                                               unsigned char *rightColumns_mem_28235,\n                                               __global\n                                               unsigned char *rightOffsets_mem_28236,\n                                               __global\n                                               unsigned char *mem_28337,\n                                               __global\n                                               unsigned char *mem_28341,\n                                               __global\n                                               unsigned char *mem_28484,\n                                               __global\n                                               unsigned char *mem_28493,\n                                               __global\n                                               unsigned char *mem_28495,\n                                               __global\n                                               unsigned char *mem_28497,\n                                               __global\n                                               unsigned char *mem_28499,\n                                               __global\n                                               unsigned char *mem_28501,\n                                               __global\n                                               unsigned char *mem_28563,\n                                               __global\n                                               unsigned char *mem_28582,\n                                               __global\n                                               unsigned char *double_buffer_mem_28767,\n                                               __global\n                                               unsigned char *eWiseAddMultEntryziid_counter_mem_29680,\n                                               __global\n                                               unsigned char *status_",
            "flags_mem_29682,\n                                               __global\n                                               unsigned char *aggregates_mem_29684,\n                                               __global\n                                               unsigned char *incprefixes_mem_29686)\n{\n    #define segscan_group_sizze_27964 (eWiseAddMultEntryzisegscan_group_sizze_27963)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *local_mem_29697_backing_0 =\n                  &shared_mem[local_mem_29697_backing_offset_0];\n    volatile __local bool local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = false;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t global_tid_29688;\n    int32_t local_tid_29689;\n    int64_t group_sizze_29692;\n    int32_t wave_sizze_29691;\n    int32_t group_tid_29690;\n    \n    global_tid_29688 = get_global_id(0);\n    local_tid_29689 = get_local_id(0);\n    group_sizze_29692 = get_local_size(0);\n    wave_sizze_29691 = LOCKSTEP_WIDTH;\n    group_tid_29690 = get_group_id(0);\n    \n    int32_t phys_tid_27969;\n    \n    phys_tid_27969 = global_tid_29688;\n    \n    int64_t byte_offsets_29693;\n    \n    byte_offsets_29693 = (int64_t) 0;\n    \n    int64_t byte_offsets_29694;\n    \n    byte_offsets_29694 = segscan_group_sizze_27964 * (int64_t) 8;\n    \n    int64_t warp_byte_offset_29695;\n    \n    warp_byte_offset_29695 = (int64_t) 32;\n    \n    int64_t warp_byte_offset_29696;\n    \n    warp_byte_offset_29696 = (int64_t) 288;\n    // Allocate reused shared memeory\n    { }\n    \n    __local char *local_mem_29697;\n    \n    local_mem_29697 = (__local char *) local_mem_29697_backing_0;\n    \n    int64_t trans_arr_len_29698;\n    \n    trans_arr_len_29698 = (int64_t) 9 * segscan_group_sizze_27964;\n    \n    int32_t dynamic_id_29705;\n    \n    if (local_tid_29689 == 0) {\n        dynamic_id_29705 = a",
            "tomic_add_i32_global(&((volatile __global\n                                                    int *) eWiseAddMultEntryziid_counter_mem_29680)[(int64_t) 0],\n                                                 (int) 1);\n        ((__local int32_t *) local_mem_29697)[(int64_t) 0] = dynamic_id_29705;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    dynamic_id_29705 = ((__local int32_t *) local_mem_29697)[(int64_t) 0];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t blockOff_29706;\n    \n    blockOff_29706 = sext_i32_i64(dynamic_id_29705) * (int64_t) 9 *\n        segscan_group_sizze_27964;\n    \n    int64_t private_mem_29707[9];\n    \n    // Load and map\n    {\n        for (int64_t i_29709 = 0; i_29709 < (int64_t) 9; i_29709++) {\n            int64_t gtid_27968 = blockOff_29706 +\n                    sext_i32_i64(local_tid_29689) + i_29709 *\n                    segscan_group_sizze_27964;\n            \n            if (slt64(gtid_27968, m_26408)) {\n                int64_t x_27022 = ((__global int64_t *) mem_28337)[gtid_27968];\n                int64_t x_27024 = ((__global\n                                    int64_t *) rightOffsets_mem_28236)[gtid_27968];\n                bool cond_27025 = gtid_27968 == (int64_t) 0;\n                int64_t prevx2_27026;\n                \n                if (cond_27025) {\n                    prevx2_27026 = gtid_27968;\n                } else {\n                    int64_t prevx2_f_res_27027 = sub64(gtid_27968, (int64_t) 1);\n                    \n                    prevx2_27026 = prevx2_f_res_27027;\n                }\n                \n                int64_t prevy2_27028;\n                \n                if (cond_27025) {\n                    prevy2_27028 = gtid_27968;\n                } else {\n                    int64_t prevy2_f_res_27029 = sub64(gtid_27968, (int64_t) 1);\n                    \n                    prevy2_27028 = prevy2_f_res_27029;\n                }\n                \n                bool x_27030 = sle64((int64_t) 0, prevy2_27028);\n                b",
            "ool y_27031 = slt64(prevy2_27028, m_26408);\n                bool bounds_check_27032 = x_27030 && y_27031;\n                bool index_certs_27033;\n                \n                if (!bounds_check_27032) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 40) ==\n                            -1) {\n                            global_failure_args[0] = prevy2_27028;\n                            global_failure_args[1] = m_26408;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                \n                int64_t i_27034 = ((__global\n                                    int64_t *) rightOffsets_mem_28236)[prevy2_27028];\n                int64_t j_m_i_27035 = sub64(x_27024, i_27034);\n                bool empty_slice_27036 = j_m_i_27035 == (int64_t) 0;\n                int64_t m_27037 = sub64(j_m_i_27035, (int64_t) 1);\n                int64_t i_p_m_t_s_27038 = add64(i_27034, m_27037);\n                bool zzero_leq_i_p_m_t_s_27039 = sle64((int64_t) 0,\n                                                       i_p_m_t_s_27038);\n                bool i_p_m_t_s_leq_w_27040 = slt64(i_p_m_t_s_27038, k_26409);\n                bool zzero_lte_i_27041 = sle64((int64_t) 0, i_27034);\n                bool i_lte_j_27042 = sle64(i_27034, x_27024);\n                bool y_27043 = i_p_m_t_s_leq_w_27040 && zzero_lte_i_27041;\n                bool y_27044 = zzero_leq_i_p_m_t_s_27039 && y_27043;\n                bool y_27045 = i_lte_j_27042 && y_27044;\n                bool forwards_ok_27046 = zzero_lte_i_27041 && y_27045;\n                bool ok_or_empty_27047 = empty_slice_27036 || forwards_ok_27046;\n                bool index_certs_27048;\n                \n                if (!ok_or_empty_27047) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 41) ==\n                            ",
            "-1) {\n                            global_failure_args[0] = i_27034;\n                            global_failure_args[1] = x_27024;\n                            global_failure_args[2] = k_26409;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                \n                bool x_27050 = sle64((int64_t) 0, prevx2_27026);\n                bool y_27051 = slt64(prevx2_27026, m_26408);\n                bool bounds_check_27052 = x_27050 && y_27051;\n                bool index_certs_27053;\n                \n                if (!bounds_check_27052) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 42) ==\n                            -1) {\n                            global_failure_args[0] = prevx2_27026;\n                            global_failure_args[1] = m_26408;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                \n                int64_t i_27054 = ((__global\n                                    int64_t *) mem_28337)[prevx2_27026];\n                int64_t j_m_i_27055 = sub64(x_27022, i_27054);\n                bool empty_slice_27056 = j_m_i_27055 == (int64_t) 0;\n                int64_t m_27057 = sub64(j_m_i_27055, (int64_t) 1);\n                int64_t i_p_m_t_s_27058 = add64(i_27054, m_27057);\n                bool zzero_leq_i_p_m_t_s_27059 = sle64((int64_t) 0,\n                                                       i_p_m_t_s_27058);\n                bool i_p_m_t_s_leq_w_27060 = slt64(i_p_m_t_s_27058,\n                                                   eWiseAddOffsets_res_26600);\n                bool zzero_lte_i_27061 = sle64((int64_t) 0, i_27054);\n                bool i_lte_j_27062 = sle64(i_27054, x_27022);\n                bool y_27063 = i_p_m_t_s_leq_w_27060 && ",
            "zzero_lte_i_27061;\n                bool y_27064 = zzero_leq_i_p_m_t_s_27059 && y_27063;\n                bool y_27065 = i_lte_j_27062 && y_27064;\n                bool forwards_ok_27066 = zzero_lte_i_27061 && y_27065;\n                bool ok_or_empty_27067 = empty_slice_27056 || forwards_ok_27066;\n                bool index_certs_27068;\n                \n                if (!ok_or_empty_27067) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 43) ==\n                            -1) {\n                            global_failure_args[0] = i_27054;\n                            global_failure_args[1] = x_27022;\n                            global_failure_args[2] = eWiseAddOffsets_res_26600;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                \n                int64_t conc_tmp_27071 = j_m_i_27035 + j_m_i_27055;\n                int64_t intersectSizze_res_27070;\n                \n                if (empty_slice_27056) {\n                    intersectSizze_res_27070 = (int64_t) 0;\n                } else {\n                    int64_t j_m_i_27072 = sub64(conc_tmp_27071, (int64_t) 1);\n                    int64_t intersectSizze_res_f_res_27073;\n                    \n                    if (empty_slice_27036) {\n                        intersectSizze_res_f_res_27073 = (int64_t) 0;\n                    } else {\n                        int64_t tmp_offs_29710 = (int64_t) 0;\n                        \n                        for (int64_t i_29711 = 0; i_29711 < j_m_i_27055;\n                             i_29711++) {\n                            ((__global int64_t *) mem_28484)[phys_tid_27969 +\n                                                             (tmp_offs_29710 +\n                                                              i_29711) *\n                                                             num_threa",
            "ds_29036] =\n                                ((__global int64_t *) mem_28341)[i_27054 +\n                                                                 i_29711];\n                        }\n                        tmp_offs_29710 += j_m_i_27055;\n                        for (int64_t i_29712 = 0; i_29712 < j_m_i_27035;\n                             i_29712++) {\n                            ((__global int64_t *) mem_28484)[phys_tid_27969 +\n                                                             (tmp_offs_29710 +\n                                                              i_29712) *\n                                                             num_threads_29036] =\n                                ((__global\n                                  int64_t *) rightColumns_mem_28235)[i_27034 +\n                                                                     i_29712];\n                        }\n                        tmp_offs_29710 += j_m_i_27035;\n                        \n                        bool cond_27075 = conc_tmp_27071 == (int64_t) 0;\n                        int32_t iters_27076;\n                        \n                        if (cond_27075) {\n                            iters_27076 = 0;\n                        } else {\n                            iters_27076 = 32;\n                        }\n                        \n                        bool loop_nonempty_27077 = slt32(0, iters_27076);\n                        bool x_27078 = sle64((int64_t) 0, j_m_i_27072);\n                        bool y_27079 = slt64(j_m_i_27072, conc_tmp_27071);\n                        bool bounds_check_27080 = x_27078 && y_27079;\n                        bool loop_not_taken_27081 = !loop_nonempty_27077;\n                        bool protect_assert_disj_27082 = bounds_check_27080 ||\n                             loop_not_taken_27081;\n                        bool index_certs_27083;\n                        \n                        if (!protect_assert_disj_27082) {\n                            {\n       ",
            "                         if (atomic_cmpxchg_i32_global(global_failure,\n                                                              -1, 44) == -1) {\n                                    global_failure_args[0] = j_m_i_27072;\n                                    global_failure_args[1] = conc_tmp_27071;\n                                    ;\n                                }\n                                local_failure = true;\n                                goto error_0;\n                            }\n                        }\n                        for (int64_t i_29713 = 0; i_29713 < conc_tmp_27071;\n                             i_29713++) {\n                            ((__global\n                              int64_t *) double_buffer_mem_28767)[phys_tid_27969 +\n                                                                  i_29713 *\n                                                                  num_threads_29036] =\n                                ((__global\n                                  int64_t *) mem_28484)[phys_tid_27969 +\n                                                        i_29713 *\n                                                        num_threads_29036];\n                        }\n                        for (int32_t i_27085 = 0; i_27085 < iters_27076;\n                             i_27085++) {\n                            int32_t defunc_2_radix_sort_step_arg_27087 =\n                                    mul32(2, i_27085);\n                            int32_t defunc_0_get_bit_arg_27088 = add32(1,\n                                                                       defunc_2_radix_sort_step_arg_27087);\n                            int64_t i32_res_27089 =\n                                    sext_i32_i64(defunc_0_get_bit_arg_27088);\n                            int64_t i32_res_27090 =\n                                    sext_i32_i64(defunc_2_radix_sort_step_arg_27087);\n                            int64_t discard_28202;\n                            int64_t disc",
            "ard_28203;\n                            int64_t discard_28204;\n                            int64_t discard_28205;\n                            int64_t scanacc_28187;\n                            int64_t scanacc_28188;\n                            int64_t scanacc_28189;\n                            int64_t scanacc_28190;\n                            \n                            scanacc_28187 = (int64_t) 0;\n                            scanacc_28188 = (int64_t) 0;\n                            scanacc_28189 = (int64_t) 0;\n                            scanacc_28190 = (int64_t) 0;\n                            for (int64_t i_28196 = 0; i_28196 < conc_tmp_27071;\n                                 i_28196++) {\n                                int64_t x_27118 = ((__global\n                                                    int64_t *) double_buffer_mem_28767)[phys_tid_27969 +\n                                                                                        i_28196 *\n                                                                                        num_threads_29036];\n                                int64_t zgzg_res_27119 = ashr64(x_27118,\n                                                                i32_res_27089);\n                                int64_t za_res_27120 = (int64_t) 1 &\n                                        zgzg_res_27119;\n                                int32_t to_i32_res_27121 =\n                                        sext_i64_i32(za_res_27120);\n                                int32_t x_27122 = mul32(2, to_i32_res_27121);\n                                int64_t zgzg_res_27123 = ashr64(x_27118,\n                                                                i32_res_27090);\n                                int64_t za_res_27124 = (int64_t) 1 &\n                                        zgzg_res_27123;\n                                int32_t to_i32_res_27125 =\n                                        sext_i64_i32(za_res_27124);\n                                int32_t ",
            "defunc_0_f_res_27126 = add32(x_27122,\n                                                                     to_i32_res_27125);\n                                bool cond_27127 = defunc_0_f_res_27126 == 0;\n                                int64_t defunc_0_f_res_27128 =\n                                        btoi_bool_i64(cond_27127);\n                                int64_t defunc_0_f_res_27129;\n                                int64_t defunc_0_f_res_27130;\n                                int64_t defunc_0_f_res_27131;\n                                \n                                if (cond_27127) {\n                                    defunc_0_f_res_27129 = (int64_t) 0;\n                                    defunc_0_f_res_27130 = (int64_t) 0;\n                                    defunc_0_f_res_27131 = (int64_t) 0;\n                                } else {\n                                    bool cond_27132 = defunc_0_f_res_27126 == 1;\n                                    int64_t defunc_0_f_res_f_res_27133 =\n                                            btoi_bool_i64(cond_27132);\n                                    int64_t defunc_0_f_res_f_res_27134;\n                                    int64_t defunc_0_f_res_f_res_27135;\n                                    \n                                    if (cond_27132) {\n                                        defunc_0_f_res_f_res_27134 =\n                                            (int64_t) 0;\n                                        defunc_0_f_res_f_res_27135 =\n                                            (int64_t) 0;\n                                    } else {\n                                        bool cond_27136 =\n                                             defunc_0_f_res_27126 == 2;\n                                        int64_t defunc_0_f_res_f_res_f_res_27137\n                                                = btoi_bool_i64(cond_27136);\n                                        bool cond_neg_27138 = !cond_27136;\n                     ",
            "                   int64_t defunc_0_f_res_f_res_f_res_27139\n                                                = btoi_bool_i64(cond_neg_27138);\n                                        \n                                        defunc_0_f_res_f_res_27134 =\n                                            defunc_0_f_res_f_res_f_res_27137;\n                                        defunc_0_f_res_f_res_27135 =\n                                            defunc_0_f_res_f_res_f_res_27139;\n                                    }\n                                    defunc_0_f_res_27129 =\n                                        defunc_0_f_res_f_res_27133;\n                                    defunc_0_f_res_27130 =\n                                        defunc_0_f_res_f_res_27134;\n                                    defunc_0_f_res_27131 =\n                                        defunc_0_f_res_f_res_27135;\n                                }\n                                \n                                int64_t defunc_1_op_res_27114 =\n                                        add64(defunc_0_f_res_27128,\n                                              scanacc_28187);\n                                int64_t defunc_1_op_res_27115 =\n                                        add64(defunc_0_f_res_27129,\n                                              scanacc_28188);\n                                int64_t defunc_1_op_res_27116 =\n                                        add64(defunc_0_f_res_27130,\n                                              scanacc_28189);\n                                int64_t defunc_1_op_res_27117 =\n                                        add64(defunc_0_f_res_27131,\n                                              scanacc_28190);\n                                \n                                ((__global\n                                  int64_t *) mem_28493)[phys_tid_27969 +\n                                                        i_28196 *\n                                               ",
            "         num_threads_29036] =\n                                    defunc_1_op_res_27114;\n                                ((__global\n                                  int64_t *) mem_28495)[phys_tid_27969 +\n                                                        i_28196 *\n                                                        num_threads_29036] =\n                                    defunc_1_op_res_27115;\n                                ((__global\n                                  int64_t *) mem_28497)[phys_tid_27969 +\n                                                        i_28196 *\n                                                        num_threads_29036] =\n                                    defunc_1_op_res_27116;\n                                ((__global\n                                  int64_t *) mem_28499)[phys_tid_27969 +\n                                                        i_28196 *\n                                                        num_threads_29036] =\n                                    defunc_1_op_res_27117;\n                                ((__global\n                                  int32_t *) mem_28501)[phys_tid_27969 +\n                                                        i_28196 *\n                                                        num_threads_29036] =\n                                    defunc_0_f_res_27126;\n                                \n                                int64_t scanacc_tmp_29715 =\n                                        defunc_1_op_res_27114;\n                                int64_t scanacc_tmp_29716 =\n                                        defunc_1_op_res_27115;\n                                int64_t scanacc_tmp_29717 =\n                                        defunc_1_op_res_27116;\n                                int64_t scanacc_tmp_29718 =\n                                        defunc_1_op_res_27117;\n                                \n                                scanacc_28187 = scanacc_tmp_29715;\n               ",
            "                 scanacc_28188 = scanacc_tmp_29716;\n                                scanacc_28189 = scanacc_tmp_29717;\n                                scanacc_28190 = scanacc_tmp_29718;\n                            }\n                            discard_28202 = scanacc_28187;\n                            discard_28203 = scanacc_28188;\n                            discard_28204 = scanacc_28189;\n                            discard_28205 = scanacc_28190;\n                            \n                            int64_t last_res_27145 = ((__global\n                                                       int64_t *) mem_28493)[phys_tid_27969 +\n                                                                             j_m_i_27072 *\n                                                                             num_threads_29036];\n                            int64_t last_res_27146 = ((__global\n                                                       int64_t *) mem_28495)[phys_tid_27969 +\n                                                                             j_m_i_27072 *\n                                                                             num_threads_29036];\n                            int64_t last_res_27147 = ((__global\n                                                       int64_t *) mem_28497)[phys_tid_27969 +\n                                                                             j_m_i_27072 *\n                                                                             num_threads_29036];\n                            \n                            for (int64_t i_29724 = 0; i_29724 < conc_tmp_27071;\n                                 i_29724++) {\n                                ((__global\n                                  int64_t *) mem_28563)[phys_tid_27969 +\n                                                        i_29724 *\n                                                        num_threads_29036] =\n                                    ((__global\n                    ",
            "                  int64_t *) double_buffer_mem_28767)[phys_tid_27969 +\n                                                                          i_29724 *\n                                                                          num_threads_29036];\n                            }\n                            for (int64_t write_iter_28206 = 0;\n                                 write_iter_28206 < conc_tmp_27071;\n                                 write_iter_28206++) {\n                                int32_t write_iv_28208 = ((__global\n                                                           int32_t *) mem_28501)[phys_tid_27969 +\n                                                                                 write_iter_28206 *\n                                                                                 num_threads_29036];\n                                bool match_lit_27156 = 0 == write_iv_28208;\n                                int64_t defunc_1_f_res_27157;\n                                \n                                if (match_lit_27156) {\n                                    int64_t write_iv_28209 = ((__global\n                                                               int64_t *) mem_28493)[phys_tid_27969 +\n                                                                                     write_iter_28206 *\n                                                                                     num_threads_29036];\n                                    int64_t case_res_27158 =\n                                            sub64(write_iv_28209, (int64_t) 1);\n                                    \n                                    defunc_1_f_res_27157 = case_res_27158;\n                                } else {\n                                    int64_t write_iv_28210 = ((__global\n                                                               int64_t *) mem_28495)[phys_tid_27969 +\n                                                                                     write_",
            "iter_28206 *\n                                                                                     num_threads_29036];\n                                    int64_t write_iv_28211 = ((__global\n                                                               int64_t *) mem_28497)[phys_tid_27969 +\n                                                                                     write_iter_28206 *\n                                                                                     num_threads_29036];\n                                    int64_t write_iv_28212 = ((__global\n                                                               int64_t *) mem_28499)[phys_tid_27969 +\n                                                                                     write_iter_28206 *\n                                                                                     num_threads_29036];\n                                    bool match_lit_27159 = 1 == write_iv_28208;\n                                    int64_t x_27160;\n                                    \n                                    if (match_lit_27159) {\n                                        int64_t x_27161 = add64(last_res_27145,\n                                                                write_iv_28210);\n                                        int64_t case_res_27162 = sub64(x_27161,\n                                                                       (int64_t) 1);\n                                        \n                                        x_27160 = case_res_27162;\n                                    } else {\n                                        bool match_lit_27163 = 2 ==\n                                             write_iv_28208;\n                                        int64_t x_27164;\n                                        \n                                        if (match_lit_27163) {\n                                            int64_t x_27165 =\n                                                    add64",
            "(last_res_27145,\n                                                          last_res_27146);\n                                            int64_t x_27166 = add64(x_27165,\n                                                                    write_iv_28211);\n                                            int64_t case_res_27167 =\n                                                    sub64(x_27166, (int64_t) 1);\n                                            \n                                            x_27164 = case_res_27167;\n                                        } else {\n                                            int64_t x_27168 =\n                                                    add64(last_res_27145,\n                                                          last_res_27146);\n                                            int64_t x_27169 =\n                                                    add64(last_res_27147,\n                                                          x_27168);\n                                            int64_t x_27170 = add64(x_27169,\n                                                                    write_iv_28212);\n                                            int64_t defunc_1_f_res_res_27171 =\n                                                    sub64(x_27170, (int64_t) 1);\n                                            \n                                            x_27164 = defunc_1_f_res_res_27171;\n                                        }\n                                        x_27160 = x_27164;\n                                    }\n                                    defunc_1_f_res_27157 = x_27160;\n                                }\n                                \n                                bool less_than_zzero_28214 =\n                                     slt64(defunc_1_f_res_27157, (int64_t) 0);\n                                bool greater_than_sizze_28215 =\n                                     sle64(conc_tmp_27071,\n                                 ",
            "          defunc_1_f_res_27157);\n                                bool outside_bounds_dim_28216 =\n                                     less_than_zzero_28214 ||\n                                     greater_than_sizze_28215;\n                                \n                                if (!outside_bounds_dim_28216) {\n                                    for (int64_t i_29726 = 0; i_29726 <\n                                         (int64_t) 1; i_29726++) {\n                                        ((__global\n                                          int64_t *) mem_28563)[phys_tid_27969 +\n                                                                (defunc_1_f_res_27157 +\n                                                                 i_29726) *\n                                                                num_threads_29036] =\n                                            ((__global\n                                              int64_t *) double_buffer_mem_28767)[phys_tid_27969 +\n                                                                                  num_threads_29036 *\n                                                                                  write_iter_28206 +\n                                                                                  i_29726 *\n                                                                                  num_threads_29036];\n                                    }\n                                }\n                            }\n                            for (int64_t i_29727 = 0; i_29727 < conc_tmp_27071;\n                                 i_29727++) {\n                                ((__global\n                                  int64_t *) double_buffer_mem_28767)[phys_tid_27969 +\n                                                                      i_29727 *\n                                                                      num_threads_29036] =\n                                    ((__global\n                                 ",
            "     int64_t *) mem_28563)[phys_tid_27969 +\n                                                            i_29727 *\n                                                            num_threads_29036];\n                            }\n                        }\n                        \n                        bool empty_slice_27172 = j_m_i_27072 == (int64_t) 0;\n                        bool i_lte_j_27173 = sle64((int64_t) 1, conc_tmp_27071);\n                        bool y_27174 = bounds_check_27080 && i_lte_j_27173;\n                        bool ok_or_empty_27175 = empty_slice_27172 || y_27174;\n                        bool index_certs_27176;\n                        \n                        if (!ok_or_empty_27175) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure,\n                                                              -1, 45) == -1) {\n                                    global_failure_args[0] = (int64_t) 1;\n                                    global_failure_args[1] = conc_tmp_27071;\n                                    ;\n                                }\n                                local_failure = true;\n                                goto error_0;\n                            }\n                        }\n                        \n                        int64_t defunc_2_reduce_res_27179;\n                        int64_t redout_28220 = (int64_t) 0;\n                        \n                        for (int64_t i_28222 = 0; i_28222 < j_m_i_27072;\n                             i_28222++) {\n                            int64_t slice_28230 = (int64_t) 1 + i_28222;\n                            int64_t x_27194 = ((__global\n                                                int64_t *) double_buffer_mem_28767)[phys_tid_27969 +\n                                                                                    slice_28230 *\n                                                                                    num_threads_29036];\n      ",
            "                      bool y_27187 = slt64(i_28222, conc_tmp_27071);\n                            bool index_certs_27189;\n                            \n                            if (!y_27187) {\n                                {\n                                    if (atomic_cmpxchg_i32_global(global_failure,\n                                                                  -1, 46) ==\n                                        -1) {\n                                        global_failure_args[0] = i_28222;\n                                        global_failure_args[1] = conc_tmp_27071;\n                                        ;\n                                    }\n                                    local_failure = true;\n                                    goto error_0;\n                                }\n                            }\n                            \n                            int64_t y_27190 = ((__global\n                                                int64_t *) double_buffer_mem_28767)[phys_tid_27969 +\n                                                                                    i_28222 *\n                                                                                    num_threads_29036];\n                            bool cond_27191 = x_27194 == y_27190;\n                            int64_t defunc_1_op_res_27192;\n                            \n                            if (cond_27191) {\n                                int64_t defunc_1_op_res_t_res_27193 =\n                                        add64((int64_t) 1, redout_28220);\n                                \n                                defunc_1_op_res_27192 =\n                                    defunc_1_op_res_t_res_27193;\n                            } else {\n                                defunc_1_op_res_27192 = redout_28220;\n                            }\n                            \n                            int64_t redout_tmp_29728 = defunc_1_op_res_27192;\n                            \n    ",
            "                        redout_28220 = redout_tmp_29728;\n                        }\n                        defunc_2_reduce_res_27179 = redout_28220;\n                        intersectSizze_res_f_res_27073 =\n                            defunc_2_reduce_res_27179;\n                    }\n                    intersectSizze_res_27070 = intersectSizze_res_f_res_27073;\n                }\n                private_mem_29707[i_29709] = intersectSizze_res_27070;\n            } else {\n                private_mem_29707[i_29709] = (int64_t) 0;\n            }\n        }\n    }\n    // Transpose scan inputs\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29729 = 0; i_29729 < (int64_t) 9; i_29729++) {\n            int64_t sharedIdx_29730 = sext_i32_i64(local_tid_29689) + i_29729 *\n                    segscan_group_sizze_27964;\n            \n            ((__local int64_t *) local_mem_29697)[sharedIdx_29730] =\n                private_mem_29707[i_29729];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_29731 = 0; i_29731 < 9; i_29731++) {\n            int32_t sharedIdx_29732 = local_tid_29689 * 9 + i_29731;\n            \n            private_mem_29707[sext_i32_i64(i_29731)] = ((__local\n                                                         int64_t *) local_mem_29697)[sext_i32_i64(sharedIdx_29732)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Per thread scan\n    {\n        for (int64_t i_29733 = 0; i_29733 < (int64_t) 8; i_29733++) {\n            int64_t x_27019;\n            int64_t x_27020;\n            \n            x_27019 = private_mem_29707[i_29733];\n            x_27020 = private_mem_29707[i_29733 + (int64_t) 1];\n            \n            int64_t defunc_1_op_res_27021;\n            \n            defunc_1_op_res_27021 = add64(x_27019, x_27020);\n            private_mem_29707[i_29733 + (int64_t) 1] = defunc_1_op_res_27021;\n        }\n    }\n    // Publish results in shared memory\n    {\n        ((__local int64_t *) local_mem_29697)[squot64(byte_offse",
            "ts_29693,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_29689)] =\n            private_mem_29707[(int64_t) 8];\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t acc_29737;\n    \n    // Scan results (with warp scan)\n    {\n        int64_t x_29734;\n        int64_t x_29735;\n        int64_t x_29738;\n        int64_t x_29739;\n        bool ltid_in_bounds_29741;\n        \n        ltid_in_bounds_29741 = slt64(sext_i32_i64(local_tid_29689),\n                                     segscan_group_sizze_27964);\n        \n        int32_t skip_threads_29742;\n        \n        // read input for in-block scan\n        {\n            if (ltid_in_bounds_29741) {\n                x_29735 = ((volatile __local\n                            int64_t *) local_mem_29697)[squot64(byte_offsets_29693,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_29689)];\n                if ((local_tid_29689 - squot32(local_tid_29689, 32) * 32) ==\n                    0) {\n                    x_29734 = x_29735;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_29742 = 1;\n            while (slt32(skip_threads_29742, 32)) {\n                if (sle32(skip_threads_29742, local_tid_29689 -\n                          squot32(local_tid_29689, 32) * 32) &&\n                    ltid_in_bounds_29741) {\n                    // read operands\n                    {\n                        x_29734 = ((volatile __local\n                                    int64_t *) local_mem_29697)[squot64(byte_offsets_29693,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_29689) -\n                                                                ",
            " sext_i32_i64(skip_threads_29742))];\n                    }\n                    // perform operation\n                    {\n                        int64_t defunc_1_op_res_29736 = add64(x_29734, x_29735);\n                        \n                        x_29734 = defunc_1_op_res_29736;\n                    }\n                }\n                if (sle32(wave_sizze_29691, skip_threads_29742)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_29742, local_tid_29689 -\n                          squot32(local_tid_29689, 32) * 32) &&\n                    ltid_in_bounds_29741) {\n                    // write result\n                    {\n                        ((volatile __local\n                          int64_t *) local_mem_29697)[squot64(byte_offsets_29693,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_29689)] =\n                            x_29734;\n                        x_29735 = x_29734;\n                    }\n                }\n                if (sle32(wave_sizze_29691, skip_threads_29742)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_29742 *= 2;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // last thread of block 'i' writes its result to offset 'i'\n        {\n            if ((local_tid_29689 - squot32(local_tid_29689, 32) * 32) == 31 &&\n                ltid_in_bounds_29741) {\n                ((volatile __local\n                  int64_t *) local_mem_29697)[squot64(byte_offsets_29693,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_29689,\n                                                                   32))] =\n                    x_29734;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // scan the first block, after",
            " which offset 'i' contains carry-in for block 'i+1'\n        {\n            int32_t skip_threads_29743;\n            \n            // read input for in-block scan\n            {\n                if (squot32(local_tid_29689, 32) == 0 && ltid_in_bounds_29741) {\n                    x_29739 = ((volatile __local\n                                int64_t *) local_mem_29697)[squot64(byte_offsets_29693,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_29689)];\n                    if ((local_tid_29689 - squot32(local_tid_29689, 32) * 32) ==\n                        0) {\n                        x_29738 = x_29739;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_29743 = 1;\n                while (slt32(skip_threads_29743, 32)) {\n                    if (sle32(skip_threads_29743, local_tid_29689 -\n                              squot32(local_tid_29689, 32) * 32) &&\n                        (squot32(local_tid_29689, 32) == 0 &&\n                         ltid_in_bounds_29741)) {\n                        // read operands\n                        {\n                            x_29738 = ((volatile __local\n                                        int64_t *) local_mem_29697)[squot64(byte_offsets_29693,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_29689) -\n                                                                     sext_i32_i64(skip_threads_29743))];\n                        }\n                        // perform operation\n                        {\n                            int64_t defunc_1_op_res_29740 = add64(x_29738,\n                                                                  x_29739);\n                            \n               ",
            "             x_29738 = defunc_1_op_res_29740;\n                        }\n                    }\n                    if (sle32(wave_sizze_29691, skip_threads_29743)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_29743, local_tid_29689 -\n                              squot32(local_tid_29689, 32) * 32) &&\n                        (squot32(local_tid_29689, 32) == 0 &&\n                         ltid_in_bounds_29741)) {\n                        // write result\n                        {\n                            ((volatile __local\n                              int64_t *) local_mem_29697)[squot64(byte_offsets_29693,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_29689)] =\n                                x_29738;\n                            x_29739 = x_29738;\n                        }\n                    }\n                    if (sle32(wave_sizze_29691, skip_threads_29743)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_29743 *= 2;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // carry-in for every block except the first\n        {\n            if (!(squot32(local_tid_29689, 32) == 0 || !ltid_in_bounds_29741)) {\n                // read operands\n                {\n                    x_29735 = x_29734;\n                    x_29734 = ((__local\n                                int64_t *) local_mem_29697)[squot64(byte_offsets_29693,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_29689,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                }\n     ",
            "           // perform operation\n                {\n                    int64_t defunc_1_op_res_29736 = add64(x_29734, x_29735);\n                    \n                    x_29734 = defunc_1_op_res_29736;\n                }\n                // write final result\n                {\n                    ((__local\n                      int64_t *) local_mem_29697)[squot64(byte_offsets_29693,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_29689)] =\n                        x_29734;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // restore correct values for first block\n        {\n            if (squot32(local_tid_29689, 32) == 0) {\n                ((__local\n                  int64_t *) local_mem_29697)[squot64(byte_offsets_29693,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_29689)] =\n                    x_29735;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_tid_29689 == 0) {\n            acc_29737 = ((__local\n                          int64_t *) local_mem_29697)[squot64(byte_offsets_29693,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_27964 -\n                                                       (int64_t) 1)];\n        } else {\n            acc_29737 = ((__local\n                          int64_t *) local_mem_29697)[squot64(byte_offsets_29693,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_29689) -\n                                                       (int64_t) 1)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t prefix_29744;\n    \n    prefix_29744 = ",
            "(int64_t) 0;\n    // Perform lookback\n    {\n        if (dynamic_id_29705 == (int64_t) 0 && local_tid_29689 == 0) {\n            ((volatile __global\n              int64_t *) incprefixes_mem_29686)[dynamic_id_29705] = acc_29737;\n            mem_fence_global();\n            ((volatile __global\n              int8_t *) status_flags_mem_29682)[dynamic_id_29705] = (int8_t) 2;\n            acc_29737 = (int64_t) 0;\n        }\n        if (!(dynamic_id_29705 == (int64_t) 0) && slt32(local_tid_29689,\n                                                        wave_sizze_29691)) {\n            if (local_tid_29689 == 0) {\n                ((volatile __global\n                  int64_t *) aggregates_mem_29684)[dynamic_id_29705] =\n                    acc_29737;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_29682)[dynamic_id_29705] =\n                    (int8_t) 1;\n                ((__local int8_t *) local_mem_29697)[(int64_t) 0] = ((__global\n                                                                      int8_t *) status_flags_mem_29682)[dynamic_id_29705 -\n                                                                                                        (int64_t) 1];\n            }\n            mem_fence_local();\n            \n            int8_t status_29745;\n            \n            status_29745 = ((__local int8_t *) local_mem_29697)[(int64_t) 0];\n            if (status_29745 == (int8_t) 2) {\n                if (local_tid_29689 == 0) {\n                    prefix_29744 = ((volatile __global\n                                     int64_t *) incprefixes_mem_29686)[dynamic_id_29705 -\n                                                                       (int64_t) 1];\n                }\n            } else {\n                int32_t readOffset_29746 = dynamic_id_29705 -\n                        sext_i32_i64(wave_sizze_29691);\n                \n                while (slt32(wave_sizze_29691 * -1, readOffset_29746)) {\n           ",
            "         int32_t read_i_29747 = readOffset_29746 + local_tid_29689;\n                    int64_t aggr_29748 = (int64_t) 0;\n                    int8_t flag_29749 = (int8_t) 0;\n                    int8_t used_29750 = (int8_t) 0;\n                    \n                    if (sle32(0, read_i_29747)) {\n                        flag_29749 = ((volatile __global\n                                       int8_t *) status_flags_mem_29682)[sext_i32_i64(read_i_29747)];\n                        if (flag_29749 == (int8_t) 2) {\n                            aggr_29748 = ((volatile __global\n                                           int64_t *) incprefixes_mem_29686)[sext_i32_i64(read_i_29747)];\n                        } else {\n                            if (flag_29749 == (int8_t) 1) {\n                                aggr_29748 = ((volatile __global\n                                               int64_t *) aggregates_mem_29684)[sext_i32_i64(read_i_29747)];\n                                used_29750 = (int8_t) 1;\n                            }\n                        }\n                    }\n                    ((__local\n                      int64_t *) local_mem_29697)[squot64(warp_byte_offset_29695,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_29689)] =\n                        aggr_29748;\n                    \n                    int8_t tmp_29751;\n                    \n                    tmp_29751 = flag_29749 | used_29750 << (int8_t) 2;\n                    ((__local\n                      int8_t *) local_mem_29697)[sext_i32_i64(local_tid_29689)] =\n                        tmp_29751;\n                    mem_fence_local();\n                    flag_29749 = ((volatile __local\n                                   int8_t *) local_mem_29697)[sext_i32_i64(wave_sizze_29691) -\n                                                              (int64_t) 1];\n                    if (local_tid_29689 == 0) {\n       ",
            "                 if (!(flag_29749 == (int8_t) 2)) {\n                            int64_t x_29752 = (int64_t) 0;\n                            int64_t x_29753;\n                            int8_t flag1_29755;\n                            \n                            flag1_29755 = (int8_t) 0;\n                            \n                            int8_t flag2_29756;\n                            int8_t used1_29757;\n                            \n                            used1_29757 = (int8_t) 0;\n                            \n                            int8_t used2_29758;\n                            \n                            for (int32_t i_29759 = 0; i_29759 <\n                                 wave_sizze_29691; i_29759++) {\n                                flag2_29756 = ((__local\n                                                int8_t *) local_mem_29697)[sext_i32_i64(i_29759)];\n                                used2_29758 = lshr8(flag2_29756, (int8_t) 2);\n                                flag2_29756 = flag2_29756 & (int8_t) 3;\n                                x_29753 = ((__local\n                                            int64_t *) local_mem_29697)[squot64(warp_byte_offset_29695,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_29759)];\n                                if (!(flag2_29756 == (int8_t) 1)) {\n                                    flag1_29755 = flag2_29756;\n                                    used1_29757 = used2_29758;\n                                    x_29752 = x_29753;\n                                } else {\n                                    used1_29757 += used2_29758;\n                                    \n                                    int64_t defunc_1_op_res_29754;\n                                    \n                                    defunc_1_op_res_29754 = add64(x_29752,\n                                                 ",
            "                 x_29753);\n                                    x_29752 = defunc_1_op_res_29754;\n                                }\n                            }\n                            flag_29749 = flag1_29755;\n                            used_29750 = used1_29757;\n                            aggr_29748 = x_29752;\n                        } else {\n                            aggr_29748 = ((__local\n                                           int64_t *) local_mem_29697)[squot64(warp_byte_offset_29695,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_29691) -\n                                                                        (int64_t) 1)];\n                        }\n                        if (flag_29749 == (int8_t) 2) {\n                            readOffset_29746 = wave_sizze_29691 * -1;\n                        } else {\n                            readOffset_29746 -= zext_i8_i32(used_29750);\n                        }\n                        ((__local int32_t *) local_mem_29697)[(int64_t) 0] =\n                            readOffset_29746;\n                        \n                        int64_t x_29760;\n                        \n                        x_29760 = aggr_29748;\n                        \n                        int64_t x_29761;\n                        \n                        x_29761 = prefix_29744;\n                        \n                        int64_t defunc_1_op_res_29762;\n                        \n                        defunc_1_op_res_29762 = add64(x_29760, x_29761);\n                        prefix_29744 = defunc_1_op_res_29762;\n                    }\n                    mem_fence_local();\n                    readOffset_29746 = ((__local\n                                         int32_t *) local_mem_29697)[(int64_t) 0];\n                }\n            }\n            if (local_tid_29689 == 0) {\n                int64",
            "_t x_29763 = prefix_29744;\n                int64_t x_29764 = acc_29737;\n                int64_t defunc_1_op_res_29765 = add64(x_29763, x_29764);\n                \n                ((volatile __global\n                  int64_t *) incprefixes_mem_29686)[dynamic_id_29705] =\n                    defunc_1_op_res_29765;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_29682)[dynamic_id_29705] =\n                    (int8_t) 2;\n                ((__local\n                  int64_t *) local_mem_29697)[squot64(warp_byte_offset_29695,\n                                                      (int64_t) 8)] =\n                    prefix_29744;\n                acc_29737 = (int64_t) 0;\n            }\n        }\n        if (!(dynamic_id_29705 == (int64_t) 0)) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            prefix_29744 = ((__local\n                             int64_t *) local_mem_29697)[squot64(warp_byte_offset_29695,\n                                                                 (int64_t) 8)];\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    // Distribute results\n    {\n        int64_t x_29766;\n        int64_t x_29767;\n        int64_t x_29769;\n        \n        x_29769 = prefix_29744;\n        \n        int64_t x_29770;\n        \n        x_29770 = acc_29737;\n        \n        int64_t defunc_1_op_res_29771;\n        \n        defunc_1_op_res_29771 = add64(x_29769, x_29770);\n        x_29766 = defunc_1_op_res_29771;\n        for (int64_t i_29772 = 0; i_29772 < (int64_t) 9; i_29772++) {\n            x_29767 = private_mem_29707[i_29772];\n            \n            int64_t defunc_1_op_res_29768;\n            \n            defunc_1_op_res_29768 = add64(x_29766, x_29767);\n            private_mem_29707[i_29772] = defunc_1_op_res_29768;\n        }\n    }\n    // Transpose scan output\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29773 = 0; i_29773 < (int64_t) 9; i_29773++) {\n            int64_t sharedIdx_2977",
            "4 = sext_i32_i64(local_tid_29689 * 9) +\n                    i_29773;\n            \n            ((__local int64_t *) local_mem_29697)[sharedIdx_29774] =\n                private_mem_29707[i_29773];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29775 = 0; i_29775 < (int64_t) 9; i_29775++) {\n            int32_t sharedIdx_29776 = local_tid_29689 +\n                    sext_i64_i32(segscan_group_sizze_27964 * i_29775);\n            \n            private_mem_29707[i_29775] = ((__local\n                                           int64_t *) local_mem_29697)[sext_i32_i64(sharedIdx_29776)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Write block scan results to global memory\n    {\n        for (int64_t i_29777 = 0; i_29777 < (int64_t) 9; i_29777++) {\n            int64_t gtid_27968 = blockOff_29706 + segscan_group_sizze_27964 *\n                    i_29777 + sext_i32_i64(local_tid_29689);\n            \n            if (slt64(gtid_27968, m_26408)) {\n                ((__global int64_t *) mem_28582)[gtid_27968] =\n                    private_mem_29707[i_29777];\n            }\n        }\n    }\n    // If this is the last block, reset the dynamicId\n    {\n        if (dynamic_id_29705 == sdiv_up64(m_26408, segscan_group_sizze_27964 *\n                                          (int64_t) 9) - (int64_t) 1) {\n            ((__global\n              int32_t *) eWiseAddMultEntryziid_counter_mem_29680)[(int64_t) 0] =\n                0;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_27964\n}\n__kernel void eWiseAddMultEntryzisegscan_27977(__global int *global_failure,\n                                               uint local_mem_29824_backing_offset_0,\n                                               int64_t conc_tmp_27249,\n                                               int64_t i32_res_27284,\n                                               int64_t i32_res_27285, __global\n                                               unsigned char *mem_param_286",
            "11,\n                                               __global\n                                               unsigned char *mem_28623,\n                                               __global\n                                               unsigned char *mem_28625,\n                                               __global\n                                               unsigned char *mem_28627,\n                                               __global\n                                               unsigned char *mem_28629,\n                                               __global\n                                               unsigned char *mem_28631,\n                                               __global\n                                               unsigned char *eWiseAddMultEntryziid_counter_mem_29789,\n                                               __global\n                                               unsigned char *status_flags_mem_29791,\n                                               __global\n                                               unsigned char *aggregates_mem_29793,\n                                               __global\n                                               unsigned char *incprefixes_mem_29795,\n                                               __global\n                                               unsigned char *aggregates_mem_29797,\n                                               __global\n                                               unsigned char *incprefixes_mem_29799,\n                                               __global\n                                               unsigned char *aggregates_mem_29801,\n                                               __global\n                                               unsigned char *incprefixes_mem_29803,\n                                               __global\n                                               unsigned char *aggregates_mem_29805,\n                                               __global\n           ",
            "                                    unsigned char *incprefixes_mem_29807)\n{\n    #define segscan_group_sizze_27972 (eWiseAddMultEntryzisegscan_group_sizze_27971)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *local_mem_29824_backing_0 =\n                  &shared_mem[local_mem_29824_backing_offset_0];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29809;\n    int32_t local_tid_29810;\n    int64_t group_sizze_29813;\n    int32_t wave_sizze_29812;\n    int32_t group_tid_29811;\n    \n    global_tid_29809 = get_global_id(0);\n    local_tid_29810 = get_local_id(0);\n    group_sizze_29813 = get_local_size(0);\n    wave_sizze_29812 = LOCKSTEP_WIDTH;\n    group_tid_29811 = get_group_id(0);\n    \n    int32_t phys_tid_27977;\n    \n    phys_tid_27977 = global_tid_29809;\n    \n    int64_t byte_offsets_29814;\n    \n    byte_offsets_29814 = (int64_t) 0;\n    \n    int64_t byte_offsets_29815;\n    \n    byte_offsets_29815 = segscan_group_sizze_27972 * (int64_t) 8;\n    \n    int64_t byte_offsets_29816;\n    \n    byte_offsets_29816 = sdiv_up64(segscan_group_sizze_27972 * (int64_t) 8,\n                                   (int64_t) 8) * (int64_t) 8 +\n        segscan_group_sizze_27972 * (int64_t) 8;\n    \n    int64_t byte_offsets_29817;\n    \n    byte_offsets_29817 = sdiv_up64(sdiv_up64(segscan_group_sizze_27972 *\n                                             (int64_t) 8, (int64_t) 8) *\n                                   (int64_t) 8 + segscan_group_sizze_27972 *\n                                   (int64_t) 8, (int64_t) 8) * (int64_t) 8 +\n        segscan_group_sizze_27972 * (int64_t) 8;\n    \n    int64_t byte_offsets_29818;\n    \n    byte_offsets_29818 =\n        sdiv_up64(sdiv_up64(sdiv_up64(segscan_group_sizze_27972 * (int64_t) 8,\n                                      (int64_t) 8) * (int64_t) 8 +\n                            segscan_group_sizze_27972 * (int64_t) 8,\n                            (int64_t) 8) * (int64_t)",
            " 8 +\n                  segscan_group_sizze_27972 * (int64_t) 8, (int64_t) 8) *\n        (int64_t) 8 + segscan_group_sizze_27972 * (int64_t) 8;\n    \n    int64_t warp_byte_offset_29819;\n    \n    warp_byte_offset_29819 = (int64_t) 32;\n    \n    int64_t warp_byte_offset_29820;\n    \n    warp_byte_offset_29820 = (int64_t) 288;\n    \n    int64_t warp_byte_offset_29821;\n    \n    warp_byte_offset_29821 = (int64_t) 544;\n    \n    int64_t warp_byte_offset_29822;\n    \n    warp_byte_offset_29822 = (int64_t) 800;\n    \n    int64_t warp_byte_offset_29823;\n    \n    warp_byte_offset_29823 = (int64_t) 1056;\n    // Allocate reused shared memeory\n    { }\n    \n    __local char *local_mem_29824;\n    \n    local_mem_29824 = (__local char *) local_mem_29824_backing_0;\n    \n    int64_t trans_arr_len_29825;\n    \n    trans_arr_len_29825 = (int64_t) 9 * segscan_group_sizze_27972;\n    \n    int32_t dynamic_id_29841;\n    \n    if (local_tid_29810 == 0) {\n        dynamic_id_29841 = atomic_add_i32_global(&((volatile __global\n                                                    int *) eWiseAddMultEntryziid_counter_mem_29789)[(int64_t) 0],\n                                                 (int) 1);\n        ((__local int32_t *) local_mem_29824)[(int64_t) 0] = dynamic_id_29841;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    dynamic_id_29841 = ((__local int32_t *) local_mem_29824)[(int64_t) 0];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t blockOff_29842;\n    \n    blockOff_29842 = sext_i32_i64(dynamic_id_29841) * (int64_t) 9 *\n        segscan_group_sizze_27972;\n    \n    int64_t private_mem_29843[9];\n    int64_t private_mem_29845[9];\n    int64_t private_mem_29847[9];\n    int64_t private_mem_29849[9];\n    \n    // Load and map\n    {\n        for (int64_t i_29851 = 0; i_29851 < (int64_t) 9; i_29851++) {\n            int64_t gtid_27976 = blockOff_29842 +\n                    sext_i32_i64(local_tid_29810) + i_29851 *\n                    segscan_group_sizze_27972;\n            \n            if (slt64(gtid_27976, conc_tmp_",
            "27249)) {\n                int64_t x_27313 = ((__global\n                                    int64_t *) mem_param_28611)[gtid_27976];\n                int64_t zgzg_res_27314 = ashr64(x_27313, i32_res_27284);\n                int64_t za_res_27315 = (int64_t) 1 & zgzg_res_27314;\n                int32_t to_i32_res_27316 = sext_i64_i32(za_res_27315);\n                int32_t x_27317 = mul32(2, to_i32_res_27316);\n                int64_t zgzg_res_27318 = ashr64(x_27313, i32_res_27285);\n                int64_t za_res_27319 = (int64_t) 1 & zgzg_res_27318;\n                int32_t to_i32_res_27320 = sext_i64_i32(za_res_27319);\n                int32_t defunc_0_f_res_27321 = add32(x_27317, to_i32_res_27320);\n                bool cond_27322 = defunc_0_f_res_27321 == 0;\n                int64_t defunc_0_f_res_27323 = btoi_bool_i64(cond_27322);\n                int64_t defunc_0_f_res_27324;\n                int64_t defunc_0_f_res_27325;\n                int64_t defunc_0_f_res_27326;\n                \n                if (cond_27322) {\n                    defunc_0_f_res_27324 = (int64_t) 0;\n                    defunc_0_f_res_27325 = (int64_t) 0;\n                    defunc_0_f_res_27326 = (int64_t) 0;\n                } else {\n                    bool cond_27327 = defunc_0_f_res_27321 == 1;\n                    int64_t defunc_0_f_res_f_res_27328 =\n                            btoi_bool_i64(cond_27327);\n                    int64_t defunc_0_f_res_f_res_27329;\n                    int64_t defunc_0_f_res_f_res_27330;\n                    \n                    if (cond_27327) {\n                        defunc_0_f_res_f_res_27329 = (int64_t) 0;\n                        defunc_0_f_res_f_res_27330 = (int64_t) 0;\n                    } else {\n                        bool cond_27331 = defunc_0_f_res_27321 == 2;\n                        int64_t defunc_0_f_res_f_res_f_res_27332 =\n                                btoi_bool_i64(cond_27331);\n                        bool cond_neg_27333 = !cond_27331;\n                   ",
            "     int64_t defunc_0_f_res_f_res_f_res_27334 =\n                                btoi_bool_i64(cond_neg_27333);\n                        \n                        defunc_0_f_res_f_res_27329 =\n                            defunc_0_f_res_f_res_f_res_27332;\n                        defunc_0_f_res_f_res_27330 =\n                            defunc_0_f_res_f_res_f_res_27334;\n                    }\n                    defunc_0_f_res_27324 = defunc_0_f_res_f_res_27328;\n                    defunc_0_f_res_27325 = defunc_0_f_res_f_res_27329;\n                    defunc_0_f_res_27326 = defunc_0_f_res_f_res_27330;\n                }\n                ((__global int32_t *) mem_28631)[gtid_27976] =\n                    defunc_0_f_res_27321;\n                private_mem_29843[i_29851] = defunc_0_f_res_27323;\n                private_mem_29845[i_29851] = defunc_0_f_res_27324;\n                private_mem_29847[i_29851] = defunc_0_f_res_27325;\n                private_mem_29849[i_29851] = defunc_0_f_res_27326;\n            } else {\n                private_mem_29843[i_29851] = (int64_t) 0;\n                private_mem_29845[i_29851] = (int64_t) 0;\n                private_mem_29847[i_29851] = (int64_t) 0;\n                private_mem_29849[i_29851] = (int64_t) 0;\n            }\n        }\n    }\n    // Transpose scan inputs\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29852 = 0; i_29852 < (int64_t) 9; i_29852++) {\n            int64_t sharedIdx_29853 = sext_i32_i64(local_tid_29810) + i_29852 *\n                    segscan_group_sizze_27972;\n            \n            ((__local int64_t *) local_mem_29824)[sharedIdx_29853] =\n                private_mem_29843[i_29852];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_29854 = 0; i_29854 < 9; i_29854++) {\n            int32_t sharedIdx_29855 = local_tid_29810 * 9 + i_29854;\n            \n            private_mem_29843[sext_i32_i64(i_29854)] = ((__local\n                                                         int64_t *) local_",
            "mem_29824)[sext_i32_i64(sharedIdx_29855)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29856 = 0; i_29856 < (int64_t) 9; i_29856++) {\n            int64_t sharedIdx_29857 = sext_i32_i64(local_tid_29810) + i_29856 *\n                    segscan_group_sizze_27972;\n            \n            ((__local int64_t *) local_mem_29824)[sharedIdx_29857] =\n                private_mem_29845[i_29856];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_29858 = 0; i_29858 < 9; i_29858++) {\n            int32_t sharedIdx_29859 = local_tid_29810 * 9 + i_29858;\n            \n            private_mem_29845[sext_i32_i64(i_29858)] = ((__local\n                                                         int64_t *) local_mem_29824)[sext_i32_i64(sharedIdx_29859)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29860 = 0; i_29860 < (int64_t) 9; i_29860++) {\n            int64_t sharedIdx_29861 = sext_i32_i64(local_tid_29810) + i_29860 *\n                    segscan_group_sizze_27972;\n            \n            ((__local int64_t *) local_mem_29824)[sharedIdx_29861] =\n                private_mem_29847[i_29860];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_29862 = 0; i_29862 < 9; i_29862++) {\n            int32_t sharedIdx_29863 = local_tid_29810 * 9 + i_29862;\n            \n            private_mem_29847[sext_i32_i64(i_29862)] = ((__local\n                                                         int64_t *) local_mem_29824)[sext_i32_i64(sharedIdx_29863)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29864 = 0; i_29864 < (int64_t) 9; i_29864++) {\n            int64_t sharedIdx_29865 = sext_i32_i64(local_tid_29810) + i_29864 *\n                    segscan_group_sizze_27972;\n            \n            ((__local int64_t *) local_mem_29824)[sharedIdx_29865] =\n                private_mem_29849[i_29864];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_29866 = 0; i_29866 < 9; i_298",
            "66++) {\n            int32_t sharedIdx_29867 = local_tid_29810 * 9 + i_29866;\n            \n            private_mem_29849[sext_i32_i64(i_29866)] = ((__local\n                                                         int64_t *) local_mem_29824)[sext_i32_i64(sharedIdx_29867)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Per thread scan\n    {\n        for (int64_t i_29868 = 0; i_29868 < (int64_t) 8; i_29868++) {\n            int64_t x_27301;\n            int64_t x_27305;\n            \n            x_27301 = private_mem_29843[i_29868];\n            x_27305 = private_mem_29843[i_29868 + (int64_t) 1];\n            \n            int64_t x_27302;\n            int64_t x_27306;\n            \n            x_27302 = private_mem_29845[i_29868];\n            x_27306 = private_mem_29845[i_29868 + (int64_t) 1];\n            \n            int64_t x_27303;\n            int64_t x_27307;\n            \n            x_27303 = private_mem_29847[i_29868];\n            x_27307 = private_mem_29847[i_29868 + (int64_t) 1];\n            \n            int64_t x_27304;\n            int64_t x_27308;\n            \n            x_27304 = private_mem_29849[i_29868];\n            x_27308 = private_mem_29849[i_29868 + (int64_t) 1];\n            \n            int64_t defunc_1_op_res_27309;\n            \n            defunc_1_op_res_27309 = add64(x_27301, x_27305);\n            \n            int64_t defunc_1_op_res_27310 = add64(x_27302, x_27306);\n            int64_t defunc_1_op_res_27311 = add64(x_27303, x_27307);\n            int64_t defunc_1_op_res_27312 = add64(x_27304, x_27308);\n            \n            private_mem_29843[i_29868 + (int64_t) 1] = defunc_1_op_res_27309;\n            private_mem_29845[i_29868 + (int64_t) 1] = defunc_1_op_res_27310;\n            private_mem_29847[i_29868 + (int64_t) 1] = defunc_1_op_res_27311;\n            private_mem_29849[i_29868 + (int64_t) 1] = defunc_1_op_res_27312;\n        }\n    }\n    // Publish results in shared memory\n    {\n        ((__local int64_t *) local_mem_29824)[squot64(byte_",
            "offsets_29814,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_29810)] =\n            private_mem_29843[(int64_t) 8];\n        ((__local int64_t *) local_mem_29824)[squot64(byte_offsets_29815,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_29810)] =\n            private_mem_29845[(int64_t) 8];\n        ((__local int64_t *) local_mem_29824)[squot64(byte_offsets_29816,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_29810)] =\n            private_mem_29847[(int64_t) 8];\n        ((__local int64_t *) local_mem_29824)[squot64(byte_offsets_29817,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_29810)] =\n            private_mem_29849[(int64_t) 8];\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t acc_29881;\n    int64_t acc_29882;\n    int64_t acc_29883;\n    int64_t acc_29884;\n    \n    // Scan results (with warp scan)\n    {\n        int64_t x_29869;\n        int64_t x_29870;\n        int64_t x_29871;\n        int64_t x_29872;\n        int64_t x_29873;\n        int64_t x_29874;\n        int64_t x_29875;\n        int64_t x_29876;\n        int64_t x_29885;\n        int64_t x_29886;\n        int64_t x_29887;\n        int64_t x_29888;\n        int64_t x_29889;\n        int64_t x_29890;\n        int64_t x_29891;\n        int64_t x_29892;\n        bool ltid_in_bounds_29897;\n        \n        ltid_in_bounds_29897 = slt64(sext_i32_i64(local_tid_29810),\n                                     segscan_group_sizze_27972);\n        \n        int32_t skip_threads_29898;\n        \n        // read input for in-block scan\n        {\n            if (ltid_in_bounds_29897) {\n                x_29873 = ((volatile __local\n                            int64_t *) l",
            "ocal_mem_29824)[squot64(byte_offsets_29814,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_29810)];\n                x_29874 = ((volatile __local\n                            int64_t *) local_mem_29824)[squot64(byte_offsets_29815,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_29810)];\n                x_29875 = ((volatile __local\n                            int64_t *) local_mem_29824)[squot64(byte_offsets_29816,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_29810)];\n                x_29876 = ((volatile __local\n                            int64_t *) local_mem_29824)[squot64(byte_offsets_29817,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_29810)];\n                if ((local_tid_29810 - squot32(local_tid_29810, 32) * 32) ==\n                    0) {\n                    x_29869 = x_29873;\n                    x_29870 = x_29874;\n                    x_29871 = x_29875;\n                    x_29872 = x_29876;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_29898 = 1;\n            while (slt32(skip_threads_29898, 32)) {\n                if (sle32(skip_threads_29898, local_tid_29810 -\n                          squot32(local_tid_29810, 32) * 32) &&\n                    ltid_in_bounds_29897) {\n                    // read operands\n                    {\n                        x_29869 = ((volatile __local\n                                    int64_t *) local_mem_29824)[squot64(byte_offsets_29814,\n                                                                       ",
            " (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_29810) -\n                                                                 sext_i32_i64(skip_threads_29898))];\n                        x_29870 = ((volatile __local\n                                    int64_t *) local_mem_29824)[squot64(byte_offsets_29815,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_29810) -\n                                                                 sext_i32_i64(skip_threads_29898))];\n                        x_29871 = ((volatile __local\n                                    int64_t *) local_mem_29824)[squot64(byte_offsets_29816,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_29810) -\n                                                                 sext_i32_i64(skip_threads_29898))];\n                        x_29872 = ((volatile __local\n                                    int64_t *) local_mem_29824)[squot64(byte_offsets_29817,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_29810) -\n                                                                 sext_i32_i64(skip_threads_29898))];\n                    }\n                    // perform operation\n                    {\n                        int64_t defunc_1_op_res_29877 = add64(x_29869, x_29873);\n                        int64_t defunc_1_op_res_29878 = add64(x_29870, x_29874);\n                        int64_t defunc_1_op_res_29879 = add64(x_29871, x_29875);\n                        int64_t defunc_1_op_res_29880 = add64(x_29872, x_29876);\n                        \n                        x_29869 = defunc_1_op_res_29877;\n     ",
            "                   x_29870 = defunc_1_op_res_29878;\n                        x_29871 = defunc_1_op_res_29879;\n                        x_29872 = defunc_1_op_res_29880;\n                    }\n                }\n                if (sle32(wave_sizze_29812, skip_threads_29898)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_29898, local_tid_29810 -\n                          squot32(local_tid_29810, 32) * 32) &&\n                    ltid_in_bounds_29897) {\n                    // write result\n                    {\n                        ((volatile __local\n                          int64_t *) local_mem_29824)[squot64(byte_offsets_29814,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_29810)] =\n                            x_29869;\n                        x_29873 = x_29869;\n                        ((volatile __local\n                          int64_t *) local_mem_29824)[squot64(byte_offsets_29815,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_29810)] =\n                            x_29870;\n                        x_29874 = x_29870;\n                        ((volatile __local\n                          int64_t *) local_mem_29824)[squot64(byte_offsets_29816,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_29810)] =\n                            x_29871;\n                        x_29875 = x_29871;\n                        ((volatile __local\n                          int64_t *) local_mem_29824)[squot64(byte_offsets_29817,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_29810)] =\n                            x_298",
            "72;\n                        x_29876 = x_29872;\n                    }\n                }\n                if (sle32(wave_sizze_29812, skip_threads_29898)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_29898 *= 2;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // last thread of block 'i' writes its result to offset 'i'\n        {\n            if ((local_tid_29810 - squot32(local_tid_29810, 32) * 32) == 31 &&\n                ltid_in_bounds_29897) {\n                ((volatile __local\n                  int64_t *) local_mem_29824)[squot64(byte_offsets_29814,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_29810,\n                                                                   32))] =\n                    x_29869;\n                ((volatile __local\n                  int64_t *) local_mem_29824)[squot64(byte_offsets_29815,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_29810,\n                                                                   32))] =\n                    x_29870;\n                ((volatile __local\n                  int64_t *) local_mem_29824)[squot64(byte_offsets_29816,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_29810,\n                                                                   32))] =\n                    x_29871;\n                ((volatile __local\n                  int64_t *) local_mem_29824)[squot64(byte_offsets_29817,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_29810,\n                                                                   32))] =\n                    x_29872;\n            }\n",
            "        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n        {\n            int32_t skip_threads_29899;\n            \n            // read input for in-block scan\n            {\n                if (squot32(local_tid_29810, 32) == 0 && ltid_in_bounds_29897) {\n                    x_29889 = ((volatile __local\n                                int64_t *) local_mem_29824)[squot64(byte_offsets_29814,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_29810)];\n                    x_29890 = ((volatile __local\n                                int64_t *) local_mem_29824)[squot64(byte_offsets_29815,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_29810)];\n                    x_29891 = ((volatile __local\n                                int64_t *) local_mem_29824)[squot64(byte_offsets_29816,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_29810)];\n                    x_29892 = ((volatile __local\n                                int64_t *) local_mem_29824)[squot64(byte_offsets_29817,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_29810)];\n                    if ((local_tid_29810 - squot32(local_tid_29810, 32) * 32) ==\n                        0) {\n                        x_29885 = x_29889;\n                        x_29886 = x_29890;\n                        x_29887 = x_29891;\n                        x_29888 = x_29892;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n  ",
            "              skip_threads_29899 = 1;\n                while (slt32(skip_threads_29899, 32)) {\n                    if (sle32(skip_threads_29899, local_tid_29810 -\n                              squot32(local_tid_29810, 32) * 32) &&\n                        (squot32(local_tid_29810, 32) == 0 &&\n                         ltid_in_bounds_29897)) {\n                        // read operands\n                        {\n                            x_29885 = ((volatile __local\n                                        int64_t *) local_mem_29824)[squot64(byte_offsets_29814,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_29810) -\n                                                                     sext_i32_i64(skip_threads_29899))];\n                            x_29886 = ((volatile __local\n                                        int64_t *) local_mem_29824)[squot64(byte_offsets_29815,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_29810) -\n                                                                     sext_i32_i64(skip_threads_29899))];\n                            x_29887 = ((volatile __local\n                                        int64_t *) local_mem_29824)[squot64(byte_offsets_29816,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_29810) -\n                                                                     sext_i32_i64(skip_threads_29899))];\n                            x_29888 = ((volatile __local\n                                        int64_t *) local_mem_29824)[squot64(byte_offsets_29817,\n                                                                            (int64_t) 8)",
            " +\n                                                                    (sext_i32_i64(local_tid_29810) -\n                                                                     sext_i32_i64(skip_threads_29899))];\n                        }\n                        // perform operation\n                        {\n                            int64_t defunc_1_op_res_29893 = add64(x_29885,\n                                                                  x_29889);\n                            int64_t defunc_1_op_res_29894 = add64(x_29886,\n                                                                  x_29890);\n                            int64_t defunc_1_op_res_29895 = add64(x_29887,\n                                                                  x_29891);\n                            int64_t defunc_1_op_res_29896 = add64(x_29888,\n                                                                  x_29892);\n                            \n                            x_29885 = defunc_1_op_res_29893;\n                            x_29886 = defunc_1_op_res_29894;\n                            x_29887 = defunc_1_op_res_29895;\n                            x_29888 = defunc_1_op_res_29896;\n                        }\n                    }\n                    if (sle32(wave_sizze_29812, skip_threads_29899)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_29899, local_tid_29810 -\n                              squot32(local_tid_29810, 32) * 32) &&\n                        (squot32(local_tid_29810, 32) == 0 &&\n                         ltid_in_bounds_29897)) {\n                        // write result\n                        {\n                            ((volatile __local\n                              int64_t *) local_mem_29824)[squot64(byte_offsets_29814,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_29810)] =\n   ",
            "                             x_29885;\n                            x_29889 = x_29885;\n                            ((volatile __local\n                              int64_t *) local_mem_29824)[squot64(byte_offsets_29815,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_29810)] =\n                                x_29886;\n                            x_29890 = x_29886;\n                            ((volatile __local\n                              int64_t *) local_mem_29824)[squot64(byte_offsets_29816,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_29810)] =\n                                x_29887;\n                            x_29891 = x_29887;\n                            ((volatile __local\n                              int64_t *) local_mem_29824)[squot64(byte_offsets_29817,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_29810)] =\n                                x_29888;\n                            x_29892 = x_29888;\n                        }\n                    }\n                    if (sle32(wave_sizze_29812, skip_threads_29899)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_29899 *= 2;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // carry-in for every block except the first\n        {\n            if (!(squot32(local_tid_29810, 32) == 0 || !ltid_in_bounds_29897)) {\n                // read operands\n                {\n                    x_29873 = x_29869;\n                    x_29874 = x_29870;\n                    x_29875 = x_29871;\n                    x_29876 = x_29872;\n                    x_29869 = ((__local\n                         ",
            "       int64_t *) local_mem_29824)[squot64(byte_offsets_29814,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_29810,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                    x_29870 = ((__local\n                                int64_t *) local_mem_29824)[squot64(byte_offsets_29815,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_29810,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                    x_29871 = ((__local\n                                int64_t *) local_mem_29824)[squot64(byte_offsets_29816,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_29810,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                    x_29872 = ((__local\n                                int64_t *) local_mem_29824)[squot64(byte_offsets_29817,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_29810,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                }\n                // perform operation\n                {\n                    int64_t defunc_1_op_res_29877 = add64(x_29869, x_29873);\n               ",
            "     int64_t defunc_1_op_res_29878 = add64(x_29870, x_29874);\n                    int64_t defunc_1_op_res_29879 = add64(x_29871, x_29875);\n                    int64_t defunc_1_op_res_29880 = add64(x_29872, x_29876);\n                    \n                    x_29869 = defunc_1_op_res_29877;\n                    x_29870 = defunc_1_op_res_29878;\n                    x_29871 = defunc_1_op_res_29879;\n                    x_29872 = defunc_1_op_res_29880;\n                }\n                // write final result\n                {\n                    ((__local\n                      int64_t *) local_mem_29824)[squot64(byte_offsets_29814,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_29810)] =\n                        x_29869;\n                    ((__local\n                      int64_t *) local_mem_29824)[squot64(byte_offsets_29815,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_29810)] =\n                        x_29870;\n                    ((__local\n                      int64_t *) local_mem_29824)[squot64(byte_offsets_29816,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_29810)] =\n                        x_29871;\n                    ((__local\n                      int64_t *) local_mem_29824)[squot64(byte_offsets_29817,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_29810)] =\n                        x_29872;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // restore correct values for first block\n        {\n            if (squot32(local_tid_29810, 32) == 0) {\n                ((__local\n                  int64_t *) local_mem_29824)[squot64(byte_offsets_298",
            "14,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_29810)] =\n                    x_29873;\n                ((__local\n                  int64_t *) local_mem_29824)[squot64(byte_offsets_29815,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_29810)] =\n                    x_29874;\n                ((__local\n                  int64_t *) local_mem_29824)[squot64(byte_offsets_29816,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_29810)] =\n                    x_29875;\n                ((__local\n                  int64_t *) local_mem_29824)[squot64(byte_offsets_29817,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_29810)] =\n                    x_29876;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_tid_29810 == 0) {\n            acc_29881 = ((__local\n                          int64_t *) local_mem_29824)[squot64(byte_offsets_29814,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_27972 -\n                                                       (int64_t) 1)];\n            acc_29882 = ((__local\n                          int64_t *) local_mem_29824)[squot64(byte_offsets_29815,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_27972 -\n                                                       (int64_t) 1)];\n            acc_29883 = ((__local\n                          int64_t *) local_mem_29824)[squot64(byte_offsets_29816,\n                                            ",
            "                  (int64_t) 8) +\n                                                      (segscan_group_sizze_27972 -\n                                                       (int64_t) 1)];\n            acc_29884 = ((__local\n                          int64_t *) local_mem_29824)[squot64(byte_offsets_29817,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_27972 -\n                                                       (int64_t) 1)];\n        } else {\n            acc_29881 = ((__local\n                          int64_t *) local_mem_29824)[squot64(byte_offsets_29814,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_29810) -\n                                                       (int64_t) 1)];\n            acc_29882 = ((__local\n                          int64_t *) local_mem_29824)[squot64(byte_offsets_29815,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_29810) -\n                                                       (int64_t) 1)];\n            acc_29883 = ((__local\n                          int64_t *) local_mem_29824)[squot64(byte_offsets_29816,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_29810) -\n                                                       (int64_t) 1)];\n            acc_29884 = ((__local\n                          int64_t *) local_mem_29824)[squot64(byte_offsets_29817,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_29810) -\n                                                       (int64_t) 1)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n   ",
            " }\n    \n    int64_t prefix_29900;\n    \n    prefix_29900 = (int64_t) 0;\n    \n    int64_t prefix_29901;\n    \n    prefix_29901 = (int64_t) 0;\n    \n    int64_t prefix_29902;\n    \n    prefix_29902 = (int64_t) 0;\n    \n    int64_t prefix_29903;\n    \n    prefix_29903 = (int64_t) 0;\n    // Perform lookback\n    {\n        if (dynamic_id_29841 == (int64_t) 0 && local_tid_29810 == 0) {\n            ((volatile __global\n              int64_t *) incprefixes_mem_29795)[dynamic_id_29841] = acc_29881;\n            ((volatile __global\n              int64_t *) incprefixes_mem_29799)[dynamic_id_29841] = acc_29882;\n            ((volatile __global\n              int64_t *) incprefixes_mem_29803)[dynamic_id_29841] = acc_29883;\n            ((volatile __global\n              int64_t *) incprefixes_mem_29807)[dynamic_id_29841] = acc_29884;\n            mem_fence_global();\n            ((volatile __global\n              int8_t *) status_flags_mem_29791)[dynamic_id_29841] = (int8_t) 2;\n            acc_29881 = (int64_t) 0;\n            acc_29882 = (int64_t) 0;\n            acc_29883 = (int64_t) 0;\n            acc_29884 = (int64_t) 0;\n        }\n        if (!(dynamic_id_29841 == (int64_t) 0) && slt32(local_tid_29810,\n                                                        wave_sizze_29812)) {\n            if (local_tid_29810 == 0) {\n                ((volatile __global\n                  int64_t *) aggregates_mem_29793)[dynamic_id_29841] =\n                    acc_29881;\n                ((volatile __global\n                  int64_t *) aggregates_mem_29797)[dynamic_id_29841] =\n                    acc_29882;\n                ((volatile __global\n                  int64_t *) aggregates_mem_29801)[dynamic_id_29841] =\n                    acc_29883;\n                ((volatile __global\n                  int64_t *) aggregates_mem_29805)[dynamic_id_29841] =\n                    acc_29884;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_29791)[dynamic_id_2",
            "9841] =\n                    (int8_t) 1;\n                ((__local int8_t *) local_mem_29824)[(int64_t) 0] = ((__global\n                                                                      int8_t *) status_flags_mem_29791)[dynamic_id_29841 -\n                                                                                                        (int64_t) 1];\n            }\n            mem_fence_local();\n            \n            int8_t status_29904;\n            \n            status_29904 = ((__local int8_t *) local_mem_29824)[(int64_t) 0];\n            if (status_29904 == (int8_t) 2) {\n                if (local_tid_29810 == 0) {\n                    prefix_29900 = ((volatile __global\n                                     int64_t *) incprefixes_mem_29795)[dynamic_id_29841 -\n                                                                       (int64_t) 1];\n                    prefix_29901 = ((volatile __global\n                                     int64_t *) incprefixes_mem_29799)[dynamic_id_29841 -\n                                                                       (int64_t) 1];\n                    prefix_29902 = ((volatile __global\n                                     int64_t *) incprefixes_mem_29803)[dynamic_id_29841 -\n                                                                       (int64_t) 1];\n                    prefix_29903 = ((volatile __global\n                                     int64_t *) incprefixes_mem_29807)[dynamic_id_29841 -\n                                                                       (int64_t) 1];\n                }\n            } else {\n                int32_t readOffset_29905 = dynamic_id_29841 -\n                        sext_i32_i64(wave_sizze_29812);\n                \n                while (slt32(wave_sizze_29812 * -1, readOffset_29905)) {\n                    int32_t read_i_29906 = readOffset_29905 + local_tid_29810;\n                    int64_t aggr_29907 = (int64_t) 0;\n                    int64_t aggr_29908 = (int64_t) 0;\n              ",
            "      int64_t aggr_29909 = (int64_t) 0;\n                    int64_t aggr_29910 = (int64_t) 0;\n                    int8_t flag_29911 = (int8_t) 0;\n                    int8_t used_29912 = (int8_t) 0;\n                    \n                    if (sle32(0, read_i_29906)) {\n                        flag_29911 = ((volatile __global\n                                       int8_t *) status_flags_mem_29791)[sext_i32_i64(read_i_29906)];\n                        if (flag_29911 == (int8_t) 2) {\n                            aggr_29907 = ((volatile __global\n                                           int64_t *) incprefixes_mem_29795)[sext_i32_i64(read_i_29906)];\n                            aggr_29908 = ((volatile __global\n                                           int64_t *) incprefixes_mem_29799)[sext_i32_i64(read_i_29906)];\n                            aggr_29909 = ((volatile __global\n                                           int64_t *) incprefixes_mem_29803)[sext_i32_i64(read_i_29906)];\n                            aggr_29910 = ((volatile __global\n                                           int64_t *) incprefixes_mem_29807)[sext_i32_i64(read_i_29906)];\n                        } else {\n                            if (flag_29911 == (int8_t) 1) {\n                                aggr_29907 = ((volatile __global\n                                               int64_t *) aggregates_mem_29793)[sext_i32_i64(read_i_29906)];\n                                aggr_29908 = ((volatile __global\n                                               int64_t *) aggregates_mem_29797)[sext_i32_i64(read_i_29906)];\n                                aggr_29909 = ((volatile __global\n                                               int64_t *) aggregates_mem_29801)[sext_i32_i64(read_i_29906)];\n                                aggr_29910 = ((volatile __global\n                                               int64_t *) aggregates_mem_29805)[sext_i32_i64(read_i_29906)];\n                                used_29912 = (int8_t) 1;\n  ",
            "                          }\n                        }\n                    }\n                    ((__local\n                      int64_t *) local_mem_29824)[squot64(warp_byte_offset_29819,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_29810)] =\n                        aggr_29907;\n                    ((__local\n                      int64_t *) local_mem_29824)[squot64(warp_byte_offset_29820,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_29810)] =\n                        aggr_29908;\n                    ((__local\n                      int64_t *) local_mem_29824)[squot64(warp_byte_offset_29821,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_29810)] =\n                        aggr_29909;\n                    ((__local\n                      int64_t *) local_mem_29824)[squot64(warp_byte_offset_29822,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_29810)] =\n                        aggr_29910;\n                    \n                    int8_t tmp_29913;\n                    \n                    tmp_29913 = flag_29911 | used_29912 << (int8_t) 2;\n                    ((__local\n                      int8_t *) local_mem_29824)[sext_i32_i64(local_tid_29810)] =\n                        tmp_29913;\n                    mem_fence_local();\n                    flag_29911 = ((volatile __local\n                                   int8_t *) local_mem_29824)[sext_i32_i64(wave_sizze_29812) -\n                                                              (int64_t) 1];\n                    if (local_tid_29810 == 0) {\n                        if (!(flag_29911 == (int8_t) 2)) {\n                            int64_t x_299",
            "14 = (int64_t) 0;\n                            int64_t x_29915 = (int64_t) 0;\n                            int64_t x_29916 = (int64_t) 0;\n                            int64_t x_29917 = (int64_t) 0;\n                            int64_t x_29918;\n                            int64_t x_29919;\n                            int64_t x_29920;\n                            int64_t x_29921;\n                            int8_t flag1_29926;\n                            \n                            flag1_29926 = (int8_t) 0;\n                            \n                            int8_t flag2_29927;\n                            int8_t used1_29928;\n                            \n                            used1_29928 = (int8_t) 0;\n                            \n                            int8_t used2_29929;\n                            \n                            for (int32_t i_29930 = 0; i_29930 <\n                                 wave_sizze_29812; i_29930++) {\n                                flag2_29927 = ((__local\n                                                int8_t *) local_mem_29824)[sext_i32_i64(i_29930)];\n                                used2_29929 = lshr8(flag2_29927, (int8_t) 2);\n                                flag2_29927 = flag2_29927 & (int8_t) 3;\n                                x_29918 = ((__local\n                                            int64_t *) local_mem_29824)[squot64(warp_byte_offset_29819,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_29930)];\n                                x_29919 = ((__local\n                                            int64_t *) local_mem_29824)[squot64(warp_byte_offset_29820,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_29930)];\n                                x_29920 = ((__local\n ",
            "                                           int64_t *) local_mem_29824)[squot64(warp_byte_offset_29821,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_29930)];\n                                x_29921 = ((__local\n                                            int64_t *) local_mem_29824)[squot64(warp_byte_offset_29822,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_29930)];\n                                if (!(flag2_29927 == (int8_t) 1)) {\n                                    flag1_29926 = flag2_29927;\n                                    used1_29928 = used2_29929;\n                                    x_29914 = x_29918;\n                                    x_29915 = x_29919;\n                                    x_29916 = x_29920;\n                                    x_29917 = x_29921;\n                                } else {\n                                    used1_29928 += used2_29929;\n                                    \n                                    int64_t defunc_1_op_res_29922;\n                                    \n                                    defunc_1_op_res_29922 = add64(x_29914,\n                                                                  x_29918);\n                                    \n                                    int64_t defunc_1_op_res_29923 =\n                                            add64(x_29915, x_29919);\n                                    int64_t defunc_1_op_res_29924 =\n                                            add64(x_29916, x_29920);\n                                    int64_t defunc_1_op_res_29925 =\n                                            add64(x_29917, x_29921);\n                                    \n                                    x_29914 = defunc_1_op_res_2",
            "9922;\n                                    x_29915 = defunc_1_op_res_29923;\n                                    x_29916 = defunc_1_op_res_29924;\n                                    x_29917 = defunc_1_op_res_29925;\n                                }\n                            }\n                            flag_29911 = flag1_29926;\n                            used_29912 = used1_29928;\n                            aggr_29907 = x_29914;\n                            aggr_29908 = x_29915;\n                            aggr_29909 = x_29916;\n                            aggr_29910 = x_29917;\n                        } else {\n                            aggr_29907 = ((__local\n                                           int64_t *) local_mem_29824)[squot64(warp_byte_offset_29819,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_29812) -\n                                                                        (int64_t) 1)];\n                            aggr_29908 = ((__local\n                                           int64_t *) local_mem_29824)[squot64(warp_byte_offset_29820,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_29812) -\n                                                                        (int64_t) 1)];\n                            aggr_29909 = ((__local\n                                           int64_t *) local_mem_29824)[squot64(warp_byte_offset_29821,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_29812) -\n                                                                        (int64_t) 1)];\n                            aggr_29910 = ((__local\n           ",
            "                                int64_t *) local_mem_29824)[squot64(warp_byte_offset_29822,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_29812) -\n                                                                        (int64_t) 1)];\n                        }\n                        if (flag_29911 == (int8_t) 2) {\n                            readOffset_29905 = wave_sizze_29812 * -1;\n                        } else {\n                            readOffset_29905 -= zext_i8_i32(used_29912);\n                        }\n                        ((__local int32_t *) local_mem_29824)[(int64_t) 0] =\n                            readOffset_29905;\n                        \n                        int64_t x_29931;\n                        \n                        x_29931 = aggr_29907;\n                        \n                        int64_t x_29932;\n                        \n                        x_29932 = aggr_29908;\n                        \n                        int64_t x_29933;\n                        \n                        x_29933 = aggr_29909;\n                        \n                        int64_t x_29934;\n                        \n                        x_29934 = aggr_29910;\n                        \n                        int64_t x_29935;\n                        \n                        x_29935 = prefix_29900;\n                        \n                        int64_t x_29936;\n                        \n                        x_29936 = prefix_29901;\n                        \n                        int64_t x_29937;\n                        \n                        x_29937 = prefix_29902;\n                        \n                        int64_t x_29938;\n                        \n                        x_29938 = prefix_29903;\n                        \n                        int64_t defunc_1_op_res_29939;\n                        \n      ",
            "                  defunc_1_op_res_29939 = add64(x_29931, x_29935);\n                        \n                        int64_t defunc_1_op_res_29940 = add64(x_29932, x_29936);\n                        int64_t defunc_1_op_res_29941 = add64(x_29933, x_29937);\n                        int64_t defunc_1_op_res_29942 = add64(x_29934, x_29938);\n                        \n                        prefix_29900 = defunc_1_op_res_29939;\n                        prefix_29901 = defunc_1_op_res_29940;\n                        prefix_29902 = defunc_1_op_res_29941;\n                        prefix_29903 = defunc_1_op_res_29942;\n                    }\n                    mem_fence_local();\n                    readOffset_29905 = ((__local\n                                         int32_t *) local_mem_29824)[(int64_t) 0];\n                }\n            }\n            if (local_tid_29810 == 0) {\n                int64_t x_29943 = prefix_29900;\n                int64_t x_29944 = prefix_29901;\n                int64_t x_29945 = prefix_29902;\n                int64_t x_29946 = prefix_29903;\n                int64_t x_29947 = acc_29881;\n                int64_t x_29948 = acc_29882;\n                int64_t x_29949 = acc_29883;\n                int64_t x_29950 = acc_29884;\n                int64_t defunc_1_op_res_29951 = add64(x_29943, x_29947);\n                int64_t defunc_1_op_res_29952 = add64(x_29944, x_29948);\n                int64_t defunc_1_op_res_29953 = add64(x_29945, x_29949);\n                int64_t defunc_1_op_res_29954 = add64(x_29946, x_29950);\n                \n                ((volatile __global\n                  int64_t *) incprefixes_mem_29795)[dynamic_id_29841] =\n                    defunc_1_op_res_29951;\n                ((volatile __global\n                  int64_t *) incprefixes_mem_29799)[dynamic_id_29841] =\n                    defunc_1_op_res_29952;\n                ((volatile __global\n                  int64_t *) incprefixes_mem_29803)[dynamic_id_29841] =\n                    defunc_1_op_res_",
            "29953;\n                ((volatile __global\n                  int64_t *) incprefixes_mem_29807)[dynamic_id_29841] =\n                    defunc_1_op_res_29954;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_29791)[dynamic_id_29841] =\n                    (int8_t) 2;\n                ((__local\n                  int64_t *) local_mem_29824)[squot64(warp_byte_offset_29819,\n                                                      (int64_t) 8)] =\n                    prefix_29900;\n                ((__local\n                  int64_t *) local_mem_29824)[squot64(warp_byte_offset_29820,\n                                                      (int64_t) 8)] =\n                    prefix_29901;\n                ((__local\n                  int64_t *) local_mem_29824)[squot64(warp_byte_offset_29821,\n                                                      (int64_t) 8)] =\n                    prefix_29902;\n                ((__local\n                  int64_t *) local_mem_29824)[squot64(warp_byte_offset_29822,\n                                                      (int64_t) 8)] =\n                    prefix_29903;\n                acc_29881 = (int64_t) 0;\n                acc_29882 = (int64_t) 0;\n                acc_29883 = (int64_t) 0;\n                acc_29884 = (int64_t) 0;\n            }\n        }\n        if (!(dynamic_id_29841 == (int64_t) 0)) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            prefix_29900 = ((__local\n                             int64_t *) local_mem_29824)[squot64(warp_byte_offset_29819,\n                                                                 (int64_t) 8)];\n            prefix_29901 = ((__local\n                             int64_t *) local_mem_29824)[squot64(warp_byte_offset_29820,\n                                                                 (int64_t) 8)];\n            prefix_29902 = ((__local\n                             int64_t *) local_mem_29824)[squot64(warp_byte_offset_29821,\n                ",
            "                                                 (int64_t) 8)];\n            prefix_29903 = ((__local\n                             int64_t *) local_mem_29824)[squot64(warp_byte_offset_29822,\n                                                                 (int64_t) 8)];\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    // Distribute results\n    {\n        int64_t x_29955;\n        int64_t x_29959;\n        int64_t x_29967;\n        \n        x_29967 = prefix_29900;\n        \n        int64_t x_29971;\n        \n        x_29971 = acc_29881;\n        \n        int64_t x_29956;\n        int64_t x_29960;\n        int64_t x_29968;\n        \n        x_29968 = prefix_29901;\n        \n        int64_t x_29972;\n        \n        x_29972 = acc_29882;\n        \n        int64_t x_29957;\n        int64_t x_29961;\n        int64_t x_29969;\n        \n        x_29969 = prefix_29902;\n        \n        int64_t x_29973;\n        \n        x_29973 = acc_29883;\n        \n        int64_t x_29958;\n        int64_t x_29962;\n        int64_t x_29970;\n        \n        x_29970 = prefix_29903;\n        \n        int64_t x_29974;\n        \n        x_29974 = acc_29884;\n        \n        int64_t defunc_1_op_res_29975;\n        \n        defunc_1_op_res_29975 = add64(x_29967, x_29971);\n        \n        int64_t defunc_1_op_res_29976 = add64(x_29968, x_29972);\n        int64_t defunc_1_op_res_29977 = add64(x_29969, x_29973);\n        int64_t defunc_1_op_res_29978 = add64(x_29970, x_29974);\n        \n        x_29955 = defunc_1_op_res_29975;\n        x_29956 = defunc_1_op_res_29976;\n        x_29957 = defunc_1_op_res_29977;\n        x_29958 = defunc_1_op_res_29978;\n        for (int64_t i_29979 = 0; i_29979 < (int64_t) 9; i_29979++) {\n            x_29959 = private_mem_29843[i_29979];\n            x_29960 = private_mem_29845[i_29979];\n            x_29961 = private_mem_29847[i_29979];\n            x_29962 = private_mem_29849[i_29979];\n            \n            int64_t defunc_1_op_res_29963;\n            \n            defunc_1_op_res_299",
            "63 = add64(x_29955, x_29959);\n            \n            int64_t defunc_1_op_res_29964 = add64(x_29956, x_29960);\n            int64_t defunc_1_op_res_29965 = add64(x_29957, x_29961);\n            int64_t defunc_1_op_res_29966 = add64(x_29958, x_29962);\n            \n            private_mem_29843[i_29979] = defunc_1_op_res_29963;\n            private_mem_29845[i_29979] = defunc_1_op_res_29964;\n            private_mem_29847[i_29979] = defunc_1_op_res_29965;\n            private_mem_29849[i_29979] = defunc_1_op_res_29966;\n        }\n    }\n    // Transpose scan output\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29980 = 0; i_29980 < (int64_t) 9; i_29980++) {\n            int64_t sharedIdx_29981 = sext_i32_i64(local_tid_29810 * 9) +\n                    i_29980;\n            \n            ((__local int64_t *) local_mem_29824)[sharedIdx_29981] =\n                private_mem_29843[i_29980];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29982 = 0; i_29982 < (int64_t) 9; i_29982++) {\n            int32_t sharedIdx_29983 = local_tid_29810 +\n                    sext_i64_i32(segscan_group_sizze_27972 * i_29982);\n            \n            private_mem_29843[i_29982] = ((__local\n                                           int64_t *) local_mem_29824)[sext_i32_i64(sharedIdx_29983)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29984 = 0; i_29984 < (int64_t) 9; i_29984++) {\n            int64_t sharedIdx_29985 = sext_i32_i64(local_tid_29810 * 9) +\n                    i_29984;\n            \n            ((__local int64_t *) local_mem_29824)[sharedIdx_29985] =\n                private_mem_29845[i_29984];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29986 = 0; i_29986 < (int64_t) 9; i_29986++) {\n            int32_t sharedIdx_29987 = local_tid_29810 +\n                    sext_i64_i32(segscan_group_sizze_27972 * i_29986);\n            \n            private_mem_29845[i_29986] = ((__local\n                         ",
            "                  int64_t *) local_mem_29824)[sext_i32_i64(sharedIdx_29987)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29988 = 0; i_29988 < (int64_t) 9; i_29988++) {\n            int64_t sharedIdx_29989 = sext_i32_i64(local_tid_29810 * 9) +\n                    i_29988;\n            \n            ((__local int64_t *) local_mem_29824)[sharedIdx_29989] =\n                private_mem_29847[i_29988];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29990 = 0; i_29990 < (int64_t) 9; i_29990++) {\n            int32_t sharedIdx_29991 = local_tid_29810 +\n                    sext_i64_i32(segscan_group_sizze_27972 * i_29990);\n            \n            private_mem_29847[i_29990] = ((__local\n                                           int64_t *) local_mem_29824)[sext_i32_i64(sharedIdx_29991)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29992 = 0; i_29992 < (int64_t) 9; i_29992++) {\n            int64_t sharedIdx_29993 = sext_i32_i64(local_tid_29810 * 9) +\n                    i_29992;\n            \n            ((__local int64_t *) local_mem_29824)[sharedIdx_29993] =\n                private_mem_29849[i_29992];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29994 = 0; i_29994 < (int64_t) 9; i_29994++) {\n            int32_t sharedIdx_29995 = local_tid_29810 +\n                    sext_i64_i32(segscan_group_sizze_27972 * i_29994);\n            \n            private_mem_29849[i_29994] = ((__local\n                                           int64_t *) local_mem_29824)[sext_i32_i64(sharedIdx_29995)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Write block scan results to global memory\n    {\n        for (int64_t i_29996 = 0; i_29996 < (int64_t) 9; i_29996++) {\n            int64_t gtid_27976 = blockOff_29842 + segscan_group_sizze_27972 *\n                    i_29996 + sext_i32_i64(local_tid_29810);\n            \n            if (slt64(gtid_27976, conc_tmp_27249)) {\n                ((__",
            "global int64_t *) mem_28623)[gtid_27976] =\n                    private_mem_29843[i_29996];\n            }\n        }\n        for (int64_t i_29997 = 0; i_29997 < (int64_t) 9; i_29997++) {\n            int64_t gtid_27976 = blockOff_29842 + segscan_group_sizze_27972 *\n                    i_29997 + sext_i32_i64(local_tid_29810);\n            \n            if (slt64(gtid_27976, conc_tmp_27249)) {\n                ((__global int64_t *) mem_28625)[gtid_27976] =\n                    private_mem_29845[i_29997];\n            }\n        }\n        for (int64_t i_29998 = 0; i_29998 < (int64_t) 9; i_29998++) {\n            int64_t gtid_27976 = blockOff_29842 + segscan_group_sizze_27972 *\n                    i_29998 + sext_i32_i64(local_tid_29810);\n            \n            if (slt64(gtid_27976, conc_tmp_27249)) {\n                ((__global int64_t *) mem_28627)[gtid_27976] =\n                    private_mem_29847[i_29998];\n            }\n        }\n        for (int64_t i_29999 = 0; i_29999 < (int64_t) 9; i_29999++) {\n            int64_t gtid_27976 = blockOff_29842 + segscan_group_sizze_27972 *\n                    i_29999 + sext_i32_i64(local_tid_29810);\n            \n            if (slt64(gtid_27976, conc_tmp_27249)) {\n                ((__global int64_t *) mem_28629)[gtid_27976] =\n                    private_mem_29849[i_29999];\n            }\n        }\n    }\n    // If this is the last block, reset the dynamicId\n    {\n        if (dynamic_id_29841 == sdiv_up64(conc_tmp_27249,\n                                          segscan_group_sizze_27972 *\n                                          (int64_t) 9) - (int64_t) 1) {\n            ((__global\n              int32_t *) eWiseAddMultEntryziid_counter_mem_29789)[(int64_t) 0] =\n                0;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_27972\n}\n__kernel void eWiseAddMultEntryzisegscan_28089(__global int *global_failure,\n                                               int failure_is_an_option,\n                                 ",
            "              __global\n                                               int64_t *global_failure_args,\n                                               uint local_mem_30029_backing_offset_0,\n                                               int64_t conc_tmp_27249,\n                                               int64_t j_m_i_27250, __global\n                                               unsigned char *mem_28653,\n                                               __global\n                                               unsigned char *mem_28655,\n                                               __global\n                                               unsigned char *mem_28657,\n                                               __global\n                                               unsigned char *mem_28660,\n                                               __global\n                                               unsigned char *mem_28662,\n                                               __global\n                                               unsigned char *mem_28664,\n                                               __global\n                                               unsigned char *mem_28666,\n                                               __global\n                                               unsigned char *mem_28668,\n                                               __global\n                                               unsigned char *eWiseAddMultEntryziid_counter_mem_30012,\n                                               __global\n                                               unsigned char *status_flags_mem_30014,\n                                               __global\n                                               unsigned char *aggregates_mem_30016,\n                                               __global\n                                               unsigned char *incprefixes_mem_30018)\n{\n    #define segscan_group_sizze_28084 (eWiseAddMultEntryzisegscan_group_sizze_28083)\n    \n    const int bl",
            "ock_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *local_mem_30029_backing_0 =\n                  &shared_mem[local_mem_30029_backing_offset_0];\n    volatile __local bool local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = false;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t global_tid_30020;\n    int32_t local_tid_30021;\n    int64_t group_sizze_30024;\n    int32_t wave_sizze_30023;\n    int32_t group_tid_30022;\n    \n    global_tid_30020 = get_global_id(0);\n    local_tid_30021 = get_local_id(0);\n    group_sizze_30024 = get_local_size(0);\n    wave_sizze_30023 = LOCKSTEP_WIDTH;\n    group_tid_30022 = get_group_id(0);\n    \n    int32_t phys_tid_28089;\n    \n    phys_tid_28089 = global_tid_30020;\n    \n    int64_t byte_offsets_30025;\n    \n    byte_offsets_30025 = (int64_t) 0;\n    \n    int64_t byte_offsets_30026;\n    \n    byte_offsets_30026 = segscan_group_sizze_28084 * (int64_t) 8;\n    \n    int64_t warp_byte_offset_30027;\n    \n    warp_byte_offset_30027 = (int64_t) 32;\n    \n    int64_t warp_byte_offset_30028;\n    \n    warp_byte_offset_30028 = (int64_t) 288;\n    // Allocate reused shared memeory\n    { }\n    \n    __local char *local_mem_30029;\n    \n    local_mem_30029 = (__local char *) local_mem_30029_backing_0;\n    \n    int64_t trans_arr_len_30030;\n    \n    trans_arr_len_30030 = (int64_t) 9 * segscan_group_sizze_28084;\n    \n    int32_t dynamic_id_30037;\n    \n    if (local_tid_30021 == 0) {\n        dynamic_id_30037 = atomic_add_i32_global(&((volatile __global\n                                                    int *) eWiseAddMultEntryziid_counter_mem_30012)[(int64_t) 0],\n                                                 (int) 1);\n        ((__local int32_t *) local_mem_30029)[(int64_t) 0] = dynamic_id_30037;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    dynamic_id_30037 = ((__local int32_t *) local_mem_30029)[(int64_t) 0",
            "];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t blockOff_30038;\n    \n    blockOff_30038 = sext_i32_i64(dynamic_id_30037) * (int64_t) 9 *\n        segscan_group_sizze_28084;\n    \n    int64_t private_mem_30039[9];\n    \n    // Load and map\n    {\n        for (int64_t i_30041 = 0; i_30041 < (int64_t) 9; i_30041++) {\n            int64_t gtid_28088 = blockOff_30038 +\n                    sext_i32_i64(local_tid_30021) + i_30041 *\n                    segscan_group_sizze_28084;\n            \n            if (slt64(gtid_28088, j_m_i_27250)) {\n                int64_t slice_28120 = (int64_t) 1 + gtid_28088;\n                int64_t x_27428 = ((__global int64_t *) mem_28653)[slice_28120];\n                bool y_27434 = slt64(gtid_28088, conc_tmp_27249);\n                bool index_certs_27436;\n                \n                if (!y_27434) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 48) ==\n                            -1) {\n                            global_failure_args[0] = gtid_28088;\n                            global_failure_args[1] = conc_tmp_27249;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                \n                int64_t y_27437 = ((__global int64_t *) mem_28653)[gtid_28088];\n                bool cond_27438 = x_27428 == y_27437;\n                int64_t defunc_0_f_res_27439;\n                \n                if (cond_27438) {\n                    defunc_0_f_res_27439 = x_27428;\n                } else {\n                    defunc_0_f_res_27439 = (int64_t) -1;\n                }\n                \n                int64_t defunc_0_f_res_27440;\n                int64_t defunc_0_f_res_27441;\n                \n                if (cond_27438) {\n                    int64_t x_27429 = ((__global\n                                        int64_t *) mem_28655)[slice_28120];\n                    int6",
            "4_t x_27430 = ((__global\n                                        int64_t *) mem_28657)[slice_28120];\n                    bool cond_27442 = x_27429 == (int64_t) 0;\n                    int64_t defunc_0_f_res_t_res_27443;\n                    int64_t defunc_0_f_res_t_res_27444;\n                    \n                    if (cond_27442) {\n                        int64_t defunc_0_f_res_t_res_t_res_27445 = ((__global\n                                                                     int64_t *) mem_28657)[gtid_28088];\n                        \n                        defunc_0_f_res_t_res_27443 = x_27430;\n                        defunc_0_f_res_t_res_27444 =\n                            defunc_0_f_res_t_res_t_res_27445;\n                    } else {\n                        int64_t defunc_0_f_res_t_res_f_res_27446 = ((__global\n                                                                     int64_t *) mem_28657)[gtid_28088];\n                        \n                        defunc_0_f_res_t_res_27443 =\n                            defunc_0_f_res_t_res_f_res_27446;\n                        defunc_0_f_res_t_res_27444 = x_27430;\n                    }\n                    defunc_0_f_res_27440 = defunc_0_f_res_t_res_27443;\n                    defunc_0_f_res_27441 = defunc_0_f_res_t_res_27444;\n                } else {\n                    defunc_0_f_res_27440 = (int64_t) 0;\n                    defunc_0_f_res_27441 = (int64_t) 0;\n                }\n                \n                bool eq_x_y_27447 = (int64_t) -1 == x_27428;\n                bool p_and_eq_x_y_27448 = cond_27438 && eq_x_y_27447;\n                bool not_p_27449 = !cond_27438;\n                bool defunc_0_p_res_27450 = p_and_eq_x_y_27448 || not_p_27449;\n                int64_t defunc_1_lifted_lambda_res_27451 =\n                        btoi_bool_i64(defunc_0_p_res_27450);\n                bool is_i_27452 = defunc_1_lifted_lambda_res_27451 ==\n                     (int64_t) 0;\n                bool cond_neg_27453 = !is_i_27452;\n",
            "                int64_t part_res_27454 = btoi_bool_i64(cond_neg_27453);\n                int64_t part_res_27455 = btoi_bool_i64(is_i_27452);\n                \n                ((__global int64_t *) mem_28662)[gtid_28088] = part_res_27454;\n                ((__global int64_t *) mem_28664)[gtid_28088] =\n                    defunc_0_f_res_27439;\n                ((__global int64_t *) mem_28666)[gtid_28088] =\n                    defunc_0_f_res_27440;\n                ((__global int64_t *) mem_28668)[gtid_28088] =\n                    defunc_0_f_res_27441;\n                private_mem_30039[i_30041] = part_res_27455;\n            } else {\n                private_mem_30039[i_30041] = (int64_t) 0;\n            }\n        }\n    }\n    // Transpose scan inputs\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_30042 = 0; i_30042 < (int64_t) 9; i_30042++) {\n            int64_t sharedIdx_30043 = sext_i32_i64(local_tid_30021) + i_30042 *\n                    segscan_group_sizze_28084;\n            \n            ((__local int64_t *) local_mem_30029)[sharedIdx_30043] =\n                private_mem_30039[i_30042];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_30044 = 0; i_30044 < 9; i_30044++) {\n            int32_t sharedIdx_30045 = local_tid_30021 * 9 + i_30044;\n            \n            private_mem_30039[sext_i32_i64(i_30044)] = ((__local\n                                                         int64_t *) local_mem_30029)[sext_i32_i64(sharedIdx_30045)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Per thread scan\n    {\n        for (int64_t i_30046 = 0; i_30046 < (int64_t) 8; i_30046++) {\n            int64_t x_27425;\n            int64_t y_27426;\n            \n            x_27425 = private_mem_30039[i_30046];\n            y_27426 = private_mem_30039[i_30046 + (int64_t) 1];\n            \n            int64_t zz_27427;\n            \n            zz_27427 = x_27425 + y_27426;\n            private_mem_30039[i_30046 + (int64_t) 1] = zz_27427;\n        }\n",
            "    }\n    // Publish results in shared memory\n    {\n        ((__local int64_t *) local_mem_30029)[squot64(byte_offsets_30025,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_30021)] =\n            private_mem_30039[(int64_t) 8];\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t acc_30050;\n    \n    // Scan results (with warp scan)\n    {\n        int64_t x_30047;\n        int64_t y_30048;\n        int64_t x_30051;\n        int64_t y_30052;\n        bool ltid_in_bounds_30054;\n        \n        ltid_in_bounds_30054 = slt64(sext_i32_i64(local_tid_30021),\n                                     segscan_group_sizze_28084);\n        \n        int32_t skip_threads_30055;\n        \n        // read input for in-block scan\n        {\n            if (ltid_in_bounds_30054) {\n                y_30048 = ((volatile __local\n                            int64_t *) local_mem_30029)[squot64(byte_offsets_30025,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_30021)];\n                if ((local_tid_30021 - squot32(local_tid_30021, 32) * 32) ==\n                    0) {\n                    x_30047 = y_30048;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_30055 = 1;\n            while (slt32(skip_threads_30055, 32)) {\n                if (sle32(skip_threads_30055, local_tid_30021 -\n                          squot32(local_tid_30021, 32) * 32) &&\n                    ltid_in_bounds_30054) {\n                    // read operands\n                    {\n                        x_30047 = ((volatile __local\n                                    int64_t *) local_mem_30029)[squot64(byte_offsets_30025,\n                                                                        (int64_t) 8) +\n                                             ",
            "                   (sext_i32_i64(local_tid_30021) -\n                                                                 sext_i32_i64(skip_threads_30055))];\n                    }\n                    // perform operation\n                    {\n                        int64_t zz_30049 = x_30047 + y_30048;\n                        \n                        x_30047 = zz_30049;\n                    }\n                }\n                if (sle32(wave_sizze_30023, skip_threads_30055)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_30055, local_tid_30021 -\n                          squot32(local_tid_30021, 32) * 32) &&\n                    ltid_in_bounds_30054) {\n                    // write result\n                    {\n                        ((volatile __local\n                          int64_t *) local_mem_30029)[squot64(byte_offsets_30025,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_30021)] =\n                            x_30047;\n                        y_30048 = x_30047;\n                    }\n                }\n                if (sle32(wave_sizze_30023, skip_threads_30055)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_30055 *= 2;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // last thread of block 'i' writes its result to offset 'i'\n        {\n            if ((local_tid_30021 - squot32(local_tid_30021, 32) * 32) == 31 &&\n                ltid_in_bounds_30054) {\n                ((volatile __local\n                  int64_t *) local_mem_30029)[squot64(byte_offsets_30025,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_30021,\n                                                                   32))] =\n                    x_30047;\n            }\n  ",
            "      }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n        {\n            int32_t skip_threads_30056;\n            \n            // read input for in-block scan\n            {\n                if (squot32(local_tid_30021, 32) == 0 && ltid_in_bounds_30054) {\n                    y_30052 = ((volatile __local\n                                int64_t *) local_mem_30029)[squot64(byte_offsets_30025,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_30021)];\n                    if ((local_tid_30021 - squot32(local_tid_30021, 32) * 32) ==\n                        0) {\n                        x_30051 = y_30052;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_30056 = 1;\n                while (slt32(skip_threads_30056, 32)) {\n                    if (sle32(skip_threads_30056, local_tid_30021 -\n                              squot32(local_tid_30021, 32) * 32) &&\n                        (squot32(local_tid_30021, 32) == 0 &&\n                         ltid_in_bounds_30054)) {\n                        // read operands\n                        {\n                            x_30051 = ((volatile __local\n                                        int64_t *) local_mem_30029)[squot64(byte_offsets_30025,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_30021) -\n                                                                     sext_i32_i64(skip_threads_30056))];\n                        }\n                        // perform operation\n                        {\n                            int64_t zz_30053 = x_30051 + y_30052;\n                            \n                ",
            "            x_30051 = zz_30053;\n                        }\n                    }\n                    if (sle32(wave_sizze_30023, skip_threads_30056)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_30056, local_tid_30021 -\n                              squot32(local_tid_30021, 32) * 32) &&\n                        (squot32(local_tid_30021, 32) == 0 &&\n                         ltid_in_bounds_30054)) {\n                        // write result\n                        {\n                            ((volatile __local\n                              int64_t *) local_mem_30029)[squot64(byte_offsets_30025,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_30021)] =\n                                x_30051;\n                            y_30052 = x_30051;\n                        }\n                    }\n                    if (sle32(wave_sizze_30023, skip_threads_30056)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_30056 *= 2;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // carry-in for every block except the first\n        {\n            if (!(squot32(local_tid_30021, 32) == 0 || !ltid_in_bounds_30054)) {\n                // read operands\n                {\n                    y_30048 = x_30047;\n                    x_30047 = ((__local\n                                int64_t *) local_mem_30029)[squot64(byte_offsets_30025,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_30021,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                }\n                // ",
            "perform operation\n                {\n                    int64_t zz_30049 = x_30047 + y_30048;\n                    \n                    x_30047 = zz_30049;\n                }\n                // write final result\n                {\n                    ((__local\n                      int64_t *) local_mem_30029)[squot64(byte_offsets_30025,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_30021)] =\n                        x_30047;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // restore correct values for first block\n        {\n            if (squot32(local_tid_30021, 32) == 0) {\n                ((__local\n                  int64_t *) local_mem_30029)[squot64(byte_offsets_30025,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_30021)] =\n                    y_30048;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_tid_30021 == 0) {\n            acc_30050 = ((__local\n                          int64_t *) local_mem_30029)[squot64(byte_offsets_30025,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_28084 -\n                                                       (int64_t) 1)];\n        } else {\n            acc_30050 = ((__local\n                          int64_t *) local_mem_30029)[squot64(byte_offsets_30025,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_30021) -\n                                                       (int64_t) 1)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t prefix_30057;\n    \n    prefix_30057 = (int64_t) 0;\n    // Perform lookback\n    {\n   ",
            "     if (dynamic_id_30037 == (int64_t) 0 && local_tid_30021 == 0) {\n            ((volatile __global\n              int64_t *) incprefixes_mem_30018)[dynamic_id_30037] = acc_30050;\n            mem_fence_global();\n            ((volatile __global\n              int8_t *) status_flags_mem_30014)[dynamic_id_30037] = (int8_t) 2;\n            acc_30050 = (int64_t) 0;\n        }\n        if (!(dynamic_id_30037 == (int64_t) 0) && slt32(local_tid_30021,\n                                                        wave_sizze_30023)) {\n            if (local_tid_30021 == 0) {\n                ((volatile __global\n                  int64_t *) aggregates_mem_30016)[dynamic_id_30037] =\n                    acc_30050;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_30014)[dynamic_id_30037] =\n                    (int8_t) 1;\n                ((__local int8_t *) local_mem_30029)[(int64_t) 0] = ((__global\n                                                                      int8_t *) status_flags_mem_30014)[dynamic_id_30037 -\n                                                                                                        (int64_t) 1];\n            }\n            mem_fence_local();\n            \n            int8_t status_30058;\n            \n            status_30058 = ((__local int8_t *) local_mem_30029)[(int64_t) 0];\n            if (status_30058 == (int8_t) 2) {\n                if (local_tid_30021 == 0) {\n                    prefix_30057 = ((volatile __global\n                                     int64_t *) incprefixes_mem_30018)[dynamic_id_30037 -\n                                                                       (int64_t) 1];\n                }\n            } else {\n                int32_t readOffset_30059 = dynamic_id_30037 -\n                        sext_i32_i64(wave_sizze_30023);\n                \n                while (slt32(wave_sizze_30023 * -1, readOffset_30059)) {\n                    int32_t read_i_30060 = readOffset_300",
            "59 + local_tid_30021;\n                    int64_t aggr_30061 = (int64_t) 0;\n                    int8_t flag_30062 = (int8_t) 0;\n                    int8_t used_30063 = (int8_t) 0;\n                    \n                    if (sle32(0, read_i_30060)) {\n                        flag_30062 = ((volatile __global\n                                       int8_t *) status_flags_mem_30014)[sext_i32_i64(read_i_30060)];\n                        if (flag_30062 == (int8_t) 2) {\n                            aggr_30061 = ((volatile __global\n                                           int64_t *) incprefixes_mem_30018)[sext_i32_i64(read_i_30060)];\n                        } else {\n                            if (flag_30062 == (int8_t) 1) {\n                                aggr_30061 = ((volatile __global\n                                               int64_t *) aggregates_mem_30016)[sext_i32_i64(read_i_30060)];\n                                used_30063 = (int8_t) 1;\n                            }\n                        }\n                    }\n                    ((__local\n                      int64_t *) local_mem_30029)[squot64(warp_byte_offset_30027,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_30021)] =\n                        aggr_30061;\n                    \n                    int8_t tmp_30064;\n                    \n                    tmp_30064 = flag_30062 | used_30063 << (int8_t) 2;\n                    ((__local\n                      int8_t *) local_mem_30029)[sext_i32_i64(local_tid_30021)] =\n                        tmp_30064;\n                    mem_fence_local();\n                    flag_30062 = ((volatile __local\n                                   int8_t *) local_mem_30029)[sext_i32_i64(wave_sizze_30023) -\n                                                              (int64_t) 1];\n                    if (local_tid_30021 == 0) {\n                        if (!(flag_30062 == (int8_t) ",
            "2)) {\n                            int64_t x_30065 = (int64_t) 0;\n                            int64_t y_30066;\n                            int8_t flag1_30068;\n                            \n                            flag1_30068 = (int8_t) 0;\n                            \n                            int8_t flag2_30069;\n                            int8_t used1_30070;\n                            \n                            used1_30070 = (int8_t) 0;\n                            \n                            int8_t used2_30071;\n                            \n                            for (int32_t i_30072 = 0; i_30072 <\n                                 wave_sizze_30023; i_30072++) {\n                                flag2_30069 = ((__local\n                                                int8_t *) local_mem_30029)[sext_i32_i64(i_30072)];\n                                used2_30071 = lshr8(flag2_30069, (int8_t) 2);\n                                flag2_30069 = flag2_30069 & (int8_t) 3;\n                                y_30066 = ((__local\n                                            int64_t *) local_mem_30029)[squot64(warp_byte_offset_30027,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_30072)];\n                                if (!(flag2_30069 == (int8_t) 1)) {\n                                    flag1_30068 = flag2_30069;\n                                    used1_30070 = used2_30071;\n                                    x_30065 = y_30066;\n                                } else {\n                                    used1_30070 += used2_30071;\n                                    \n                                    int64_t zz_30067;\n                                    \n                                    zz_30067 = x_30065 + y_30066;\n                                    x_30065 = zz_30067;\n                                }\n                           ",
            " }\n                            flag_30062 = flag1_30068;\n                            used_30063 = used1_30070;\n                            aggr_30061 = x_30065;\n                        } else {\n                            aggr_30061 = ((__local\n                                           int64_t *) local_mem_30029)[squot64(warp_byte_offset_30027,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_30023) -\n                                                                        (int64_t) 1)];\n                        }\n                        if (flag_30062 == (int8_t) 2) {\n                            readOffset_30059 = wave_sizze_30023 * -1;\n                        } else {\n                            readOffset_30059 -= zext_i8_i32(used_30063);\n                        }\n                        ((__local int32_t *) local_mem_30029)[(int64_t) 0] =\n                            readOffset_30059;\n                        \n                        int64_t x_30073;\n                        \n                        x_30073 = aggr_30061;\n                        \n                        int64_t y_30074;\n                        \n                        y_30074 = prefix_30057;\n                        \n                        int64_t zz_30075;\n                        \n                        zz_30075 = x_30073 + y_30074;\n                        prefix_30057 = zz_30075;\n                    }\n                    mem_fence_local();\n                    readOffset_30059 = ((__local\n                                         int32_t *) local_mem_30029)[(int64_t) 0];\n                }\n            }\n            if (local_tid_30021 == 0) {\n                int64_t x_30076 = prefix_30057;\n                int64_t y_30077 = acc_30050;\n                int64_t zz_30078 = x_30076 + y_30077;\n                \n                ((volatile __global\n                  int64",
            "_t *) incprefixes_mem_30018)[dynamic_id_30037] =\n                    zz_30078;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_30014)[dynamic_id_30037] =\n                    (int8_t) 2;\n                ((__local\n                  int64_t *) local_mem_30029)[squot64(warp_byte_offset_30027,\n                                                      (int64_t) 8)] =\n                    prefix_30057;\n                acc_30050 = (int64_t) 0;\n            }\n        }\n        if (!(dynamic_id_30037 == (int64_t) 0)) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            prefix_30057 = ((__local\n                             int64_t *) local_mem_30029)[squot64(warp_byte_offset_30027,\n                                                                 (int64_t) 8)];\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    // Distribute results\n    {\n        int64_t x_30079;\n        int64_t y_30080;\n        int64_t x_30082;\n        \n        x_30082 = prefix_30057;\n        \n        int64_t y_30083;\n        \n        y_30083 = acc_30050;\n        \n        int64_t zz_30084;\n        \n        zz_30084 = x_30082 + y_30083;\n        x_30079 = zz_30084;\n        for (int64_t i_30085 = 0; i_30085 < (int64_t) 9; i_30085++) {\n            y_30080 = private_mem_30039[i_30085];\n            \n            int64_t zz_30081;\n            \n            zz_30081 = x_30079 + y_30080;\n            private_mem_30039[i_30085] = zz_30081;\n        }\n    }\n    // Transpose scan output\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_30086 = 0; i_30086 < (int64_t) 9; i_30086++) {\n            int64_t sharedIdx_30087 = sext_i32_i64(local_tid_30021 * 9) +\n                    i_30086;\n            \n            ((__local int64_t *) local_mem_30029)[sharedIdx_30087] =\n                private_mem_30039[i_30086];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_30088 = 0; i_30088 < (int64_t) 9; i_30088++) {\n           ",
            " int32_t sharedIdx_30089 = local_tid_30021 +\n                    sext_i64_i32(segscan_group_sizze_28084 * i_30088);\n            \n            private_mem_30039[i_30088] = ((__local\n                                           int64_t *) local_mem_30029)[sext_i32_i64(sharedIdx_30089)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Write block scan results to global memory\n    {\n        for (int64_t i_30090 = 0; i_30090 < (int64_t) 9; i_30090++) {\n            int64_t gtid_28088 = blockOff_30038 + segscan_group_sizze_28084 *\n                    i_30090 + sext_i32_i64(local_tid_30021);\n            \n            if (slt64(gtid_28088, j_m_i_27250)) {\n                ((__global int64_t *) mem_28660)[gtid_28088] =\n                    private_mem_30039[i_30090];\n            }\n        }\n    }\n    // If this is the last block, reset the dynamicId\n    {\n        if (dynamic_id_30037 == sdiv_up64(j_m_i_27250,\n                                          segscan_group_sizze_28084 *\n                                          (int64_t) 9) - (int64_t) 1) {\n            ((__global\n              int32_t *) eWiseAddMultEntryziid_counter_mem_30012)[(int64_t) 0] =\n                0;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_28084\n}\n__kernel void eWiseMultEntryzisegmap_27693(__global int *global_failure,\n                                           int64_t conc_tmp_26126,\n                                           int64_t last_res_26217,\n                                           int64_t last_res_26218,\n                                           int64_t last_res_26219, __global\n                                           unsigned char *mem_param_28366,\n                                           __global\n                                           unsigned char *mem_param_28371,\n                                           __global unsigned char *mem_28378,\n                                           __global unsigned char *mem_28380,\n                        ",
            "                   __global unsigned char *mem_28382,\n                                           __global unsigned char *mem_28384,\n                                           __global unsigned char *mem_28386,\n                                           __global unsigned char *mem_28388,\n                                           __global unsigned char *mem_28390)\n{\n    #define segmap_group_sizze_27696 (eWiseMultEntryzisegmap_group_sizze_27695)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29530;\n    int32_t local_tid_29531;\n    int64_t group_sizze_29534;\n    int32_t wave_sizze_29533;\n    int32_t group_tid_29532;\n    \n    global_tid_29530 = get_global_id(0);\n    local_tid_29531 = get_local_id(0);\n    group_sizze_29534 = get_local_size(0);\n    wave_sizze_29533 = LOCKSTEP_WIDTH;\n    group_tid_29532 = get_group_id(0);\n    \n    int32_t phys_tid_27693;\n    \n    phys_tid_27693 = global_tid_29530;\n    \n    int64_t write_i_27692;\n    \n    write_i_27692 = sext_i32_i64(group_tid_29532) * segmap_group_sizze_27696 +\n        sext_i32_i64(local_tid_29531);\n    if (slt64(write_i_27692, conc_tmp_26126)) {\n        int32_t x_26224 = ((__global int32_t *) mem_28386)[write_i_27692];\n        int64_t write_value_26229 = ((__global\n                                      int64_t *) mem_param_28366)[write_i_27692];\n        int64_t write_value_26230 = ((__global\n                                      int64_t *) mem_param_28371)[write_i_27692];\n        bool match_lit_26231 = 0 == x_26224;\n        int64_t defunc_1_f_res_26232;\n        \n        if (match_lit_26231) {\n            int64_t x_26225 = ((__global int64_t *) mem_28378)[write_i_27692];\n            int64_t case_res_26233 = sub64(x_26225, (int64_t) 1);\n            \n            defunc_1_f_res_26232 = case_res_26233;\n        } else {\n            int64_t x_26226 = ((__global int64_t *) mem_28380)[write_i_27692];\n     ",
            "       int64_t x_26227 = ((__global int64_t *) mem_28382)[write_i_27692];\n            int64_t x_26228 = ((__global int64_t *) mem_28384)[write_i_27692];\n            bool match_lit_26234 = 1 == x_26224;\n            int64_t x_26235;\n            \n            if (match_lit_26234) {\n                int64_t x_26236 = add64(last_res_26217, x_26226);\n                int64_t case_res_26237 = sub64(x_26236, (int64_t) 1);\n                \n                x_26235 = case_res_26237;\n            } else {\n                bool match_lit_26238 = 2 == x_26224;\n                int64_t x_26239;\n                \n                if (match_lit_26238) {\n                    int64_t x_26240 = add64(last_res_26217, last_res_26218);\n                    int64_t x_26241 = add64(x_26227, x_26240);\n                    int64_t case_res_26242 = sub64(x_26241, (int64_t) 1);\n                    \n                    x_26239 = case_res_26242;\n                } else {\n                    int64_t x_26243 = add64(last_res_26217, last_res_26218);\n                    int64_t x_26244 = add64(last_res_26219, x_26243);\n                    int64_t x_26245 = add64(x_26228, x_26244);\n                    int64_t defunc_1_f_res_res_26246 = sub64(x_26245,\n                                                             (int64_t) 1);\n                    \n                    x_26239 = defunc_1_f_res_res_26246;\n                }\n                x_26235 = x_26239;\n            }\n            defunc_1_f_res_26232 = x_26235;\n        }\n        if (sle64((int64_t) 0, defunc_1_f_res_26232) &&\n            slt64(defunc_1_f_res_26232, conc_tmp_26126)) {\n            ((__global int64_t *) mem_28388)[defunc_1_f_res_26232] =\n                write_value_26229;\n        }\n        if (sle64((int64_t) 0, defunc_1_f_res_26232) &&\n            slt64(defunc_1_f_res_26232, conc_tmp_26126)) {\n            ((__global int64_t *) mem_28390)[defunc_1_f_res_26232] =\n                write_value_26230;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef s",
            "egmap_group_sizze_27696\n}\n__kernel void eWiseMultEntryzisegmap_27749(__global int *global_failure,\n                                           int failure_is_an_option, __global\n                                           int64_t *global_failure_args,\n                                           int64_t i_26087, int64_t i_26109,\n                                           int64_t j_m_i_26111,\n                                           int64_t conc_tmp_26126, __global\n                                           unsigned char *leftColumns_mem_28232,\n                                           __global\n                                           unsigned char *rightColumns_mem_28235,\n                                           __global\n                                           unsigned char *defunc_0_f_res_mem_28405,\n                                           __global unsigned char *mem_28408,\n                                           __global unsigned char *mem_28410,\n                                           __global unsigned char *mem_28412)\n{\n    #define segmap_group_sizze_27773 (eWiseMultEntryzisegmap_group_sizze_27751)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29535;\n    int32_t local_tid_29536;\n    int64_t group_sizze_29539;\n    int32_t wave_sizze_29538;\n    int32_t group_tid_29537;\n    \n    global_tid_29535 = get_global_id(0);\n    local_tid_29536 = get_local_id(0);\n    group_sizze_29539 = get_local_size(0);\n    wave_sizze_29538 = LOCKSTEP_WIDTH;\n    group_tid_29537 = get_group_id(0);\n    \n    int32_t phys_tid_27749;\n    \n    phys_tid_27749 = global_tid_29535;\n    \n    int64_t gtid_27748;\n    \n    gtid_27748 = sext_i32_i64(group_tid_29537) * segmap_group_sizze_27773 +\n        sext_i32_i64(local_tid_29536);\n    if (slt64(gtid_27748, conc_tmp_26126)) {\n        int64_t x_27778 = ((__global\n                            int64_t *) defunc_0_f_re",
            "s_mem_28405)[gtid_27748];\n        bool x_27779 = sle64((int64_t) 0, x_27778);\n        bool y_27780 = slt64(x_27778, conc_tmp_26126);\n        bool bounds_check_27781 = x_27779 && y_27780;\n        bool index_certs_27782;\n        \n        if (!bounds_check_27781) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 61) == -1) {\n                    global_failure_args[0] = x_27778;\n                    global_failure_args[1] = conc_tmp_26126;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        bool index_concat_cmp_27783 = sle64(j_m_i_26111, x_27778);\n        int64_t index_concat_branch_27784;\n        \n        if (index_concat_cmp_27783) {\n            int64_t index_concat_i_27785 = sub64(x_27778, j_m_i_26111);\n            int64_t slice_27786 = i_26087 + index_concat_i_27785;\n            int64_t index_concat_27787 = ((__global\n                                           int64_t *) rightColumns_mem_28235)[slice_27786];\n            \n            index_concat_branch_27784 = index_concat_27787;\n        } else {\n            int64_t slice_27788 = i_26109 + x_27778;\n            int64_t index_concat_27789 = ((__global\n                                           int64_t *) leftColumns_mem_28232)[slice_27788];\n            \n            index_concat_branch_27784 = index_concat_27789;\n        }\n        \n        int64_t defunc_0_f_res_27790 = index_concat_branch_27784;\n        int64_t index_concat_branch_27791 =\n                btoi_bool_i64(index_concat_cmp_27783);\n        int64_t defunc_0_f_res_27792 = index_concat_branch_27791;\n        int64_t index_concat_branch_27793;\n        \n        if (index_concat_cmp_27783) {\n            int64_t index_concat_i_27794 = sub64(x_27778, j_m_i_26111);\n            \n            index_concat_branch_27793 = index_concat_i_27794;\n        } else {\n            index_concat_branch_27793 = x_27778;\n        }\n        \n        int64_t defunc_0_f_res_27795 = index_concat_branch_277",
            "93;\n        \n        ((__global int64_t *) mem_28408)[gtid_27748] = defunc_0_f_res_27790;\n        ((__global int64_t *) mem_28410)[gtid_27748] = defunc_0_f_res_27792;\n        ((__global int64_t *) mem_28412)[gtid_27748] = defunc_0_f_res_27795;\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_27773\n}\n__kernel void eWiseMultEntryzisegmap_27805(__global int *global_failure,\n                                           int64_t j_m_i_26127, __global\n                                           unsigned char *mem_28415, __global\n                                           unsigned char *mem_28417, __global\n                                           unsigned char *mem_28419, __global\n                                           unsigned char *mem_28421, __global\n                                           unsigned char *mem_28423, __global\n                                           unsigned char *mem_28425, __global\n                                           unsigned char *mem_28427, __global\n                                           unsigned char *mem_28429)\n{\n    #define segmap_group_sizze_27808 (eWiseMultEntryzisegmap_group_sizze_27807)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29621;\n    int32_t local_tid_29622;\n    int64_t group_sizze_29625;\n    int32_t wave_sizze_29624;\n    int32_t group_tid_29623;\n    \n    global_tid_29621 = get_global_id(0);\n    local_tid_29622 = get_local_id(0);\n    group_sizze_29625 = get_local_size(0);\n    wave_sizze_29624 = LOCKSTEP_WIDTH;\n    group_tid_29623 = get_group_id(0);\n    \n    int32_t phys_tid_27805;\n    \n    phys_tid_27805 = global_tid_29621;\n    \n    int64_t write_i_27804;\n    \n    write_i_27804 = sext_i32_i64(group_tid_29623) * segmap_group_sizze_27808 +\n        sext_i32_i64(local_tid_29622);\n    if (slt64(write_i_27804, j_m_i_26127)) {\n        int64_t c_26346 = ((__global int64_t *) mem_28417)",
            "[write_i_27804];\n        int64_t offset_26347 = ((__global int64_t *) mem_28415)[write_i_27804];\n        int64_t v_26348 = ((__global int64_t *) mem_28419)[write_i_27804];\n        int64_t v_26349 = ((__global int64_t *) mem_28421)[write_i_27804];\n        int64_t v_26350 = ((__global int64_t *) mem_28423)[write_i_27804];\n        bool is_this_one_26351 = c_26346 == (int64_t) 0;\n        int64_t this_offset_26352 = (int64_t) -1 + offset_26347;\n        int64_t total_res_26353;\n        \n        if (is_this_one_26351) {\n            total_res_26353 = this_offset_26352;\n        } else {\n            total_res_26353 = (int64_t) -1;\n        }\n        if (sle64((int64_t) 0, total_res_26353) && slt64(total_res_26353,\n                                                         j_m_i_26127)) {\n            ((__global int64_t *) mem_28425)[total_res_26353] = v_26348;\n        }\n        if (sle64((int64_t) 0, total_res_26353) && slt64(total_res_26353,\n                                                         j_m_i_26127)) {\n            ((__global int64_t *) mem_28427)[total_res_26353] = v_26349;\n        }\n        if (sle64((int64_t) 0, total_res_26353) && slt64(total_res_26353,\n                                                         j_m_i_26127)) {\n            ((__global int64_t *) mem_28429)[total_res_26353] = v_26350;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_27808\n}\n__kernel void eWiseMultEntryzisegmap_27811(__global int *global_failure,\n                                           int failure_is_an_option, __global\n                                           int64_t *global_failure_args,\n                                           int64_t n_25880, int64_t k_25882,\n                                           int64_t eWiseMultOffsets_res_26073,\n                                           int64_t i_26087, int64_t i_26109,\n                                           int64_t sizze_26128, int64_t y_26371,\n                                           int64_t indxs_2637",
            "2, __global\n                                           unsigned char *leftValues_mem_28231,\n                                           __global\n                                           unsigned char *rightValues_mem_28234,\n                                           __global unsigned char *mem_28339,\n                                           __global unsigned char *mem_28341,\n                                           __global\n                                           unsigned char *intersectArrays_res_mem_28442,\n                                           __global\n                                           unsigned char *intersectArrays_res_mem_28445,\n                                           __global\n                                           unsigned char *intersectArrays_res_mem_28448)\n{\n    #define segmap_group_sizze_27814 (eWiseMultEntryzisegmap_group_sizze_27813)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29626;\n    int32_t local_tid_29627;\n    int64_t group_sizze_29630;\n    int32_t wave_sizze_29629;\n    int32_t group_tid_29628;\n    \n    global_tid_29626 = get_global_id(0);\n    local_tid_29627 = get_local_id(0);\n    group_sizze_29630 = get_local_size(0);\n    wave_sizze_29629 = LOCKSTEP_WIDTH;\n    group_tid_29628 = get_group_id(0);\n    \n    int32_t phys_tid_27811;\n    \n    phys_tid_27811 = global_tid_29626;\n    \n    int64_t write_i_27810;\n    \n    write_i_27810 = sext_i32_i64(group_tid_29628) * segmap_group_sizze_27814 +\n        sext_i32_i64(local_tid_29627);\n    if (slt64(write_i_27810, indxs_26372)) {\n        int64_t index_primexp_28115 = add64(y_26371, write_i_27810);\n        int64_t write_value_26385 = ((__global\n                                      int64_t *) intersectArrays_res_mem_28442)[write_i_27810];\n        bool y_26389 = slt64(write_i_27810, sizze_26128);\n        bool index_certs_26391;\n        \n        if (!y_26389",
            ") {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 63) == -1) {\n                    global_failure_args[0] = write_i_27810;\n                    global_failure_args[1] = sizze_26128;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        int64_t y_26392 = ((__global\n                            int64_t *) intersectArrays_res_mem_28448)[write_i_27810];\n        int64_t i_26393 = add64(i_26087, y_26392);\n        bool x_26394 = sle64((int64_t) 0, i_26393);\n        bool y_26395 = slt64(i_26393, k_25882);\n        bool bounds_check_26396 = x_26394 && y_26395;\n        bool index_certs_26397;\n        \n        if (!bounds_check_26396) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 64) == -1) {\n                    global_failure_args[0] = i_26393;\n                    global_failure_args[1] = k_25882;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        double defunc_1_mult_arg_26398 = ((__global\n                                           double *) rightValues_mem_28234)[i_26393];\n        int64_t y_26399 = ((__global\n                            int64_t *) intersectArrays_res_mem_28445)[write_i_27810];\n        int64_t i_26400 = add64(i_26109, y_26399);\n        bool x_26401 = sle64((int64_t) 0, i_26400);\n        bool y_26402 = slt64(i_26400, n_25880);\n        bool bounds_check_26403 = x_26401 && y_26402;\n        bool index_certs_26404;\n        \n        if (!bounds_check_26403) {\n            {\n                if (atomic_cmpxchg_i32_global(global_failure, -1, 65) == -1) {\n                    global_failure_args[0] = i_26400;\n                    global_failure_args[1] = n_25880;\n                    ;\n                }\n                return;\n            }\n        }\n        \n        double defunc_0_mult_arg_26405 = ((__global\n                                           double *) leftValues_mem_28231)[i_26400];\n        d",
            "ouble defunc_1_mult_res_26406 = defunc_1_mult_arg_26398 *\n               defunc_0_mult_arg_26405;\n        \n        if (sle64((int64_t) 0, index_primexp_28115) &&\n            slt64(index_primexp_28115, eWiseMultOffsets_res_26073)) {\n            ((__global double *) mem_28339)[index_primexp_28115] =\n                defunc_1_mult_res_26406;\n        }\n        if (sle64((int64_t) 0, index_primexp_28115) &&\n            slt64(index_primexp_28115, eWiseMultOffsets_res_26073)) {\n            ((__global int64_t *) mem_28341)[index_primexp_28115] =\n                write_value_26385;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segmap_group_sizze_27814\n}\n__kernel void eWiseMultEntryzisegred_nonseg_28898(__global int *global_failure,\n                                                  int failure_is_an_option,\n                                                  __global\n                                                  int64_t *global_failure_args,\n                                                  uint red_arr_mem_29145_backing_offset_0,\n                                                  uint red_arr_mem_29143_backing_offset_1,\n                                                  uint red_arr_mem_29141_backing_offset_2,\n                                                  uint sync_arr_mem_29139_backing_offset_3,\n                                                  int64_t m_25881,\n                                                  int64_t num_threads_29133,\n                                                  __global\n                                                  unsigned char *leftOffsets_mem_28233,\n                                                  __global\n                                                  unsigned char *rightOffsets_mem_28236,\n                                                  __global\n                                                  unsigned char *mem_28939,\n                                                  __global\n                                               ",
            "   unsigned char *mem_28941,\n                                                  __global\n                                                  unsigned char *mem_28943,\n                                                  __global\n                                                  unsigned char *eWiseMultEntryzicounter_mem_29125,\n                                                  __global\n                                                  unsigned char *group_res_arr_mem_29127,\n                                                  __global\n                                                  unsigned char *group_res_arr_mem_29129,\n                                                  __global\n                                                  unsigned char *group_res_arr_mem_29131)\n{\n    #define segred_num_groups_28890 (eWiseMultEntryzisegred_num_groups_28889)\n    #define segred_group_sizze_28892 (eWiseMultEntryzisegred_group_sizze_28891)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *red_arr_mem_29145_backing_3 =\n                  &shared_mem[red_arr_mem_29145_backing_offset_0];\n    volatile char *red_arr_mem_29143_backing_2 =\n                  &shared_mem[red_arr_mem_29143_backing_offset_1];\n    volatile char *red_arr_mem_29141_backing_1 =\n                  &shared_mem[red_arr_mem_29141_backing_offset_2];\n    volatile char *sync_arr_mem_29139_backing_0 =\n                  &shared_mem[sync_arr_mem_29139_backing_offset_3];\n    volatile __local bool local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = false;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t global_tid_29134;\n    int32_t local_tid_29135;\n    int64_t group_sizze_29138;\n    int32_t wave_sizze_29137;\n    int32_t group_tid_29136;\n    \n    global_tid_29134 = get_global_id(0);\n    local_tid_29135 = get_local_id(0);\n    group_sizze_29138 = get_local",
            "_size(0);\n    wave_sizze_29137 = LOCKSTEP_WIDTH;\n    group_tid_29136 = get_group_id(0);\n    \n    int32_t phys_tid_28898;\n    \n    phys_tid_28898 = global_tid_29134;\n    \n    __local char *sync_arr_mem_29139;\n    \n    sync_arr_mem_29139 = (__local char *) sync_arr_mem_29139_backing_0;\n    \n    __local char *red_arr_mem_29141;\n    \n    red_arr_mem_29141 = (__local char *) red_arr_mem_29141_backing_1;\n    \n    __local char *red_arr_mem_29143;\n    \n    red_arr_mem_29143 = (__local char *) red_arr_mem_29143_backing_2;\n    \n    __local char *red_arr_mem_29145;\n    \n    red_arr_mem_29145 = (__local char *) red_arr_mem_29145_backing_3;\n    \n    int64_t dummy_28896;\n    \n    dummy_28896 = (int64_t) 0;\n    \n    int64_t gtid_28897;\n    \n    gtid_28897 = (int64_t) 0;\n    \n    int64_t x_acc_29147;\n    int64_t x_acc_29148;\n    int64_t x_acc_29149;\n    int64_t chunk_sizze_29150;\n    \n    chunk_sizze_29150 = smin64(sdiv_up64(m_25881,\n                                         sext_i32_i64(sext_i64_i32(segred_group_sizze_28892 *\n                                         segred_num_groups_28890))),\n                               sdiv_up64(m_25881 - sext_i32_i64(phys_tid_28898),\n                                         num_threads_29133));\n    \n    int64_t x_28899;\n    int64_t x_28900;\n    int64_t x_28901;\n    int64_t y_28902;\n    int64_t y_28903;\n    int64_t y_28904;\n    \n    // neutral-initialise the accumulators\n    {\n        x_acc_29147 = (int64_t) 0;\n        x_acc_29148 = (int64_t) 0;\n        x_acc_29149 = (int64_t) 0;\n    }\n    for (int64_t i_29160 = 0; i_29160 < chunk_sizze_29150; i_29160++) {\n        gtid_28897 = sext_i32_i64(phys_tid_28898) + num_threads_29133 * i_29160;\n        // apply map function\n        {\n            int64_t x_28909 = ((__global\n                                int64_t *) leftOffsets_mem_28233)[gtid_28897];\n            int64_t x_28910 = ((__global\n                                int64_t *) rightOffsets_mem_28236)[gtid_28897];\n            bool cond_28911 = gt",
            "id_28897 == (int64_t) 0;\n            int64_t prevx2_28912;\n            \n            if (cond_28911) {\n                prevx2_28912 = gtid_28897;\n            } else {\n                int64_t prevx2_f_res_28913 = sub64(gtid_28897, (int64_t) 1);\n                \n                prevx2_28912 = prevx2_f_res_28913;\n            }\n            \n            int64_t prevy2_28914;\n            \n            if (cond_28911) {\n                prevy2_28914 = gtid_28897;\n            } else {\n                int64_t prevy2_f_res_28915 = sub64(gtid_28897, (int64_t) 1);\n                \n                prevy2_28914 = prevy2_f_res_28915;\n            }\n            \n            bool x_28916 = sle64((int64_t) 0, prevy2_28914);\n            bool y_28917 = slt64(prevy2_28914, m_25881);\n            bool bounds_check_28918 = x_28916 && y_28917;\n            bool index_certs_28919;\n            \n            if (!bounds_check_28918) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 52) ==\n                        -1) {\n                        global_failure_args[0] = prevy2_28914;\n                        global_failure_args[1] = m_25881;\n                        ;\n                    }\n                    local_failure = true;\n                    goto error_0;\n                }\n            }\n            \n            int64_t i_28920 = ((__global\n                                int64_t *) rightOffsets_mem_28236)[prevy2_28914];\n            int64_t j_m_i_28921 = sub64(x_28910, i_28920);\n            bool x_28922 = sle64((int64_t) 0, prevx2_28912);\n            bool y_28923 = slt64(prevx2_28912, m_25881);\n            bool bounds_check_28924 = x_28922 && y_28923;\n            bool index_certs_28925;\n            \n            if (!bounds_check_28924) {\n                {\n                    if (atomic_cmpxchg_i32_global(global_failure, -1, 53) ==\n                        -1) {\n                        global_failure_args[0] = prevx2_28912;\n                        global_failu",
            "re_args[1] = m_25881;\n                        ;\n                    }\n                    local_failure = true;\n                    goto error_0;\n                }\n            }\n            \n            int64_t i_28926 = ((__global\n                                int64_t *) leftOffsets_mem_28233)[prevx2_28912];\n            int64_t j_m_i_28927 = sub64(x_28909, i_28926);\n            int64_t conc_tmp_28928 = j_m_i_28921 + j_m_i_28927;\n            int64_t bytes_28929 = (int64_t) 8 * conc_tmp_28928;\n            int64_t bytes_28930 = (int64_t) 4 * conc_tmp_28928;\n            int64_t double_buffer_sizze_28931 = (int64_t) 8 * conc_tmp_28928;\n            \n            // save map-out results\n            { }\n            // load accumulator\n            {\n                x_28899 = x_acc_29147;\n                x_28900 = x_acc_29148;\n                x_28901 = x_acc_29149;\n            }\n            // load new values\n            {\n                y_28902 = bytes_28929;\n                y_28903 = bytes_28930;\n                y_28904 = double_buffer_sizze_28931;\n            }\n            // apply reduction operator\n            {\n                int64_t zz_28905 = smax64(x_28899, y_28902);\n                int64_t zz_28906 = smax64(x_28900, y_28903);\n                int64_t zz_28907 = smax64(x_28901, y_28904);\n                \n                // store in accumulator\n                {\n                    x_acc_29147 = zz_28905;\n                    x_acc_29148 = zz_28906;\n                    x_acc_29149 = zz_28907;\n                }\n            }\n        }\n    }\n    // to reduce current chunk, first store our result in memory\n    {\n        x_28899 = x_acc_29147;\n        x_28900 = x_acc_29148;\n        x_28901 = x_acc_29149;\n        ((__local int64_t *) red_arr_mem_29141)[sext_i32_i64(local_tid_29135)] =\n            x_28899;\n        ((__local int64_t *) red_arr_mem_29143)[sext_i32_i64(local_tid_29135)] =\n            x_28900;\n        ((__local int64_t *) red_arr_mem_29145)[sext_i32_i64(local",
            "_tid_29135)] =\n            x_28901;\n    }\n    \n  error_0:\n    barrier(CLK_LOCAL_MEM_FENCE);\n    if (local_failure)\n        return;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t offset_29161;\n    int32_t skip_waves_29162;\n    \n    skip_waves_29162 = 1;\n    \n    int64_t x_29151;\n    int64_t x_29152;\n    int64_t x_29153;\n    int64_t y_29154;\n    int64_t y_29155;\n    int64_t y_29156;\n    \n    offset_29161 = 0;\n    // participating threads read initial accumulator\n    {\n        if (slt32(local_tid_29135, sext_i64_i32(segred_group_sizze_28892))) {\n            x_29151 = ((__local\n                        int64_t *) red_arr_mem_29141)[sext_i32_i64(local_tid_29135 +\n                                                      offset_29161)];\n            x_29152 = ((__local\n                        int64_t *) red_arr_mem_29143)[sext_i32_i64(local_tid_29135 +\n                                                      offset_29161)];\n            x_29153 = ((__local\n                        int64_t *) red_arr_mem_29145)[sext_i32_i64(local_tid_29135 +\n                                                      offset_29161)];\n        }\n    }\n    offset_29161 = 1;\n    while (slt32(offset_29161, wave_sizze_29137)) {\n        if (slt32(local_tid_29135 + offset_29161,\n                  sext_i64_i32(segred_group_sizze_28892)) && ((local_tid_29135 -\n                                                               squot32(local_tid_29135,\n                                                                       wave_sizze_29137) *\n                                                               wave_sizze_29137) &\n                                                              (2 *\n                                                               offset_29161 -\n                                                               1)) == 0) {\n            // read array element\n            {\n                y_29154 = ((volatile __local\n                            int64_t *) red_arr_mem_29141)[sext_i32_i64(local_tid_29135 +\n ",
            "                                                         offset_29161)];\n                y_29155 = ((volatile __local\n                            int64_t *) red_arr_mem_29143)[sext_i32_i64(local_tid_29135 +\n                                                          offset_29161)];\n                y_29156 = ((volatile __local\n                            int64_t *) red_arr_mem_29145)[sext_i32_i64(local_tid_29135 +\n                                                          offset_29161)];\n            }\n            // apply reduction operation\n            {\n                int64_t zz_29157 = smax64(x_29151, y_29154);\n                int64_t zz_29158 = smax64(x_29152, y_29155);\n                int64_t zz_29159 = smax64(x_29153, y_29156);\n                \n                x_29151 = zz_29157;\n                x_29152 = zz_29158;\n                x_29153 = zz_29159;\n            }\n            // write result of operation\n            {\n                ((volatile __local\n                  int64_t *) red_arr_mem_29141)[sext_i32_i64(local_tid_29135)] =\n                    x_29151;\n                ((volatile __local\n                  int64_t *) red_arr_mem_29143)[sext_i32_i64(local_tid_29135)] =\n                    x_29152;\n                ((volatile __local\n                  int64_t *) red_arr_mem_29145)[sext_i32_i64(local_tid_29135)] =\n                    x_29153;\n            }\n        }\n        offset_29161 *= 2;\n    }\n    while (slt32(skip_waves_29162,\n                 squot32(sext_i64_i32(segred_group_sizze_28892) +\n                         wave_sizze_29137 - 1, wave_sizze_29137))) {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        offset_29161 = skip_waves_29162 * wave_sizze_29137;\n        if (slt32(local_tid_29135 + offset_29161,\n                  sext_i64_i32(segred_group_sizze_28892)) && ((local_tid_29135 -\n                                                               squot32(local_tid_29135,\n                                                                       wave_sizze_2913",
            "7) *\n                                                               wave_sizze_29137) ==\n                                                              0 &&\n                                                              (squot32(local_tid_29135,\n                                                                       wave_sizze_29137) &\n                                                               (2 *\n                                                                skip_waves_29162 -\n                                                                1)) == 0)) {\n            // read array element\n            {\n                y_29154 = ((__local\n                            int64_t *) red_arr_mem_29141)[sext_i32_i64(local_tid_29135 +\n                                                          offset_29161)];\n                y_29155 = ((__local\n                            int64_t *) red_arr_mem_29143)[sext_i32_i64(local_tid_29135 +\n                                                          offset_29161)];\n                y_29156 = ((__local\n                            int64_t *) red_arr_mem_29145)[sext_i32_i64(local_tid_29135 +\n                                                          offset_29161)];\n            }\n            // apply reduction operation\n            {\n                int64_t zz_29157 = smax64(x_29151, y_29154);\n                int64_t zz_29158 = smax64(x_29152, y_29155);\n                int64_t zz_29159 = smax64(x_29153, y_29156);\n                \n                x_29151 = zz_29157;\n                x_29152 = zz_29158;\n                x_29153 = zz_29159;\n            }\n            // write result of operation\n            {\n                ((__local\n                  int64_t *) red_arr_mem_29141)[sext_i32_i64(local_tid_29135)] =\n                    x_29151;\n                ((__local\n                  int64_t *) red_arr_mem_29143)[sext_i32_i64(local_tid_29135)] =\n                    x_29152;\n                ((__local\n                  int64_t *) red_arr_mem_29145)[",
            "sext_i32_i64(local_tid_29135)] =\n                    x_29153;\n            }\n        }\n        skip_waves_29162 *= 2;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    // first thread saves the result in accumulator\n    {\n        if (sext_i32_i64(local_tid_29135) == (int64_t) 0) {\n            x_acc_29147 = x_29151;\n            x_acc_29148 = x_29152;\n            x_acc_29149 = x_29153;\n        }\n    }\n    \n    int32_t old_counter_29163;\n    \n    // first thread in group saves group result to global memory\n    {\n        if (local_tid_29135 == 0) {\n            ((__global\n              int64_t *) group_res_arr_mem_29127)[sext_i32_i64(group_tid_29136) *\n                                                  segred_group_sizze_28892] =\n                x_acc_29147;\n            ((__global\n              int64_t *) group_res_arr_mem_29129)[sext_i32_i64(group_tid_29136) *\n                                                  segred_group_sizze_28892] =\n                x_acc_29148;\n            ((__global\n              int64_t *) group_res_arr_mem_29131)[sext_i32_i64(group_tid_29136) *\n                                                  segred_group_sizze_28892] =\n                x_acc_29149;\n            mem_fence_global();\n            old_counter_29163 = atomic_add_i32_global(&((volatile __global\n                                                         int *) eWiseMultEntryzicounter_mem_29125)[(int64_t) 0],\n                                                      (int) 1);\n            ((__local bool *) sync_arr_mem_29139)[(int64_t) 0] =\n                old_counter_29163 == segred_num_groups_28890 - (int64_t) 1;\n        }\n    }\n    barrier(CLK_GLOBAL_MEM_FENCE | CLK_LOCAL_MEM_FENCE);\n    \n    bool is_last_group_29164;\n    \n    is_last_group_29164 = ((__local bool *) sync_arr_mem_29139)[(int64_t) 0];\n    if (is_last_group_29164) {\n        if (local_tid_29135 == 0) {\n            old_counter_29163 = atomic_add_i32_global(&((volatile __global\n                                                         int *",
            ") eWiseMultEntryzicounter_mem_29125)[(int64_t) 0],\n                                                      (int) ((int64_t) 0 -\n                                                             segred_num_groups_28890));\n        }\n        // read in the per-group-results\n        {\n            int64_t read_per_thread_29165 = sdiv_up64(segred_num_groups_28890,\n                                                      segred_group_sizze_28892);\n            \n            x_28899 = (int64_t) 0;\n            x_28900 = (int64_t) 0;\n            x_28901 = (int64_t) 0;\n            for (int64_t i_29166 = 0; i_29166 < read_per_thread_29165;\n                 i_29166++) {\n                int64_t group_res_id_29167 = sext_i32_i64(local_tid_29135) *\n                        read_per_thread_29165 + i_29166;\n                int64_t index_of_group_res_29168 = group_res_id_29167;\n                \n                if (slt64(group_res_id_29167, segred_num_groups_28890)) {\n                    y_28902 = ((__global\n                                int64_t *) group_res_arr_mem_29127)[index_of_group_res_29168 *\n                                                                    segred_group_sizze_28892];\n                    y_28903 = ((__global\n                                int64_t *) group_res_arr_mem_29129)[index_of_group_res_29168 *\n                                                                    segred_group_sizze_28892];\n                    y_28904 = ((__global\n                                int64_t *) group_res_arr_mem_29131)[index_of_group_res_29168 *\n                                                                    segred_group_sizze_28892];\n                    \n                    int64_t zz_28905;\n                    \n                    zz_28905 = smax64(x_28899, y_28902);\n                    \n                    int64_t zz_28906 = smax64(x_28900, y_28903);\n                    int64_t zz_28907 = smax64(x_28901, y_28904);\n                    \n                    x_28899 = zz_28905;\n        ",
            "            x_28900 = zz_28906;\n                    x_28901 = zz_28907;\n                }\n            }\n        }\n        ((__local int64_t *) red_arr_mem_29141)[sext_i32_i64(local_tid_29135)] =\n            x_28899;\n        ((__local int64_t *) red_arr_mem_29143)[sext_i32_i64(local_tid_29135)] =\n            x_28900;\n        ((__local int64_t *) red_arr_mem_29145)[sext_i32_i64(local_tid_29135)] =\n            x_28901;\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // reduce the per-group results\n        {\n            int32_t offset_29169;\n            int32_t skip_waves_29170;\n            \n            skip_waves_29170 = 1;\n            \n            int64_t x_29151;\n            int64_t x_29152;\n            int64_t x_29153;\n            int64_t y_29154;\n            int64_t y_29155;\n            int64_t y_29156;\n            \n            offset_29169 = 0;\n            // participating threads read initial accumulator\n            {\n                if (slt32(local_tid_29135,\n                          sext_i64_i32(segred_group_sizze_28892))) {\n                    x_29151 = ((__local\n                                int64_t *) red_arr_mem_29141)[sext_i32_i64(local_tid_29135 +\n                                                              offset_29169)];\n                    x_29152 = ((__local\n                                int64_t *) red_arr_mem_29143)[sext_i32_i64(local_tid_29135 +\n                                                              offset_29169)];\n                    x_29153 = ((__local\n                                int64_t *) red_arr_mem_29145)[sext_i32_i64(local_tid_29135 +\n                                                              offset_29169)];\n                }\n            }\n            offset_29169 = 1;\n            while (slt32(offset_29169, wave_sizze_29137)) {\n                if (slt32(local_tid_29135 + offset_29169,\n                          sext_i64_i32(segred_group_sizze_28892)) &&\n                    ((local_tid_29135 - squot32(local_tid_29135,\n        ",
            "                                        wave_sizze_29137) *\n                      wave_sizze_29137) & (2 * offset_29169 - 1)) == 0) {\n                    // read array element\n                    {\n                        y_29154 = ((volatile __local\n                                    int64_t *) red_arr_mem_29141)[sext_i32_i64(local_tid_29135 +\n                                                                  offset_29169)];\n                        y_29155 = ((volatile __local\n                                    int64_t *) red_arr_mem_29143)[sext_i32_i64(local_tid_29135 +\n                                                                  offset_29169)];\n                        y_29156 = ((volatile __local\n                                    int64_t *) red_arr_mem_29145)[sext_i32_i64(local_tid_29135 +\n                                                                  offset_29169)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t zz_29157 = smax64(x_29151, y_29154);\n                        int64_t zz_29158 = smax64(x_29152, y_29155);\n                        int64_t zz_29159 = smax64(x_29153, y_29156);\n                        \n                        x_29151 = zz_29157;\n                        x_29152 = zz_29158;\n                        x_29153 = zz_29159;\n                    }\n                    // write result of operation\n                    {\n                        ((volatile __local\n                          int64_t *) red_arr_mem_29141)[sext_i32_i64(local_tid_29135)] =\n                            x_29151;\n                        ((volatile __local\n                          int64_t *) red_arr_mem_29143)[sext_i32_i64(local_tid_29135)] =\n                            x_29152;\n                        ((volatile __local\n                          int64_t *) red_arr_mem_29145)[sext_i32_i64(local_tid_29135)] =\n                            x_29153;\n                    }\n                }\n         ",
            "       offset_29169 *= 2;\n            }\n            while (slt32(skip_waves_29170,\n                         squot32(sext_i64_i32(segred_group_sizze_28892) +\n                                 wave_sizze_29137 - 1, wave_sizze_29137))) {\n                barrier(CLK_LOCAL_MEM_FENCE);\n                offset_29169 = skip_waves_29170 * wave_sizze_29137;\n                if (slt32(local_tid_29135 + offset_29169,\n                          sext_i64_i32(segred_group_sizze_28892)) &&\n                    ((local_tid_29135 - squot32(local_tid_29135,\n                                                wave_sizze_29137) *\n                      wave_sizze_29137) == 0 && (squot32(local_tid_29135,\n                                                         wave_sizze_29137) &\n                                                 (2 * skip_waves_29170 - 1)) ==\n                     0)) {\n                    // read array element\n                    {\n                        y_29154 = ((__local\n                                    int64_t *) red_arr_mem_29141)[sext_i32_i64(local_tid_29135 +\n                                                                  offset_29169)];\n                        y_29155 = ((__local\n                                    int64_t *) red_arr_mem_29143)[sext_i32_i64(local_tid_29135 +\n                                                                  offset_29169)];\n                        y_29156 = ((__local\n                                    int64_t *) red_arr_mem_29145)[sext_i32_i64(local_tid_29135 +\n                                                                  offset_29169)];\n                    }\n                    // apply reduction operation\n                    {\n                        int64_t zz_29157 = smax64(x_29151, y_29154);\n                        int64_t zz_29158 = smax64(x_29152, y_29155);\n                        int64_t zz_29159 = smax64(x_29153, y_29156);\n                        \n                        x_29151 = zz_29157;\n                        x_29152 ",
            "= zz_29158;\n                        x_29153 = zz_29159;\n                    }\n                    // write result of operation\n                    {\n                        ((__local\n                          int64_t *) red_arr_mem_29141)[sext_i32_i64(local_tid_29135)] =\n                            x_29151;\n                        ((__local\n                          int64_t *) red_arr_mem_29143)[sext_i32_i64(local_tid_29135)] =\n                            x_29152;\n                        ((__local\n                          int64_t *) red_arr_mem_29145)[sext_i32_i64(local_tid_29135)] =\n                            x_29153;\n                    }\n                }\n                skip_waves_29170 *= 2;\n            }\n            // and back to memory with the final result\n            {\n                if (local_tid_29135 == 0) {\n                    ((__global int64_t *) mem_28939)[(int64_t) 0] = x_29151;\n                    ((__global int64_t *) mem_28941)[(int64_t) 0] = x_29152;\n                    ((__global int64_t *) mem_28943)[(int64_t) 0] = x_29153;\n                }\n            }\n        }\n    }\n    \n  error_1:\n    return;\n    #undef segred_num_groups_28890\n    #undef segred_group_sizze_28892\n}\n__kernel void eWiseMultEntryzisegscan_27683(__global int *global_failure,\n                                            int failure_is_an_option, __global\n                                            int64_t *global_failure_args,\n                                            uint local_mem_29199_backing_offset_0,\n                                            int64_t n_25880, int64_t m_25881,\n                                            int64_t k_25882,\n                                            int64_t num_threads_28870, __global\n                                            unsigned char *leftColumns_mem_28232,\n                                            __global\n                                            unsigned char *leftOffsets_mem_28233,\n                                      ",
            "      __global\n                                            unsigned char *rightColumns_mem_28235,\n                                            __global\n                                            unsigned char *rightOffsets_mem_28236,\n                                            __global unsigned char *mem_28239,\n                                            __global unsigned char *mem_28248,\n                                            __global unsigned char *mem_28250,\n                                            __global unsigned char *mem_28252,\n                                            __global unsigned char *mem_28254,\n                                            __global unsigned char *mem_28256,\n                                            __global unsigned char *mem_28318,\n                                            __global unsigned char *mem_28337,\n                                            __global\n                                            unsigned char *double_buffer_mem_28763,\n                                            __global\n                                            unsigned char *eWiseMultEntryziid_counter_mem_29173,\n                                            __global\n                                            unsigned char *status_flags_mem_29175,\n                                            __global\n                                            unsigned char *aggregates_mem_29177,\n                                            __global\n                                            unsigned char *incprefixes_mem_29179)\n{\n    #define segscan_group_sizze_27678 (eWiseMultEntryzisegscan_group_sizze_27677)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *local_mem_29199_backing_0 =\n                  &shared_mem[local_mem_29199_backing_offset_0];\n    volatile __local bool local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n ",
            "           return;\n    }\n    local_failure = false;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t global_tid_29190;\n    int32_t local_tid_29191;\n    int64_t group_sizze_29194;\n    int32_t wave_sizze_29193;\n    int32_t group_tid_29192;\n    \n    global_tid_29190 = get_global_id(0);\n    local_tid_29191 = get_local_id(0);\n    group_sizze_29194 = get_local_size(0);\n    wave_sizze_29193 = LOCKSTEP_WIDTH;\n    group_tid_29192 = get_group_id(0);\n    \n    int32_t phys_tid_27683;\n    \n    phys_tid_27683 = global_tid_29190;\n    \n    int64_t byte_offsets_29195;\n    \n    byte_offsets_29195 = (int64_t) 0;\n    \n    int64_t byte_offsets_29196;\n    \n    byte_offsets_29196 = segscan_group_sizze_27678 * (int64_t) 8;\n    \n    int64_t warp_byte_offset_29197;\n    \n    warp_byte_offset_29197 = (int64_t) 32;\n    \n    int64_t warp_byte_offset_29198;\n    \n    warp_byte_offset_29198 = (int64_t) 288;\n    // Allocate reused shared memeory\n    { }\n    \n    __local char *local_mem_29199;\n    \n    local_mem_29199 = (__local char *) local_mem_29199_backing_0;\n    \n    int64_t trans_arr_len_29200;\n    \n    trans_arr_len_29200 = (int64_t) 9 * segscan_group_sizze_27678;\n    \n    int32_t dynamic_id_29207;\n    \n    if (local_tid_29191 == 0) {\n        dynamic_id_29207 = atomic_add_i32_global(&((volatile __global\n                                                    int *) eWiseMultEntryziid_counter_mem_29173)[(int64_t) 0],\n                                                 (int) 1);\n        ((__local int32_t *) local_mem_29199)[(int64_t) 0] = dynamic_id_29207;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    dynamic_id_29207 = ((__local int32_t *) local_mem_29199)[(int64_t) 0];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t blockOff_29208;\n    \n    blockOff_29208 = sext_i32_i64(dynamic_id_29207) * (int64_t) 9 *\n        segscan_group_sizze_27678;\n    \n    int64_t private_mem_29209[9];\n    \n    // Load and map\n    {\n        for (int64_t i_29211 = 0; i_29211 < (int64_t) 9; i_29211++) {\n            int64_t gt",
            "id_27682 = blockOff_29208 +\n                    sext_i32_i64(local_tid_29191) + i_29211 *\n                    segscan_group_sizze_27678;\n            \n            if (slt64(gtid_27682, m_25881)) {\n                int64_t x_25894 = ((__global\n                                    int64_t *) leftOffsets_mem_28233)[gtid_27682];\n                int64_t x_25896 = ((__global\n                                    int64_t *) rightOffsets_mem_28236)[gtid_27682];\n                bool cond_25897 = gtid_27682 == (int64_t) 0;\n                int64_t prevx2_25898;\n                \n                if (cond_25897) {\n                    prevx2_25898 = gtid_27682;\n                } else {\n                    int64_t prevx2_f_res_25899 = sub64(gtid_27682, (int64_t) 1);\n                    \n                    prevx2_25898 = prevx2_f_res_25899;\n                }\n                \n                int64_t prevy2_25900;\n                \n                if (cond_25897) {\n                    prevy2_25900 = gtid_27682;\n                } else {\n                    int64_t prevy2_f_res_25901 = sub64(gtid_27682, (int64_t) 1);\n                    \n                    prevy2_25900 = prevy2_f_res_25901;\n                }\n                \n                bool x_25902 = sle64((int64_t) 0, prevy2_25900);\n                bool y_25903 = slt64(prevy2_25900, m_25881);\n                bool bounds_check_25904 = x_25902 && y_25903;\n                bool index_certs_25905;\n                \n                if (!bounds_check_25904) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 54) ==\n                            -1) {\n                            global_failure_args[0] = prevy2_25900;\n                            global_failure_args[1] = m_25881;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                \n                int64_t i_259",
            "06 = ((__global\n                                    int64_t *) rightOffsets_mem_28236)[prevy2_25900];\n                int64_t j_m_i_25907 = sub64(x_25896, i_25906);\n                bool empty_slice_25908 = j_m_i_25907 == (int64_t) 0;\n                int64_t m_25909 = sub64(j_m_i_25907, (int64_t) 1);\n                int64_t i_p_m_t_s_25910 = add64(i_25906, m_25909);\n                bool zzero_leq_i_p_m_t_s_25911 = sle64((int64_t) 0,\n                                                       i_p_m_t_s_25910);\n                bool i_p_m_t_s_leq_w_25912 = slt64(i_p_m_t_s_25910, k_25882);\n                bool zzero_lte_i_25913 = sle64((int64_t) 0, i_25906);\n                bool i_lte_j_25914 = sle64(i_25906, x_25896);\n                bool y_25915 = i_p_m_t_s_leq_w_25912 && zzero_lte_i_25913;\n                bool y_25916 = zzero_leq_i_p_m_t_s_25911 && y_25915;\n                bool y_25917 = i_lte_j_25914 && y_25916;\n                bool forwards_ok_25918 = zzero_lte_i_25913 && y_25917;\n                bool ok_or_empty_25919 = empty_slice_25908 || forwards_ok_25918;\n                bool index_certs_25920;\n                \n                if (!ok_or_empty_25919) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 55) ==\n                            -1) {\n                            global_failure_args[0] = i_25906;\n                            global_failure_args[1] = x_25896;\n                            global_failure_args[2] = k_25882;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                \n                bool x_25922 = sle64((int64_t) 0, prevx2_25898);\n                bool y_25923 = slt64(prevx2_25898, m_25881);\n                bool bounds_check_25924 = x_25922 && y_25923;\n                bool index_certs_25925;\n                \n                if (!bounds_check_25924) {\n                    {",
            "\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 56) ==\n                            -1) {\n                            global_failure_args[0] = prevx2_25898;\n                            global_failure_args[1] = m_25881;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                \n                int64_t i_25926 = ((__global\n                                    int64_t *) leftOffsets_mem_28233)[prevx2_25898];\n                int64_t j_m_i_25927 = sub64(x_25894, i_25926);\n                bool empty_slice_25928 = j_m_i_25927 == (int64_t) 0;\n                int64_t m_25929 = sub64(j_m_i_25927, (int64_t) 1);\n                int64_t i_p_m_t_s_25930 = add64(i_25926, m_25929);\n                bool zzero_leq_i_p_m_t_s_25931 = sle64((int64_t) 0,\n                                                       i_p_m_t_s_25930);\n                bool i_p_m_t_s_leq_w_25932 = slt64(i_p_m_t_s_25930, n_25880);\n                bool zzero_lte_i_25933 = sle64((int64_t) 0, i_25926);\n                bool i_lte_j_25934 = sle64(i_25926, x_25894);\n                bool y_25935 = i_p_m_t_s_leq_w_25932 && zzero_lte_i_25933;\n                bool y_25936 = zzero_leq_i_p_m_t_s_25931 && y_25935;\n                bool y_25937 = i_lte_j_25934 && y_25936;\n                bool forwards_ok_25938 = zzero_lte_i_25933 && y_25937;\n                bool ok_or_empty_25939 = empty_slice_25928 || forwards_ok_25938;\n                bool index_certs_25940;\n                \n                if (!ok_or_empty_25939) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 57) ==\n                            -1) {\n                            global_failure_args[0] = i_25926;\n                            global_failure_args[1] = x_25894;\n                            global_failure_args[2] = n_25880;\n                            ;\n      ",
            "                  }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                \n                int64_t conc_tmp_25943 = j_m_i_25907 + j_m_i_25927;\n                int64_t intersectSizze_res_25942;\n                \n                if (empty_slice_25928) {\n                    intersectSizze_res_25942 = (int64_t) 0;\n                } else {\n                    int64_t j_m_i_25944 = sub64(conc_tmp_25943, (int64_t) 1);\n                    int64_t intersectSizze_res_f_res_25945;\n                    \n                    if (empty_slice_25908) {\n                        intersectSizze_res_f_res_25945 = (int64_t) 0;\n                    } else {\n                        int64_t tmp_offs_29212 = (int64_t) 0;\n                        \n                        for (int64_t i_29213 = 0; i_29213 < j_m_i_25927;\n                             i_29213++) {\n                            ((__global int64_t *) mem_28239)[phys_tid_27683 +\n                                                             (tmp_offs_29212 +\n                                                              i_29213) *\n                                                             num_threads_28870] =\n                                ((__global\n                                  int64_t *) leftColumns_mem_28232)[i_25926 +\n                                                                    i_29213];\n                        }\n                        tmp_offs_29212 += j_m_i_25927;\n                        for (int64_t i_29214 = 0; i_29214 < j_m_i_25907;\n                             i_29214++) {\n                            ((__global int64_t *) mem_28239)[phys_tid_27683 +\n                                                             (tmp_offs_29212 +\n                                                              i_29214) *\n                                                             num_threads_28870] =\n                                ((__global\n           ",
            "                       int64_t *) rightColumns_mem_28235)[i_25906 +\n                                                                     i_29214];\n                        }\n                        tmp_offs_29212 += j_m_i_25907;\n                        \n                        bool cond_25947 = conc_tmp_25943 == (int64_t) 0;\n                        int32_t iters_25948;\n                        \n                        if (cond_25947) {\n                            iters_25948 = 0;\n                        } else {\n                            iters_25948 = 32;\n                        }\n                        \n                        bool loop_nonempty_25949 = slt32(0, iters_25948);\n                        bool x_25950 = sle64((int64_t) 0, j_m_i_25944);\n                        bool y_25951 = slt64(j_m_i_25944, conc_tmp_25943);\n                        bool bounds_check_25952 = x_25950 && y_25951;\n                        bool loop_not_taken_25953 = !loop_nonempty_25949;\n                        bool protect_assert_disj_25954 = bounds_check_25952 ||\n                             loop_not_taken_25953;\n                        bool index_certs_25955;\n                        \n                        if (!protect_assert_disj_25954) {\n                            {\n                                if (atomic_cmpxchg_i32_global(global_failure,\n                                                              -1, 58) == -1) {\n                                    global_failure_args[0] = j_m_i_25944;\n                                    global_failure_args[1] = conc_tmp_25943;\n                                    ;\n                                }\n                                local_failure = true;\n                                goto error_0;\n                            }\n                        }\n                        for (int64_t i_29215 = 0; i_29215 < conc_tmp_25943;\n                             i_29215++) {\n                            ((__global\n                              int64_t ",
            "*) double_buffer_mem_28763)[phys_tid_27683 +\n                                                                  i_29215 *\n                                                                  num_threads_28870] =\n                                ((__global\n                                  int64_t *) mem_28239)[phys_tid_27683 +\n                                                        i_29215 *\n                                                        num_threads_28870];\n                        }\n                        for (int32_t i_25957 = 0; i_25957 < iters_25948;\n                             i_25957++) {\n                            int32_t defunc_2_radix_sort_step_arg_25959 =\n                                    mul32(2, i_25957);\n                            int32_t defunc_0_get_bit_arg_25960 = add32(1,\n                                                                       defunc_2_radix_sort_step_arg_25959);\n                            int64_t i32_res_25961 =\n                                    sext_i32_i64(defunc_0_get_bit_arg_25960);\n                            int64_t i32_res_25962 =\n                                    sext_i32_i64(defunc_2_radix_sort_step_arg_25959);\n                            int64_t discard_28161;\n                            int64_t discard_28162;\n                            int64_t discard_28163;\n                            int64_t discard_28164;\n                            int64_t scanacc_28146;\n                            int64_t scanacc_28147;\n                            int64_t scanacc_28148;\n                            int64_t scanacc_28149;\n                            \n                            scanacc_28146 = (int64_t) 0;\n                            scanacc_28147 = (int64_t) 0;\n                            scanacc_28148 = (int64_t) 0;\n                            scanacc_28149 = (int64_t) 0;\n                            for (int64_t i_28155 = 0; i_28155 < conc_tmp_25943;\n                                 i_28155++) {\n                        ",
            "        int64_t x_25990 = ((__global\n                                                    int64_t *) double_buffer_mem_28763)[phys_tid_27683 +\n                                                                                        i_28155 *\n                                                                                        num_threads_28870];\n                                int64_t zgzg_res_25991 = ashr64(x_25990,\n                                                                i32_res_25961);\n                                int64_t za_res_25992 = (int64_t) 1 &\n                                        zgzg_res_25991;\n                                int32_t to_i32_res_25993 =\n                                        sext_i64_i32(za_res_25992);\n                                int32_t x_25994 = mul32(2, to_i32_res_25993);\n                                int64_t zgzg_res_25995 = ashr64(x_25990,\n                                                                i32_res_25962);\n                                int64_t za_res_25996 = (int64_t) 1 &\n                                        zgzg_res_25995;\n                                int32_t to_i32_res_25997 =\n                                        sext_i64_i32(za_res_25996);\n                                int32_t defunc_0_f_res_25998 = add32(x_25994,\n                                                                     to_i32_res_25997);\n                                bool cond_25999 = defunc_0_f_res_25998 == 0;\n                                int64_t defunc_0_f_res_26000 =\n                                        btoi_bool_i64(cond_25999);\n                                int64_t defunc_0_f_res_26001;\n                                int64_t defunc_0_f_res_26002;\n                                int64_t defunc_0_f_res_26003;\n                                \n                                if (cond_25999) {\n                                    defunc_0_f_res_26001 = (int64_t) 0;\n                                    defunc_0_f_res",
            "_26002 = (int64_t) 0;\n                                    defunc_0_f_res_26003 = (int64_t) 0;\n                                } else {\n                                    bool cond_26004 = defunc_0_f_res_25998 == 1;\n                                    int64_t defunc_0_f_res_f_res_26005 =\n                                            btoi_bool_i64(cond_26004);\n                                    int64_t defunc_0_f_res_f_res_26006;\n                                    int64_t defunc_0_f_res_f_res_26007;\n                                    \n                                    if (cond_26004) {\n                                        defunc_0_f_res_f_res_26006 =\n                                            (int64_t) 0;\n                                        defunc_0_f_res_f_res_26007 =\n                                            (int64_t) 0;\n                                    } else {\n                                        bool cond_26008 =\n                                             defunc_0_f_res_25998 == 2;\n                                        int64_t defunc_0_f_res_f_res_f_res_26009\n                                                = btoi_bool_i64(cond_26008);\n                                        bool cond_neg_26010 = !cond_26008;\n                                        int64_t defunc_0_f_res_f_res_f_res_26011\n                                                = btoi_bool_i64(cond_neg_26010);\n                                        \n                                        defunc_0_f_res_f_res_26006 =\n                                            defunc_0_f_res_f_res_f_res_26009;\n                                        defunc_0_f_res_f_res_26007 =\n                                            defunc_0_f_res_f_res_f_res_26011;\n                                    }\n                                    defunc_0_f_res_26001 =\n                                        defunc_0_f_res_f_res_26005;\n                                    defunc_0_f_res_26002 =\n                        ",
            "                defunc_0_f_res_f_res_26006;\n                                    defunc_0_f_res_26003 =\n                                        defunc_0_f_res_f_res_26007;\n                                }\n                                \n                                int64_t defunc_1_op_res_25986 =\n                                        add64(defunc_0_f_res_26000,\n                                              scanacc_28146);\n                                int64_t defunc_1_op_res_25987 =\n                                        add64(defunc_0_f_res_26001,\n                                              scanacc_28147);\n                                int64_t defunc_1_op_res_25988 =\n                                        add64(defunc_0_f_res_26002,\n                                              scanacc_28148);\n                                int64_t defunc_1_op_res_25989 =\n                                        add64(defunc_0_f_res_26003,\n                                              scanacc_28149);\n                                \n                                ((__global\n                                  int64_t *) mem_28248)[phys_tid_27683 +\n                                                        i_28155 *\n                                                        num_threads_28870] =\n                                    defunc_1_op_res_25986;\n                                ((__global\n                                  int64_t *) mem_28250)[phys_tid_27683 +\n                                                        i_28155 *\n                                                        num_threads_28870] =\n                                    defunc_1_op_res_25987;\n                                ((__global\n                                  int64_t *) mem_28252)[phys_tid_27683 +\n                                                        i_28155 *\n                                                        num_threads_28870] =\n                                    defunc_1_op_res_25988;",
            "\n                                ((__global\n                                  int64_t *) mem_28254)[phys_tid_27683 +\n                                                        i_28155 *\n                                                        num_threads_28870] =\n                                    defunc_1_op_res_25989;\n                                ((__global\n                                  int32_t *) mem_28256)[phys_tid_27683 +\n                                                        i_28155 *\n                                                        num_threads_28870] =\n                                    defunc_0_f_res_25998;\n                                \n                                int64_t scanacc_tmp_29217 =\n                                        defunc_1_op_res_25986;\n                                int64_t scanacc_tmp_29218 =\n                                        defunc_1_op_res_25987;\n                                int64_t scanacc_tmp_29219 =\n                                        defunc_1_op_res_25988;\n                                int64_t scanacc_tmp_29220 =\n                                        defunc_1_op_res_25989;\n                                \n                                scanacc_28146 = scanacc_tmp_29217;\n                                scanacc_28147 = scanacc_tmp_29218;\n                                scanacc_28148 = scanacc_tmp_29219;\n                                scanacc_28149 = scanacc_tmp_29220;\n                            }\n                            discard_28161 = scanacc_28146;\n                            discard_28162 = scanacc_28147;\n                            discard_28163 = scanacc_28148;\n                            discard_28164 = scanacc_28149;\n                            \n                            int64_t last_res_26017 = ((__global\n                                                       int64_t *) mem_28248)[phys_tid_27683 +\n                                                                             j_m_i_25",
            "944 *\n                                                                             num_threads_28870];\n                            int64_t last_res_26018 = ((__global\n                                                       int64_t *) mem_28250)[phys_tid_27683 +\n                                                                             j_m_i_25944 *\n                                                                             num_threads_28870];\n                            int64_t last_res_26019 = ((__global\n                                                       int64_t *) mem_28252)[phys_tid_27683 +\n                                                                             j_m_i_25944 *\n                                                                             num_threads_28870];\n                            \n                            for (int64_t i_29226 = 0; i_29226 < conc_tmp_25943;\n                                 i_29226++) {\n                                ((__global\n                                  int64_t *) mem_28318)[phys_tid_27683 +\n                                                        i_29226 *\n                                                        num_threads_28870] =\n                                    ((__global\n                                      int64_t *) double_buffer_mem_28763)[phys_tid_27683 +\n                                                                          i_29226 *\n                                                                          num_threads_28870];\n                            }\n                            for (int64_t write_iter_28165 = 0;\n                                 write_iter_28165 < conc_tmp_25943;\n                                 write_iter_28165++) {\n                                int32_t write_iv_28167 = ((__global\n                                                           int32_t *) mem_28256)[phys_tid_27683 +\n                                                                                 write_iter_2",
            "8165 *\n                                                                                 num_threads_28870];\n                                bool match_lit_26028 = 0 == write_iv_28167;\n                                int64_t defunc_1_f_res_26029;\n                                \n                                if (match_lit_26028) {\n                                    int64_t write_iv_28168 = ((__global\n                                                               int64_t *) mem_28248)[phys_tid_27683 +\n                                                                                     write_iter_28165 *\n                                                                                     num_threads_28870];\n                                    int64_t case_res_26030 =\n                                            sub64(write_iv_28168, (int64_t) 1);\n                                    \n                                    defunc_1_f_res_26029 = case_res_26030;\n                                } else {\n                                    int64_t write_iv_28169 = ((__global\n                                                               int64_t *) mem_28250)[phys_tid_27683 +\n                                                                                     write_iter_28165 *\n                                                                                     num_threads_28870];\n                                    int64_t write_iv_28170 = ((__global\n                                                               int64_t *) mem_28252)[phys_tid_27683 +\n                                                                                     write_iter_28165 *\n                                                                                     num_threads_28870];\n                                    int64_t write_iv_28171 = ((__global\n                                                               int64_t *) mem_28254)[phys_tid_27683 +\n                                                 ",
            "                                    write_iter_28165 *\n                                                                                     num_threads_28870];\n                                    bool match_lit_26031 = 1 == write_iv_28167;\n                                    int64_t x_26032;\n                                    \n                                    if (match_lit_26031) {\n                                        int64_t x_26033 = add64(last_res_26017,\n                                                                write_iv_28169);\n                                        int64_t case_res_26034 = sub64(x_26033,\n                                                                       (int64_t) 1);\n                                        \n                                        x_26032 = case_res_26034;\n                                    } else {\n                                        bool match_lit_26035 = 2 ==\n                                             write_iv_28167;\n                                        int64_t x_26036;\n                                        \n                                        if (match_lit_26035) {\n                                            int64_t x_26037 =\n                                                    add64(last_res_26017,\n                                                          last_res_26018);\n                                            int64_t x_26038 = add64(x_26037,\n                                                                    write_iv_28170);\n                                            int64_t case_res_26039 =\n                                                    sub64(x_26038, (int64_t) 1);\n                                            \n                                            x_26036 = case_res_26039;\n                                        } else {\n                                            int64_t x_26040 =\n                                                    add64(last_res_26017,\n                    ",
            "                                      last_res_26018);\n                                            int64_t x_26041 =\n                                                    add64(last_res_26019,\n                                                          x_26040);\n                                            int64_t x_26042 = add64(x_26041,\n                                                                    write_iv_28171);\n                                            int64_t defunc_1_f_res_res_26043 =\n                                                    sub64(x_26042, (int64_t) 1);\n                                            \n                                            x_26036 = defunc_1_f_res_res_26043;\n                                        }\n                                        x_26032 = x_26036;\n                                    }\n                                    defunc_1_f_res_26029 = x_26032;\n                                }\n                                \n                                bool less_than_zzero_28173 =\n                                     slt64(defunc_1_f_res_26029, (int64_t) 0);\n                                bool greater_than_sizze_28174 =\n                                     sle64(conc_tmp_25943,\n                                           defunc_1_f_res_26029);\n                                bool outside_bounds_dim_28175 =\n                                     less_than_zzero_28173 ||\n                                     greater_than_sizze_28174;\n                                \n                                if (!outside_bounds_dim_28175) {\n                                    for (int64_t i_29228 = 0; i_29228 <\n                                         (int64_t) 1; i_29228++) {\n                                        ((__global\n                                          int64_t *) mem_28318)[phys_tid_27683 +\n                                                                (defunc_1_f_res_26029 +\n                                             ",
            "                    i_29228) *\n                                                                num_threads_28870] =\n                                            ((__global\n                                              int64_t *) double_buffer_mem_28763)[phys_tid_27683 +\n                                                                                  num_threads_28870 *\n                                                                                  write_iter_28165 +\n                                                                                  i_29228 *\n                                                                                  num_threads_28870];\n                                    }\n                                }\n                            }\n                            for (int64_t i_29229 = 0; i_29229 < conc_tmp_25943;\n                                 i_29229++) {\n                                ((__global\n                                  int64_t *) double_buffer_mem_28763)[phys_tid_27683 +\n                                                                      i_29229 *\n                                                                      num_threads_28870] =\n                                    ((__global\n                                      int64_t *) mem_28318)[phys_tid_27683 +\n                                                            i_29229 *\n                                                            num_threads_28870];\n                            }\n                        }\n                        \n                        bool empty_slice_26044 = j_m_i_25944 == (int64_t) 0;\n                        bool i_lte_j_26045 = sle64((int64_t) 1, conc_tmp_25943);\n                        bool y_26046 = bounds_check_25952 && i_lte_j_26045;\n                        bool ok_or_empty_26047 = empty_slice_26044 || y_26046;\n                        bool index_certs_26048;\n                        \n                        if (!ok_or_empty_26047) {\n             ",
            "               {\n                                if (atomic_cmpxchg_i32_global(global_failure,\n                                                              -1, 59) == -1) {\n                                    global_failure_args[0] = (int64_t) 1;\n                                    global_failure_args[1] = conc_tmp_25943;\n                                    ;\n                                }\n                                local_failure = true;\n                                goto error_0;\n                            }\n                        }\n                        \n                        int64_t defunc_2_reduce_res_26051;\n                        int64_t redout_28179 = (int64_t) 0;\n                        \n                        for (int64_t i_28181 = 0; i_28181 < j_m_i_25944;\n                             i_28181++) {\n                            int64_t slice_28226 = (int64_t) 1 + i_28181;\n                            int64_t x_26066 = ((__global\n                                                int64_t *) double_buffer_mem_28763)[phys_tid_27683 +\n                                                                                    slice_28226 *\n                                                                                    num_threads_28870];\n                            bool y_26059 = slt64(i_28181, conc_tmp_25943);\n                            bool index_certs_26061;\n                            \n                            if (!y_26059) {\n                                {\n                                    if (atomic_cmpxchg_i32_global(global_failure,\n                                                                  -1, 60) ==\n                                        -1) {\n                                        global_failure_args[0] = i_28181;\n                                        global_failure_args[1] = conc_tmp_25943;\n                                        ;\n                                    }\n                                    local_failure = true",
            ";\n                                    goto error_0;\n                                }\n                            }\n                            \n                            int64_t y_26062 = ((__global\n                                                int64_t *) double_buffer_mem_28763)[phys_tid_27683 +\n                                                                                    i_28181 *\n                                                                                    num_threads_28870];\n                            bool cond_26063 = x_26066 == y_26062;\n                            int64_t defunc_1_op_res_26064;\n                            \n                            if (cond_26063) {\n                                int64_t defunc_1_op_res_t_res_26065 =\n                                        add64((int64_t) 1, redout_28179);\n                                \n                                defunc_1_op_res_26064 =\n                                    defunc_1_op_res_t_res_26065;\n                            } else {\n                                defunc_1_op_res_26064 = redout_28179;\n                            }\n                            \n                            int64_t redout_tmp_29230 = defunc_1_op_res_26064;\n                            \n                            redout_28179 = redout_tmp_29230;\n                        }\n                        defunc_2_reduce_res_26051 = redout_28179;\n                        intersectSizze_res_f_res_25945 =\n                            defunc_2_reduce_res_26051;\n                    }\n                    intersectSizze_res_25942 = intersectSizze_res_f_res_25945;\n                }\n                private_mem_29209[i_29211] = intersectSizze_res_25942;\n            } else {\n                private_mem_29209[i_29211] = (int64_t) 0;\n            }\n        }\n    }\n    // Transpose scan inputs\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29231 = 0; i_29231 < (int64_t) 9; i_29231++) {\n            int64_t s",
            "haredIdx_29232 = sext_i32_i64(local_tid_29191) + i_29231 *\n                    segscan_group_sizze_27678;\n            \n            ((__local int64_t *) local_mem_29199)[sharedIdx_29232] =\n                private_mem_29209[i_29231];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_29233 = 0; i_29233 < 9; i_29233++) {\n            int32_t sharedIdx_29234 = local_tid_29191 * 9 + i_29233;\n            \n            private_mem_29209[sext_i32_i64(i_29233)] = ((__local\n                                                         int64_t *) local_mem_29199)[sext_i32_i64(sharedIdx_29234)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Per thread scan\n    {\n        for (int64_t i_29235 = 0; i_29235 < (int64_t) 8; i_29235++) {\n            int64_t x_25891;\n            int64_t x_25892;\n            \n            x_25891 = private_mem_29209[i_29235];\n            x_25892 = private_mem_29209[i_29235 + (int64_t) 1];\n            \n            int64_t defunc_1_op_res_25893;\n            \n            defunc_1_op_res_25893 = add64(x_25891, x_25892);\n            private_mem_29209[i_29235 + (int64_t) 1] = defunc_1_op_res_25893;\n        }\n    }\n    // Publish results in shared memory\n    {\n        ((__local int64_t *) local_mem_29199)[squot64(byte_offsets_29195,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_29191)] =\n            private_mem_29209[(int64_t) 8];\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t acc_29239;\n    \n    // Scan results (with warp scan)\n    {\n        int64_t x_29236;\n        int64_t x_29237;\n        int64_t x_29240;\n        int64_t x_29241;\n        bool ltid_in_bounds_29243;\n        \n        ltid_in_bounds_29243 = slt64(sext_i32_i64(local_tid_29191),\n                                     segscan_group_sizze_27678);\n        \n        int32_t skip_threads_29244;\n        \n        // read input for in-block scan\n        {\n            if (ltid_",
            "in_bounds_29243) {\n                x_29237 = ((volatile __local\n                            int64_t *) local_mem_29199)[squot64(byte_offsets_29195,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_29191)];\n                if ((local_tid_29191 - squot32(local_tid_29191, 32) * 32) ==\n                    0) {\n                    x_29236 = x_29237;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_29244 = 1;\n            while (slt32(skip_threads_29244, 32)) {\n                if (sle32(skip_threads_29244, local_tid_29191 -\n                          squot32(local_tid_29191, 32) * 32) &&\n                    ltid_in_bounds_29243) {\n                    // read operands\n                    {\n                        x_29236 = ((volatile __local\n                                    int64_t *) local_mem_29199)[squot64(byte_offsets_29195,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_29191) -\n                                                                 sext_i32_i64(skip_threads_29244))];\n                    }\n                    // perform operation\n                    {\n                        int64_t defunc_1_op_res_29238 = add64(x_29236, x_29237);\n                        \n                        x_29236 = defunc_1_op_res_29238;\n                    }\n                }\n                if (sle32(wave_sizze_29193, skip_threads_29244)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_29244, local_tid_29191 -\n                          squot32(local_tid_29191, 32) * 32) &&\n                    ltid_in_bounds_29243) {\n                    // write result\n                    {\n                        ((volatile",
            " __local\n                          int64_t *) local_mem_29199)[squot64(byte_offsets_29195,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_29191)] =\n                            x_29236;\n                        x_29237 = x_29236;\n                    }\n                }\n                if (sle32(wave_sizze_29193, skip_threads_29244)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_29244 *= 2;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // last thread of block 'i' writes its result to offset 'i'\n        {\n            if ((local_tid_29191 - squot32(local_tid_29191, 32) * 32) == 31 &&\n                ltid_in_bounds_29243) {\n                ((volatile __local\n                  int64_t *) local_mem_29199)[squot64(byte_offsets_29195,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_29191,\n                                                                   32))] =\n                    x_29236;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n        {\n            int32_t skip_threads_29245;\n            \n            // read input for in-block scan\n            {\n                if (squot32(local_tid_29191, 32) == 0 && ltid_in_bounds_29243) {\n                    x_29241 = ((volatile __local\n                                int64_t *) local_mem_29199)[squot64(byte_offsets_29195,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_29191)];\n                    if ((local_tid_29191 - squot32(local_tid_29191, 32) * 32) ==\n                        0) {\n                        x_29240 = x_29241;\n     ",
            "               }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_29245 = 1;\n                while (slt32(skip_threads_29245, 32)) {\n                    if (sle32(skip_threads_29245, local_tid_29191 -\n                              squot32(local_tid_29191, 32) * 32) &&\n                        (squot32(local_tid_29191, 32) == 0 &&\n                         ltid_in_bounds_29243)) {\n                        // read operands\n                        {\n                            x_29240 = ((volatile __local\n                                        int64_t *) local_mem_29199)[squot64(byte_offsets_29195,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_29191) -\n                                                                     sext_i32_i64(skip_threads_29245))];\n                        }\n                        // perform operation\n                        {\n                            int64_t defunc_1_op_res_29242 = add64(x_29240,\n                                                                  x_29241);\n                            \n                            x_29240 = defunc_1_op_res_29242;\n                        }\n                    }\n                    if (sle32(wave_sizze_29193, skip_threads_29245)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_29245, local_tid_29191 -\n                              squot32(local_tid_29191, 32) * 32) &&\n                        (squot32(local_tid_29191, 32) == 0 &&\n                         ltid_in_bounds_29243)) {\n                        // write result\n                        {\n                            ((volatile __local\n                              int64_t *) local_mem_29199)[squot64(byte_offsets_29195,\n                                    ",
            "                              (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_29191)] =\n                                x_29240;\n                            x_29241 = x_29240;\n                        }\n                    }\n                    if (sle32(wave_sizze_29193, skip_threads_29245)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_29245 *= 2;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // carry-in for every block except the first\n        {\n            if (!(squot32(local_tid_29191, 32) == 0 || !ltid_in_bounds_29243)) {\n                // read operands\n                {\n                    x_29237 = x_29236;\n                    x_29236 = ((__local\n                                int64_t *) local_mem_29199)[squot64(byte_offsets_29195,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_29191,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                }\n                // perform operation\n                {\n                    int64_t defunc_1_op_res_29238 = add64(x_29236, x_29237);\n                    \n                    x_29236 = defunc_1_op_res_29238;\n                }\n                // write final result\n                {\n                    ((__local\n                      int64_t *) local_mem_29199)[squot64(byte_offsets_29195,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_29191)] =\n                        x_29236;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // restore correct values for first block\n        {\n            ",
            "if (squot32(local_tid_29191, 32) == 0) {\n                ((__local\n                  int64_t *) local_mem_29199)[squot64(byte_offsets_29195,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_29191)] =\n                    x_29237;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_tid_29191 == 0) {\n            acc_29239 = ((__local\n                          int64_t *) local_mem_29199)[squot64(byte_offsets_29195,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_27678 -\n                                                       (int64_t) 1)];\n        } else {\n            acc_29239 = ((__local\n                          int64_t *) local_mem_29199)[squot64(byte_offsets_29195,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_29191) -\n                                                       (int64_t) 1)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t prefix_29246;\n    \n    prefix_29246 = (int64_t) 0;\n    // Perform lookback\n    {\n        if (dynamic_id_29207 == (int64_t) 0 && local_tid_29191 == 0) {\n            ((volatile __global\n              int64_t *) incprefixes_mem_29179)[dynamic_id_29207] = acc_29239;\n            mem_fence_global();\n            ((volatile __global\n              int8_t *) status_flags_mem_29175)[dynamic_id_29207] = (int8_t) 2;\n            acc_29239 = (int64_t) 0;\n        }\n        if (!(dynamic_id_29207 == (int64_t) 0) && slt32(local_tid_29191,\n                                                        wave_sizze_29193)) {\n            if (local_tid_29191 == 0) {\n                ((volatile __global\n                  int64_t *) aggregates_mem_29177)[dynamic_id_29207] =\n           ",
            "         acc_29239;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_29175)[dynamic_id_29207] =\n                    (int8_t) 1;\n                ((__local int8_t *) local_mem_29199)[(int64_t) 0] = ((__global\n                                                                      int8_t *) status_flags_mem_29175)[dynamic_id_29207 -\n                                                                                                        (int64_t) 1];\n            }\n            mem_fence_local();\n            \n            int8_t status_29247;\n            \n            status_29247 = ((__local int8_t *) local_mem_29199)[(int64_t) 0];\n            if (status_29247 == (int8_t) 2) {\n                if (local_tid_29191 == 0) {\n                    prefix_29246 = ((volatile __global\n                                     int64_t *) incprefixes_mem_29179)[dynamic_id_29207 -\n                                                                       (int64_t) 1];\n                }\n            } else {\n                int32_t readOffset_29248 = dynamic_id_29207 -\n                        sext_i32_i64(wave_sizze_29193);\n                \n                while (slt32(wave_sizze_29193 * -1, readOffset_29248)) {\n                    int32_t read_i_29249 = readOffset_29248 + local_tid_29191;\n                    int64_t aggr_29250 = (int64_t) 0;\n                    int8_t flag_29251 = (int8_t) 0;\n                    int8_t used_29252 = (int8_t) 0;\n                    \n                    if (sle32(0, read_i_29249)) {\n                        flag_29251 = ((volatile __global\n                                       int8_t *) status_flags_mem_29175)[sext_i32_i64(read_i_29249)];\n                        if (flag_29251 == (int8_t) 2) {\n                            aggr_29250 = ((volatile __global\n                                           int64_t *) incprefixes_mem_29179)[sext_i32_i64(read_i_29249)];\n                        } else {\n            ",
            "                if (flag_29251 == (int8_t) 1) {\n                                aggr_29250 = ((volatile __global\n                                               int64_t *) aggregates_mem_29177)[sext_i32_i64(read_i_29249)];\n                                used_29252 = (int8_t) 1;\n                            }\n                        }\n                    }\n                    ((__local\n                      int64_t *) local_mem_29199)[squot64(warp_byte_offset_29197,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_29191)] =\n                        aggr_29250;\n                    \n                    int8_t tmp_29253;\n                    \n                    tmp_29253 = flag_29251 | used_29252 << (int8_t) 2;\n                    ((__local\n                      int8_t *) local_mem_29199)[sext_i32_i64(local_tid_29191)] =\n                        tmp_29253;\n                    mem_fence_local();\n                    flag_29251 = ((volatile __local\n                                   int8_t *) local_mem_29199)[sext_i32_i64(wave_sizze_29193) -\n                                                              (int64_t) 1];\n                    if (local_tid_29191 == 0) {\n                        if (!(flag_29251 == (int8_t) 2)) {\n                            int64_t x_29254 = (int64_t) 0;\n                            int64_t x_29255;\n                            int8_t flag1_29257;\n                            \n                            flag1_29257 = (int8_t) 0;\n                            \n                            int8_t flag2_29258;\n                            int8_t used1_29259;\n                            \n                            used1_29259 = (int8_t) 0;\n                            \n                            int8_t used2_29260;\n                            \n                            for (int32_t i_29261 = 0; i_29261 <\n                                 wave_sizze_29193; i_29261+",
            "+) {\n                                flag2_29258 = ((__local\n                                                int8_t *) local_mem_29199)[sext_i32_i64(i_29261)];\n                                used2_29260 = lshr8(flag2_29258, (int8_t) 2);\n                                flag2_29258 = flag2_29258 & (int8_t) 3;\n                                x_29255 = ((__local\n                                            int64_t *) local_mem_29199)[squot64(warp_byte_offset_29197,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_29261)];\n                                if (!(flag2_29258 == (int8_t) 1)) {\n                                    flag1_29257 = flag2_29258;\n                                    used1_29259 = used2_29260;\n                                    x_29254 = x_29255;\n                                } else {\n                                    used1_29259 += used2_29260;\n                                    \n                                    int64_t defunc_1_op_res_29256;\n                                    \n                                    defunc_1_op_res_29256 = add64(x_29254,\n                                                                  x_29255);\n                                    x_29254 = defunc_1_op_res_29256;\n                                }\n                            }\n                            flag_29251 = flag1_29257;\n                            used_29252 = used1_29259;\n                            aggr_29250 = x_29254;\n                        } else {\n                            aggr_29250 = ((__local\n                                           int64_t *) local_mem_29199)[squot64(warp_byte_offset_29197,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_29193) -\n                    ",
            "                                                    (int64_t) 1)];\n                        }\n                        if (flag_29251 == (int8_t) 2) {\n                            readOffset_29248 = wave_sizze_29193 * -1;\n                        } else {\n                            readOffset_29248 -= zext_i8_i32(used_29252);\n                        }\n                        ((__local int32_t *) local_mem_29199)[(int64_t) 0] =\n                            readOffset_29248;\n                        \n                        int64_t x_29262;\n                        \n                        x_29262 = aggr_29250;\n                        \n                        int64_t x_29263;\n                        \n                        x_29263 = prefix_29246;\n                        \n                        int64_t defunc_1_op_res_29264;\n                        \n                        defunc_1_op_res_29264 = add64(x_29262, x_29263);\n                        prefix_29246 = defunc_1_op_res_29264;\n                    }\n                    mem_fence_local();\n                    readOffset_29248 = ((__local\n                                         int32_t *) local_mem_29199)[(int64_t) 0];\n                }\n            }\n            if (local_tid_29191 == 0) {\n                int64_t x_29265 = prefix_29246;\n                int64_t x_29266 = acc_29239;\n                int64_t defunc_1_op_res_29267 = add64(x_29265, x_29266);\n                \n                ((volatile __global\n                  int64_t *) incprefixes_mem_29179)[dynamic_id_29207] =\n                    defunc_1_op_res_29267;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_29175)[dynamic_id_29207] =\n                    (int8_t) 2;\n                ((__local\n                  int64_t *) local_mem_29199)[squot64(warp_byte_offset_29197,\n                                                      (int64_t) 8)] =\n                    prefix_29246;\n                acc_29239 =",
            " (int64_t) 0;\n            }\n        }\n        if (!(dynamic_id_29207 == (int64_t) 0)) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            prefix_29246 = ((__local\n                             int64_t *) local_mem_29199)[squot64(warp_byte_offset_29197,\n                                                                 (int64_t) 8)];\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    // Distribute results\n    {\n        int64_t x_29268;\n        int64_t x_29269;\n        int64_t x_29271;\n        \n        x_29271 = prefix_29246;\n        \n        int64_t x_29272;\n        \n        x_29272 = acc_29239;\n        \n        int64_t defunc_1_op_res_29273;\n        \n        defunc_1_op_res_29273 = add64(x_29271, x_29272);\n        x_29268 = defunc_1_op_res_29273;\n        for (int64_t i_29274 = 0; i_29274 < (int64_t) 9; i_29274++) {\n            x_29269 = private_mem_29209[i_29274];\n            \n            int64_t defunc_1_op_res_29270;\n            \n            defunc_1_op_res_29270 = add64(x_29268, x_29269);\n            private_mem_29209[i_29274] = defunc_1_op_res_29270;\n        }\n    }\n    // Transpose scan output\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29275 = 0; i_29275 < (int64_t) 9; i_29275++) {\n            int64_t sharedIdx_29276 = sext_i32_i64(local_tid_29191 * 9) +\n                    i_29275;\n            \n            ((__local int64_t *) local_mem_29199)[sharedIdx_29276] =\n                private_mem_29209[i_29275];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29277 = 0; i_29277 < (int64_t) 9; i_29277++) {\n            int32_t sharedIdx_29278 = local_tid_29191 +\n                    sext_i64_i32(segscan_group_sizze_27678 * i_29277);\n            \n            private_mem_29209[i_29277] = ((__local\n                                           int64_t *) local_mem_29199)[sext_i32_i64(sharedIdx_29278)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Write block scan results to global memory\n    {\n        ",
            "for (int64_t i_29279 = 0; i_29279 < (int64_t) 9; i_29279++) {\n            int64_t gtid_27682 = blockOff_29208 + segscan_group_sizze_27678 *\n                    i_29279 + sext_i32_i64(local_tid_29191);\n            \n            if (slt64(gtid_27682, m_25881)) {\n                ((__global int64_t *) mem_28337)[gtid_27682] =\n                    private_mem_29209[i_29279];\n            }\n        }\n    }\n    // If this is the last block, reset the dynamicId\n    {\n        if (dynamic_id_29207 == sdiv_up64(m_25881, segscan_group_sizze_27678 *\n                                          (int64_t) 9) - (int64_t) 1) {\n            ((__global\n              int32_t *) eWiseMultEntryziid_counter_mem_29173)[(int64_t) 0] = 0;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_27678\n}\n__kernel void eWiseMultEntryzisegscan_27691(__global int *global_failure,\n                                            uint local_mem_29354_backing_offset_0,\n                                            int64_t conc_tmp_26126,\n                                            int64_t i32_res_26161,\n                                            int64_t i32_res_26162, __global\n                                            unsigned char *mem_param_28366,\n                                            __global unsigned char *mem_28378,\n                                            __global unsigned char *mem_28380,\n                                            __global unsigned char *mem_28382,\n                                            __global unsigned char *mem_28384,\n                                            __global unsigned char *mem_28386,\n                                            __global\n                                            unsigned char *eWiseMultEntryziid_counter_mem_29319,\n                                            __global\n                                            unsigned char *status_flags_mem_29321,\n                                            __global\n                       ",
            "                     unsigned char *aggregates_mem_29323,\n                                            __global\n                                            unsigned char *incprefixes_mem_29325,\n                                            __global\n                                            unsigned char *aggregates_mem_29327,\n                                            __global\n                                            unsigned char *incprefixes_mem_29329,\n                                            __global\n                                            unsigned char *aggregates_mem_29331,\n                                            __global\n                                            unsigned char *incprefixes_mem_29333,\n                                            __global\n                                            unsigned char *aggregates_mem_29335,\n                                            __global\n                                            unsigned char *incprefixes_mem_29337)\n{\n    #define segscan_group_sizze_27686 (eWiseMultEntryzisegscan_group_sizze_27685)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *local_mem_29354_backing_0 =\n                  &shared_mem[local_mem_29354_backing_offset_0];\n    \n    if (*global_failure >= 0)\n        return;\n    \n    int32_t global_tid_29339;\n    int32_t local_tid_29340;\n    int64_t group_sizze_29343;\n    int32_t wave_sizze_29342;\n    int32_t group_tid_29341;\n    \n    global_tid_29339 = get_global_id(0);\n    local_tid_29340 = get_local_id(0);\n    group_sizze_29343 = get_local_size(0);\n    wave_sizze_29342 = LOCKSTEP_WIDTH;\n    group_tid_29341 = get_group_id(0);\n    \n    int32_t phys_tid_27691;\n    \n    phys_tid_27691 = global_tid_29339;\n    \n    int64_t byte_offsets_29344;\n    \n    byte_offsets_29344 = (int64_t) 0;\n    \n    int64_t byte_offsets_29345;\n    \n    byte_offsets_29345 = segscan_group_sizze_27686 * (int64_t) 8;\n    \n    int64_t byte_offsets_293",
            "46;\n    \n    byte_offsets_29346 = sdiv_up64(segscan_group_sizze_27686 * (int64_t) 8,\n                                   (int64_t) 8) * (int64_t) 8 +\n        segscan_group_sizze_27686 * (int64_t) 8;\n    \n    int64_t byte_offsets_29347;\n    \n    byte_offsets_29347 = sdiv_up64(sdiv_up64(segscan_group_sizze_27686 *\n                                             (int64_t) 8, (int64_t) 8) *\n                                   (int64_t) 8 + segscan_group_sizze_27686 *\n                                   (int64_t) 8, (int64_t) 8) * (int64_t) 8 +\n        segscan_group_sizze_27686 * (int64_t) 8;\n    \n    int64_t byte_offsets_29348;\n    \n    byte_offsets_29348 =\n        sdiv_up64(sdiv_up64(sdiv_up64(segscan_group_sizze_27686 * (int64_t) 8,\n                                      (int64_t) 8) * (int64_t) 8 +\n                            segscan_group_sizze_27686 * (int64_t) 8,\n                            (int64_t) 8) * (int64_t) 8 +\n                  segscan_group_sizze_27686 * (int64_t) 8, (int64_t) 8) *\n        (int64_t) 8 + segscan_group_sizze_27686 * (int64_t) 8;\n    \n    int64_t warp_byte_offset_29349;\n    \n    warp_byte_offset_29349 = (int64_t) 32;\n    \n    int64_t warp_byte_offset_29350;\n    \n    warp_byte_offset_29350 = (int64_t) 288;\n    \n    int64_t warp_byte_offset_29351;\n    \n    warp_byte_offset_29351 = (int64_t) 544;\n    \n    int64_t warp_byte_offset_29352;\n    \n    warp_byte_offset_29352 = (int64_t) 800;\n    \n    int64_t warp_byte_offset_29353;\n    \n    warp_byte_offset_29353 = (int64_t) 1056;\n    // Allocate reused shared memeory\n    { }\n    \n    __local char *local_mem_29354;\n    \n    local_mem_29354 = (__local char *) local_mem_29354_backing_0;\n    \n    int64_t trans_arr_len_29355;\n    \n    trans_arr_len_29355 = (int64_t) 9 * segscan_group_sizze_27686;\n    \n    int32_t dynamic_id_29371;\n    \n    if (local_tid_29340 == 0) {\n        dynamic_id_29371 = atomic_add_i32_global(&((volatile __global\n                                                    int *) eWiseMultEntryzii",
            "d_counter_mem_29319)[(int64_t) 0],\n                                                 (int) 1);\n        ((__local int32_t *) local_mem_29354)[(int64_t) 0] = dynamic_id_29371;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    dynamic_id_29371 = ((__local int32_t *) local_mem_29354)[(int64_t) 0];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t blockOff_29372;\n    \n    blockOff_29372 = sext_i32_i64(dynamic_id_29371) * (int64_t) 9 *\n        segscan_group_sizze_27686;\n    \n    int64_t private_mem_29373[9];\n    int64_t private_mem_29375[9];\n    int64_t private_mem_29377[9];\n    int64_t private_mem_29379[9];\n    \n    // Load and map\n    {\n        for (int64_t i_29381 = 0; i_29381 < (int64_t) 9; i_29381++) {\n            int64_t gtid_27690 = blockOff_29372 +\n                    sext_i32_i64(local_tid_29340) + i_29381 *\n                    segscan_group_sizze_27686;\n            \n            if (slt64(gtid_27690, conc_tmp_26126)) {\n                int64_t x_26190 = ((__global\n                                    int64_t *) mem_param_28366)[gtid_27690];\n                int64_t zgzg_res_26191 = ashr64(x_26190, i32_res_26161);\n                int64_t za_res_26192 = (int64_t) 1 & zgzg_res_26191;\n                int32_t to_i32_res_26193 = sext_i64_i32(za_res_26192);\n                int32_t x_26194 = mul32(2, to_i32_res_26193);\n                int64_t zgzg_res_26195 = ashr64(x_26190, i32_res_26162);\n                int64_t za_res_26196 = (int64_t) 1 & zgzg_res_26195;\n                int32_t to_i32_res_26197 = sext_i64_i32(za_res_26196);\n                int32_t defunc_0_f_res_26198 = add32(x_26194, to_i32_res_26197);\n                bool cond_26199 = defunc_0_f_res_26198 == 0;\n                int64_t defunc_0_f_res_26200 = btoi_bool_i64(cond_26199);\n                int64_t defunc_0_f_res_26201;\n                int64_t defunc_0_f_res_26202;\n                int64_t defunc_0_f_res_26203;\n                \n                if (cond_26199) {\n                    defunc_0_f_res_26201 = (int64_t) 0;",
            "\n                    defunc_0_f_res_26202 = (int64_t) 0;\n                    defunc_0_f_res_26203 = (int64_t) 0;\n                } else {\n                    bool cond_26204 = defunc_0_f_res_26198 == 1;\n                    int64_t defunc_0_f_res_f_res_26205 =\n                            btoi_bool_i64(cond_26204);\n                    int64_t defunc_0_f_res_f_res_26206;\n                    int64_t defunc_0_f_res_f_res_26207;\n                    \n                    if (cond_26204) {\n                        defunc_0_f_res_f_res_26206 = (int64_t) 0;\n                        defunc_0_f_res_f_res_26207 = (int64_t) 0;\n                    } else {\n                        bool cond_26208 = defunc_0_f_res_26198 == 2;\n                        int64_t defunc_0_f_res_f_res_f_res_26209 =\n                                btoi_bool_i64(cond_26208);\n                        bool cond_neg_26210 = !cond_26208;\n                        int64_t defunc_0_f_res_f_res_f_res_26211 =\n                                btoi_bool_i64(cond_neg_26210);\n                        \n                        defunc_0_f_res_f_res_26206 =\n                            defunc_0_f_res_f_res_f_res_26209;\n                        defunc_0_f_res_f_res_26207 =\n                            defunc_0_f_res_f_res_f_res_26211;\n                    }\n                    defunc_0_f_res_26201 = defunc_0_f_res_f_res_26205;\n                    defunc_0_f_res_26202 = defunc_0_f_res_f_res_26206;\n                    defunc_0_f_res_26203 = defunc_0_f_res_f_res_26207;\n                }\n                ((__global int32_t *) mem_28386)[gtid_27690] =\n                    defunc_0_f_res_26198;\n                private_mem_29373[i_29381] = defunc_0_f_res_26200;\n                private_mem_29375[i_29381] = defunc_0_f_res_26201;\n                private_mem_29377[i_29381] = defunc_0_f_res_26202;\n                private_mem_29379[i_29381] = defunc_0_f_res_26203;\n            } else {\n                private_mem_29373[i_29381] = (int64_t) 0;\n         ",
            "       private_mem_29375[i_29381] = (int64_t) 0;\n                private_mem_29377[i_29381] = (int64_t) 0;\n                private_mem_29379[i_29381] = (int64_t) 0;\n            }\n        }\n    }\n    // Transpose scan inputs\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29382 = 0; i_29382 < (int64_t) 9; i_29382++) {\n            int64_t sharedIdx_29383 = sext_i32_i64(local_tid_29340) + i_29382 *\n                    segscan_group_sizze_27686;\n            \n            ((__local int64_t *) local_mem_29354)[sharedIdx_29383] =\n                private_mem_29373[i_29382];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_29384 = 0; i_29384 < 9; i_29384++) {\n            int32_t sharedIdx_29385 = local_tid_29340 * 9 + i_29384;\n            \n            private_mem_29373[sext_i32_i64(i_29384)] = ((__local\n                                                         int64_t *) local_mem_29354)[sext_i32_i64(sharedIdx_29385)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29386 = 0; i_29386 < (int64_t) 9; i_29386++) {\n            int64_t sharedIdx_29387 = sext_i32_i64(local_tid_29340) + i_29386 *\n                    segscan_group_sizze_27686;\n            \n            ((__local int64_t *) local_mem_29354)[sharedIdx_29387] =\n                private_mem_29375[i_29386];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_29388 = 0; i_29388 < 9; i_29388++) {\n            int32_t sharedIdx_29389 = local_tid_29340 * 9 + i_29388;\n            \n            private_mem_29375[sext_i32_i64(i_29388)] = ((__local\n                                                         int64_t *) local_mem_29354)[sext_i32_i64(sharedIdx_29389)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29390 = 0; i_29390 < (int64_t) 9; i_29390++) {\n            int64_t sharedIdx_29391 = sext_i32_i64(local_tid_29340) + i_29390 *\n                    segscan_group_sizze_27686;\n            \n            ((__local int64_t *) loc",
            "al_mem_29354)[sharedIdx_29391] =\n                private_mem_29377[i_29390];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_29392 = 0; i_29392 < 9; i_29392++) {\n            int32_t sharedIdx_29393 = local_tid_29340 * 9 + i_29392;\n            \n            private_mem_29377[sext_i32_i64(i_29392)] = ((__local\n                                                         int64_t *) local_mem_29354)[sext_i32_i64(sharedIdx_29393)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29394 = 0; i_29394 < (int64_t) 9; i_29394++) {\n            int64_t sharedIdx_29395 = sext_i32_i64(local_tid_29340) + i_29394 *\n                    segscan_group_sizze_27686;\n            \n            ((__local int64_t *) local_mem_29354)[sharedIdx_29395] =\n                private_mem_29379[i_29394];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_29396 = 0; i_29396 < 9; i_29396++) {\n            int32_t sharedIdx_29397 = local_tid_29340 * 9 + i_29396;\n            \n            private_mem_29379[sext_i32_i64(i_29396)] = ((__local\n                                                         int64_t *) local_mem_29354)[sext_i32_i64(sharedIdx_29397)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Per thread scan\n    {\n        for (int64_t i_29398 = 0; i_29398 < (int64_t) 8; i_29398++) {\n            int64_t x_26178;\n            int64_t x_26182;\n            \n            x_26178 = private_mem_29373[i_29398];\n            x_26182 = private_mem_29373[i_29398 + (int64_t) 1];\n            \n            int64_t x_26179;\n            int64_t x_26183;\n            \n            x_26179 = private_mem_29375[i_29398];\n            x_26183 = private_mem_29375[i_29398 + (int64_t) 1];\n            \n            int64_t x_26180;\n            int64_t x_26184;\n            \n            x_26180 = private_mem_29377[i_29398];\n            x_26184 = private_mem_29377[i_29398 + (int64_t) 1];\n            \n            int64_t x_26181;\n            int64_t x_26185;\n   ",
            "         \n            x_26181 = private_mem_29379[i_29398];\n            x_26185 = private_mem_29379[i_29398 + (int64_t) 1];\n            \n            int64_t defunc_1_op_res_26186;\n            \n            defunc_1_op_res_26186 = add64(x_26178, x_26182);\n            \n            int64_t defunc_1_op_res_26187 = add64(x_26179, x_26183);\n            int64_t defunc_1_op_res_26188 = add64(x_26180, x_26184);\n            int64_t defunc_1_op_res_26189 = add64(x_26181, x_26185);\n            \n            private_mem_29373[i_29398 + (int64_t) 1] = defunc_1_op_res_26186;\n            private_mem_29375[i_29398 + (int64_t) 1] = defunc_1_op_res_26187;\n            private_mem_29377[i_29398 + (int64_t) 1] = defunc_1_op_res_26188;\n            private_mem_29379[i_29398 + (int64_t) 1] = defunc_1_op_res_26189;\n        }\n    }\n    // Publish results in shared memory\n    {\n        ((__local int64_t *) local_mem_29354)[squot64(byte_offsets_29344,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_29340)] =\n            private_mem_29373[(int64_t) 8];\n        ((__local int64_t *) local_mem_29354)[squot64(byte_offsets_29345,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_29340)] =\n            private_mem_29375[(int64_t) 8];\n        ((__local int64_t *) local_mem_29354)[squot64(byte_offsets_29346,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_29340)] =\n            private_mem_29377[(int64_t) 8];\n        ((__local int64_t *) local_mem_29354)[squot64(byte_offsets_29347,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_29340)] =\n            private_mem_29379[(int64_t) 8];\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t acc_29411;\n   ",
            " int64_t acc_29412;\n    int64_t acc_29413;\n    int64_t acc_29414;\n    \n    // Scan results (with warp scan)\n    {\n        int64_t x_29399;\n        int64_t x_29400;\n        int64_t x_29401;\n        int64_t x_29402;\n        int64_t x_29403;\n        int64_t x_29404;\n        int64_t x_29405;\n        int64_t x_29406;\n        int64_t x_29415;\n        int64_t x_29416;\n        int64_t x_29417;\n        int64_t x_29418;\n        int64_t x_29419;\n        int64_t x_29420;\n        int64_t x_29421;\n        int64_t x_29422;\n        bool ltid_in_bounds_29427;\n        \n        ltid_in_bounds_29427 = slt64(sext_i32_i64(local_tid_29340),\n                                     segscan_group_sizze_27686);\n        \n        int32_t skip_threads_29428;\n        \n        // read input for in-block scan\n        {\n            if (ltid_in_bounds_29427) {\n                x_29403 = ((volatile __local\n                            int64_t *) local_mem_29354)[squot64(byte_offsets_29344,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_29340)];\n                x_29404 = ((volatile __local\n                            int64_t *) local_mem_29354)[squot64(byte_offsets_29345,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_29340)];\n                x_29405 = ((volatile __local\n                            int64_t *) local_mem_29354)[squot64(byte_offsets_29346,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_29340)];\n                x_29406 = ((volatile __local\n                            int64_t *) local_mem_29354)[squot64(byte_offsets_29347,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(",
            "local_tid_29340)];\n                if ((local_tid_29340 - squot32(local_tid_29340, 32) * 32) ==\n                    0) {\n                    x_29399 = x_29403;\n                    x_29400 = x_29404;\n                    x_29401 = x_29405;\n                    x_29402 = x_29406;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_29428 = 1;\n            while (slt32(skip_threads_29428, 32)) {\n                if (sle32(skip_threads_29428, local_tid_29340 -\n                          squot32(local_tid_29340, 32) * 32) &&\n                    ltid_in_bounds_29427) {\n                    // read operands\n                    {\n                        x_29399 = ((volatile __local\n                                    int64_t *) local_mem_29354)[squot64(byte_offsets_29344,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_29340) -\n                                                                 sext_i32_i64(skip_threads_29428))];\n                        x_29400 = ((volatile __local\n                                    int64_t *) local_mem_29354)[squot64(byte_offsets_29345,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_29340) -\n                                                                 sext_i32_i64(skip_threads_29428))];\n                        x_29401 = ((volatile __local\n                                    int64_t *) local_mem_29354)[squot64(byte_offsets_29346,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_29340) -\n                                                                 sext_i32_i64(skip_threads_29428))];\n      ",
            "                  x_29402 = ((volatile __local\n                                    int64_t *) local_mem_29354)[squot64(byte_offsets_29347,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_29340) -\n                                                                 sext_i32_i64(skip_threads_29428))];\n                    }\n                    // perform operation\n                    {\n                        int64_t defunc_1_op_res_29407 = add64(x_29399, x_29403);\n                        int64_t defunc_1_op_res_29408 = add64(x_29400, x_29404);\n                        int64_t defunc_1_op_res_29409 = add64(x_29401, x_29405);\n                        int64_t defunc_1_op_res_29410 = add64(x_29402, x_29406);\n                        \n                        x_29399 = defunc_1_op_res_29407;\n                        x_29400 = defunc_1_op_res_29408;\n                        x_29401 = defunc_1_op_res_29409;\n                        x_29402 = defunc_1_op_res_29410;\n                    }\n                }\n                if (sle32(wave_sizze_29342, skip_threads_29428)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_29428, local_tid_29340 -\n                          squot32(local_tid_29340, 32) * 32) &&\n                    ltid_in_bounds_29427) {\n                    // write result\n                    {\n                        ((volatile __local\n                          int64_t *) local_mem_29354)[squot64(byte_offsets_29344,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_29340)] =\n                            x_29399;\n                        x_29403 = x_29399;\n                        ((volatile __local\n                          int64_t *) local_mem_29354)[squot64(byte_offsets_29345,\n               ",
            "                                               (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_29340)] =\n                            x_29400;\n                        x_29404 = x_29400;\n                        ((volatile __local\n                          int64_t *) local_mem_29354)[squot64(byte_offsets_29346,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_29340)] =\n                            x_29401;\n                        x_29405 = x_29401;\n                        ((volatile __local\n                          int64_t *) local_mem_29354)[squot64(byte_offsets_29347,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_29340)] =\n                            x_29402;\n                        x_29406 = x_29402;\n                    }\n                }\n                if (sle32(wave_sizze_29342, skip_threads_29428)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_29428 *= 2;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // last thread of block 'i' writes its result to offset 'i'\n        {\n            if ((local_tid_29340 - squot32(local_tid_29340, 32) * 32) == 31 &&\n                ltid_in_bounds_29427) {\n                ((volatile __local\n                  int64_t *) local_mem_29354)[squot64(byte_offsets_29344,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_29340,\n                                                                   32))] =\n                    x_29399;\n                ((volatile __local\n                  int64_t *) local_mem_29354)[squot64(byte_offsets_29345,\n                                                      (int64_t) 8) +\n              ",
            "                                sext_i32_i64(squot32(local_tid_29340,\n                                                                   32))] =\n                    x_29400;\n                ((volatile __local\n                  int64_t *) local_mem_29354)[squot64(byte_offsets_29346,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_29340,\n                                                                   32))] =\n                    x_29401;\n                ((volatile __local\n                  int64_t *) local_mem_29354)[squot64(byte_offsets_29347,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_29340,\n                                                                   32))] =\n                    x_29402;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n        {\n            int32_t skip_threads_29429;\n            \n            // read input for in-block scan\n            {\n                if (squot32(local_tid_29340, 32) == 0 && ltid_in_bounds_29427) {\n                    x_29419 = ((volatile __local\n                                int64_t *) local_mem_29354)[squot64(byte_offsets_29344,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_29340)];\n                    x_29420 = ((volatile __local\n                                int64_t *) local_mem_29354)[squot64(byte_offsets_29345,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_29340)];\n                    x_29421 = ((volatile __local\n                                int64_t *) local_mem_29354)[squot64",
            "(byte_offsets_29346,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_29340)];\n                    x_29422 = ((volatile __local\n                                int64_t *) local_mem_29354)[squot64(byte_offsets_29347,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_29340)];\n                    if ((local_tid_29340 - squot32(local_tid_29340, 32) * 32) ==\n                        0) {\n                        x_29415 = x_29419;\n                        x_29416 = x_29420;\n                        x_29417 = x_29421;\n                        x_29418 = x_29422;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_29429 = 1;\n                while (slt32(skip_threads_29429, 32)) {\n                    if (sle32(skip_threads_29429, local_tid_29340 -\n                              squot32(local_tid_29340, 32) * 32) &&\n                        (squot32(local_tid_29340, 32) == 0 &&\n                         ltid_in_bounds_29427)) {\n                        // read operands\n                        {\n                            x_29415 = ((volatile __local\n                                        int64_t *) local_mem_29354)[squot64(byte_offsets_29344,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_29340) -\n                                                                     sext_i32_i64(skip_threads_29429))];\n                            x_29416 = ((volatile __local\n                                        int64_t *) local_mem_29354)[squot64(byte_offsets_29345,\n                                                                    ",
            "        (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_29340) -\n                                                                     sext_i32_i64(skip_threads_29429))];\n                            x_29417 = ((volatile __local\n                                        int64_t *) local_mem_29354)[squot64(byte_offsets_29346,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_29340) -\n                                                                     sext_i32_i64(skip_threads_29429))];\n                            x_29418 = ((volatile __local\n                                        int64_t *) local_mem_29354)[squot64(byte_offsets_29347,\n                                                                            (int64_t) 8) +\n                                                                    (sext_i32_i64(local_tid_29340) -\n                                                                     sext_i32_i64(skip_threads_29429))];\n                        }\n                        // perform operation\n                        {\n                            int64_t defunc_1_op_res_29423 = add64(x_29415,\n                                                                  x_29419);\n                            int64_t defunc_1_op_res_29424 = add64(x_29416,\n                                                                  x_29420);\n                            int64_t defunc_1_op_res_29425 = add64(x_29417,\n                                                                  x_29421);\n                            int64_t defunc_1_op_res_29426 = add64(x_29418,\n                                                                  x_29422);\n                            \n                            x_29415 = defunc_1_op_res_29423;\n                            x_29416 = defunc_1_op_res_29424;\n                   ",
            "         x_29417 = defunc_1_op_res_29425;\n                            x_29418 = defunc_1_op_res_29426;\n                        }\n                    }\n                    if (sle32(wave_sizze_29342, skip_threads_29429)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_29429, local_tid_29340 -\n                              squot32(local_tid_29340, 32) * 32) &&\n                        (squot32(local_tid_29340, 32) == 0 &&\n                         ltid_in_bounds_29427)) {\n                        // write result\n                        {\n                            ((volatile __local\n                              int64_t *) local_mem_29354)[squot64(byte_offsets_29344,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_29340)] =\n                                x_29415;\n                            x_29419 = x_29415;\n                            ((volatile __local\n                              int64_t *) local_mem_29354)[squot64(byte_offsets_29345,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_29340)] =\n                                x_29416;\n                            x_29420 = x_29416;\n                            ((volatile __local\n                              int64_t *) local_mem_29354)[squot64(byte_offsets_29346,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_29340)] =\n                                x_29417;\n                            x_29421 = x_29417;\n                            ((volatile __local\n                              int64_t *) local_mem_29354)[squot64(byte_offsets_29347,\n                                                                  (int64_t) ",
            "8) +\n                                                          sext_i32_i64(local_tid_29340)] =\n                                x_29418;\n                            x_29422 = x_29418;\n                        }\n                    }\n                    if (sle32(wave_sizze_29342, skip_threads_29429)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_29429 *= 2;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // carry-in for every block except the first\n        {\n            if (!(squot32(local_tid_29340, 32) == 0 || !ltid_in_bounds_29427)) {\n                // read operands\n                {\n                    x_29403 = x_29399;\n                    x_29404 = x_29400;\n                    x_29405 = x_29401;\n                    x_29406 = x_29402;\n                    x_29399 = ((__local\n                                int64_t *) local_mem_29354)[squot64(byte_offsets_29344,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_29340,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                    x_29400 = ((__local\n                                int64_t *) local_mem_29354)[squot64(byte_offsets_29345,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_29340,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                    x_29401 = ((__local\n                                int64_t *) local_mem_29354)[squot64(byte_offsets_29346,\n                                                                   ",
            " (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_29340,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                    x_29402 = ((__local\n                                int64_t *) local_mem_29354)[squot64(byte_offsets_29347,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_29340,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                }\n                // perform operation\n                {\n                    int64_t defunc_1_op_res_29407 = add64(x_29399, x_29403);\n                    int64_t defunc_1_op_res_29408 = add64(x_29400, x_29404);\n                    int64_t defunc_1_op_res_29409 = add64(x_29401, x_29405);\n                    int64_t defunc_1_op_res_29410 = add64(x_29402, x_29406);\n                    \n                    x_29399 = defunc_1_op_res_29407;\n                    x_29400 = defunc_1_op_res_29408;\n                    x_29401 = defunc_1_op_res_29409;\n                    x_29402 = defunc_1_op_res_29410;\n                }\n                // write final result\n                {\n                    ((__local\n                      int64_t *) local_mem_29354)[squot64(byte_offsets_29344,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_29340)] =\n                        x_29399;\n                    ((__local\n                      int64_t *) local_mem_29354)[squot64(byte_offsets_29345,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_29340)",
            "] =\n                        x_29400;\n                    ((__local\n                      int64_t *) local_mem_29354)[squot64(byte_offsets_29346,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_29340)] =\n                        x_29401;\n                    ((__local\n                      int64_t *) local_mem_29354)[squot64(byte_offsets_29347,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_29340)] =\n                        x_29402;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // restore correct values for first block\n        {\n            if (squot32(local_tid_29340, 32) == 0) {\n                ((__local\n                  int64_t *) local_mem_29354)[squot64(byte_offsets_29344,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_29340)] =\n                    x_29403;\n                ((__local\n                  int64_t *) local_mem_29354)[squot64(byte_offsets_29345,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_29340)] =\n                    x_29404;\n                ((__local\n                  int64_t *) local_mem_29354)[squot64(byte_offsets_29346,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_29340)] =\n                    x_29405;\n                ((__local\n                  int64_t *) local_mem_29354)[squot64(byte_offsets_29347,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_29340)] =\n                    x_29406;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n      ",
            "  barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_tid_29340 == 0) {\n            acc_29411 = ((__local\n                          int64_t *) local_mem_29354)[squot64(byte_offsets_29344,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_27686 -\n                                                       (int64_t) 1)];\n            acc_29412 = ((__local\n                          int64_t *) local_mem_29354)[squot64(byte_offsets_29345,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_27686 -\n                                                       (int64_t) 1)];\n            acc_29413 = ((__local\n                          int64_t *) local_mem_29354)[squot64(byte_offsets_29346,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_27686 -\n                                                       (int64_t) 1)];\n            acc_29414 = ((__local\n                          int64_t *) local_mem_29354)[squot64(byte_offsets_29347,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_27686 -\n                                                       (int64_t) 1)];\n        } else {\n            acc_29411 = ((__local\n                          int64_t *) local_mem_29354)[squot64(byte_offsets_29344,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_29340) -\n                                                       (int64_t) 1)];\n            acc_29412 = ((__local\n                          int64_t *) local_mem_29354)[squot64(byte_offsets_29345,\n                                                              (in",
            "t64_t) 8) +\n                                                      (sext_i32_i64(local_tid_29340) -\n                                                       (int64_t) 1)];\n            acc_29413 = ((__local\n                          int64_t *) local_mem_29354)[squot64(byte_offsets_29346,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_29340) -\n                                                       (int64_t) 1)];\n            acc_29414 = ((__local\n                          int64_t *) local_mem_29354)[squot64(byte_offsets_29347,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_29340) -\n                                                       (int64_t) 1)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t prefix_29430;\n    \n    prefix_29430 = (int64_t) 0;\n    \n    int64_t prefix_29431;\n    \n    prefix_29431 = (int64_t) 0;\n    \n    int64_t prefix_29432;\n    \n    prefix_29432 = (int64_t) 0;\n    \n    int64_t prefix_29433;\n    \n    prefix_29433 = (int64_t) 0;\n    // Perform lookback\n    {\n        if (dynamic_id_29371 == (int64_t) 0 && local_tid_29340 == 0) {\n            ((volatile __global\n              int64_t *) incprefixes_mem_29325)[dynamic_id_29371] = acc_29411;\n            ((volatile __global\n              int64_t *) incprefixes_mem_29329)[dynamic_id_29371] = acc_29412;\n            ((volatile __global\n              int64_t *) incprefixes_mem_29333)[dynamic_id_29371] = acc_29413;\n            ((volatile __global\n              int64_t *) incprefixes_mem_29337)[dynamic_id_29371] = acc_29414;\n            mem_fence_global();\n            ((volatile __global\n              int8_t *) status_flags_mem_29321)[dynamic_id_29371] = (int8_t) 2;\n            acc_29411 = (int64_t) 0;\n            acc_29412 = (int64_t) 0;\n            acc_29413 = (int64_t) 0;\n     ",
            "       acc_29414 = (int64_t) 0;\n        }\n        if (!(dynamic_id_29371 == (int64_t) 0) && slt32(local_tid_29340,\n                                                        wave_sizze_29342)) {\n            if (local_tid_29340 == 0) {\n                ((volatile __global\n                  int64_t *) aggregates_mem_29323)[dynamic_id_29371] =\n                    acc_29411;\n                ((volatile __global\n                  int64_t *) aggregates_mem_29327)[dynamic_id_29371] =\n                    acc_29412;\n                ((volatile __global\n                  int64_t *) aggregates_mem_29331)[dynamic_id_29371] =\n                    acc_29413;\n                ((volatile __global\n                  int64_t *) aggregates_mem_29335)[dynamic_id_29371] =\n                    acc_29414;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_29321)[dynamic_id_29371] =\n                    (int8_t) 1;\n                ((__local int8_t *) local_mem_29354)[(int64_t) 0] = ((__global\n                                                                      int8_t *) status_flags_mem_29321)[dynamic_id_29371 -\n                                                                                                        (int64_t) 1];\n            }\n            mem_fence_local();\n            \n            int8_t status_29434;\n            \n            status_29434 = ((__local int8_t *) local_mem_29354)[(int64_t) 0];\n            if (status_29434 == (int8_t) 2) {\n                if (local_tid_29340 == 0) {\n                    prefix_29430 = ((volatile __global\n                                     int64_t *) incprefixes_mem_29325)[dynamic_id_29371 -\n                                                                       (int64_t) 1];\n                    prefix_29431 = ((volatile __global\n                                     int64_t *) incprefixes_mem_29329)[dynamic_id_29371 -\n                                                                       (i",
            "nt64_t) 1];\n                    prefix_29432 = ((volatile __global\n                                     int64_t *) incprefixes_mem_29333)[dynamic_id_29371 -\n                                                                       (int64_t) 1];\n                    prefix_29433 = ((volatile __global\n                                     int64_t *) incprefixes_mem_29337)[dynamic_id_29371 -\n                                                                       (int64_t) 1];\n                }\n            } else {\n                int32_t readOffset_29435 = dynamic_id_29371 -\n                        sext_i32_i64(wave_sizze_29342);\n                \n                while (slt32(wave_sizze_29342 * -1, readOffset_29435)) {\n                    int32_t read_i_29436 = readOffset_29435 + local_tid_29340;\n                    int64_t aggr_29437 = (int64_t) 0;\n                    int64_t aggr_29438 = (int64_t) 0;\n                    int64_t aggr_29439 = (int64_t) 0;\n                    int64_t aggr_29440 = (int64_t) 0;\n                    int8_t flag_29441 = (int8_t) 0;\n                    int8_t used_29442 = (int8_t) 0;\n                    \n                    if (sle32(0, read_i_29436)) {\n                        flag_29441 = ((volatile __global\n                                       int8_t *) status_flags_mem_29321)[sext_i32_i64(read_i_29436)];\n                        if (flag_29441 == (int8_t) 2) {\n                            aggr_29437 = ((volatile __global\n                                           int64_t *) incprefixes_mem_29325)[sext_i32_i64(read_i_29436)];\n                            aggr_29438 = ((volatile __global\n                                           int64_t *) incprefixes_mem_29329)[sext_i32_i64(read_i_29436)];\n                            aggr_29439 = ((volatile __global\n                                           int64_t *) incprefixes_mem_29333)[sext_i32_i64(read_i_29436)];\n                            aggr_29440 = ((volatile __global\n                                  ",
            "         int64_t *) incprefixes_mem_29337)[sext_i32_i64(read_i_29436)];\n                        } else {\n                            if (flag_29441 == (int8_t) 1) {\n                                aggr_29437 = ((volatile __global\n                                               int64_t *) aggregates_mem_29323)[sext_i32_i64(read_i_29436)];\n                                aggr_29438 = ((volatile __global\n                                               int64_t *) aggregates_mem_29327)[sext_i32_i64(read_i_29436)];\n                                aggr_29439 = ((volatile __global\n                                               int64_t *) aggregates_mem_29331)[sext_i32_i64(read_i_29436)];\n                                aggr_29440 = ((volatile __global\n                                               int64_t *) aggregates_mem_29335)[sext_i32_i64(read_i_29436)];\n                                used_29442 = (int8_t) 1;\n                            }\n                        }\n                    }\n                    ((__local\n                      int64_t *) local_mem_29354)[squot64(warp_byte_offset_29349,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_29340)] =\n                        aggr_29437;\n                    ((__local\n                      int64_t *) local_mem_29354)[squot64(warp_byte_offset_29350,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_29340)] =\n                        aggr_29438;\n                    ((__local\n                      int64_t *) local_mem_29354)[squot64(warp_byte_offset_29351,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_29340)] =\n                        aggr_29439;\n                    ((__local\n                      int64_t *) local_mem_29354)[squot64(warp",
            "_byte_offset_29352,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_29340)] =\n                        aggr_29440;\n                    \n                    int8_t tmp_29443;\n                    \n                    tmp_29443 = flag_29441 | used_29442 << (int8_t) 2;\n                    ((__local\n                      int8_t *) local_mem_29354)[sext_i32_i64(local_tid_29340)] =\n                        tmp_29443;\n                    mem_fence_local();\n                    flag_29441 = ((volatile __local\n                                   int8_t *) local_mem_29354)[sext_i32_i64(wave_sizze_29342) -\n                                                              (int64_t) 1];\n                    if (local_tid_29340 == 0) {\n                        if (!(flag_29441 == (int8_t) 2)) {\n                            int64_t x_29444 = (int64_t) 0;\n                            int64_t x_29445 = (int64_t) 0;\n                            int64_t x_29446 = (int64_t) 0;\n                            int64_t x_29447 = (int64_t) 0;\n                            int64_t x_29448;\n                            int64_t x_29449;\n                            int64_t x_29450;\n                            int64_t x_29451;\n                            int8_t flag1_29456;\n                            \n                            flag1_29456 = (int8_t) 0;\n                            \n                            int8_t flag2_29457;\n                            int8_t used1_29458;\n                            \n                            used1_29458 = (int8_t) 0;\n                            \n                            int8_t used2_29459;\n                            \n                            for (int32_t i_29460 = 0; i_29460 <\n                                 wave_sizze_29342; i_29460++) {\n                                flag2_29457 = ((__local\n                                                int8_t *) local_mem_29354)[s",
            "ext_i32_i64(i_29460)];\n                                used2_29459 = lshr8(flag2_29457, (int8_t) 2);\n                                flag2_29457 = flag2_29457 & (int8_t) 3;\n                                x_29448 = ((__local\n                                            int64_t *) local_mem_29354)[squot64(warp_byte_offset_29349,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_29460)];\n                                x_29449 = ((__local\n                                            int64_t *) local_mem_29354)[squot64(warp_byte_offset_29350,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_29460)];\n                                x_29450 = ((__local\n                                            int64_t *) local_mem_29354)[squot64(warp_byte_offset_29351,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_29460)];\n                                x_29451 = ((__local\n                                            int64_t *) local_mem_29354)[squot64(warp_byte_offset_29352,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_29460)];\n                                if (!(flag2_29457 == (int8_t) 1)) {\n                                    flag1_29456 = flag2_29457;\n                                    used1_29458 = used2_29459;\n                                    x_29444 = x_29448;\n                                    x_29445 = x_29449;\n                                    x_29446 = x_29450;\n                                    x_29447 = x_29451;\n                         ",
            "       } else {\n                                    used1_29458 += used2_29459;\n                                    \n                                    int64_t defunc_1_op_res_29452;\n                                    \n                                    defunc_1_op_res_29452 = add64(x_29444,\n                                                                  x_29448);\n                                    \n                                    int64_t defunc_1_op_res_29453 =\n                                            add64(x_29445, x_29449);\n                                    int64_t defunc_1_op_res_29454 =\n                                            add64(x_29446, x_29450);\n                                    int64_t defunc_1_op_res_29455 =\n                                            add64(x_29447, x_29451);\n                                    \n                                    x_29444 = defunc_1_op_res_29452;\n                                    x_29445 = defunc_1_op_res_29453;\n                                    x_29446 = defunc_1_op_res_29454;\n                                    x_29447 = defunc_1_op_res_29455;\n                                }\n                            }\n                            flag_29441 = flag1_29456;\n                            used_29442 = used1_29458;\n                            aggr_29437 = x_29444;\n                            aggr_29438 = x_29445;\n                            aggr_29439 = x_29446;\n                            aggr_29440 = x_29447;\n                        } else {\n                            aggr_29437 = ((__local\n                                           int64_t *) local_mem_29354)[squot64(warp_byte_offset_29349,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_29342) -\n                                                                        (int64_t) 1)];\n                      ",
            "      aggr_29438 = ((__local\n                                           int64_t *) local_mem_29354)[squot64(warp_byte_offset_29350,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_29342) -\n                                                                        (int64_t) 1)];\n                            aggr_29439 = ((__local\n                                           int64_t *) local_mem_29354)[squot64(warp_byte_offset_29351,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_29342) -\n                                                                        (int64_t) 1)];\n                            aggr_29440 = ((__local\n                                           int64_t *) local_mem_29354)[squot64(warp_byte_offset_29352,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_29342) -\n                                                                        (int64_t) 1)];\n                        }\n                        if (flag_29441 == (int8_t) 2) {\n                            readOffset_29435 = wave_sizze_29342 * -1;\n                        } else {\n                            readOffset_29435 -= zext_i8_i32(used_29442);\n                        }\n                        ((__local int32_t *) local_mem_29354)[(int64_t) 0] =\n                            readOffset_29435;\n                        \n                        int64_t x_29461;\n                        \n                        x_29461 = aggr_29437;\n                        \n                        int64_t x_29462;\n                        \n                        x_29462 = aggr_29438;\n                     ",
            "   \n                        int64_t x_29463;\n                        \n                        x_29463 = aggr_29439;\n                        \n                        int64_t x_29464;\n                        \n                        x_29464 = aggr_29440;\n                        \n                        int64_t x_29465;\n                        \n                        x_29465 = prefix_29430;\n                        \n                        int64_t x_29466;\n                        \n                        x_29466 = prefix_29431;\n                        \n                        int64_t x_29467;\n                        \n                        x_29467 = prefix_29432;\n                        \n                        int64_t x_29468;\n                        \n                        x_29468 = prefix_29433;\n                        \n                        int64_t defunc_1_op_res_29469;\n                        \n                        defunc_1_op_res_29469 = add64(x_29461, x_29465);\n                        \n                        int64_t defunc_1_op_res_29470 = add64(x_29462, x_29466);\n                        int64_t defunc_1_op_res_29471 = add64(x_29463, x_29467);\n                        int64_t defunc_1_op_res_29472 = add64(x_29464, x_29468);\n                        \n                        prefix_29430 = defunc_1_op_res_29469;\n                        prefix_29431 = defunc_1_op_res_29470;\n                        prefix_29432 = defunc_1_op_res_29471;\n                        prefix_29433 = defunc_1_op_res_29472;\n                    }\n                    mem_fence_local();\n                    readOffset_29435 = ((__local\n                                         int32_t *) local_mem_29354)[(int64_t) 0];\n                }\n            }\n            if (local_tid_29340 == 0) {\n                int64_t x_29473 = prefix_29430;\n                int64_t x_29474 = prefix_29431;\n                int64_t x_29475 = prefix_29432;\n                int64_t x_29476 = prefix_29433;\n               ",
            " int64_t x_29477 = acc_29411;\n                int64_t x_29478 = acc_29412;\n                int64_t x_29479 = acc_29413;\n                int64_t x_29480 = acc_29414;\n                int64_t defunc_1_op_res_29481 = add64(x_29473, x_29477);\n                int64_t defunc_1_op_res_29482 = add64(x_29474, x_29478);\n                int64_t defunc_1_op_res_29483 = add64(x_29475, x_29479);\n                int64_t defunc_1_op_res_29484 = add64(x_29476, x_29480);\n                \n                ((volatile __global\n                  int64_t *) incprefixes_mem_29325)[dynamic_id_29371] =\n                    defunc_1_op_res_29481;\n                ((volatile __global\n                  int64_t *) incprefixes_mem_29329)[dynamic_id_29371] =\n                    defunc_1_op_res_29482;\n                ((volatile __global\n                  int64_t *) incprefixes_mem_29333)[dynamic_id_29371] =\n                    defunc_1_op_res_29483;\n                ((volatile __global\n                  int64_t *) incprefixes_mem_29337)[dynamic_id_29371] =\n                    defunc_1_op_res_29484;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_29321)[dynamic_id_29371] =\n                    (int8_t) 2;\n                ((__local\n                  int64_t *) local_mem_29354)[squot64(warp_byte_offset_29349,\n                                                      (int64_t) 8)] =\n                    prefix_29430;\n                ((__local\n                  int64_t *) local_mem_29354)[squot64(warp_byte_offset_29350,\n                                                      (int64_t) 8)] =\n                    prefix_29431;\n                ((__local\n                  int64_t *) local_mem_29354)[squot64(warp_byte_offset_29351,\n                                                      (int64_t) 8)] =\n                    prefix_29432;\n                ((__local\n                  int64_t *) local_mem_29354)[squot64(warp_byte_offset_29352,\n                  ",
            "                                    (int64_t) 8)] =\n                    prefix_29433;\n                acc_29411 = (int64_t) 0;\n                acc_29412 = (int64_t) 0;\n                acc_29413 = (int64_t) 0;\n                acc_29414 = (int64_t) 0;\n            }\n        }\n        if (!(dynamic_id_29371 == (int64_t) 0)) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            prefix_29430 = ((__local\n                             int64_t *) local_mem_29354)[squot64(warp_byte_offset_29349,\n                                                                 (int64_t) 8)];\n            prefix_29431 = ((__local\n                             int64_t *) local_mem_29354)[squot64(warp_byte_offset_29350,\n                                                                 (int64_t) 8)];\n            prefix_29432 = ((__local\n                             int64_t *) local_mem_29354)[squot64(warp_byte_offset_29351,\n                                                                 (int64_t) 8)];\n            prefix_29433 = ((__local\n                             int64_t *) local_mem_29354)[squot64(warp_byte_offset_29352,\n                                                                 (int64_t) 8)];\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    // Distribute results\n    {\n        int64_t x_29485;\n        int64_t x_29489;\n        int64_t x_29497;\n        \n        x_29497 = prefix_29430;\n        \n        int64_t x_29501;\n        \n        x_29501 = acc_29411;\n        \n        int64_t x_29486;\n        int64_t x_29490;\n        int64_t x_29498;\n        \n        x_29498 = prefix_29431;\n        \n        int64_t x_29502;\n        \n        x_29502 = acc_29412;\n        \n        int64_t x_29487;\n        int64_t x_29491;\n        int64_t x_29499;\n        \n        x_29499 = prefix_29432;\n        \n        int64_t x_29503;\n        \n        x_29503 = acc_29413;\n        \n        int64_t x_29488;\n        int64_t x_29492;\n        int64_t x_29500;\n        \n        x_29500 = prefix_29433;\n        \n    ",
            "    int64_t x_29504;\n        \n        x_29504 = acc_29414;\n        \n        int64_t defunc_1_op_res_29505;\n        \n        defunc_1_op_res_29505 = add64(x_29497, x_29501);\n        \n        int64_t defunc_1_op_res_29506 = add64(x_29498, x_29502);\n        int64_t defunc_1_op_res_29507 = add64(x_29499, x_29503);\n        int64_t defunc_1_op_res_29508 = add64(x_29500, x_29504);\n        \n        x_29485 = defunc_1_op_res_29505;\n        x_29486 = defunc_1_op_res_29506;\n        x_29487 = defunc_1_op_res_29507;\n        x_29488 = defunc_1_op_res_29508;\n        for (int64_t i_29509 = 0; i_29509 < (int64_t) 9; i_29509++) {\n            x_29489 = private_mem_29373[i_29509];\n            x_29490 = private_mem_29375[i_29509];\n            x_29491 = private_mem_29377[i_29509];\n            x_29492 = private_mem_29379[i_29509];\n            \n            int64_t defunc_1_op_res_29493;\n            \n            defunc_1_op_res_29493 = add64(x_29485, x_29489);\n            \n            int64_t defunc_1_op_res_29494 = add64(x_29486, x_29490);\n            int64_t defunc_1_op_res_29495 = add64(x_29487, x_29491);\n            int64_t defunc_1_op_res_29496 = add64(x_29488, x_29492);\n            \n            private_mem_29373[i_29509] = defunc_1_op_res_29493;\n            private_mem_29375[i_29509] = defunc_1_op_res_29494;\n            private_mem_29377[i_29509] = defunc_1_op_res_29495;\n            private_mem_29379[i_29509] = defunc_1_op_res_29496;\n        }\n    }\n    // Transpose scan output\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29510 = 0; i_29510 < (int64_t) 9; i_29510++) {\n            int64_t sharedIdx_29511 = sext_i32_i64(local_tid_29340 * 9) +\n                    i_29510;\n            \n            ((__local int64_t *) local_mem_29354)[sharedIdx_29511] =\n                private_mem_29373[i_29510];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29512 = 0; i_29512 < (int64_t) 9; i_29512++) {\n            int32_t sharedIdx_29513 = local_tid_29340 +",
            "\n                    sext_i64_i32(segscan_group_sizze_27686 * i_29512);\n            \n            private_mem_29373[i_29512] = ((__local\n                                           int64_t *) local_mem_29354)[sext_i32_i64(sharedIdx_29513)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29514 = 0; i_29514 < (int64_t) 9; i_29514++) {\n            int64_t sharedIdx_29515 = sext_i32_i64(local_tid_29340 * 9) +\n                    i_29514;\n            \n            ((__local int64_t *) local_mem_29354)[sharedIdx_29515] =\n                private_mem_29375[i_29514];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29516 = 0; i_29516 < (int64_t) 9; i_29516++) {\n            int32_t sharedIdx_29517 = local_tid_29340 +\n                    sext_i64_i32(segscan_group_sizze_27686 * i_29516);\n            \n            private_mem_29375[i_29516] = ((__local\n                                           int64_t *) local_mem_29354)[sext_i32_i64(sharedIdx_29517)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29518 = 0; i_29518 < (int64_t) 9; i_29518++) {\n            int64_t sharedIdx_29519 = sext_i32_i64(local_tid_29340 * 9) +\n                    i_29518;\n            \n            ((__local int64_t *) local_mem_29354)[sharedIdx_29519] =\n                private_mem_29377[i_29518];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29520 = 0; i_29520 < (int64_t) 9; i_29520++) {\n            int32_t sharedIdx_29521 = local_tid_29340 +\n                    sext_i64_i32(segscan_group_sizze_27686 * i_29520);\n            \n            private_mem_29377[i_29520] = ((__local\n                                           int64_t *) local_mem_29354)[sext_i32_i64(sharedIdx_29521)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29522 = 0; i_29522 < (int64_t) 9; i_29522++) {\n            int64_t sharedIdx_29523 = sext_i32_i64(local_tid_29340 * 9) +\n                    i_29522;\n            \n         ",
            "   ((__local int64_t *) local_mem_29354)[sharedIdx_29523] =\n                private_mem_29379[i_29522];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29524 = 0; i_29524 < (int64_t) 9; i_29524++) {\n            int32_t sharedIdx_29525 = local_tid_29340 +\n                    sext_i64_i32(segscan_group_sizze_27686 * i_29524);\n            \n            private_mem_29379[i_29524] = ((__local\n                                           int64_t *) local_mem_29354)[sext_i32_i64(sharedIdx_29525)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Write block scan results to global memory\n    {\n        for (int64_t i_29526 = 0; i_29526 < (int64_t) 9; i_29526++) {\n            int64_t gtid_27690 = blockOff_29372 + segscan_group_sizze_27686 *\n                    i_29526 + sext_i32_i64(local_tid_29340);\n            \n            if (slt64(gtid_27690, conc_tmp_26126)) {\n                ((__global int64_t *) mem_28378)[gtid_27690] =\n                    private_mem_29373[i_29526];\n            }\n        }\n        for (int64_t i_29527 = 0; i_29527 < (int64_t) 9; i_29527++) {\n            int64_t gtid_27690 = blockOff_29372 + segscan_group_sizze_27686 *\n                    i_29527 + sext_i32_i64(local_tid_29340);\n            \n            if (slt64(gtid_27690, conc_tmp_26126)) {\n                ((__global int64_t *) mem_28380)[gtid_27690] =\n                    private_mem_29375[i_29527];\n            }\n        }\n        for (int64_t i_29528 = 0; i_29528 < (int64_t) 9; i_29528++) {\n            int64_t gtid_27690 = blockOff_29372 + segscan_group_sizze_27686 *\n                    i_29528 + sext_i32_i64(local_tid_29340);\n            \n            if (slt64(gtid_27690, conc_tmp_26126)) {\n                ((__global int64_t *) mem_28382)[gtid_27690] =\n                    private_mem_29377[i_29528];\n            }\n        }\n        for (int64_t i_29529 = 0; i_29529 < (int64_t) 9; i_29529++) {\n            int64_t gtid_27690 = blockOff_29372 + segscan_group_sizze_27686",
            " *\n                    i_29529 + sext_i32_i64(local_tid_29340);\n            \n            if (slt64(gtid_27690, conc_tmp_26126)) {\n                ((__global int64_t *) mem_28384)[gtid_27690] =\n                    private_mem_29379[i_29529];\n            }\n        }\n    }\n    // If this is the last block, reset the dynamicId\n    {\n        if (dynamic_id_29371 == sdiv_up64(conc_tmp_26126,\n                                          segscan_group_sizze_27686 *\n                                          (int64_t) 9) - (int64_t) 1) {\n            ((__global\n              int32_t *) eWiseMultEntryziid_counter_mem_29319)[(int64_t) 0] = 0;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_27686\n}\n__kernel void eWiseMultEntryzisegscan_27803(__global int *global_failure,\n                                            int failure_is_an_option, __global\n                                            int64_t *global_failure_args,\n                                            uint local_mem_29559_backing_offset_0,\n                                            int64_t conc_tmp_26126,\n                                            int64_t j_m_i_26127, __global\n                                            unsigned char *mem_28408, __global\n                                            unsigned char *mem_28410, __global\n                                            unsigned char *mem_28412, __global\n                                            unsigned char *mem_28415, __global\n                                            unsigned char *mem_28417, __global\n                                            unsigned char *mem_28419, __global\n                                            unsigned char *mem_28421, __global\n                                            unsigned char *mem_28423, __global\n                                            unsigned char *eWiseMultEntryziid_counter_mem_29542,\n                                            __global\n                                            unsi",
            "gned char *status_flags_mem_29544,\n                                            __global\n                                            unsigned char *aggregates_mem_29546,\n                                            __global\n                                            unsigned char *incprefixes_mem_29548)\n{\n    #define segscan_group_sizze_27798 (eWiseMultEntryzisegscan_group_sizze_27797)\n    \n    const int block_dim0 = 0;\n    const int block_dim1 = 1;\n    const int block_dim2 = 2;\n    volatile char *local_mem_29559_backing_0 =\n                  &shared_mem[local_mem_29559_backing_offset_0];\n    volatile __local bool local_failure;\n    \n    if (failure_is_an_option) {\n        int failed = *global_failure >= 0;\n        \n        if (failed)\n            return;\n    }\n    local_failure = false;\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int32_t global_tid_29550;\n    int32_t local_tid_29551;\n    int64_t group_sizze_29554;\n    int32_t wave_sizze_29553;\n    int32_t group_tid_29552;\n    \n    global_tid_29550 = get_global_id(0);\n    local_tid_29551 = get_local_id(0);\n    group_sizze_29554 = get_local_size(0);\n    wave_sizze_29553 = LOCKSTEP_WIDTH;\n    group_tid_29552 = get_group_id(0);\n    \n    int32_t phys_tid_27803;\n    \n    phys_tid_27803 = global_tid_29550;\n    \n    int64_t byte_offsets_29555;\n    \n    byte_offsets_29555 = (int64_t) 0;\n    \n    int64_t byte_offsets_29556;\n    \n    byte_offsets_29556 = segscan_group_sizze_27798 * (int64_t) 8;\n    \n    int64_t warp_byte_offset_29557;\n    \n    warp_byte_offset_29557 = (int64_t) 32;\n    \n    int64_t warp_byte_offset_29558;\n    \n    warp_byte_offset_29558 = (int64_t) 288;\n    // Allocate reused shared memeory\n    { }\n    \n    __local char *local_mem_29559;\n    \n    local_mem_29559 = (__local char *) local_mem_29559_backing_0;\n    \n    int64_t trans_arr_len_29560;\n    \n    trans_arr_len_29560 = (int64_t) 9 * segscan_group_sizze_27798;\n    \n    int32_t dynamic_id_29567;\n    \n    if (local_tid_29551 == 0) {\n        dynamic_id_29567 ",
            "= atomic_add_i32_global(&((volatile __global\n                                                    int *) eWiseMultEntryziid_counter_mem_29542)[(int64_t) 0],\n                                                 (int) 1);\n        ((__local int32_t *) local_mem_29559)[(int64_t) 0] = dynamic_id_29567;\n    }\n    barrier(CLK_LOCAL_MEM_FENCE);\n    dynamic_id_29567 = ((__local int32_t *) local_mem_29559)[(int64_t) 0];\n    barrier(CLK_LOCAL_MEM_FENCE);\n    \n    int64_t blockOff_29568;\n    \n    blockOff_29568 = sext_i32_i64(dynamic_id_29567) * (int64_t) 9 *\n        segscan_group_sizze_27798;\n    \n    int64_t private_mem_29569[9];\n    \n    // Load and map\n    {\n        for (int64_t i_29571 = 0; i_29571 < (int64_t) 9; i_29571++) {\n            int64_t gtid_27802 = blockOff_29568 +\n                    sext_i32_i64(local_tid_29551) + i_29571 *\n                    segscan_group_sizze_27798;\n            \n            if (slt64(gtid_27802, j_m_i_26127)) {\n                int64_t slice_28109 = (int64_t) 1 + gtid_27802;\n                int64_t x_26305 = ((__global int64_t *) mem_28408)[slice_28109];\n                bool y_26311 = slt64(gtid_27802, conc_tmp_26126);\n                bool index_certs_26313;\n                \n                if (!y_26311) {\n                    {\n                        if (atomic_cmpxchg_i32_global(global_failure, -1, 62) ==\n                            -1) {\n                            global_failure_args[0] = gtid_27802;\n                            global_failure_args[1] = conc_tmp_26126;\n                            ;\n                        }\n                        local_failure = true;\n                        goto error_0;\n                    }\n                }\n                \n                int64_t y_26314 = ((__global int64_t *) mem_28408)[gtid_27802];\n                bool cond_26315 = x_26305 == y_26314;\n                int64_t defunc_0_f_res_26316;\n                \n                if (cond_26315) {\n                    defunc_0_f_res_26316 = x_26305;\n   ",
            "             } else {\n                    defunc_0_f_res_26316 = (int64_t) -1;\n                }\n                \n                int64_t defunc_0_f_res_26317;\n                int64_t defunc_0_f_res_26318;\n                \n                if (cond_26315) {\n                    int64_t x_26306 = ((__global\n                                        int64_t *) mem_28410)[slice_28109];\n                    int64_t x_26307 = ((__global\n                                        int64_t *) mem_28412)[slice_28109];\n                    bool cond_26319 = x_26306 == (int64_t) 0;\n                    int64_t defunc_0_f_res_t_res_26320;\n                    int64_t defunc_0_f_res_t_res_26321;\n                    \n                    if (cond_26319) {\n                        int64_t defunc_0_f_res_t_res_t_res_26322 = ((__global\n                                                                     int64_t *) mem_28412)[gtid_27802];\n                        \n                        defunc_0_f_res_t_res_26320 = x_26307;\n                        defunc_0_f_res_t_res_26321 =\n                            defunc_0_f_res_t_res_t_res_26322;\n                    } else {\n                        int64_t defunc_0_f_res_t_res_f_res_26323 = ((__global\n                                                                     int64_t *) mem_28412)[gtid_27802];\n                        \n                        defunc_0_f_res_t_res_26320 =\n                            defunc_0_f_res_t_res_f_res_26323;\n                        defunc_0_f_res_t_res_26321 = x_26307;\n                    }\n                    defunc_0_f_res_26317 = defunc_0_f_res_t_res_26320;\n                    defunc_0_f_res_26318 = defunc_0_f_res_t_res_26321;\n                } else {\n                    defunc_0_f_res_26317 = (int64_t) 0;\n                    defunc_0_f_res_26318 = (int64_t) 0;\n                }\n                \n                bool eq_x_y_26324 = (int64_t) -1 == x_26305;\n                bool p_and_eq_x_y_26325 = cond_26315 && eq_x_y_263",
            "24;\n                bool not_p_26326 = !cond_26315;\n                bool defunc_0_p_res_26327 = p_and_eq_x_y_26325 || not_p_26326;\n                int64_t defunc_1_lifted_lambda_res_26328 =\n                        btoi_bool_i64(defunc_0_p_res_26327);\n                bool is_i_26329 = defunc_1_lifted_lambda_res_26328 ==\n                     (int64_t) 0;\n                bool cond_neg_26330 = !is_i_26329;\n                int64_t part_res_26331 = btoi_bool_i64(cond_neg_26330);\n                int64_t part_res_26332 = btoi_bool_i64(is_i_26329);\n                \n                ((__global int64_t *) mem_28417)[gtid_27802] = part_res_26331;\n                ((__global int64_t *) mem_28419)[gtid_27802] =\n                    defunc_0_f_res_26316;\n                ((__global int64_t *) mem_28421)[gtid_27802] =\n                    defunc_0_f_res_26317;\n                ((__global int64_t *) mem_28423)[gtid_27802] =\n                    defunc_0_f_res_26318;\n                private_mem_29569[i_29571] = part_res_26332;\n            } else {\n                private_mem_29569[i_29571] = (int64_t) 0;\n            }\n        }\n    }\n    // Transpose scan inputs\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29572 = 0; i_29572 < (int64_t) 9; i_29572++) {\n            int64_t sharedIdx_29573 = sext_i32_i64(local_tid_29551) + i_29572 *\n                    segscan_group_sizze_27798;\n            \n            ((__local int64_t *) local_mem_29559)[sharedIdx_29573] =\n                private_mem_29569[i_29572];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int32_t i_29574 = 0; i_29574 < 9; i_29574++) {\n            int32_t sharedIdx_29575 = local_tid_29551 * 9 + i_29574;\n            \n            private_mem_29569[sext_i32_i64(i_29574)] = ((__local\n                                                         int64_t *) local_mem_29559)[sext_i32_i64(sharedIdx_29575)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Per thread scan\n    {\n        for (int64_t i",
            "_29576 = 0; i_29576 < (int64_t) 8; i_29576++) {\n            int64_t x_26302;\n            int64_t y_26303;\n            \n            x_26302 = private_mem_29569[i_29576];\n            y_26303 = private_mem_29569[i_29576 + (int64_t) 1];\n            \n            int64_t zz_26304;\n            \n            zz_26304 = x_26302 + y_26303;\n            private_mem_29569[i_29576 + (int64_t) 1] = zz_26304;\n        }\n    }\n    // Publish results in shared memory\n    {\n        ((__local int64_t *) local_mem_29559)[squot64(byte_offsets_29555,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_29551)] =\n            private_mem_29569[(int64_t) 8];\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t acc_29580;\n    \n    // Scan results (with warp scan)\n    {\n        int64_t x_29577;\n        int64_t y_29578;\n        int64_t x_29581;\n        int64_t y_29582;\n        bool ltid_in_bounds_29584;\n        \n        ltid_in_bounds_29584 = slt64(sext_i32_i64(local_tid_29551),\n                                     segscan_group_sizze_27798);\n        \n        int32_t skip_threads_29585;\n        \n        // read input for in-block scan\n        {\n            if (ltid_in_bounds_29584) {\n                y_29578 = ((volatile __local\n                            int64_t *) local_mem_29559)[squot64(byte_offsets_29555,\n                                                                (int64_t) 8) +\n                                                        sext_i32_i64(local_tid_29551)];\n                if ((local_tid_29551 - squot32(local_tid_29551, 32) * 32) ==\n                    0) {\n                    x_29577 = y_29578;\n                }\n            }\n        }\n        // in-block scan (hopefully no barriers needed)\n        {\n            skip_threads_29585 = 1;\n            while (slt32(skip_threads_29585, 32)) {\n                if (sle32(skip_threads_29585, local_tid_29551 -\n                          squot32(loca",
            "l_tid_29551, 32) * 32) &&\n                    ltid_in_bounds_29584) {\n                    // read operands\n                    {\n                        x_29577 = ((volatile __local\n                                    int64_t *) local_mem_29559)[squot64(byte_offsets_29555,\n                                                                        (int64_t) 8) +\n                                                                (sext_i32_i64(local_tid_29551) -\n                                                                 sext_i32_i64(skip_threads_29585))];\n                    }\n                    // perform operation\n                    {\n                        int64_t zz_29579 = x_29577 + y_29578;\n                        \n                        x_29577 = zz_29579;\n                    }\n                }\n                if (sle32(wave_sizze_29553, skip_threads_29585)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                if (sle32(skip_threads_29585, local_tid_29551 -\n                          squot32(local_tid_29551, 32) * 32) &&\n                    ltid_in_bounds_29584) {\n                    // write result\n                    {\n                        ((volatile __local\n                          int64_t *) local_mem_29559)[squot64(byte_offsets_29555,\n                                                              (int64_t) 8) +\n                                                      sext_i32_i64(local_tid_29551)] =\n                            x_29577;\n                        y_29578 = x_29577;\n                    }\n                }\n                if (sle32(wave_sizze_29553, skip_threads_29585)) {\n                    barrier(CLK_LOCAL_MEM_FENCE);\n                }\n                skip_threads_29585 *= 2;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // last thread of block 'i' writes its result to offset 'i'\n        {\n            if ((local_tid_29551 - squot32(local_tid_29551, 32) * 32) == 31 &&\n                ",
            "ltid_in_bounds_29584) {\n                ((volatile __local\n                  int64_t *) local_mem_29559)[squot64(byte_offsets_29555,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(squot32(local_tid_29551,\n                                                                   32))] =\n                    x_29577;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // scan the first block, after which offset 'i' contains carry-in for block 'i+1'\n        {\n            int32_t skip_threads_29586;\n            \n            // read input for in-block scan\n            {\n                if (squot32(local_tid_29551, 32) == 0 && ltid_in_bounds_29584) {\n                    y_29582 = ((volatile __local\n                                int64_t *) local_mem_29559)[squot64(byte_offsets_29555,\n                                                                    (int64_t) 8) +\n                                                            sext_i32_i64(local_tid_29551)];\n                    if ((local_tid_29551 - squot32(local_tid_29551, 32) * 32) ==\n                        0) {\n                        x_29581 = y_29582;\n                    }\n                }\n            }\n            // in-block scan (hopefully no barriers needed)\n            {\n                skip_threads_29586 = 1;\n                while (slt32(skip_threads_29586, 32)) {\n                    if (sle32(skip_threads_29586, local_tid_29551 -\n                              squot32(local_tid_29551, 32) * 32) &&\n                        (squot32(local_tid_29551, 32) == 0 &&\n                         ltid_in_bounds_29584)) {\n                        // read operands\n                        {\n                            x_29581 = ((volatile __local\n                                        int64_t *) local_mem_29559)[squot64(byte_offsets_29555,\n                                                                            (int64_t) 8) +\n        ",
            "                                                            (sext_i32_i64(local_tid_29551) -\n                                                                     sext_i32_i64(skip_threads_29586))];\n                        }\n                        // perform operation\n                        {\n                            int64_t zz_29583 = x_29581 + y_29582;\n                            \n                            x_29581 = zz_29583;\n                        }\n                    }\n                    if (sle32(wave_sizze_29553, skip_threads_29586)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    if (sle32(skip_threads_29586, local_tid_29551 -\n                              squot32(local_tid_29551, 32) * 32) &&\n                        (squot32(local_tid_29551, 32) == 0 &&\n                         ltid_in_bounds_29584)) {\n                        // write result\n                        {\n                            ((volatile __local\n                              int64_t *) local_mem_29559)[squot64(byte_offsets_29555,\n                                                                  (int64_t) 8) +\n                                                          sext_i32_i64(local_tid_29551)] =\n                                x_29581;\n                            y_29582 = x_29581;\n                        }\n                    }\n                    if (sle32(wave_sizze_29553, skip_threads_29586)) {\n                        barrier(CLK_LOCAL_MEM_FENCE);\n                    }\n                    skip_threads_29586 *= 2;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // carry-in for every block except the first\n        {\n            if (!(squot32(local_tid_29551, 32) == 0 || !ltid_in_bounds_29584)) {\n                // read operands\n                {\n                    y_29578 = x_29577;\n                    x_29577 = ((__local\n                                int64_t *) local_mem_29559)[squot6",
            "4(byte_offsets_29555,\n                                                                    (int64_t) 8) +\n                                                            (sext_i32_i64(squot32(local_tid_29551,\n                                                                                  32)) -\n                                                             (int64_t) 1)];\n                }\n                // perform operation\n                {\n                    int64_t zz_29579 = x_29577 + y_29578;\n                    \n                    x_29577 = zz_29579;\n                }\n                // write final result\n                {\n                    ((__local\n                      int64_t *) local_mem_29559)[squot64(byte_offsets_29555,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_29551)] =\n                        x_29577;\n                }\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        // restore correct values for first block\n        {\n            if (squot32(local_tid_29551, 32) == 0) {\n                ((__local\n                  int64_t *) local_mem_29559)[squot64(byte_offsets_29555,\n                                                      (int64_t) 8) +\n                                              sext_i32_i64(local_tid_29551)] =\n                    y_29578;\n            }\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        barrier(CLK_LOCAL_MEM_FENCE);\n        if (local_tid_29551 == 0) {\n            acc_29580 = ((__local\n                          int64_t *) local_mem_29559)[squot64(byte_offsets_29555,\n                                                              (int64_t) 8) +\n                                                      (segscan_group_sizze_27798 -\n                                                       (int64_t) 1)];\n        } else {\n            acc_29580 = ((__local\n                          int64_t *) local_mem_29559)[squot64(byt",
            "e_offsets_29555,\n                                                              (int64_t) 8) +\n                                                      (sext_i32_i64(local_tid_29551) -\n                                                       (int64_t) 1)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    \n    int64_t prefix_29587;\n    \n    prefix_29587 = (int64_t) 0;\n    // Perform lookback\n    {\n        if (dynamic_id_29567 == (int64_t) 0 && local_tid_29551 == 0) {\n            ((volatile __global\n              int64_t *) incprefixes_mem_29548)[dynamic_id_29567] = acc_29580;\n            mem_fence_global();\n            ((volatile __global\n              int8_t *) status_flags_mem_29544)[dynamic_id_29567] = (int8_t) 2;\n            acc_29580 = (int64_t) 0;\n        }\n        if (!(dynamic_id_29567 == (int64_t) 0) && slt32(local_tid_29551,\n                                                        wave_sizze_29553)) {\n            if (local_tid_29551 == 0) {\n                ((volatile __global\n                  int64_t *) aggregates_mem_29546)[dynamic_id_29567] =\n                    acc_29580;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_29544)[dynamic_id_29567] =\n                    (int8_t) 1;\n                ((__local int8_t *) local_mem_29559)[(int64_t) 0] = ((__global\n                                                                      int8_t *) status_flags_mem_29544)[dynamic_id_29567 -\n                                                                                                        (int64_t) 1];\n            }\n            mem_fence_local();\n            \n            int8_t status_29588;\n            \n            status_29588 = ((__local int8_t *) local_mem_29559)[(int64_t) 0];\n            if (status_29588 == (int8_t) 2) {\n                if (local_tid_29551 == 0) {\n                    prefix_29587 = ((volatile __global\n                                     int64_t *) incprefixes_mem_29548)[dy",
            "namic_id_29567 -\n                                                                       (int64_t) 1];\n                }\n            } else {\n                int32_t readOffset_29589 = dynamic_id_29567 -\n                        sext_i32_i64(wave_sizze_29553);\n                \n                while (slt32(wave_sizze_29553 * -1, readOffset_29589)) {\n                    int32_t read_i_29590 = readOffset_29589 + local_tid_29551;\n                    int64_t aggr_29591 = (int64_t) 0;\n                    int8_t flag_29592 = (int8_t) 0;\n                    int8_t used_29593 = (int8_t) 0;\n                    \n                    if (sle32(0, read_i_29590)) {\n                        flag_29592 = ((volatile __global\n                                       int8_t *) status_flags_mem_29544)[sext_i32_i64(read_i_29590)];\n                        if (flag_29592 == (int8_t) 2) {\n                            aggr_29591 = ((volatile __global\n                                           int64_t *) incprefixes_mem_29548)[sext_i32_i64(read_i_29590)];\n                        } else {\n                            if (flag_29592 == (int8_t) 1) {\n                                aggr_29591 = ((volatile __global\n                                               int64_t *) aggregates_mem_29546)[sext_i32_i64(read_i_29590)];\n                                used_29593 = (int8_t) 1;\n                            }\n                        }\n                    }\n                    ((__local\n                      int64_t *) local_mem_29559)[squot64(warp_byte_offset_29557,\n                                                          (int64_t) 8) +\n                                                  sext_i32_i64(local_tid_29551)] =\n                        aggr_29591;\n                    \n                    int8_t tmp_29594;\n                    \n                    tmp_29594 = flag_29592 | used_29593 << (int8_t) 2;\n                    ((__local\n                      int8_t *) local_mem_29559)[sext_i32_i64(local_tid_29",
            "551)] =\n                        tmp_29594;\n                    mem_fence_local();\n                    flag_29592 = ((volatile __local\n                                   int8_t *) local_mem_29559)[sext_i32_i64(wave_sizze_29553) -\n                                                              (int64_t) 1];\n                    if (local_tid_29551 == 0) {\n                        if (!(flag_29592 == (int8_t) 2)) {\n                            int64_t x_29595 = (int64_t) 0;\n                            int64_t y_29596;\n                            int8_t flag1_29598;\n                            \n                            flag1_29598 = (int8_t) 0;\n                            \n                            int8_t flag2_29599;\n                            int8_t used1_29600;\n                            \n                            used1_29600 = (int8_t) 0;\n                            \n                            int8_t used2_29601;\n                            \n                            for (int32_t i_29602 = 0; i_29602 <\n                                 wave_sizze_29553; i_29602++) {\n                                flag2_29599 = ((__local\n                                                int8_t *) local_mem_29559)[sext_i32_i64(i_29602)];\n                                used2_29601 = lshr8(flag2_29599, (int8_t) 2);\n                                flag2_29599 = flag2_29599 & (int8_t) 3;\n                                y_29596 = ((__local\n                                            int64_t *) local_mem_29559)[squot64(warp_byte_offset_29557,\n                                                                                (int64_t) 8) +\n                                                                        sext_i32_i64(i_29602)];\n                                if (!(flag2_29599 == (int8_t) 1)) {\n                                    flag1_29598 = flag2_29599;\n                                    used1_29600 = used2_29601;\n                                    x_29595 = y_29596;\n          ",
            "                      } else {\n                                    used1_29600 += used2_29601;\n                                    \n                                    int64_t zz_29597;\n                                    \n                                    zz_29597 = x_29595 + y_29596;\n                                    x_29595 = zz_29597;\n                                }\n                            }\n                            flag_29592 = flag1_29598;\n                            used_29593 = used1_29600;\n                            aggr_29591 = x_29595;\n                        } else {\n                            aggr_29591 = ((__local\n                                           int64_t *) local_mem_29559)[squot64(warp_byte_offset_29557,\n                                                                               (int64_t) 8) +\n                                                                       (sext_i32_i64(wave_sizze_29553) -\n                                                                        (int64_t) 1)];\n                        }\n                        if (flag_29592 == (int8_t) 2) {\n                            readOffset_29589 = wave_sizze_29553 * -1;\n                        } else {\n                            readOffset_29589 -= zext_i8_i32(used_29593);\n                        }\n                        ((__local int32_t *) local_mem_29559)[(int64_t) 0] =\n                            readOffset_29589;\n                        \n                        int64_t x_29603;\n                        \n                        x_29603 = aggr_29591;\n                        \n                        int64_t y_29604;\n                        \n                        y_29604 = prefix_29587;\n                        \n                        int64_t zz_29605;\n                        \n                        zz_29605 = x_29603 + y_29604;\n                        prefix_29587 = zz_29605;\n                    }\n                    mem_fence_local();\n                    r",
            "eadOffset_29589 = ((__local\n                                         int32_t *) local_mem_29559)[(int64_t) 0];\n                }\n            }\n            if (local_tid_29551 == 0) {\n                int64_t x_29606 = prefix_29587;\n                int64_t y_29607 = acc_29580;\n                int64_t zz_29608 = x_29606 + y_29607;\n                \n                ((volatile __global\n                  int64_t *) incprefixes_mem_29548)[dynamic_id_29567] =\n                    zz_29608;\n                mem_fence_global();\n                ((volatile __global\n                  int8_t *) status_flags_mem_29544)[dynamic_id_29567] =\n                    (int8_t) 2;\n                ((__local\n                  int64_t *) local_mem_29559)[squot64(warp_byte_offset_29557,\n                                                      (int64_t) 8)] =\n                    prefix_29587;\n                acc_29580 = (int64_t) 0;\n            }\n        }\n        if (!(dynamic_id_29567 == (int64_t) 0)) {\n            barrier(CLK_LOCAL_MEM_FENCE);\n            prefix_29587 = ((__local\n                             int64_t *) local_mem_29559)[squot64(warp_byte_offset_29557,\n                                                                 (int64_t) 8)];\n            barrier(CLK_LOCAL_MEM_FENCE);\n        }\n    }\n    // Distribute results\n    {\n        int64_t x_29609;\n        int64_t y_29610;\n        int64_t x_29612;\n        \n        x_29612 = prefix_29587;\n        \n        int64_t y_29613;\n        \n        y_29613 = acc_29580;\n        \n        int64_t zz_29614;\n        \n        zz_29614 = x_29612 + y_29613;\n        x_29609 = zz_29614;\n        for (int64_t i_29615 = 0; i_29615 < (int64_t) 9; i_29615++) {\n            y_29610 = private_mem_29569[i_29615];\n            \n            int64_t zz_29611;\n            \n            zz_29611 = x_29609 + y_29610;\n            private_mem_29569[i_29615] = zz_29611;\n        }\n    }\n    // Transpose scan output\n    {\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i",
            "_29616 = 0; i_29616 < (int64_t) 9; i_29616++) {\n            int64_t sharedIdx_29617 = sext_i32_i64(local_tid_29551 * 9) +\n                    i_29616;\n            \n            ((__local int64_t *) local_mem_29559)[sharedIdx_29617] =\n                private_mem_29569[i_29616];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n        for (int64_t i_29618 = 0; i_29618 < (int64_t) 9; i_29618++) {\n            int32_t sharedIdx_29619 = local_tid_29551 +\n                    sext_i64_i32(segscan_group_sizze_27798 * i_29618);\n            \n            private_mem_29569[i_29618] = ((__local\n                                           int64_t *) local_mem_29559)[sext_i32_i64(sharedIdx_29619)];\n        }\n        barrier(CLK_LOCAL_MEM_FENCE);\n    }\n    // Write block scan results to global memory\n    {\n        for (int64_t i_29620 = 0; i_29620 < (int64_t) 9; i_29620++) {\n            int64_t gtid_27802 = blockOff_29568 + segscan_group_sizze_27798 *\n                    i_29620 + sext_i32_i64(local_tid_29551);\n            \n            if (slt64(gtid_27802, j_m_i_26127)) {\n                ((__global int64_t *) mem_28415)[gtid_27802] =\n                    private_mem_29569[i_29620];\n            }\n        }\n    }\n    // If this is the last block, reset the dynamicId\n    {\n        if (dynamic_id_29567 == sdiv_up64(j_m_i_26127,\n                                          segscan_group_sizze_27798 *\n                                          (int64_t) 9) - (int64_t) 1) {\n            ((__global\n              int32_t *) eWiseMultEntryziid_counter_mem_29542)[(int64_t) 0] = 0;\n        }\n    }\n    \n  error_0:\n    return;\n    #undef segscan_group_sizze_27798\n}\n",
            NULL};
static const char *size_names[] = {"builtin#iota_i64.group_size_29308",
                                   "builtin#replicate_f64.group_size_29287",
                                   "builtin#replicate_i64.group_size_29296",
                                   "builtin#replicate_i8.group_size_29188",
                                   "eWiseAddEntry.segmap_group_size_27549",
                                   "eWiseAddEntry.segmap_group_size_27608",
                                   "eWiseAddEntry.segmap_group_size_27667",
                                   "eWiseAddEntry.segmap_group_size_27673",
                                   "eWiseAddEntry.segred_group_size_28808",
                                   "eWiseAddEntry.segred_num_groups_28806",
                                   "eWiseAddEntry.segscan_group_size_27531",
                                   "eWiseAddEntry.segscan_group_size_27539",
                                   "eWiseAddEntry.segscan_group_size_27657",
                                   "eWiseAddEntry.segscan_num_groups_27533",
                                   "eWiseAddEntry.segscan_num_groups_27541",
                                   "eWiseAddEntry.segscan_num_groups_27659",
                                   "eWiseAddMultEntry.segmap_group_size_27835",
                                   "eWiseAddMultEntry.segmap_group_size_27894",
                                   "eWiseAddMultEntry.segmap_group_size_27953",
                                   "eWiseAddMultEntry.segmap_group_size_27959",
                                   "eWiseAddMultEntry.segmap_group_size_27981",
                                   "eWiseAddMultEntry.segmap_group_size_28037",
                                   "eWiseAddMultEntry.segmap_group_size_28093",
                                   "eWiseAddMultEntry.segmap_group_size_28099",
                                   "eWiseAddMultEntry.segred_group_size_28974",
                                   "eWiseAddMultEntry.segred_group_size_29057",
                                   "eWiseAddMultEntry.segred_num_groups_28972",
                                   "eWiseAddMultEntry.segred_num_groups_29055",
                                   "eWiseAddMultEntry.segscan_group_size_27817",
                                   "eWiseAddMultEntry.segscan_group_size_27825",
                                   "eWiseAddMultEntry.segscan_group_size_27943",
                                   "eWiseAddMultEntry.segscan_group_size_27963",
                                   "eWiseAddMultEntry.segscan_group_size_27971",
                                   "eWiseAddMultEntry.segscan_group_size_28083",
                                   "eWiseAddMultEntry.segscan_num_groups_27819",
                                   "eWiseAddMultEntry.segscan_num_groups_27827",
                                   "eWiseAddMultEntry.segscan_num_groups_27945",
                                   "eWiseAddMultEntry.segscan_num_groups_27965",
                                   "eWiseAddMultEntry.segscan_num_groups_27973",
                                   "eWiseAddMultEntry.segscan_num_groups_28085",
                                   "eWiseMultEntry.segmap_group_size_27695",
                                   "eWiseMultEntry.segmap_group_size_27751",
                                   "eWiseMultEntry.segmap_group_size_27807",
                                   "eWiseMultEntry.segmap_group_size_27813",
                                   "eWiseMultEntry.segred_group_size_28891",
                                   "eWiseMultEntry.segred_num_groups_28889",
                                   "eWiseMultEntry.segscan_group_size_27677",
                                   "eWiseMultEntry.segscan_group_size_27685",
                                   "eWiseMultEntry.segscan_group_size_27797",
                                   "eWiseMultEntry.segscan_num_groups_27679",
                                   "eWiseMultEntry.segscan_num_groups_27687",
                                   "eWiseMultEntry.segscan_num_groups_27799"};
static const char *size_vars[] = {"builtinzhiota_i64zigroup_sizze_29308",
                                  "builtinzhreplicate_f64zigroup_sizze_29287",
                                  "builtinzhreplicate_i64zigroup_sizze_29296",
                                  "builtinzhreplicate_i8zigroup_sizze_29188",
                                  "eWiseAddEntryzisegmap_group_sizze_27549",
                                  "eWiseAddEntryzisegmap_group_sizze_27608",
                                  "eWiseAddEntryzisegmap_group_sizze_27667",
                                  "eWiseAddEntryzisegmap_group_sizze_27673",
                                  "eWiseAddEntryzisegred_group_sizze_28808",
                                  "eWiseAddEntryzisegred_num_groups_28806",
                                  "eWiseAddEntryzisegscan_group_sizze_27531",
                                  "eWiseAddEntryzisegscan_group_sizze_27539",
                                  "eWiseAddEntryzisegscan_group_sizze_27657",
                                  "eWiseAddEntryzisegscan_num_groups_27533",
                                  "eWiseAddEntryzisegscan_num_groups_27541",
                                  "eWiseAddEntryzisegscan_num_groups_27659",
                                  "eWiseAddMultEntryzisegmap_group_sizze_27835",
                                  "eWiseAddMultEntryzisegmap_group_sizze_27894",
                                  "eWiseAddMultEntryzisegmap_group_sizze_27953",
                                  "eWiseAddMultEntryzisegmap_group_sizze_27959",
                                  "eWiseAddMultEntryzisegmap_group_sizze_27981",
                                  "eWiseAddMultEntryzisegmap_group_sizze_28037",
                                  "eWiseAddMultEntryzisegmap_group_sizze_28093",
                                  "eWiseAddMultEntryzisegmap_group_sizze_28099",
                                  "eWiseAddMultEntryzisegred_group_sizze_28974",
                                  "eWiseAddMultEntryzisegred_group_sizze_29057",
                                  "eWiseAddMultEntryzisegred_num_groups_28972",
                                  "eWiseAddMultEntryzisegred_num_groups_29055",
                                  "eWiseAddMultEntryzisegscan_group_sizze_27817",
                                  "eWiseAddMultEntryzisegscan_group_sizze_27825",
                                  "eWiseAddMultEntryzisegscan_group_sizze_27943",
                                  "eWiseAddMultEntryzisegscan_group_sizze_27963",
                                  "eWiseAddMultEntryzisegscan_group_sizze_27971",
                                  "eWiseAddMultEntryzisegscan_group_sizze_28083",
                                  "eWiseAddMultEntryzisegscan_num_groups_27819",
                                  "eWiseAddMultEntryzisegscan_num_groups_27827",
                                  "eWiseAddMultEntryzisegscan_num_groups_27945",
                                  "eWiseAddMultEntryzisegscan_num_groups_27965",
                                  "eWiseAddMultEntryzisegscan_num_groups_27973",
                                  "eWiseAddMultEntryzisegscan_num_groups_28085",
                                  "eWiseMultEntryzisegmap_group_sizze_27695",
                                  "eWiseMultEntryzisegmap_group_sizze_27751",
                                  "eWiseMultEntryzisegmap_group_sizze_27807",
                                  "eWiseMultEntryzisegmap_group_sizze_27813",
                                  "eWiseMultEntryzisegred_group_sizze_28891",
                                  "eWiseMultEntryzisegred_num_groups_28889",
                                  "eWiseMultEntryzisegscan_group_sizze_27677",
                                  "eWiseMultEntryzisegscan_group_sizze_27685",
                                  "eWiseMultEntryzisegscan_group_sizze_27797",
                                  "eWiseMultEntryzisegscan_num_groups_27679",
                                  "eWiseMultEntryzisegscan_num_groups_27687",
                                  "eWiseMultEntryzisegscan_num_groups_27799"};
static const char *size_classes[] = {"group_size", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "num_groups", "group_size", "group_size",
                                     "group_size", "num_groups", "num_groups",
                                     "num_groups", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "group_size", "num_groups",
                                     "num_groups", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "group_size", "num_groups", "num_groups",
                                     "num_groups", "num_groups", "num_groups",
                                     "num_groups", "group_size", "group_size",
                                     "group_size", "group_size", "group_size",
                                     "num_groups", "group_size", "group_size",
                                     "group_size", "num_groups", "num_groups",
                                     "num_groups"};
int futhark_get_num_sizes(void)
{
    return 52;
}
const char *futhark_get_size_name(int i)
{
    return size_names[i];
}
const char *futhark_get_size_class(int i)
{
    return size_classes[i];
}
struct sizes {
    int64_t builtinzhiota_i64zigroup_sizze_29308;
    int64_t builtinzhreplicate_f64zigroup_sizze_29287;
    int64_t builtinzhreplicate_i64zigroup_sizze_29296;
    int64_t builtinzhreplicate_i8zigroup_sizze_29188;
    int64_t eWiseAddEntryzisegmap_group_sizze_27549;
    int64_t eWiseAddEntryzisegmap_group_sizze_27608;
    int64_t eWiseAddEntryzisegmap_group_sizze_27667;
    int64_t eWiseAddEntryzisegmap_group_sizze_27673;
    int64_t eWiseAddEntryzisegred_group_sizze_28808;
    int64_t eWiseAddEntryzisegred_num_groups_28806;
    int64_t eWiseAddEntryzisegscan_group_sizze_27531;
    int64_t eWiseAddEntryzisegscan_group_sizze_27539;
    int64_t eWiseAddEntryzisegscan_group_sizze_27657;
    int64_t eWiseAddEntryzisegscan_num_groups_27533;
    int64_t eWiseAddEntryzisegscan_num_groups_27541;
    int64_t eWiseAddEntryzisegscan_num_groups_27659;
    int64_t eWiseAddMultEntryzisegmap_group_sizze_27835;
    int64_t eWiseAddMultEntryzisegmap_group_sizze_27894;
    int64_t eWiseAddMultEntryzisegmap_group_sizze_27953;
    int64_t eWiseAddMultEntryzisegmap_group_sizze_27959;
    int64_t eWiseAddMultEntryzisegmap_group_sizze_27981;
    int64_t eWiseAddMultEntryzisegmap_group_sizze_28037;
    int64_t eWiseAddMultEntryzisegmap_group_sizze_28093;
    int64_t eWiseAddMultEntryzisegmap_group_sizze_28099;
    int64_t eWiseAddMultEntryzisegred_group_sizze_28974;
    int64_t eWiseAddMultEntryzisegred_group_sizze_29057;
    int64_t eWiseAddMultEntryzisegred_num_groups_28972;
    int64_t eWiseAddMultEntryzisegred_num_groups_29055;
    int64_t eWiseAddMultEntryzisegscan_group_sizze_27817;
    int64_t eWiseAddMultEntryzisegscan_group_sizze_27825;
    int64_t eWiseAddMultEntryzisegscan_group_sizze_27943;
    int64_t eWiseAddMultEntryzisegscan_group_sizze_27963;
    int64_t eWiseAddMultEntryzisegscan_group_sizze_27971;
    int64_t eWiseAddMultEntryzisegscan_group_sizze_28083;
    int64_t eWiseAddMultEntryzisegscan_num_groups_27819;
    int64_t eWiseAddMultEntryzisegscan_num_groups_27827;
    int64_t eWiseAddMultEntryzisegscan_num_groups_27945;
    int64_t eWiseAddMultEntryzisegscan_num_groups_27965;
    int64_t eWiseAddMultEntryzisegscan_num_groups_27973;
    int64_t eWiseAddMultEntryzisegscan_num_groups_28085;
    int64_t eWiseMultEntryzisegmap_group_sizze_27695;
    int64_t eWiseMultEntryzisegmap_group_sizze_27751;
    int64_t eWiseMultEntryzisegmap_group_sizze_27807;
    int64_t eWiseMultEntryzisegmap_group_sizze_27813;
    int64_t eWiseMultEntryzisegred_group_sizze_28891;
    int64_t eWiseMultEntryzisegred_num_groups_28889;
    int64_t eWiseMultEntryzisegscan_group_sizze_27677;
    int64_t eWiseMultEntryzisegscan_group_sizze_27685;
    int64_t eWiseMultEntryzisegscan_group_sizze_27797;
    int64_t eWiseMultEntryzisegscan_num_groups_27679;
    int64_t eWiseMultEntryzisegscan_num_groups_27687;
    int64_t eWiseMultEntryzisegscan_num_groups_27799;
} ;
struct futhark_context_config {
    struct cuda_config cu_cfg;
    int profiling;
    int64_t sizes[52];
    int num_nvrtc_opts;
    const char **nvrtc_opts;
} ;
struct futhark_context_config *futhark_context_config_new(void)
{
    struct futhark_context_config *cfg =
                                  (struct futhark_context_config *) malloc(sizeof(struct futhark_context_config));
    
    if (cfg == NULL)
        return NULL;
    cfg->profiling = 0;
    cfg->num_nvrtc_opts = 0;
    cfg->nvrtc_opts = (const char **) malloc(sizeof(const char *));
    cfg->nvrtc_opts[0] = NULL;
    cfg->sizes[0] = 0;
    cfg->sizes[1] = 0;
    cfg->sizes[2] = 0;
    cfg->sizes[3] = 0;
    cfg->sizes[4] = 0;
    cfg->sizes[5] = 0;
    cfg->sizes[6] = 0;
    cfg->sizes[7] = 0;
    cfg->sizes[8] = 0;
    cfg->sizes[9] = 0;
    cfg->sizes[10] = 0;
    cfg->sizes[11] = 0;
    cfg->sizes[12] = 0;
    cfg->sizes[13] = 0;
    cfg->sizes[14] = 0;
    cfg->sizes[15] = 0;
    cfg->sizes[16] = 0;
    cfg->sizes[17] = 0;
    cfg->sizes[18] = 0;
    cfg->sizes[19] = 0;
    cfg->sizes[20] = 0;
    cfg->sizes[21] = 0;
    cfg->sizes[22] = 0;
    cfg->sizes[23] = 0;
    cfg->sizes[24] = 0;
    cfg->sizes[25] = 0;
    cfg->sizes[26] = 0;
    cfg->sizes[27] = 0;
    cfg->sizes[28] = 0;
    cfg->sizes[29] = 0;
    cfg->sizes[30] = 0;
    cfg->sizes[31] = 0;
    cfg->sizes[32] = 0;
    cfg->sizes[33] = 0;
    cfg->sizes[34] = 0;
    cfg->sizes[35] = 0;
    cfg->sizes[36] = 0;
    cfg->sizes[37] = 0;
    cfg->sizes[38] = 0;
    cfg->sizes[39] = 0;
    cfg->sizes[40] = 0;
    cfg->sizes[41] = 0;
    cfg->sizes[42] = 0;
    cfg->sizes[43] = 0;
    cfg->sizes[44] = 0;
    cfg->sizes[45] = 0;
    cfg->sizes[46] = 0;
    cfg->sizes[47] = 0;
    cfg->sizes[48] = 0;
    cfg->sizes[49] = 0;
    cfg->sizes[50] = 0;
    cfg->sizes[51] = 0;
    cuda_config_init(&cfg->cu_cfg, 52, size_names, size_vars, cfg->sizes,
                     size_classes);
    return cfg;
}
void futhark_context_config_free(struct futhark_context_config *cfg)
{
    free(cfg->nvrtc_opts);
    free(cfg);
}
void futhark_context_config_add_nvrtc_option(struct futhark_context_config *cfg,
                                             const char *opt)
{
    cfg->nvrtc_opts[cfg->num_nvrtc_opts] = opt;
    cfg->num_nvrtc_opts++;
    cfg->nvrtc_opts = (const char **) realloc(cfg->nvrtc_opts,
                                              (cfg->num_nvrtc_opts + 1) *
                                              sizeof(const char *));
    cfg->nvrtc_opts[cfg->num_nvrtc_opts] = NULL;
}
void futhark_context_config_set_debugging(struct futhark_context_config *cfg,
                                          int flag)
{
    cfg->cu_cfg.logging = cfg->cu_cfg.debugging = flag;
}
void futhark_context_config_set_profiling(struct futhark_context_config *cfg,
                                          int flag)
{
    cfg->profiling = flag;
}
void futhark_context_config_set_logging(struct futhark_context_config *cfg,
                                        int flag)
{
    cfg->cu_cfg.logging = flag;
}
void futhark_context_config_set_device(struct futhark_context_config *cfg, const
                                       char *s)
{
    set_preferred_device(&cfg->cu_cfg, s);
}
void futhark_context_config_dump_program_to(struct futhark_context_config *cfg,
                                            const char *path)
{
    cfg->cu_cfg.dump_program_to = path;
}
void futhark_context_config_load_program_from(struct futhark_context_config *cfg,
                                              const char *path)
{
    cfg->cu_cfg.load_program_from = path;
}
void futhark_context_config_dump_ptx_to(struct futhark_context_config *cfg,
                                        const char *path)
{
    cfg->cu_cfg.dump_ptx_to = path;
}
void futhark_context_config_load_ptx_from(struct futhark_context_config *cfg,
                                          const char *path)
{
    cfg->cu_cfg.load_ptx_from = path;
}
void futhark_context_config_set_default_group_size(struct futhark_context_config *cfg,
                                                   int size)
{
    cfg->cu_cfg.default_block_size = size;
    cfg->cu_cfg.default_block_size_changed = 1;
}
void futhark_context_config_set_default_num_groups(struct futhark_context_config *cfg,
                                                   int num)
{
    cfg->cu_cfg.default_grid_size = num;
    cfg->cu_cfg.default_grid_size_changed = 1;
}
void futhark_context_config_set_default_tile_size(struct futhark_context_config *cfg,
                                                  int size)
{
    cfg->cu_cfg.default_tile_size = size;
    cfg->cu_cfg.default_tile_size_changed = 1;
}
void futhark_context_config_set_default_threshold(struct futhark_context_config *cfg,
                                                  int size)
{
    cfg->cu_cfg.default_threshold = size;
}
int futhark_context_config_set_size(struct futhark_context_config *cfg, const
                                    char *size_name, size_t size_value)
{
    for (int i = 0; i < 52; i++) {
        if (strcmp(size_name, size_names[i]) == 0) {
            cfg->sizes[i] = size_value;
            return 0;
        }
    }
    if (strcmp(size_name, "default_group_size") == 0) {
        cfg->cu_cfg.default_block_size = size_value;
        return 0;
    }
    if (strcmp(size_name, "default_num_groups") == 0) {
        cfg->cu_cfg.default_grid_size = size_value;
        return 0;
    }
    if (strcmp(size_name, "default_threshold") == 0) {
        cfg->cu_cfg.default_threshold = size_value;
        return 0;
    }
    if (strcmp(size_name, "default_tile_size") == 0) {
        cfg->cu_cfg.default_tile_size = size_value;
        return 0;
    }
    return 1;
}
struct futhark_context {
    int detail_memory;
    int debugging;
    int profiling;
    int profiling_paused;
    lock_t lock;
    char *error;
    int64_t peak_mem_usage_device;
    int64_t cur_mem_usage_device;
    int64_t peak_mem_usage_default;
    int64_t cur_mem_usage_default;
    struct {
        int dummy;
    } constants;
    struct memblock_device eWiseAddEntryzicounter_mem_29125;
    struct memblock_device eWiseAddEntryziid_counter_mem_29173;
    struct memblock_device eWiseAddEntryziid_counter_mem_29319;
    struct memblock_device eWiseAddEntryziid_counter_mem_29542;
    struct memblock_device eWiseAddMultEntryzicounter_mem_29125;
    struct memblock_device eWiseAddMultEntryziid_counter_mem_29173;
    struct memblock_device eWiseAddMultEntryziid_counter_mem_29319;
    struct memblock_device eWiseAddMultEntryziid_counter_mem_29542;
    struct memblock_device eWiseAddMultEntryzicounter_mem_29632;
    struct memblock_device eWiseAddMultEntryziid_counter_mem_29680;
    struct memblock_device eWiseAddMultEntryziid_counter_mem_29789;
    struct memblock_device eWiseAddMultEntryziid_counter_mem_30012;
    struct memblock_device eWiseMultEntryzicounter_mem_29125;
    struct memblock_device eWiseMultEntryziid_counter_mem_29173;
    struct memblock_device eWiseMultEntryziid_counter_mem_29319;
    struct memblock_device eWiseMultEntryziid_counter_mem_29542;
    CUfunction builtinzhiota_i64ziiota_i64_29305;
    int64_t builtinzhiota_i64ziiota_i64_29305_total_runtime;
    int builtinzhiota_i64ziiota_i64_29305_runs;
    CUfunction builtinzhreplicate_f64zireplicate_29284;
    int64_t builtinzhreplicate_f64zireplicate_29284_total_runtime;
    int builtinzhreplicate_f64zireplicate_29284_runs;
    CUfunction builtinzhreplicate_i64zireplicate_29293;
    int64_t builtinzhreplicate_i64zireplicate_29293_total_runtime;
    int builtinzhreplicate_i64zireplicate_29293_runs;
    CUfunction builtinzhreplicate_i8zireplicate_29185;
    int64_t builtinzhreplicate_i8zireplicate_29185_total_runtime;
    int builtinzhreplicate_i8zireplicate_29185_runs;
    CUfunction eWiseAddEntryzisegmap_27547;
    int64_t eWiseAddEntryzisegmap_27547_total_runtime;
    int eWiseAddEntryzisegmap_27547_runs;
    CUfunction eWiseAddEntryzisegmap_27606;
    int64_t eWiseAddEntryzisegmap_27606_total_runtime;
    int eWiseAddEntryzisegmap_27606_runs;
    CUfunction eWiseAddEntryzisegmap_27665;
    int64_t eWiseAddEntryzisegmap_27665_total_runtime;
    int eWiseAddEntryzisegmap_27665_runs;
    CUfunction eWiseAddEntryzisegmap_27671;
    int64_t eWiseAddEntryzisegmap_27671_total_runtime;
    int eWiseAddEntryzisegmap_27671_runs;
    CUfunction eWiseAddEntryzisegred_nonseg_28815;
    int64_t eWiseAddEntryzisegred_nonseg_28815_total_runtime;
    int eWiseAddEntryzisegred_nonseg_28815_runs;
    CUfunction eWiseAddEntryzisegscan_27537;
    int64_t eWiseAddEntryzisegscan_27537_total_runtime;
    int eWiseAddEntryzisegscan_27537_runs;
    CUfunction eWiseAddEntryzisegscan_27545;
    int64_t eWiseAddEntryzisegscan_27545_total_runtime;
    int eWiseAddEntryzisegscan_27545_runs;
    CUfunction eWiseAddEntryzisegscan_27663;
    int64_t eWiseAddEntryzisegscan_27663_total_runtime;
    int eWiseAddEntryzisegscan_27663_runs;
    CUfunction eWiseAddMultEntryzisegmap_27833;
    int64_t eWiseAddMultEntryzisegmap_27833_total_runtime;
    int eWiseAddMultEntryzisegmap_27833_runs;
    CUfunction eWiseAddMultEntryzisegmap_27892;
    int64_t eWiseAddMultEntryzisegmap_27892_total_runtime;
    int eWiseAddMultEntryzisegmap_27892_runs;
    CUfunction eWiseAddMultEntryzisegmap_27951;
    int64_t eWiseAddMultEntryzisegmap_27951_total_runtime;
    int eWiseAddMultEntryzisegmap_27951_runs;
    CUfunction eWiseAddMultEntryzisegmap_27957;
    int64_t eWiseAddMultEntryzisegmap_27957_total_runtime;
    int eWiseAddMultEntryzisegmap_27957_runs;
    CUfunction eWiseAddMultEntryzisegmap_27979;
    int64_t eWiseAddMultEntryzisegmap_27979_total_runtime;
    int eWiseAddMultEntryzisegmap_27979_runs;
    CUfunction eWiseAddMultEntryzisegmap_28035;
    int64_t eWiseAddMultEntryzisegmap_28035_total_runtime;
    int eWiseAddMultEntryzisegmap_28035_runs;
    CUfunction eWiseAddMultEntryzisegmap_28091;
    int64_t eWiseAddMultEntryzisegmap_28091_total_runtime;
    int eWiseAddMultEntryzisegmap_28091_runs;
    CUfunction eWiseAddMultEntryzisegmap_28097;
    int64_t eWiseAddMultEntryzisegmap_28097_total_runtime;
    int eWiseAddMultEntryzisegmap_28097_runs;
    CUfunction eWiseAddMultEntryzisegred_nonseg_28981;
    int64_t eWiseAddMultEntryzisegred_nonseg_28981_total_runtime;
    int eWiseAddMultEntryzisegred_nonseg_28981_runs;
    CUfunction eWiseAddMultEntryzisegred_nonseg_29064;
    int64_t eWiseAddMultEntryzisegred_nonseg_29064_total_runtime;
    int eWiseAddMultEntryzisegred_nonseg_29064_runs;
    CUfunction eWiseAddMultEntryzisegscan_27823;
    int64_t eWiseAddMultEntryzisegscan_27823_total_runtime;
    int eWiseAddMultEntryzisegscan_27823_runs;
    CUfunction eWiseAddMultEntryzisegscan_27831;
    int64_t eWiseAddMultEntryzisegscan_27831_total_runtime;
    int eWiseAddMultEntryzisegscan_27831_runs;
    CUfunction eWiseAddMultEntryzisegscan_27949;
    int64_t eWiseAddMultEntryzisegscan_27949_total_runtime;
    int eWiseAddMultEntryzisegscan_27949_runs;
    CUfunction eWiseAddMultEntryzisegscan_27969;
    int64_t eWiseAddMultEntryzisegscan_27969_total_runtime;
    int eWiseAddMultEntryzisegscan_27969_runs;
    CUfunction eWiseAddMultEntryzisegscan_27977;
    int64_t eWiseAddMultEntryzisegscan_27977_total_runtime;
    int eWiseAddMultEntryzisegscan_27977_runs;
    CUfunction eWiseAddMultEntryzisegscan_28089;
    int64_t eWiseAddMultEntryzisegscan_28089_total_runtime;
    int eWiseAddMultEntryzisegscan_28089_runs;
    CUfunction eWiseMultEntryzisegmap_27693;
    int64_t eWiseMultEntryzisegmap_27693_total_runtime;
    int eWiseMultEntryzisegmap_27693_runs;
    CUfunction eWiseMultEntryzisegmap_27749;
    int64_t eWiseMultEntryzisegmap_27749_total_runtime;
    int eWiseMultEntryzisegmap_27749_runs;
    CUfunction eWiseMultEntryzisegmap_27805;
    int64_t eWiseMultEntryzisegmap_27805_total_runtime;
    int eWiseMultEntryzisegmap_27805_runs;
    CUfunction eWiseMultEntryzisegmap_27811;
    int64_t eWiseMultEntryzisegmap_27811_total_runtime;
    int eWiseMultEntryzisegmap_27811_runs;
    CUfunction eWiseMultEntryzisegred_nonseg_28898;
    int64_t eWiseMultEntryzisegred_nonseg_28898_total_runtime;
    int eWiseMultEntryzisegred_nonseg_28898_runs;
    CUfunction eWiseMultEntryzisegscan_27683;
    int64_t eWiseMultEntryzisegscan_27683_total_runtime;
    int eWiseMultEntryzisegscan_27683_runs;
    CUfunction eWiseMultEntryzisegscan_27691;
    int64_t eWiseMultEntryzisegscan_27691_total_runtime;
    int eWiseMultEntryzisegscan_27691_runs;
    CUfunction eWiseMultEntryzisegscan_27803;
    int64_t eWiseMultEntryzisegscan_27803_total_runtime;
    int eWiseMultEntryzisegscan_27803_runs;
    int64_t copy_dev_to_dev_total_runtime;
    int copy_dev_to_dev_runs;
    int64_t copy_dev_to_host_total_runtime;
    int copy_dev_to_host_runs;
    int64_t copy_host_to_dev_total_runtime;
    int copy_host_to_dev_runs;
    int64_t copy_scalar_to_dev_total_runtime;
    int copy_scalar_to_dev_runs;
    int64_t copy_scalar_from_dev_total_runtime;
    int copy_scalar_from_dev_runs;
    CUdeviceptr global_failure;
    CUdeviceptr global_failure_args;
    struct cuda_context cuda;
    struct sizes sizes;
    int32_t failure_is_an_option;
    int total_runs;
    long total_runtime;
} ;
struct futhark_context *futhark_context_new(struct futhark_context_config *cfg)
{
    struct futhark_context *ctx =
                           (struct futhark_context *) malloc(sizeof(struct futhark_context));
    
    if (ctx == NULL)
        return NULL;
    ctx->debugging = ctx->detail_memory = cfg->cu_cfg.debugging;
    ctx->profiling = cfg->profiling;
    ctx->profiling_paused = 0;
    ctx->error = NULL;
    ctx->cuda.profiling_records_capacity = 200;
    ctx->cuda.profiling_records_used = 0;
    ctx->cuda.profiling_records = malloc(ctx->cuda.profiling_records_capacity *
        sizeof(struct profiling_record));
    ctx->cuda.cfg = cfg->cu_cfg;
    create_lock(&ctx->lock);
    ctx->failure_is_an_option = 0;
    ctx->total_runs = 0;
    ctx->total_runtime = 0;
    ctx->peak_mem_usage_device = 0;
    ctx->cur_mem_usage_device = 0;
    ctx->peak_mem_usage_default = 0;
    ctx->cur_mem_usage_default = 0;
    cuda_setup(&ctx->cuda, cuda_program, cfg->nvrtc_opts);
    
    int32_t no_error = -1;
    
    CUDA_SUCCEED(cuMemAlloc(&ctx->global_failure, sizeof(no_error)));
    CUDA_SUCCEED(cuMemcpyHtoD(ctx->global_failure, &no_error,
                              sizeof(no_error)));
    // The +1 is to avoid zero-byte allocations.
    CUDA_SUCCEED(cuMemAlloc(&ctx->global_failure_args, sizeof(int64_t) * (3 +
                                                                          1)));
    CUDA_SUCCEED(cuModuleGetFunction(&ctx->builtinzhiota_i64ziiota_i64_29305,
                                     ctx->cuda.module,
                                     "builtinzhiota_i64ziiota_i64_29305"));
    ctx->builtinzhiota_i64ziiota_i64_29305_total_runtime = 0;
    ctx->builtinzhiota_i64ziiota_i64_29305_runs = 0;
    CUDA_SUCCEED(cuModuleGetFunction(&ctx->builtinzhreplicate_f64zireplicate_29284,
                                     ctx->cuda.module,
                                     "builtinzhreplicate_f64zireplicate_29284"));
    ctx->builtinzhreplicate_f64zireplicate_29284_total_runtime = 0;
    ctx->builtinzhreplicate_f64zireplicate_29284_runs = 0;
    CUDA_SUCCEED(cuModuleGetFunction(&ctx->builtinzhreplicate_i64zireplicate_29293,
                                     ctx->cuda.module,
                                     "builtinzhreplicate_i64zireplicate_29293"));
    ctx->builtinzhreplicate_i64zireplicate_29293_total_runtime = 0;
    ctx->builtinzhreplicate_i64zireplicate_29293_runs = 0;
    CUDA_SUCCEED(cuModuleGetFunction(&ctx->builtinzhreplicate_i8zireplicate_29185,
                                     ctx->cuda.module,
                                     "builtinzhreplicate_i8zireplicate_29185"));
    ctx->builtinzhreplicate_i8zireplicate_29185_total_runtime = 0;
    ctx->builtinzhreplicate_i8zireplicate_29185_runs = 0;
    CUDA_SUCCEED(cuModuleGetFunction(&ctx->eWiseAddEntryzisegmap_27547,
                                     ctx->cuda.module,
                                     "eWiseAddEntryzisegmap_27547"));
    ctx->eWiseAddEntryzisegmap_27547_total_runtime = 0;
    ctx->eWiseAddEntryzisegmap_27547_runs = 0;
    CUDA_SUCCEED(cuModuleGetFunction(&ctx->eWiseAddEntryzisegmap_27606,
                                     ctx->cuda.module,
                                     "eWiseAddEntryzisegmap_27606"));
    ctx->eWiseAddEntryzisegmap_27606_total_runtime = 0;
    ctx->eWiseAddEntryzisegmap_27606_runs = 0;
    CUDA_SUCCEED(cuModuleGetFunction(&ctx->eWiseAddEntryzisegmap_27665,
                                     ctx->cuda.module,
                                     "eWiseAddEntryzisegmap_27665"));
    ctx->eWiseAddEntryzisegmap_27665_total_runtime = 0;
    ctx->eWiseAddEntryzisegmap_27665_runs = 0;
    CUDA_SUCCEED(cuModuleGetFunction(&ctx->eWiseAddEntryzisegmap_27671,
                                     ctx->cuda.module,
                                     "eWiseAddEntryzisegmap_27671"));
    ctx->eWiseAddEntryzisegmap_27671_total_runtime = 0;
    ctx->eWiseAddEntryzisegmap_27671_runs = 0;
    CUDA_SUCCEED(cuModuleGetFunction(&ctx->eWiseAddEntryzisegred_nonseg_28815,
                                     ctx->cuda.module,
                                     "eWiseAddEntryzisegred_nonseg_28815"));
    ctx->eWiseAddEntryzisegred_nonseg_28815_total_runtime = 0;
    ctx->eWiseAddEntryzisegred_nonseg_28815_runs = 0;
    CUDA_SUCCEED(cuModuleGetFunction(&ctx->eWiseAddEntryzisegscan_27537,
                                     ctx->cuda.module,
                                     "eWiseAddEntryzisegscan_27537"));
    ctx->eWiseAddEntryzisegscan_27537_total_runtime = 0;
    ctx->eWiseAddEntryzisegscan_27537_runs = 0;
    CUDA_SUCCEED(cuModuleGetFunction(&ctx->eWiseAddEntryzisegscan_27545,
                                     ctx->cuda.module,
                                     "eWiseAddEntryzisegscan_27545"));
    ctx->eWiseAddEntryzisegscan_27545_total_runtime = 0;
    ctx->eWiseAddEntryzisegscan_27545_runs = 0;
    CUDA_SUCCEED(cuModuleGetFunction(&ctx->eWiseAddEntryzisegscan_27663,
                                     ctx->cuda.module,
                                     "eWiseAddEntryzisegscan_27663"));
    ctx->eWiseAddEntryzisegscan_27663_total_runtime = 0;
    ctx->eWiseAddEntryzisegscan_27663_runs = 0;
    CUDA_SUCCEED(cuModuleGetFunction(&ctx->eWiseAddMultEntryzisegmap_27833,
                                     ctx->cuda.module,
                                     "eWiseAddMultEntryzisegmap_27833"));
    ctx->eWiseAddMultEntryzisegmap_27833_total_runtime = 0;
    ctx->eWiseAddMultEntryzisegmap_27833_runs = 0;
    CUDA_SUCCEED(cuModuleGetFunction(&ctx->eWiseAddMultEntryzisegmap_27892,
                                     ctx->cuda.module,
                                     "eWiseAddMultEntryzisegmap_27892"));
    ctx->eWiseAddMultEntryzisegmap_27892_total_runtime = 0;
    ctx->eWiseAddMultEntryzisegmap_27892_runs = 0;
    CUDA_SUCCEED(cuModuleGetFunction(&ctx->eWiseAddMultEntryzisegmap_27951,
                                     ctx->cuda.module,
                                     "eWiseAddMultEntryzisegmap_27951"));
    ctx->eWiseAddMultEntryzisegmap_27951_total_runtime = 0;
    ctx->eWiseAddMultEntryzisegmap_27951_runs = 0;
    CUDA_SUCCEED(cuModuleGetFunction(&ctx->eWiseAddMultEntryzisegmap_27957,
                                     ctx->cuda.module,
                                     "eWiseAddMultEntryzisegmap_27957"));
    ctx->eWiseAddMultEntryzisegmap_27957_total_runtime = 0;
    ctx->eWiseAddMultEntryzisegmap_27957_runs = 0;
    CUDA_SUCCEED(cuModuleGetFunction(&ctx->eWiseAddMultEntryzisegmap_27979,
                                     ctx->cuda.module,
                                     "eWiseAddMultEntryzisegmap_27979"));
    ctx->eWiseAddMultEntryzisegmap_27979_total_runtime = 0;
    ctx->eWiseAddMultEntryzisegmap_27979_runs = 0;
    CUDA_SUCCEED(cuModuleGetFunction(&ctx->eWiseAddMultEntryzisegmap_28035,
                                     ctx->cuda.module,
                                     "eWiseAddMultEntryzisegmap_28035"));
    ctx->eWiseAddMultEntryzisegmap_28035_total_runtime = 0;
    ctx->eWiseAddMultEntryzisegmap_28035_runs = 0;
    CUDA_SUCCEED(cuModuleGetFunction(&ctx->eWiseAddMultEntryzisegmap_28091,
                                     ctx->cuda.module,
                                     "eWiseAddMultEntryzisegmap_28091"));
    ctx->eWiseAddMultEntryzisegmap_28091_total_runtime = 0;
    ctx->eWiseAddMultEntryzisegmap_28091_runs = 0;
    CUDA_SUCCEED(cuModuleGetFunction(&ctx->eWiseAddMultEntryzisegmap_28097,
                                     ctx->cuda.module,
                                     "eWiseAddMultEntryzisegmap_28097"));
    ctx->eWiseAddMultEntryzisegmap_28097_total_runtime = 0;
    ctx->eWiseAddMultEntryzisegmap_28097_runs = 0;
    CUDA_SUCCEED(cuModuleGetFunction(&ctx->eWiseAddMultEntryzisegred_nonseg_28981,
                                     ctx->cuda.module,
                                     "eWiseAddMultEntryzisegred_nonseg_28981"));
    ctx->eWiseAddMultEntryzisegred_nonseg_28981_total_runtime = 0;
    ctx->eWiseAddMultEntryzisegred_nonseg_28981_runs = 0;
    CUDA_SUCCEED(cuModuleGetFunction(&ctx->eWiseAddMultEntryzisegred_nonseg_29064,
                                     ctx->cuda.module,
                                     "eWiseAddMultEntryzisegred_nonseg_29064"));
    ctx->eWiseAddMultEntryzisegred_nonseg_29064_total_runtime = 0;
    ctx->eWiseAddMultEntryzisegred_nonseg_29064_runs = 0;
    CUDA_SUCCEED(cuModuleGetFunction(&ctx->eWiseAddMultEntryzisegscan_27823,
                                     ctx->cuda.module,
                                     "eWiseAddMultEntryzisegscan_27823"));
    ctx->eWiseAddMultEntryzisegscan_27823_total_runtime = 0;
    ctx->eWiseAddMultEntryzisegscan_27823_runs = 0;
    CUDA_SUCCEED(cuModuleGetFunction(&ctx->eWiseAddMultEntryzisegscan_27831,
                                     ctx->cuda.module,
                                     "eWiseAddMultEntryzisegscan_27831"));
    ctx->eWiseAddMultEntryzisegscan_27831_total_runtime = 0;
    ctx->eWiseAddMultEntryzisegscan_27831_runs = 0;
    CUDA_SUCCEED(cuModuleGetFunction(&ctx->eWiseAddMultEntryzisegscan_27949,
                                     ctx->cuda.module,
                                     "eWiseAddMultEntryzisegscan_27949"));
    ctx->eWiseAddMultEntryzisegscan_27949_total_runtime = 0;
    ctx->eWiseAddMultEntryzisegscan_27949_runs = 0;
    CUDA_SUCCEED(cuModuleGetFunction(&ctx->eWiseAddMultEntryzisegscan_27969,
                                     ctx->cuda.module,
                                     "eWiseAddMultEntryzisegscan_27969"));
    ctx->eWiseAddMultEntryzisegscan_27969_total_runtime = 0;
    ctx->eWiseAddMultEntryzisegscan_27969_runs = 0;
    CUDA_SUCCEED(cuModuleGetFunction(&ctx->eWiseAddMultEntryzisegscan_27977,
                                     ctx->cuda.module,
                                     "eWiseAddMultEntryzisegscan_27977"));
    ctx->eWiseAddMultEntryzisegscan_27977_total_runtime = 0;
    ctx->eWiseAddMultEntryzisegscan_27977_runs = 0;
    CUDA_SUCCEED(cuModuleGetFunction(&ctx->eWiseAddMultEntryzisegscan_28089,
                                     ctx->cuda.module,
                                     "eWiseAddMultEntryzisegscan_28089"));
    ctx->eWiseAddMultEntryzisegscan_28089_total_runtime = 0;
    ctx->eWiseAddMultEntryzisegscan_28089_runs = 0;
    CUDA_SUCCEED(cuModuleGetFunction(&ctx->eWiseMultEntryzisegmap_27693,
                                     ctx->cuda.module,
                                     "eWiseMultEntryzisegmap_27693"));
    ctx->eWiseMultEntryzisegmap_27693_total_runtime = 0;
    ctx->eWiseMultEntryzisegmap_27693_runs = 0;
    CUDA_SUCCEED(cuModuleGetFunction(&ctx->eWiseMultEntryzisegmap_27749,
                                     ctx->cuda.module,
                                     "eWiseMultEntryzisegmap_27749"));
    ctx->eWiseMultEntryzisegmap_27749_total_runtime = 0;
    ctx->eWiseMultEntryzisegmap_27749_runs = 0;
    CUDA_SUCCEED(cuModuleGetFunction(&ctx->eWiseMultEntryzisegmap_27805,
                                     ctx->cuda.module,
                                     "eWiseMultEntryzisegmap_27805"));
    ctx->eWiseMultEntryzisegmap_27805_total_runtime = 0;
    ctx->eWiseMultEntryzisegmap_27805_runs = 0;
    CUDA_SUCCEED(cuModuleGetFunction(&ctx->eWiseMultEntryzisegmap_27811,
                                     ctx->cuda.module,
                                     "eWiseMultEntryzisegmap_27811"));
    ctx->eWiseMultEntryzisegmap_27811_total_runtime = 0;
    ctx->eWiseMultEntryzisegmap_27811_runs = 0;
    CUDA_SUCCEED(cuModuleGetFunction(&ctx->eWiseMultEntryzisegred_nonseg_28898,
                                     ctx->cuda.module,
                                     "eWiseMultEntryzisegred_nonseg_28898"));
    ctx->eWiseMultEntryzisegred_nonseg_28898_total_runtime = 0;
    ctx->eWiseMultEntryzisegred_nonseg_28898_runs = 0;
    CUDA_SUCCEED(cuModuleGetFunction(&ctx->eWiseMultEntryzisegscan_27683,
                                     ctx->cuda.module,
                                     "eWiseMultEntryzisegscan_27683"));
    ctx->eWiseMultEntryzisegscan_27683_total_runtime = 0;
    ctx->eWiseMultEntryzisegscan_27683_runs = 0;
    CUDA_SUCCEED(cuModuleGetFunction(&ctx->eWiseMultEntryzisegscan_27691,
                                     ctx->cuda.module,
                                     "eWiseMultEntryzisegscan_27691"));
    ctx->eWiseMultEntryzisegscan_27691_total_runtime = 0;
    ctx->eWiseMultEntryzisegscan_27691_runs = 0;
    CUDA_SUCCEED(cuModuleGetFunction(&ctx->eWiseMultEntryzisegscan_27803,
                                     ctx->cuda.module,
                                     "eWiseMultEntryzisegscan_27803"));
    ctx->eWiseMultEntryzisegscan_27803_total_runtime = 0;
    ctx->eWiseMultEntryzisegscan_27803_runs = 0;
    ctx->copy_dev_to_dev_total_runtime = 0;
    ctx->copy_dev_to_dev_runs = 0;
    ctx->copy_dev_to_host_total_runtime = 0;
    ctx->copy_dev_to_host_runs = 0;
    ctx->copy_host_to_dev_total_runtime = 0;
    ctx->copy_host_to_dev_runs = 0;
    ctx->copy_scalar_to_dev_total_runtime = 0;
    ctx->copy_scalar_to_dev_runs = 0;
    ctx->copy_scalar_from_dev_total_runtime = 0;
    ctx->copy_scalar_from_dev_runs = 0;
    {
        ctx->eWiseAddEntryzicounter_mem_29125.references = NULL;
        ctx->eWiseAddEntryzicounter_mem_29125.size = 0;
        CUDA_SUCCEED(cuMemAlloc(&ctx->eWiseAddEntryzicounter_mem_29125.mem,
                                (10 > 0 ? 10 : 1) * sizeof(int32_t)));
        if (10 > 0)
            CUDA_SUCCEED(cuMemcpyHtoD(ctx->eWiseAddEntryzicounter_mem_29125.mem,
                                      eWiseAddEntryzicounter_mem_realtype_30122,
                                      10 * sizeof(int32_t)));
    }
    {
        ctx->eWiseAddEntryziid_counter_mem_29173.references = NULL;
        ctx->eWiseAddEntryziid_counter_mem_29173.size = 0;
        CUDA_SUCCEED(cuMemAlloc(&ctx->eWiseAddEntryziid_counter_mem_29173.mem,
                                (1 > 0 ? 1 : 1) * sizeof(int32_t)));
        if (1 > 0)
            CUDA_SUCCEED(cuMemcpyHtoD(ctx->eWiseAddEntryziid_counter_mem_29173.mem,
                                      eWiseAddEntryziid_counter_mem_realtype_30146,
                                      1 * sizeof(int32_t)));
    }
    {
        ctx->eWiseAddEntryziid_counter_mem_29319.references = NULL;
        ctx->eWiseAddEntryziid_counter_mem_29319.size = 0;
        CUDA_SUCCEED(cuMemAlloc(&ctx->eWiseAddEntryziid_counter_mem_29319.mem,
                                (1 > 0 ? 1 : 1) * sizeof(int32_t)));
        if (1 > 0)
            CUDA_SUCCEED(cuMemcpyHtoD(ctx->eWiseAddEntryziid_counter_mem_29319.mem,
                                      eWiseAddEntryziid_counter_mem_realtype_30174,
                                      1 * sizeof(int32_t)));
    }
    {
        ctx->eWiseAddEntryziid_counter_mem_29542.references = NULL;
        ctx->eWiseAddEntryziid_counter_mem_29542.size = 0;
        CUDA_SUCCEED(cuMemAlloc(&ctx->eWiseAddEntryziid_counter_mem_29542.mem,
                                (1 > 0 ? 1 : 1) * sizeof(int32_t)));
        if (1 > 0)
            CUDA_SUCCEED(cuMemcpyHtoD(ctx->eWiseAddEntryziid_counter_mem_29542.mem,
                                      eWiseAddEntryziid_counter_mem_realtype_30221,
                                      1 * sizeof(int32_t)));
    }
    {
        ctx->eWiseAddMultEntryzicounter_mem_29125.references = NULL;
        ctx->eWiseAddMultEntryzicounter_mem_29125.size = 0;
        CUDA_SUCCEED(cuMemAlloc(&ctx->eWiseAddMultEntryzicounter_mem_29125.mem,
                                (10 > 0 ? 10 : 1) * sizeof(int32_t)));
        if (10 > 0)
            CUDA_SUCCEED(cuMemcpyHtoD(ctx->eWiseAddMultEntryzicounter_mem_29125.mem,
                                      eWiseAddMultEntryzicounter_mem_realtype_30273,
                                      10 * sizeof(int32_t)));
    }
    {
        ctx->eWiseAddMultEntryziid_counter_mem_29173.references = NULL;
        ctx->eWiseAddMultEntryziid_counter_mem_29173.size = 0;
        CUDA_SUCCEED(cuMemAlloc(&ctx->eWiseAddMultEntryziid_counter_mem_29173.mem,
                                (1 > 0 ? 1 : 1) * sizeof(int32_t)));
        if (1 > 0)
            CUDA_SUCCEED(cuMemcpyHtoD(ctx->eWiseAddMultEntryziid_counter_mem_29173.mem,
                                      eWiseAddMultEntryziid_counter_mem_realtype_30297,
                                      1 * sizeof(int32_t)));
    }
    {
        ctx->eWiseAddMultEntryziid_counter_mem_29319.references = NULL;
        ctx->eWiseAddMultEntryziid_counter_mem_29319.size = 0;
        CUDA_SUCCEED(cuMemAlloc(&ctx->eWiseAddMultEntryziid_counter_mem_29319.mem,
                                (1 > 0 ? 1 : 1) * sizeof(int32_t)));
        if (1 > 0)
            CUDA_SUCCEED(cuMemcpyHtoD(ctx->eWiseAddMultEntryziid_counter_mem_29319.mem,
                                      eWiseAddMultEntryziid_counter_mem_realtype_30325,
                                      1 * sizeof(int32_t)));
    }
    {
        ctx->eWiseAddMultEntryziid_counter_mem_29542.references = NULL;
        ctx->eWiseAddMultEntryziid_counter_mem_29542.size = 0;
        CUDA_SUCCEED(cuMemAlloc(&ctx->eWiseAddMultEntryziid_counter_mem_29542.mem,
                                (1 > 0 ? 1 : 1) * sizeof(int32_t)));
        if (1 > 0)
            CUDA_SUCCEED(cuMemcpyHtoD(ctx->eWiseAddMultEntryziid_counter_mem_29542.mem,
                                      eWiseAddMultEntryziid_counter_mem_realtype_30372,
                                      1 * sizeof(int32_t)));
    }
    {
        ctx->eWiseAddMultEntryzicounter_mem_29632.references = NULL;
        ctx->eWiseAddMultEntryzicounter_mem_29632.size = 0;
        CUDA_SUCCEED(cuMemAlloc(&ctx->eWiseAddMultEntryzicounter_mem_29632.mem,
                                (10 > 0 ? 10 : 1) * sizeof(int32_t)));
        if (10 > 0)
            CUDA_SUCCEED(cuMemcpyHtoD(ctx->eWiseAddMultEntryzicounter_mem_29632.mem,
                                      eWiseAddMultEntryzicounter_mem_realtype_30419,
                                      10 * sizeof(int32_t)));
    }
    {
        ctx->eWiseAddMultEntryziid_counter_mem_29680.references = NULL;
        ctx->eWiseAddMultEntryziid_counter_mem_29680.size = 0;
        CUDA_SUCCEED(cuMemAlloc(&ctx->eWiseAddMultEntryziid_counter_mem_29680.mem,
                                (1 > 0 ? 1 : 1) * sizeof(int32_t)));
        if (1 > 0)
            CUDA_SUCCEED(cuMemcpyHtoD(ctx->eWiseAddMultEntryziid_counter_mem_29680.mem,
                                      eWiseAddMultEntryziid_counter_mem_realtype_30443,
                                      1 * sizeof(int32_t)));
    }
    {
        ctx->eWiseAddMultEntryziid_counter_mem_29789.references = NULL;
        ctx->eWiseAddMultEntryziid_counter_mem_29789.size = 0;
        CUDA_SUCCEED(cuMemAlloc(&ctx->eWiseAddMultEntryziid_counter_mem_29789.mem,
                                (1 > 0 ? 1 : 1) * sizeof(int32_t)));
        if (1 > 0)
            CUDA_SUCCEED(cuMemcpyHtoD(ctx->eWiseAddMultEntryziid_counter_mem_29789.mem,
                                      eWiseAddMultEntryziid_counter_mem_realtype_30471,
                                      1 * sizeof(int32_t)));
    }
    {
        ctx->eWiseAddMultEntryziid_counter_mem_30012.references = NULL;
        ctx->eWiseAddMultEntryziid_counter_mem_30012.size = 0;
        CUDA_SUCCEED(cuMemAlloc(&ctx->eWiseAddMultEntryziid_counter_mem_30012.mem,
                                (1 > 0 ? 1 : 1) * sizeof(int32_t)));
        if (1 > 0)
            CUDA_SUCCEED(cuMemcpyHtoD(ctx->eWiseAddMultEntryziid_counter_mem_30012.mem,
                                      eWiseAddMultEntryziid_counter_mem_realtype_30517,
                                      1 * sizeof(int32_t)));
    }
    {
        ctx->eWiseMultEntryzicounter_mem_29125.references = NULL;
        ctx->eWiseMultEntryzicounter_mem_29125.size = 0;
        CUDA_SUCCEED(cuMemAlloc(&ctx->eWiseMultEntryzicounter_mem_29125.mem,
                                (10 > 0 ? 10 : 1) * sizeof(int32_t)));
        if (10 > 0)
            CUDA_SUCCEED(cuMemcpyHtoD(ctx->eWiseMultEntryzicounter_mem_29125.mem,
                                      eWiseMultEntryzicounter_mem_realtype_30564,
                                      10 * sizeof(int32_t)));
    }
    {
        ctx->eWiseMultEntryziid_counter_mem_29173.references = NULL;
        ctx->eWiseMultEntryziid_counter_mem_29173.size = 0;
        CUDA_SUCCEED(cuMemAlloc(&ctx->eWiseMultEntryziid_counter_mem_29173.mem,
                                (1 > 0 ? 1 : 1) * sizeof(int32_t)));
        if (1 > 0)
            CUDA_SUCCEED(cuMemcpyHtoD(ctx->eWiseMultEntryziid_counter_mem_29173.mem,
                                      eWiseMultEntryziid_counter_mem_realtype_30588,
                                      1 * sizeof(int32_t)));
    }
    {
        ctx->eWiseMultEntryziid_counter_mem_29319.references = NULL;
        ctx->eWiseMultEntryziid_counter_mem_29319.size = 0;
        CUDA_SUCCEED(cuMemAlloc(&ctx->eWiseMultEntryziid_counter_mem_29319.mem,
                                (1 > 0 ? 1 : 1) * sizeof(int32_t)));
        if (1 > 0)
            CUDA_SUCCEED(cuMemcpyHtoD(ctx->eWiseMultEntryziid_counter_mem_29319.mem,
                                      eWiseMultEntryziid_counter_mem_realtype_30616,
                                      1 * sizeof(int32_t)));
    }
    {
        ctx->eWiseMultEntryziid_counter_mem_29542.references = NULL;
        ctx->eWiseMultEntryziid_counter_mem_29542.size = 0;
        CUDA_SUCCEED(cuMemAlloc(&ctx->eWiseMultEntryziid_counter_mem_29542.mem,
                                (1 > 0 ? 1 : 1) * sizeof(int32_t)));
        if (1 > 0)
            CUDA_SUCCEED(cuMemcpyHtoD(ctx->eWiseMultEntryziid_counter_mem_29542.mem,
                                      eWiseMultEntryziid_counter_mem_realtype_30662,
                                      1 * sizeof(int32_t)));
    }
    ctx->sizes.builtinzhiota_i64zigroup_sizze_29308 = cfg->sizes[0];
    ctx->sizes.builtinzhreplicate_f64zigroup_sizze_29287 = cfg->sizes[1];
    ctx->sizes.builtinzhreplicate_i64zigroup_sizze_29296 = cfg->sizes[2];
    ctx->sizes.builtinzhreplicate_i8zigroup_sizze_29188 = cfg->sizes[3];
    ctx->sizes.eWiseAddEntryzisegmap_group_sizze_27549 = cfg->sizes[4];
    ctx->sizes.eWiseAddEntryzisegmap_group_sizze_27608 = cfg->sizes[5];
    ctx->sizes.eWiseAddEntryzisegmap_group_sizze_27667 = cfg->sizes[6];
    ctx->sizes.eWiseAddEntryzisegmap_group_sizze_27673 = cfg->sizes[7];
    ctx->sizes.eWiseAddEntryzisegred_group_sizze_28808 = cfg->sizes[8];
    ctx->sizes.eWiseAddEntryzisegred_num_groups_28806 = cfg->sizes[9];
    ctx->sizes.eWiseAddEntryzisegscan_group_sizze_27531 = cfg->sizes[10];
    ctx->sizes.eWiseAddEntryzisegscan_group_sizze_27539 = cfg->sizes[11];
    ctx->sizes.eWiseAddEntryzisegscan_group_sizze_27657 = cfg->sizes[12];
    ctx->sizes.eWiseAddEntryzisegscan_num_groups_27533 = cfg->sizes[13];
    ctx->sizes.eWiseAddEntryzisegscan_num_groups_27541 = cfg->sizes[14];
    ctx->sizes.eWiseAddEntryzisegscan_num_groups_27659 = cfg->sizes[15];
    ctx->sizes.eWiseAddMultEntryzisegmap_group_sizze_27835 = cfg->sizes[16];
    ctx->sizes.eWiseAddMultEntryzisegmap_group_sizze_27894 = cfg->sizes[17];
    ctx->sizes.eWiseAddMultEntryzisegmap_group_sizze_27953 = cfg->sizes[18];
    ctx->sizes.eWiseAddMultEntryzisegmap_group_sizze_27959 = cfg->sizes[19];
    ctx->sizes.eWiseAddMultEntryzisegmap_group_sizze_27981 = cfg->sizes[20];
    ctx->sizes.eWiseAddMultEntryzisegmap_group_sizze_28037 = cfg->sizes[21];
    ctx->sizes.eWiseAddMultEntryzisegmap_group_sizze_28093 = cfg->sizes[22];
    ctx->sizes.eWiseAddMultEntryzisegmap_group_sizze_28099 = cfg->sizes[23];
    ctx->sizes.eWiseAddMultEntryzisegred_group_sizze_28974 = cfg->sizes[24];
    ctx->sizes.eWiseAddMultEntryzisegred_group_sizze_29057 = cfg->sizes[25];
    ctx->sizes.eWiseAddMultEntryzisegred_num_groups_28972 = cfg->sizes[26];
    ctx->sizes.eWiseAddMultEntryzisegred_num_groups_29055 = cfg->sizes[27];
    ctx->sizes.eWiseAddMultEntryzisegscan_group_sizze_27817 = cfg->sizes[28];
    ctx->sizes.eWiseAddMultEntryzisegscan_group_sizze_27825 = cfg->sizes[29];
    ctx->sizes.eWiseAddMultEntryzisegscan_group_sizze_27943 = cfg->sizes[30];
    ctx->sizes.eWiseAddMultEntryzisegscan_group_sizze_27963 = cfg->sizes[31];
    ctx->sizes.eWiseAddMultEntryzisegscan_group_sizze_27971 = cfg->sizes[32];
    ctx->sizes.eWiseAddMultEntryzisegscan_group_sizze_28083 = cfg->sizes[33];
    ctx->sizes.eWiseAddMultEntryzisegscan_num_groups_27819 = cfg->sizes[34];
    ctx->sizes.eWiseAddMultEntryzisegscan_num_groups_27827 = cfg->sizes[35];
    ctx->sizes.eWiseAddMultEntryzisegscan_num_groups_27945 = cfg->sizes[36];
    ctx->sizes.eWiseAddMultEntryzisegscan_num_groups_27965 = cfg->sizes[37];
    ctx->sizes.eWiseAddMultEntryzisegscan_num_groups_27973 = cfg->sizes[38];
    ctx->sizes.eWiseAddMultEntryzisegscan_num_groups_28085 = cfg->sizes[39];
    ctx->sizes.eWiseMultEntryzisegmap_group_sizze_27695 = cfg->sizes[40];
    ctx->sizes.eWiseMultEntryzisegmap_group_sizze_27751 = cfg->sizes[41];
    ctx->sizes.eWiseMultEntryzisegmap_group_sizze_27807 = cfg->sizes[42];
    ctx->sizes.eWiseMultEntryzisegmap_group_sizze_27813 = cfg->sizes[43];
    ctx->sizes.eWiseMultEntryzisegred_group_sizze_28891 = cfg->sizes[44];
    ctx->sizes.eWiseMultEntryzisegred_num_groups_28889 = cfg->sizes[45];
    ctx->sizes.eWiseMultEntryzisegscan_group_sizze_27677 = cfg->sizes[46];
    ctx->sizes.eWiseMultEntryzisegscan_group_sizze_27685 = cfg->sizes[47];
    ctx->sizes.eWiseMultEntryzisegscan_group_sizze_27797 = cfg->sizes[48];
    ctx->sizes.eWiseMultEntryzisegscan_num_groups_27679 = cfg->sizes[49];
    ctx->sizes.eWiseMultEntryzisegscan_num_groups_27687 = cfg->sizes[50];
    ctx->sizes.eWiseMultEntryzisegscan_num_groups_27799 = cfg->sizes[51];
    init_constants(ctx);
    // Clear the free list of any deallocations that occurred while initialising constants.
    CUDA_SUCCEED(cuda_free_all(&ctx->cuda));
    futhark_context_sync(ctx);
    return ctx;
}
void futhark_context_free(struct futhark_context *ctx)
{
    free_constants(ctx);
    cuda_cleanup(&ctx->cuda);
    free_lock(&ctx->lock);
    free(ctx);
}
int futhark_context_sync(struct futhark_context *ctx)
{
    CUDA_SUCCEED(cuCtxPushCurrent(ctx->cuda.cu_ctx));
    CUDA_SUCCEED(cuCtxSynchronize());
    if (ctx->failure_is_an_option) {
        int32_t failure_idx;
        
        CUDA_SUCCEED(cuMemcpyDtoH(&failure_idx, ctx->global_failure,
                                  sizeof(int32_t)));
        ctx->failure_is_an_option = 0;
        if (failure_idx >= 0) {
            int32_t no_failure = -1;
            
            CUDA_SUCCEED(cuMemcpyHtoD(ctx->global_failure, &no_failure,
                                      sizeof(int32_t)));
            
            int64_t args[3 + 1];
            
            CUDA_SUCCEED(cuMemcpyDtoH(&args, ctx->global_failure_args,
                                      sizeof(args)));
            switch (failure_idx) {
                
              case 0:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:112:58-78\n   #1  /prelude/soacs.fut:56:19-23\n   #2  /prelude/soacs.fut:56:3-37\n   #3  sparse.fut:109:19-114:50\n   #4  sparse.fut:131:23-48\n   #5  sparse.fut:219:17-59\n   #6  sparse.fut:210:1-220:48\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 1:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:111:53-72\n   #1  /prelude/soacs.fut:56:19-23\n   #2  /prelude/soacs.fut:56:3-37\n   #3  sparse.fut:109:19-114:50\n   #4  sparse.fut:131:23-48\n   #5  sparse.fut:219:17-59\n   #6  sparse.fut:210:1-220:48\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 2:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:112:58-78\n   #1  /prelude/soacs.fut:56:19-23\n   #2  /prelude/soacs.fut:56:3-37\n   #3  sparse.fut:109:19-114:50\n   #4  sparse.fut:131:23-48\n   #5  sparse.fut:219:17-59\n   #6  sparse.fut:210:1-220:48\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 3:
                {
                    ctx->error =
                        msgprintf("Index [%lld:%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:112:44-82\n   #1  /prelude/soacs.fut:56:19-23\n   #2  /prelude/soacs.fut:56:3-37\n   #3  sparse.fut:109:19-114:50\n   #4  sparse.fut:131:23-48\n   #5  sparse.fut:219:17-59\n   #6  sparse.fut:210:1-220:48\n",
                                  args[0], args[1], args[2]);
                    break;
                }
                
              case 4:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:111:53-72\n   #1  /prelude/soacs.fut:56:19-23\n   #2  /prelude/soacs.fut:56:3-37\n   #3  sparse.fut:109:19-114:50\n   #4  sparse.fut:131:23-48\n   #5  sparse.fut:219:17-59\n   #6  sparse.fut:210:1-220:48\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 5:
                {
                    ctx->error =
                        msgprintf("Index [%lld:%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:111:40-76\n   #1  /prelude/soacs.fut:56:19-23\n   #2  /prelude/soacs.fut:56:3-37\n   #3  sparse.fut:109:19-114:50\n   #4  sparse.fut:131:23-48\n   #5  sparse.fut:219:17-59\n   #6  sparse.fut:210:1-220:48\n",
                                  args[0], args[1], args[2]);
                    break;
                }
                
              case 6:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  /prelude/array.fut:18:29-34\n   #1  lib/github.com/diku-dk/sorts/radix_sort.fut:25:24-35\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:53:31-62\n   #3  sparse.fut:3:25-4:48\n   #4  sparse.fut:40:12-24\n   #5  sparse.fut:111:30-112:82\n   #6  /prelude/soacs.fut:56:19-23\n   #7  /prelude/soacs.fut:56:3-37\n   #8  sparse.fut:109:19-114:50\n   #9  sparse.fut:131:23-48\n   #10 sparse.fut:219:17-59\n   #11 sparse.fut:210:1-220:48\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 7:
                {
                    ctx->error =
                        msgprintf("Index [%lld:] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:43:97-106\n   #1  sparse.fut:111:30-112:82\n   #2  /prelude/soacs.fut:56:19-23\n   #3  /prelude/soacs.fut:56:3-37\n   #4  sparse.fut:109:19-114:50\n   #5  sparse.fut:131:23-48\n   #6  sparse.fut:219:17-59\n   #7  sparse.fut:210:1-220:48\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 8:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:43:41-51\n   #1  sparse.fut:43:4-106\n   #2  sparse.fut:111:30-112:82\n   #3  /prelude/soacs.fut:56:19-23\n   #4  /prelude/soacs.fut:56:3-37\n   #5  sparse.fut:109:19-114:50\n   #6  sparse.fut:131:23-48\n   #7  sparse.fut:219:17-59\n   #8  sparse.fut:210:1-220:48\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 9:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  lib/github.com/diku-dk/sorts/radix_sort.fut:62:28-32\n   #1  /prelude/functional.fut:9:42-44\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:59:3-62:33\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:68:3-51\n   #4  sparse.fut:5:34-6:77\n   #5  sparse.fut:53:12-35\n   #6  sparse.fut:138:59-140:81\n   #7  sparse.fut:219:17-59\n   #8  sparse.fut:210:1-220:48\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 10:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:60:63-73\n   #1  sparse.fut:58:33-68:55\n   #2  sparse.fut:138:59-140:81\n   #3  sparse.fut:219:17-59\n   #4  sparse.fut:210:1-220:48\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 11:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:63:59-69\n   #1  sparse.fut:58:33-68:55\n   #2  sparse.fut:138:59-140:81\n   #3  sparse.fut:219:17-59\n   #4  sparse.fut:210:1-220:48\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 12:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:65:67-77\n   #1  sparse.fut:58:33-68:55\n   #2  sparse.fut:138:59-140:81\n   #3  sparse.fut:219:17-59\n   #4  sparse.fut:210:1-220:48\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 13:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:67:59-69\n   #1  sparse.fut:58:33-68:55\n   #2  sparse.fut:138:59-140:81\n   #3  sparse.fut:219:17-59\n   #4  sparse.fut:210:1-220:48\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 14:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:148:37-47\n   #1  sparse.fut:147:26-154:63\n   #2  sparse.fut:219:17-59\n   #3  sparse.fut:210:1-220:48\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 15:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:150:39-85\n   #1  sparse.fut:147:26-154:63\n   #2  sparse.fut:219:17-59\n   #3  sparse.fut:210:1-220:48\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 16:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:149:46-90\n   #1  sparse.fut:147:26-154:63\n   #2  sparse.fut:219:17-59\n   #3  sparse.fut:210:1-220:48\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 17:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:152:39-83\n   #1  sparse.fut:147:26-154:63\n   #2  sparse.fut:219:17-59\n   #3  sparse.fut:210:1-220:48\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 18:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:153:39-85\n   #1  sparse.fut:147:26-154:63\n   #2  sparse.fut:219:17-59\n   #3  sparse.fut:210:1-220:48\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 19:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:112:58-78\n   #1  /prelude/soacs.fut:56:19-23\n   #2  /prelude/soacs.fut:56:3-37\n   #3  sparse.fut:109:19-114:50\n   #4  sparse.fut:131:23-48\n   #5  sparse.fut:243:20-62\n   #6  sparse.fut:234:1-247:60\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 20:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:111:53-72\n   #1  /prelude/soacs.fut:56:19-23\n   #2  /prelude/soacs.fut:56:3-37\n   #3  sparse.fut:109:19-114:50\n   #4  sparse.fut:131:23-48\n   #5  sparse.fut:243:20-62\n   #6  sparse.fut:234:1-247:60\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 21:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:112:58-78\n   #1  /prelude/soacs.fut:56:19-23\n   #2  /prelude/soacs.fut:56:3-37\n   #3  sparse.fut:109:19-114:50\n   #4  sparse.fut:131:23-48\n   #5  sparse.fut:243:20-62\n   #6  sparse.fut:234:1-247:60\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 22:
                {
                    ctx->error =
                        msgprintf("Index [%lld:%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:112:44-82\n   #1  /prelude/soacs.fut:56:19-23\n   #2  /prelude/soacs.fut:56:3-37\n   #3  sparse.fut:109:19-114:50\n   #4  sparse.fut:131:23-48\n   #5  sparse.fut:243:20-62\n   #6  sparse.fut:234:1-247:60\n",
                                  args[0], args[1], args[2]);
                    break;
                }
                
              case 23:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:111:53-72\n   #1  /prelude/soacs.fut:56:19-23\n   #2  /prelude/soacs.fut:56:3-37\n   #3  sparse.fut:109:19-114:50\n   #4  sparse.fut:131:23-48\n   #5  sparse.fut:243:20-62\n   #6  sparse.fut:234:1-247:60\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 24:
                {
                    ctx->error =
                        msgprintf("Index [%lld:%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:111:40-76\n   #1  /prelude/soacs.fut:56:19-23\n   #2  /prelude/soacs.fut:56:3-37\n   #3  sparse.fut:109:19-114:50\n   #4  sparse.fut:131:23-48\n   #5  sparse.fut:243:20-62\n   #6  sparse.fut:234:1-247:60\n",
                                  args[0], args[1], args[2]);
                    break;
                }
                
              case 25:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  /prelude/array.fut:18:29-34\n   #1  lib/github.com/diku-dk/sorts/radix_sort.fut:25:24-35\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:53:31-62\n   #3  sparse.fut:3:25-4:48\n   #4  sparse.fut:40:12-24\n   #5  sparse.fut:111:30-112:82\n   #6  /prelude/soacs.fut:56:19-23\n   #7  /prelude/soacs.fut:56:3-37\n   #8  sparse.fut:109:19-114:50\n   #9  sparse.fut:131:23-48\n   #10 sparse.fut:243:20-62\n   #11 sparse.fut:234:1-247:60\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 26:
                {
                    ctx->error =
                        msgprintf("Index [%lld:] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:43:97-106\n   #1  sparse.fut:111:30-112:82\n   #2  /prelude/soacs.fut:56:19-23\n   #3  /prelude/soacs.fut:56:3-37\n   #4  sparse.fut:109:19-114:50\n   #5  sparse.fut:131:23-48\n   #6  sparse.fut:243:20-62\n   #7  sparse.fut:234:1-247:60\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 27:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:43:41-51\n   #1  sparse.fut:43:4-106\n   #2  sparse.fut:111:30-112:82\n   #3  /prelude/soacs.fut:56:19-23\n   #4  /prelude/soacs.fut:56:3-37\n   #5  sparse.fut:109:19-114:50\n   #6  sparse.fut:131:23-48\n   #7  sparse.fut:243:20-62\n   #8  sparse.fut:234:1-247:60\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 28:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  lib/github.com/diku-dk/sorts/radix_sort.fut:62:28-32\n   #1  /prelude/functional.fut:9:42-44\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:59:3-62:33\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:68:3-51\n   #4  sparse.fut:5:34-6:77\n   #5  sparse.fut:53:12-35\n   #6  sparse.fut:138:59-140:81\n   #7  sparse.fut:243:20-62\n   #8  sparse.fut:234:1-247:60\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 29:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:60:63-73\n   #1  sparse.fut:58:33-68:55\n   #2  sparse.fut:138:59-140:81\n   #3  sparse.fut:243:20-62\n   #4  sparse.fut:234:1-247:60\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 30:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:63:59-69\n   #1  sparse.fut:58:33-68:55\n   #2  sparse.fut:138:59-140:81\n   #3  sparse.fut:243:20-62\n   #4  sparse.fut:234:1-247:60\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 31:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:65:67-77\n   #1  sparse.fut:58:33-68:55\n   #2  sparse.fut:138:59-140:81\n   #3  sparse.fut:243:20-62\n   #4  sparse.fut:234:1-247:60\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 32:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:67:59-69\n   #1  sparse.fut:58:33-68:55\n   #2  sparse.fut:138:59-140:81\n   #3  sparse.fut:243:20-62\n   #4  sparse.fut:234:1-247:60\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 33:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:148:37-47\n   #1  sparse.fut:147:26-154:63\n   #2  sparse.fut:243:20-62\n   #3  sparse.fut:234:1-247:60\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 34:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:150:39-85\n   #1  sparse.fut:147:26-154:63\n   #2  sparse.fut:243:20-62\n   #3  sparse.fut:234:1-247:60\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 35:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:149:46-90\n   #1  sparse.fut:147:26-154:63\n   #2  sparse.fut:243:20-62\n   #3  sparse.fut:234:1-247:60\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 36:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:152:39-83\n   #1  sparse.fut:147:26-154:63\n   #2  sparse.fut:243:20-62\n   #3  sparse.fut:234:1-247:60\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 37:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:153:39-85\n   #1  sparse.fut:147:26-154:63\n   #2  sparse.fut:243:20-62\n   #3  sparse.fut:234:1-247:60\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 38:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:123:58-78\n   #1  /prelude/soacs.fut:56:19-23\n   #2  /prelude/soacs.fut:56:3-37\n   #3  sparse.fut:120:19-125:50\n   #4  sparse.fut:162:23-49\n   #5  sparse.fut:245:21-96\n   #6  sparse.fut:234:1-247:60\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 39:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:122:57-76\n   #1  /prelude/soacs.fut:56:19-23\n   #2  /prelude/soacs.fut:56:3-37\n   #3  sparse.fut:120:19-125:50\n   #4  sparse.fut:162:23-49\n   #5  sparse.fut:245:21-96\n   #6  sparse.fut:234:1-247:60\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 40:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:123:58-78\n   #1  /prelude/soacs.fut:56:19-23\n   #2  /prelude/soacs.fut:56:3-37\n   #3  sparse.fut:120:19-125:50\n   #4  sparse.fut:162:23-49\n   #5  sparse.fut:245:21-96\n   #6  sparse.fut:234:1-247:60\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 41:
                {
                    ctx->error =
                        msgprintf("Index [%lld:%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:123:44-82\n   #1  /prelude/soacs.fut:56:19-23\n   #2  /prelude/soacs.fut:56:3-37\n   #3  sparse.fut:120:19-125:50\n   #4  sparse.fut:162:23-49\n   #5  sparse.fut:245:21-96\n   #6  sparse.fut:234:1-247:60\n",
                                  args[0], args[1], args[2]);
                    break;
                }
                
              case 42:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:122:57-76\n   #1  /prelude/soacs.fut:56:19-23\n   #2  /prelude/soacs.fut:56:3-37\n   #3  sparse.fut:120:19-125:50\n   #4  sparse.fut:162:23-49\n   #5  sparse.fut:245:21-96\n   #6  sparse.fut:234:1-247:60\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 43:
                {
                    ctx->error =
                        msgprintf("Index [%lld:%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:122:44-80\n   #1  /prelude/soacs.fut:56:19-23\n   #2  /prelude/soacs.fut:56:3-37\n   #3  sparse.fut:120:19-125:50\n   #4  sparse.fut:162:23-49\n   #5  sparse.fut:245:21-96\n   #6  sparse.fut:234:1-247:60\n",
                                  args[0], args[1], args[2]);
                    break;
                }
                
              case 44:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  /prelude/array.fut:18:29-34\n   #1  lib/github.com/diku-dk/sorts/radix_sort.fut:25:24-35\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:53:31-62\n   #3  sparse.fut:3:25-4:48\n   #4  sparse.fut:76:12-24\n   #5  sparse.fut:122:30-123:82\n   #6  /prelude/soacs.fut:56:19-23\n   #7  /prelude/soacs.fut:56:3-37\n   #8  sparse.fut:120:19-125:50\n   #9  sparse.fut:162:23-49\n   #10 sparse.fut:245:21-96\n   #11 sparse.fut:234:1-247:60\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 45:
                {
                    ctx->error =
                        msgprintf("Index [%lld:] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:79:97-106\n   #1  sparse.fut:122:30-123:82\n   #2  /prelude/soacs.fut:56:19-23\n   #3  /prelude/soacs.fut:56:3-37\n   #4  sparse.fut:120:19-125:50\n   #5  sparse.fut:162:23-49\n   #6  sparse.fut:245:21-96\n   #7  sparse.fut:234:1-247:60\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 46:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:79:41-51\n   #1  sparse.fut:79:4-106\n   #2  sparse.fut:122:30-123:82\n   #3  /prelude/soacs.fut:56:19-23\n   #4  /prelude/soacs.fut:56:3-37\n   #5  sparse.fut:120:19-125:50\n   #6  sparse.fut:162:23-49\n   #7  sparse.fut:245:21-96\n   #8  sparse.fut:234:1-247:60\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 47:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  lib/github.com/diku-dk/sorts/radix_sort.fut:62:28-32\n   #1  /prelude/functional.fut:9:42-44\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:59:3-62:33\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:68:3-51\n   #4  sparse.fut:5:34-6:77\n   #5  sparse.fut:86:12-35\n   #6  sparse.fut:169:49-171:81\n   #7  sparse.fut:245:21-96\n   #8  sparse.fut:234:1-247:60\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 48:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:91:47-57\n   #1  sparse.fut:90:31-100:68\n   #2  sparse.fut:169:49-171:81\n   #3  sparse.fut:245:21-96\n   #4  sparse.fut:234:1-247:60\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 49:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:180:58-76\n   #1  sparse.fut:178:26-181:63\n   #2  sparse.fut:245:21-96\n   #3  sparse.fut:234:1-247:60\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 50:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:180:33-79\n   #1  sparse.fut:178:26-181:63\n   #2  sparse.fut:245:21-96\n   #3  sparse.fut:234:1-247:60\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 51:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:179:33-77\n   #1  sparse.fut:178:26-181:63\n   #2  sparse.fut:245:21-96\n   #3  sparse.fut:234:1-247:60\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 52:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:123:58-78\n   #1  /prelude/soacs.fut:56:19-23\n   #2  /prelude/soacs.fut:56:3-37\n   #3  sparse.fut:120:19-125:50\n   #4  sparse.fut:162:23-49\n   #5  sparse.fut:231:17-60\n   #6  sparse.fut:222:1-232:48\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 53:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:122:57-76\n   #1  /prelude/soacs.fut:56:19-23\n   #2  /prelude/soacs.fut:56:3-37\n   #3  sparse.fut:120:19-125:50\n   #4  sparse.fut:162:23-49\n   #5  sparse.fut:231:17-60\n   #6  sparse.fut:222:1-232:48\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 54:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:123:58-78\n   #1  /prelude/soacs.fut:56:19-23\n   #2  /prelude/soacs.fut:56:3-37\n   #3  sparse.fut:120:19-125:50\n   #4  sparse.fut:162:23-49\n   #5  sparse.fut:231:17-60\n   #6  sparse.fut:222:1-232:48\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 55:
                {
                    ctx->error =
                        msgprintf("Index [%lld:%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:123:44-82\n   #1  /prelude/soacs.fut:56:19-23\n   #2  /prelude/soacs.fut:56:3-37\n   #3  sparse.fut:120:19-125:50\n   #4  sparse.fut:162:23-49\n   #5  sparse.fut:231:17-60\n   #6  sparse.fut:222:1-232:48\n",
                                  args[0], args[1], args[2]);
                    break;
                }
                
              case 56:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:122:57-76\n   #1  /prelude/soacs.fut:56:19-23\n   #2  /prelude/soacs.fut:56:3-37\n   #3  sparse.fut:120:19-125:50\n   #4  sparse.fut:162:23-49\n   #5  sparse.fut:231:17-60\n   #6  sparse.fut:222:1-232:48\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 57:
                {
                    ctx->error =
                        msgprintf("Index [%lld:%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:122:44-80\n   #1  /prelude/soacs.fut:56:19-23\n   #2  /prelude/soacs.fut:56:3-37\n   #3  sparse.fut:120:19-125:50\n   #4  sparse.fut:162:23-49\n   #5  sparse.fut:231:17-60\n   #6  sparse.fut:222:1-232:48\n",
                                  args[0], args[1], args[2]);
                    break;
                }
                
              case 58:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  /prelude/array.fut:18:29-34\n   #1  lib/github.com/diku-dk/sorts/radix_sort.fut:25:24-35\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:53:31-62\n   #3  sparse.fut:3:25-4:48\n   #4  sparse.fut:76:12-24\n   #5  sparse.fut:122:30-123:82\n   #6  /prelude/soacs.fut:56:19-23\n   #7  /prelude/soacs.fut:56:3-37\n   #8  sparse.fut:120:19-125:50\n   #9  sparse.fut:162:23-49\n   #10 sparse.fut:231:17-60\n   #11 sparse.fut:222:1-232:48\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 59:
                {
                    ctx->error =
                        msgprintf("Index [%lld:] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:79:97-106\n   #1  sparse.fut:122:30-123:82\n   #2  /prelude/soacs.fut:56:19-23\n   #3  /prelude/soacs.fut:56:3-37\n   #4  sparse.fut:120:19-125:50\n   #5  sparse.fut:162:23-49\n   #6  sparse.fut:231:17-60\n   #7  sparse.fut:222:1-232:48\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 60:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:79:41-51\n   #1  sparse.fut:79:4-106\n   #2  sparse.fut:122:30-123:82\n   #3  /prelude/soacs.fut:56:19-23\n   #4  /prelude/soacs.fut:56:3-37\n   #5  sparse.fut:120:19-125:50\n   #6  sparse.fut:162:23-49\n   #7  sparse.fut:231:17-60\n   #8  sparse.fut:222:1-232:48\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 61:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  lib/github.com/diku-dk/sorts/radix_sort.fut:62:28-32\n   #1  /prelude/functional.fut:9:42-44\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:59:3-62:33\n   #3  lib/github.com/diku-dk/sorts/radix_sort.fut:68:3-51\n   #4  sparse.fut:5:34-6:77\n   #5  sparse.fut:86:12-35\n   #6  sparse.fut:169:49-171:81\n   #7  sparse.fut:231:17-60\n   #8  sparse.fut:222:1-232:48\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 62:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:91:47-57\n   #1  sparse.fut:90:31-100:68\n   #2  sparse.fut:169:49-171:81\n   #3  sparse.fut:231:17-60\n   #4  sparse.fut:222:1-232:48\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 63:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:180:58-76\n   #1  sparse.fut:178:26-181:63\n   #2  sparse.fut:231:17-60\n   #3  sparse.fut:222:1-232:48\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 64:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:180:33-79\n   #1  sparse.fut:178:26-181:63\n   #2  sparse.fut:231:17-60\n   #3  sparse.fut:222:1-232:48\n",
                                  args[0], args[1]);
                    break;
                }
                
              case 65:
                {
                    ctx->error =
                        msgprintf("Index [%lld] out of bounds for array of shape [%lld].\n-> #0  sparse.fut:179:33-77\n   #1  sparse.fut:178:26-181:63\n   #2  sparse.fut:231:17-60\n   #3  sparse.fut:222:1-232:48\n",
                                  args[0], args[1]);
                    break;
                }
            }
            return 1;
        }
    }
    CUDA_SUCCEED(cuCtxPopCurrent(&ctx->cuda.cu_ctx));
    return 0;
}
int futhark_context_clear_caches(struct futhark_context *ctx)
{
    lock_lock(&ctx->lock);
    CUDA_SUCCEED(cuda_free_all(&ctx->cuda));
    lock_unlock(&ctx->lock);
    return 0;
}
static int memblock_unref_device(struct futhark_context *ctx,
                                 struct memblock_device *block, const
                                 char *desc)
{
    if (block->references != NULL) {
        *block->references -= 1;
        if (ctx->detail_memory)
            fprintf(stderr,
                    "Unreferencing block %s (allocated as %s) in %s: %d references remaining.\n",
                    desc, block->desc, "space 'device'", *block->references);
        if (*block->references == 0) {
            ctx->cur_mem_usage_device -= block->size;
            CUDA_SUCCEED(cuda_free(&ctx->cuda, block->mem, desc));
            free(block->references);
            if (ctx->detail_memory)
                fprintf(stderr,
                        "%lld bytes freed (now allocated: %lld bytes)\n",
                        (long long) block->size,
                        (long long) ctx->cur_mem_usage_device);
        }
        block->references = NULL;
    }
    return 0;
}
static int memblock_alloc_device(struct futhark_context *ctx,
                                 struct memblock_device *block, int64_t size,
                                 const char *desc)
{
    if (size < 0)
        futhark_panic(1,
                      "Negative allocation of %lld bytes attempted for %s in %s.\n",
                      (long long) size, desc, "space 'device'",
                      ctx->cur_mem_usage_device);
    
    int ret = memblock_unref_device(ctx, block, desc);
    
    ctx->cur_mem_usage_device += size;
    if (ctx->detail_memory)
        fprintf(stderr,
                "Allocating %lld bytes for %s in %s (then allocated: %lld bytes)",
                (long long) size, desc, "space 'device'",
                (long long) ctx->cur_mem_usage_device);
    if (ctx->cur_mem_usage_device > ctx->peak_mem_usage_device) {
        ctx->peak_mem_usage_device = ctx->cur_mem_usage_device;
        if (ctx->detail_memory)
            fprintf(stderr, " (new peak).\n");
    } else if (ctx->detail_memory)
        fprintf(stderr, ".\n");
    CUDA_SUCCEED(cuda_alloc(&ctx->cuda, size, desc, &block->mem));
    block->references = (int *) malloc(sizeof(int));
    *block->references = 1;
    block->size = size;
    block->desc = desc;
    return ret;
}
static int memblock_set_device(struct futhark_context *ctx,
                               struct memblock_device *lhs,
                               struct memblock_device *rhs, const
                               char *lhs_desc)
{
    int ret = memblock_unref_device(ctx, lhs, lhs_desc);
    
    if (rhs->references != NULL)
        (*rhs->references)++;
    *lhs = *rhs;
    return ret;
}
static int memblock_unref(struct futhark_context *ctx, struct memblock *block,
                          const char *desc)
{
    if (block->references != NULL) {
        *block->references -= 1;
        if (ctx->detail_memory)
            fprintf(stderr,
                    "Unreferencing block %s (allocated as %s) in %s: %d references remaining.\n",
                    desc, block->desc, "default space", *block->references);
        if (*block->references == 0) {
            ctx->cur_mem_usage_default -= block->size;
            free(block->mem);
            free(block->references);
            if (ctx->detail_memory)
                fprintf(stderr,
                        "%lld bytes freed (now allocated: %lld bytes)\n",
                        (long long) block->size,
                        (long long) ctx->cur_mem_usage_default);
        }
        block->references = NULL;
    }
    return 0;
}
static int memblock_alloc(struct futhark_context *ctx, struct memblock *block,
                          int64_t size, const char *desc)
{
    if (size < 0)
        futhark_panic(1,
                      "Negative allocation of %lld bytes attempted for %s in %s.\n",
                      (long long) size, desc, "default space",
                      ctx->cur_mem_usage_default);
    
    int ret = memblock_unref(ctx, block, desc);
    
    ctx->cur_mem_usage_default += size;
    if (ctx->detail_memory)
        fprintf(stderr,
                "Allocating %lld bytes for %s in %s (then allocated: %lld bytes)",
                (long long) size, desc, "default space",
                (long long) ctx->cur_mem_usage_default);
    if (ctx->cur_mem_usage_default > ctx->peak_mem_usage_default) {
        ctx->peak_mem_usage_default = ctx->cur_mem_usage_default;
        if (ctx->detail_memory)
            fprintf(stderr, " (new peak).\n");
    } else if (ctx->detail_memory)
        fprintf(stderr, ".\n");
    block->mem = (char *) malloc(size);
    block->references = (int *) malloc(sizeof(int));
    *block->references = 1;
    block->size = size;
    block->desc = desc;
    return ret;
}
static int memblock_set(struct futhark_context *ctx, struct memblock *lhs,
                        struct memblock *rhs, const char *lhs_desc)
{
    int ret = memblock_unref(ctx, lhs, lhs_desc);
    
    if (rhs->references != NULL)
        (*rhs->references)++;
    *lhs = *rhs;
    return ret;
}
char *futhark_context_report(struct futhark_context *ctx)
{
    struct str_builder builder;
    
    str_builder_init(&builder);
    if (ctx->detail_memory || ctx->profiling) {
        str_builder(&builder,
                    "Peak memory usage for space 'device': %lld bytes.\n",
                    (long long) ctx->peak_mem_usage_device);
        { }
    }
    if (ctx->profiling) {
        CUDA_SUCCEED(cuda_tally_profiling_records(&ctx->cuda));
        str_builder(&builder,
                    "copy_dev_to_dev                       ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->copy_dev_to_dev_runs,
                    (long) ctx->copy_dev_to_dev_total_runtime /
                    (ctx->copy_dev_to_dev_runs !=
                     0 ? ctx->copy_dev_to_dev_runs : 1),
                    (long) ctx->copy_dev_to_dev_total_runtime);
        ctx->total_runtime += ctx->copy_dev_to_dev_total_runtime;
        ctx->total_runs += ctx->copy_dev_to_dev_runs;
        str_builder(&builder,
                    "copy_dev_to_host                      ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->copy_dev_to_host_runs,
                    (long) ctx->copy_dev_to_host_total_runtime /
                    (ctx->copy_dev_to_host_runs !=
                     0 ? ctx->copy_dev_to_host_runs : 1),
                    (long) ctx->copy_dev_to_host_total_runtime);
        ctx->total_runtime += ctx->copy_dev_to_host_total_runtime;
        ctx->total_runs += ctx->copy_dev_to_host_runs;
        str_builder(&builder,
                    "copy_host_to_dev                      ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->copy_host_to_dev_runs,
                    (long) ctx->copy_host_to_dev_total_runtime /
                    (ctx->copy_host_to_dev_runs !=
                     0 ? ctx->copy_host_to_dev_runs : 1),
                    (long) ctx->copy_host_to_dev_total_runtime);
        ctx->total_runtime += ctx->copy_host_to_dev_total_runtime;
        ctx->total_runs += ctx->copy_host_to_dev_runs;
        str_builder(&builder,
                    "copy_scalar_to_dev                    ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->copy_scalar_to_dev_runs,
                    (long) ctx->copy_scalar_to_dev_total_runtime /
                    (ctx->copy_scalar_to_dev_runs !=
                     0 ? ctx->copy_scalar_to_dev_runs : 1),
                    (long) ctx->copy_scalar_to_dev_total_runtime);
        ctx->total_runtime += ctx->copy_scalar_to_dev_total_runtime;
        ctx->total_runs += ctx->copy_scalar_to_dev_runs;
        str_builder(&builder,
                    "copy_scalar_from_dev                  ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->copy_scalar_from_dev_runs,
                    (long) ctx->copy_scalar_from_dev_total_runtime /
                    (ctx->copy_scalar_from_dev_runs !=
                     0 ? ctx->copy_scalar_from_dev_runs : 1),
                    (long) ctx->copy_scalar_from_dev_total_runtime);
        ctx->total_runtime += ctx->copy_scalar_from_dev_total_runtime;
        ctx->total_runs += ctx->copy_scalar_from_dev_runs;
        str_builder(&builder,
                    "builtin#iota_i64.iota_i64_29305       ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->builtinzhiota_i64ziiota_i64_29305_runs,
                    (long) ctx->builtinzhiota_i64ziiota_i64_29305_total_runtime /
                    (ctx->builtinzhiota_i64ziiota_i64_29305_runs !=
                     0 ? ctx->builtinzhiota_i64ziiota_i64_29305_runs : 1),
                    (long) ctx->builtinzhiota_i64ziiota_i64_29305_total_runtime);
        ctx->total_runtime +=
            ctx->builtinzhiota_i64ziiota_i64_29305_total_runtime;
        ctx->total_runs += ctx->builtinzhiota_i64ziiota_i64_29305_runs;
        str_builder(&builder,
                    "builtin#replicate_f64.replicate_29284 ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->builtinzhreplicate_f64zireplicate_29284_runs,
                    (long) ctx->builtinzhreplicate_f64zireplicate_29284_total_runtime /
                    (ctx->builtinzhreplicate_f64zireplicate_29284_runs !=
                     0 ? ctx->builtinzhreplicate_f64zireplicate_29284_runs : 1),
                    (long) ctx->builtinzhreplicate_f64zireplicate_29284_total_runtime);
        ctx->total_runtime +=
            ctx->builtinzhreplicate_f64zireplicate_29284_total_runtime;
        ctx->total_runs += ctx->builtinzhreplicate_f64zireplicate_29284_runs;
        str_builder(&builder,
                    "builtin#replicate_i64.replicate_29293 ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->builtinzhreplicate_i64zireplicate_29293_runs,
                    (long) ctx->builtinzhreplicate_i64zireplicate_29293_total_runtime /
                    (ctx->builtinzhreplicate_i64zireplicate_29293_runs !=
                     0 ? ctx->builtinzhreplicate_i64zireplicate_29293_runs : 1),
                    (long) ctx->builtinzhreplicate_i64zireplicate_29293_total_runtime);
        ctx->total_runtime +=
            ctx->builtinzhreplicate_i64zireplicate_29293_total_runtime;
        ctx->total_runs += ctx->builtinzhreplicate_i64zireplicate_29293_runs;
        str_builder(&builder,
                    "builtin#replicate_i8.replicate_29185  ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->builtinzhreplicate_i8zireplicate_29185_runs,
                    (long) ctx->builtinzhreplicate_i8zireplicate_29185_total_runtime /
                    (ctx->builtinzhreplicate_i8zireplicate_29185_runs !=
                     0 ? ctx->builtinzhreplicate_i8zireplicate_29185_runs : 1),
                    (long) ctx->builtinzhreplicate_i8zireplicate_29185_total_runtime);
        ctx->total_runtime +=
            ctx->builtinzhreplicate_i8zireplicate_29185_total_runtime;
        ctx->total_runs += ctx->builtinzhreplicate_i8zireplicate_29185_runs;
        str_builder(&builder,
                    "eWiseAddEntry.segmap_27547            ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->eWiseAddEntryzisegmap_27547_runs,
                    (long) ctx->eWiseAddEntryzisegmap_27547_total_runtime /
                    (ctx->eWiseAddEntryzisegmap_27547_runs !=
                     0 ? ctx->eWiseAddEntryzisegmap_27547_runs : 1),
                    (long) ctx->eWiseAddEntryzisegmap_27547_total_runtime);
        ctx->total_runtime += ctx->eWiseAddEntryzisegmap_27547_total_runtime;
        ctx->total_runs += ctx->eWiseAddEntryzisegmap_27547_runs;
        str_builder(&builder,
                    "eWiseAddEntry.segmap_27606            ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->eWiseAddEntryzisegmap_27606_runs,
                    (long) ctx->eWiseAddEntryzisegmap_27606_total_runtime /
                    (ctx->eWiseAddEntryzisegmap_27606_runs !=
                     0 ? ctx->eWiseAddEntryzisegmap_27606_runs : 1),
                    (long) ctx->eWiseAddEntryzisegmap_27606_total_runtime);
        ctx->total_runtime += ctx->eWiseAddEntryzisegmap_27606_total_runtime;
        ctx->total_runs += ctx->eWiseAddEntryzisegmap_27606_runs;
        str_builder(&builder,
                    "eWiseAddEntry.segmap_27665            ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->eWiseAddEntryzisegmap_27665_runs,
                    (long) ctx->eWiseAddEntryzisegmap_27665_total_runtime /
                    (ctx->eWiseAddEntryzisegmap_27665_runs !=
                     0 ? ctx->eWiseAddEntryzisegmap_27665_runs : 1),
                    (long) ctx->eWiseAddEntryzisegmap_27665_total_runtime);
        ctx->total_runtime += ctx->eWiseAddEntryzisegmap_27665_total_runtime;
        ctx->total_runs += ctx->eWiseAddEntryzisegmap_27665_runs;
        str_builder(&builder,
                    "eWiseAddEntry.segmap_27671            ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->eWiseAddEntryzisegmap_27671_runs,
                    (long) ctx->eWiseAddEntryzisegmap_27671_total_runtime /
                    (ctx->eWiseAddEntryzisegmap_27671_runs !=
                     0 ? ctx->eWiseAddEntryzisegmap_27671_runs : 1),
                    (long) ctx->eWiseAddEntryzisegmap_27671_total_runtime);
        ctx->total_runtime += ctx->eWiseAddEntryzisegmap_27671_total_runtime;
        ctx->total_runs += ctx->eWiseAddEntryzisegmap_27671_runs;
        str_builder(&builder,
                    "eWiseAddEntry.segred_nonseg_28815     ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->eWiseAddEntryzisegred_nonseg_28815_runs,
                    (long) ctx->eWiseAddEntryzisegred_nonseg_28815_total_runtime /
                    (ctx->eWiseAddEntryzisegred_nonseg_28815_runs !=
                     0 ? ctx->eWiseAddEntryzisegred_nonseg_28815_runs : 1),
                    (long) ctx->eWiseAddEntryzisegred_nonseg_28815_total_runtime);
        ctx->total_runtime +=
            ctx->eWiseAddEntryzisegred_nonseg_28815_total_runtime;
        ctx->total_runs += ctx->eWiseAddEntryzisegred_nonseg_28815_runs;
        str_builder(&builder,
                    "eWiseAddEntry.segscan_27537           ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->eWiseAddEntryzisegscan_27537_runs,
                    (long) ctx->eWiseAddEntryzisegscan_27537_total_runtime /
                    (ctx->eWiseAddEntryzisegscan_27537_runs !=
                     0 ? ctx->eWiseAddEntryzisegscan_27537_runs : 1),
                    (long) ctx->eWiseAddEntryzisegscan_27537_total_runtime);
        ctx->total_runtime += ctx->eWiseAddEntryzisegscan_27537_total_runtime;
        ctx->total_runs += ctx->eWiseAddEntryzisegscan_27537_runs;
        str_builder(&builder,
                    "eWiseAddEntry.segscan_27545           ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->eWiseAddEntryzisegscan_27545_runs,
                    (long) ctx->eWiseAddEntryzisegscan_27545_total_runtime /
                    (ctx->eWiseAddEntryzisegscan_27545_runs !=
                     0 ? ctx->eWiseAddEntryzisegscan_27545_runs : 1),
                    (long) ctx->eWiseAddEntryzisegscan_27545_total_runtime);
        ctx->total_runtime += ctx->eWiseAddEntryzisegscan_27545_total_runtime;
        ctx->total_runs += ctx->eWiseAddEntryzisegscan_27545_runs;
        str_builder(&builder,
                    "eWiseAddEntry.segscan_27663           ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->eWiseAddEntryzisegscan_27663_runs,
                    (long) ctx->eWiseAddEntryzisegscan_27663_total_runtime /
                    (ctx->eWiseAddEntryzisegscan_27663_runs !=
                     0 ? ctx->eWiseAddEntryzisegscan_27663_runs : 1),
                    (long) ctx->eWiseAddEntryzisegscan_27663_total_runtime);
        ctx->total_runtime += ctx->eWiseAddEntryzisegscan_27663_total_runtime;
        ctx->total_runs += ctx->eWiseAddEntryzisegscan_27663_runs;
        str_builder(&builder,
                    "eWiseAddMultEntry.segmap_27833        ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->eWiseAddMultEntryzisegmap_27833_runs,
                    (long) ctx->eWiseAddMultEntryzisegmap_27833_total_runtime /
                    (ctx->eWiseAddMultEntryzisegmap_27833_runs !=
                     0 ? ctx->eWiseAddMultEntryzisegmap_27833_runs : 1),
                    (long) ctx->eWiseAddMultEntryzisegmap_27833_total_runtime);
        ctx->total_runtime +=
            ctx->eWiseAddMultEntryzisegmap_27833_total_runtime;
        ctx->total_runs += ctx->eWiseAddMultEntryzisegmap_27833_runs;
        str_builder(&builder,
                    "eWiseAddMultEntry.segmap_27892        ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->eWiseAddMultEntryzisegmap_27892_runs,
                    (long) ctx->eWiseAddMultEntryzisegmap_27892_total_runtime /
                    (ctx->eWiseAddMultEntryzisegmap_27892_runs !=
                     0 ? ctx->eWiseAddMultEntryzisegmap_27892_runs : 1),
                    (long) ctx->eWiseAddMultEntryzisegmap_27892_total_runtime);
        ctx->total_runtime +=
            ctx->eWiseAddMultEntryzisegmap_27892_total_runtime;
        ctx->total_runs += ctx->eWiseAddMultEntryzisegmap_27892_runs;
        str_builder(&builder,
                    "eWiseAddMultEntry.segmap_27951        ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->eWiseAddMultEntryzisegmap_27951_runs,
                    (long) ctx->eWiseAddMultEntryzisegmap_27951_total_runtime /
                    (ctx->eWiseAddMultEntryzisegmap_27951_runs !=
                     0 ? ctx->eWiseAddMultEntryzisegmap_27951_runs : 1),
                    (long) ctx->eWiseAddMultEntryzisegmap_27951_total_runtime);
        ctx->total_runtime +=
            ctx->eWiseAddMultEntryzisegmap_27951_total_runtime;
        ctx->total_runs += ctx->eWiseAddMultEntryzisegmap_27951_runs;
        str_builder(&builder,
                    "eWiseAddMultEntry.segmap_27957        ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->eWiseAddMultEntryzisegmap_27957_runs,
                    (long) ctx->eWiseAddMultEntryzisegmap_27957_total_runtime /
                    (ctx->eWiseAddMultEntryzisegmap_27957_runs !=
                     0 ? ctx->eWiseAddMultEntryzisegmap_27957_runs : 1),
                    (long) ctx->eWiseAddMultEntryzisegmap_27957_total_runtime);
        ctx->total_runtime +=
            ctx->eWiseAddMultEntryzisegmap_27957_total_runtime;
        ctx->total_runs += ctx->eWiseAddMultEntryzisegmap_27957_runs;
        str_builder(&builder,
                    "eWiseAddMultEntry.segmap_27979        ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->eWiseAddMultEntryzisegmap_27979_runs,
                    (long) ctx->eWiseAddMultEntryzisegmap_27979_total_runtime /
                    (ctx->eWiseAddMultEntryzisegmap_27979_runs !=
                     0 ? ctx->eWiseAddMultEntryzisegmap_27979_runs : 1),
                    (long) ctx->eWiseAddMultEntryzisegmap_27979_total_runtime);
        ctx->total_runtime +=
            ctx->eWiseAddMultEntryzisegmap_27979_total_runtime;
        ctx->total_runs += ctx->eWiseAddMultEntryzisegmap_27979_runs;
        str_builder(&builder,
                    "eWiseAddMultEntry.segmap_28035        ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->eWiseAddMultEntryzisegmap_28035_runs,
                    (long) ctx->eWiseAddMultEntryzisegmap_28035_total_runtime /
                    (ctx->eWiseAddMultEntryzisegmap_28035_runs !=
                     0 ? ctx->eWiseAddMultEntryzisegmap_28035_runs : 1),
                    (long) ctx->eWiseAddMultEntryzisegmap_28035_total_runtime);
        ctx->total_runtime +=
            ctx->eWiseAddMultEntryzisegmap_28035_total_runtime;
        ctx->total_runs += ctx->eWiseAddMultEntryzisegmap_28035_runs;
        str_builder(&builder,
                    "eWiseAddMultEntry.segmap_28091        ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->eWiseAddMultEntryzisegmap_28091_runs,
                    (long) ctx->eWiseAddMultEntryzisegmap_28091_total_runtime /
                    (ctx->eWiseAddMultEntryzisegmap_28091_runs !=
                     0 ? ctx->eWiseAddMultEntryzisegmap_28091_runs : 1),
                    (long) ctx->eWiseAddMultEntryzisegmap_28091_total_runtime);
        ctx->total_runtime +=
            ctx->eWiseAddMultEntryzisegmap_28091_total_runtime;
        ctx->total_runs += ctx->eWiseAddMultEntryzisegmap_28091_runs;
        str_builder(&builder,
                    "eWiseAddMultEntry.segmap_28097        ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->eWiseAddMultEntryzisegmap_28097_runs,
                    (long) ctx->eWiseAddMultEntryzisegmap_28097_total_runtime /
                    (ctx->eWiseAddMultEntryzisegmap_28097_runs !=
                     0 ? ctx->eWiseAddMultEntryzisegmap_28097_runs : 1),
                    (long) ctx->eWiseAddMultEntryzisegmap_28097_total_runtime);
        ctx->total_runtime +=
            ctx->eWiseAddMultEntryzisegmap_28097_total_runtime;
        ctx->total_runs += ctx->eWiseAddMultEntryzisegmap_28097_runs;
        str_builder(&builder,
                    "eWiseAddMultEntry.segred_nonseg_28981 ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->eWiseAddMultEntryzisegred_nonseg_28981_runs,
                    (long) ctx->eWiseAddMultEntryzisegred_nonseg_28981_total_runtime /
                    (ctx->eWiseAddMultEntryzisegred_nonseg_28981_runs !=
                     0 ? ctx->eWiseAddMultEntryzisegred_nonseg_28981_runs : 1),
                    (long) ctx->eWiseAddMultEntryzisegred_nonseg_28981_total_runtime);
        ctx->total_runtime +=
            ctx->eWiseAddMultEntryzisegred_nonseg_28981_total_runtime;
        ctx->total_runs += ctx->eWiseAddMultEntryzisegred_nonseg_28981_runs;
        str_builder(&builder,
                    "eWiseAddMultEntry.segred_nonseg_29064 ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->eWiseAddMultEntryzisegred_nonseg_29064_runs,
                    (long) ctx->eWiseAddMultEntryzisegred_nonseg_29064_total_runtime /
                    (ctx->eWiseAddMultEntryzisegred_nonseg_29064_runs !=
                     0 ? ctx->eWiseAddMultEntryzisegred_nonseg_29064_runs : 1),
                    (long) ctx->eWiseAddMultEntryzisegred_nonseg_29064_total_runtime);
        ctx->total_runtime +=
            ctx->eWiseAddMultEntryzisegred_nonseg_29064_total_runtime;
        ctx->total_runs += ctx->eWiseAddMultEntryzisegred_nonseg_29064_runs;
        str_builder(&builder,
                    "eWiseAddMultEntry.segscan_27823       ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->eWiseAddMultEntryzisegscan_27823_runs,
                    (long) ctx->eWiseAddMultEntryzisegscan_27823_total_runtime /
                    (ctx->eWiseAddMultEntryzisegscan_27823_runs !=
                     0 ? ctx->eWiseAddMultEntryzisegscan_27823_runs : 1),
                    (long) ctx->eWiseAddMultEntryzisegscan_27823_total_runtime);
        ctx->total_runtime +=
            ctx->eWiseAddMultEntryzisegscan_27823_total_runtime;
        ctx->total_runs += ctx->eWiseAddMultEntryzisegscan_27823_runs;
        str_builder(&builder,
                    "eWiseAddMultEntry.segscan_27831       ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->eWiseAddMultEntryzisegscan_27831_runs,
                    (long) ctx->eWiseAddMultEntryzisegscan_27831_total_runtime /
                    (ctx->eWiseAddMultEntryzisegscan_27831_runs !=
                     0 ? ctx->eWiseAddMultEntryzisegscan_27831_runs : 1),
                    (long) ctx->eWiseAddMultEntryzisegscan_27831_total_runtime);
        ctx->total_runtime +=
            ctx->eWiseAddMultEntryzisegscan_27831_total_runtime;
        ctx->total_runs += ctx->eWiseAddMultEntryzisegscan_27831_runs;
        str_builder(&builder,
                    "eWiseAddMultEntry.segscan_27949       ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->eWiseAddMultEntryzisegscan_27949_runs,
                    (long) ctx->eWiseAddMultEntryzisegscan_27949_total_runtime /
                    (ctx->eWiseAddMultEntryzisegscan_27949_runs !=
                     0 ? ctx->eWiseAddMultEntryzisegscan_27949_runs : 1),
                    (long) ctx->eWiseAddMultEntryzisegscan_27949_total_runtime);
        ctx->total_runtime +=
            ctx->eWiseAddMultEntryzisegscan_27949_total_runtime;
        ctx->total_runs += ctx->eWiseAddMultEntryzisegscan_27949_runs;
        str_builder(&builder,
                    "eWiseAddMultEntry.segscan_27969       ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->eWiseAddMultEntryzisegscan_27969_runs,
                    (long) ctx->eWiseAddMultEntryzisegscan_27969_total_runtime /
                    (ctx->eWiseAddMultEntryzisegscan_27969_runs !=
                     0 ? ctx->eWiseAddMultEntryzisegscan_27969_runs : 1),
                    (long) ctx->eWiseAddMultEntryzisegscan_27969_total_runtime);
        ctx->total_runtime +=
            ctx->eWiseAddMultEntryzisegscan_27969_total_runtime;
        ctx->total_runs += ctx->eWiseAddMultEntryzisegscan_27969_runs;
        str_builder(&builder,
                    "eWiseAddMultEntry.segscan_27977       ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->eWiseAddMultEntryzisegscan_27977_runs,
                    (long) ctx->eWiseAddMultEntryzisegscan_27977_total_runtime /
                    (ctx->eWiseAddMultEntryzisegscan_27977_runs !=
                     0 ? ctx->eWiseAddMultEntryzisegscan_27977_runs : 1),
                    (long) ctx->eWiseAddMultEntryzisegscan_27977_total_runtime);
        ctx->total_runtime +=
            ctx->eWiseAddMultEntryzisegscan_27977_total_runtime;
        ctx->total_runs += ctx->eWiseAddMultEntryzisegscan_27977_runs;
        str_builder(&builder,
                    "eWiseAddMultEntry.segscan_28089       ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->eWiseAddMultEntryzisegscan_28089_runs,
                    (long) ctx->eWiseAddMultEntryzisegscan_28089_total_runtime /
                    (ctx->eWiseAddMultEntryzisegscan_28089_runs !=
                     0 ? ctx->eWiseAddMultEntryzisegscan_28089_runs : 1),
                    (long) ctx->eWiseAddMultEntryzisegscan_28089_total_runtime);
        ctx->total_runtime +=
            ctx->eWiseAddMultEntryzisegscan_28089_total_runtime;
        ctx->total_runs += ctx->eWiseAddMultEntryzisegscan_28089_runs;
        str_builder(&builder,
                    "eWiseMultEntry.segmap_27693           ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->eWiseMultEntryzisegmap_27693_runs,
                    (long) ctx->eWiseMultEntryzisegmap_27693_total_runtime /
                    (ctx->eWiseMultEntryzisegmap_27693_runs !=
                     0 ? ctx->eWiseMultEntryzisegmap_27693_runs : 1),
                    (long) ctx->eWiseMultEntryzisegmap_27693_total_runtime);
        ctx->total_runtime += ctx->eWiseMultEntryzisegmap_27693_total_runtime;
        ctx->total_runs += ctx->eWiseMultEntryzisegmap_27693_runs;
        str_builder(&builder,
                    "eWiseMultEntry.segmap_27749           ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->eWiseMultEntryzisegmap_27749_runs,
                    (long) ctx->eWiseMultEntryzisegmap_27749_total_runtime /
                    (ctx->eWiseMultEntryzisegmap_27749_runs !=
                     0 ? ctx->eWiseMultEntryzisegmap_27749_runs : 1),
                    (long) ctx->eWiseMultEntryzisegmap_27749_total_runtime);
        ctx->total_runtime += ctx->eWiseMultEntryzisegmap_27749_total_runtime;
        ctx->total_runs += ctx->eWiseMultEntryzisegmap_27749_runs;
        str_builder(&builder,
                    "eWiseMultEntry.segmap_27805           ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->eWiseMultEntryzisegmap_27805_runs,
                    (long) ctx->eWiseMultEntryzisegmap_27805_total_runtime /
                    (ctx->eWiseMultEntryzisegmap_27805_runs !=
                     0 ? ctx->eWiseMultEntryzisegmap_27805_runs : 1),
                    (long) ctx->eWiseMultEntryzisegmap_27805_total_runtime);
        ctx->total_runtime += ctx->eWiseMultEntryzisegmap_27805_total_runtime;
        ctx->total_runs += ctx->eWiseMultEntryzisegmap_27805_runs;
        str_builder(&builder,
                    "eWiseMultEntry.segmap_27811           ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->eWiseMultEntryzisegmap_27811_runs,
                    (long) ctx->eWiseMultEntryzisegmap_27811_total_runtime /
                    (ctx->eWiseMultEntryzisegmap_27811_runs !=
                     0 ? ctx->eWiseMultEntryzisegmap_27811_runs : 1),
                    (long) ctx->eWiseMultEntryzisegmap_27811_total_runtime);
        ctx->total_runtime += ctx->eWiseMultEntryzisegmap_27811_total_runtime;
        ctx->total_runs += ctx->eWiseMultEntryzisegmap_27811_runs;
        str_builder(&builder,
                    "eWiseMultEntry.segred_nonseg_28898    ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->eWiseMultEntryzisegred_nonseg_28898_runs,
                    (long) ctx->eWiseMultEntryzisegred_nonseg_28898_total_runtime /
                    (ctx->eWiseMultEntryzisegred_nonseg_28898_runs !=
                     0 ? ctx->eWiseMultEntryzisegred_nonseg_28898_runs : 1),
                    (long) ctx->eWiseMultEntryzisegred_nonseg_28898_total_runtime);
        ctx->total_runtime +=
            ctx->eWiseMultEntryzisegred_nonseg_28898_total_runtime;
        ctx->total_runs += ctx->eWiseMultEntryzisegred_nonseg_28898_runs;
        str_builder(&builder,
                    "eWiseMultEntry.segscan_27683          ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->eWiseMultEntryzisegscan_27683_runs,
                    (long) ctx->eWiseMultEntryzisegscan_27683_total_runtime /
                    (ctx->eWiseMultEntryzisegscan_27683_runs !=
                     0 ? ctx->eWiseMultEntryzisegscan_27683_runs : 1),
                    (long) ctx->eWiseMultEntryzisegscan_27683_total_runtime);
        ctx->total_runtime += ctx->eWiseMultEntryzisegscan_27683_total_runtime;
        ctx->total_runs += ctx->eWiseMultEntryzisegscan_27683_runs;
        str_builder(&builder,
                    "eWiseMultEntry.segscan_27691          ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->eWiseMultEntryzisegscan_27691_runs,
                    (long) ctx->eWiseMultEntryzisegscan_27691_total_runtime /
                    (ctx->eWiseMultEntryzisegscan_27691_runs !=
                     0 ? ctx->eWiseMultEntryzisegscan_27691_runs : 1),
                    (long) ctx->eWiseMultEntryzisegscan_27691_total_runtime);
        ctx->total_runtime += ctx->eWiseMultEntryzisegscan_27691_total_runtime;
        ctx->total_runs += ctx->eWiseMultEntryzisegscan_27691_runs;
        str_builder(&builder,
                    "eWiseMultEntry.segscan_27803          ran %5d times; avg: %8ldus; total: %8ldus\n",
                    ctx->eWiseMultEntryzisegscan_27803_runs,
                    (long) ctx->eWiseMultEntryzisegscan_27803_total_runtime /
                    (ctx->eWiseMultEntryzisegscan_27803_runs !=
                     0 ? ctx->eWiseMultEntryzisegscan_27803_runs : 1),
                    (long) ctx->eWiseMultEntryzisegscan_27803_total_runtime);
        ctx->total_runtime += ctx->eWiseMultEntryzisegscan_27803_total_runtime;
        ctx->total_runs += ctx->eWiseMultEntryzisegscan_27803_runs;
        str_builder(&builder, "%d operations with cumulative runtime: %6ldus\n",
                    ctx->total_runs, ctx->total_runtime);
    }
    return builder.str;
}
char *futhark_context_get_error(struct futhark_context *ctx)
{
    char *error = ctx->error;
    
    ctx->error = NULL;
    return error;
}
void futhark_context_pause_profiling(struct futhark_context *ctx)
{
    ctx->profiling_paused = 1;
}
void futhark_context_unpause_profiling(struct futhark_context *ctx)
{
    ctx->profiling_paused = 0;
}
static int futrts_builtinzhiota_i64(struct futhark_context *ctx,
                                    struct memblock_device mem_29300,
                                    int32_t n_29301, int64_t x_29302,
                                    int64_t s_29303);
static int futrts_builtinzhreplicate_f64(struct futhark_context *ctx,
                                         struct memblock_device mem_29280,
                                         int32_t num_elems_29281,
                                         double val_29282);
static int futrts_builtinzhreplicate_i64(struct futhark_context *ctx,
                                         struct memblock_device mem_29289,
                                         int32_t num_elems_29290,
                                         int64_t val_29291);
static int futrts_builtinzhreplicate_i8(struct futhark_context *ctx,
                                        struct memblock_device mem_29181,
                                        int32_t num_elems_29182,
                                        int8_t val_29183);
static int futrts_eWiseAddEntry(struct futhark_context *ctx,
                                struct memblock_device *out_mem_p_30117,
                                int64_t *out_out_arrsizze_30118,
                                struct memblock_device *out_mem_p_30119,
                                int64_t *out_out_arrsizze_30120,
                                struct memblock_device *out_mem_p_30121,
                                struct memblock_device leftValues_mem_28231,
                                struct memblock_device leftColumns_mem_28232,
                                struct memblock_device leftOffsets_mem_28233,
                                struct memblock_device rightValues_mem_28234,
                                struct memblock_device rightColumns_mem_28235,
                                struct memblock_device rightOffsets_mem_28236,
                                int64_t n_25269, int64_t m_25270,
                                int64_t k_25271);
static int futrts_eWiseAddMultEntry(struct futhark_context *ctx,
                                    struct memblock_device *out_mem_p_30268,
                                    int64_t *out_out_arrsizze_30269,
                                    struct memblock_device *out_mem_p_30270,
                                    int64_t *out_out_arrsizze_30271,
                                    struct memblock_device *out_mem_p_30272,
                                    struct memblock_device leftValues_mem_28231,
                                    struct memblock_device leftColumns_mem_28232,
                                    struct memblock_device leftOffsets_mem_28233,
                                    struct memblock_device rightValues_mem_28234,
                                    struct memblock_device rightColumns_mem_28235,
                                    struct memblock_device rightOffsets_mem_28236,
                                    int64_t n_26407, int64_t m_26408,
                                    int64_t k_26409);
static int futrts_eWiseMultEntry(struct futhark_context *ctx,
                                 struct memblock_device *out_mem_p_30559,
                                 int64_t *out_out_arrsizze_30560,
                                 struct memblock_device *out_mem_p_30561,
                                 int64_t *out_out_arrsizze_30562,
                                 struct memblock_device *out_mem_p_30563,
                                 struct memblock_device leftValues_mem_28231,
                                 struct memblock_device leftColumns_mem_28232,
                                 struct memblock_device leftOffsets_mem_28233,
                                 struct memblock_device rightValues_mem_28234,
                                 struct memblock_device rightColumns_mem_28235,
                                 struct memblock_device rightOffsets_mem_28236,
                                 int64_t n_25880, int64_t m_25881,
                                 int64_t k_25882);
static int init_constants(struct futhark_context *ctx)
{
    (void) ctx;
    
    int err = 0;
    
    
  cleanup:
    return err;
}
static int free_constants(struct futhark_context *ctx)
{
    (void) ctx;
    return 0;
}
static int futrts_builtinzhiota_i64(struct futhark_context *ctx,
                                    struct memblock_device mem_29300,
                                    int32_t n_29301, int64_t x_29302,
                                    int64_t s_29303)
{
    (void) ctx;
    
    int err = 0;
    int64_t group_sizze_29308;
    
    group_sizze_29308 = ctx->sizes.builtinzhiota_i64zigroup_sizze_29308;
    
    int64_t num_groups_29309;
    
    num_groups_29309 = sdiv_up64(n_29301, group_sizze_29308);
    
    CUdeviceptr kernel_arg_30104 = mem_29300.mem;
    
    if ((((((1 && num_groups_29309 != 0) && 1 != 0) && 1 != 0) &&
          group_sizze_29308 != 0) && 1 != 0) && 1 != 0) {
        int perm[3] = {0, 1, 2};
        
        if (1 >= 1 << 16) {
            perm[1] = perm[0];
            perm[0] = 1;
        }
        if (1 >= 1 << 16) {
            perm[2] = perm[0];
            perm[0] = 2;
        }
        
        size_t grid[3];
        
        grid[perm[0]] = num_groups_29309;
        grid[perm[1]] = 1;
        grid[perm[2]] = 1;
        
        void *kernel_args_30101[] = {&n_29301, &x_29302, &s_29303,
                                     &kernel_arg_30104};
        int64_t time_start_30102 = 0, time_end_30103 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with grid size (",
                    "builtin#iota_i64.iota_i64_29305");
            fprintf(stderr, "%d", num_groups_29309);
            fprintf(stderr, ", ");
            fprintf(stderr, "%d", 1);
            fprintf(stderr, ", ");
            fprintf(stderr, "%d", 1);
            fprintf(stderr, ") and block size (");
            fprintf(stderr, "%d", group_sizze_29308);
            fprintf(stderr, ", ");
            fprintf(stderr, "%d", 1);
            fprintf(stderr, ", ");
            fprintf(stderr, "%d", 1);
            fprintf(stderr, ").\n");
            time_start_30102 = get_wall_time();
        }
        
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->builtinzhiota_i64ziiota_i64_29305_runs,
                                      &ctx->builtinzhiota_i64ziiota_i64_29305_total_runtime);
            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED(cuLaunchKernel(ctx->builtinzhiota_i64ziiota_i64_29305,
                                    grid[0], grid[1], grid[2],
                                    group_sizze_29308, 1, 1, 0, NULL,
                                    kernel_args_30101, NULL));
        if (pevents != NULL)
            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
        if (ctx->debugging) {
            CUDA_SUCCEED(cuCtxSynchronize());
            time_end_30103 = get_wall_time();
            fprintf(stderr, "Kernel %s runtime: %ldus\n",
                    "builtin#iota_i64.iota_i64_29305", time_end_30103 -
                    time_start_30102);
        }
    }
    
  cleanup:
    { }
    return err;
}
static int futrts_builtinzhreplicate_f64(struct futhark_context *ctx,
                                         struct memblock_device mem_29280,
                                         int32_t num_elems_29281,
                                         double val_29282)
{
    (void) ctx;
    
    int err = 0;
    int64_t group_sizze_29287;
    
    group_sizze_29287 = ctx->sizes.builtinzhreplicate_f64zigroup_sizze_29287;
    
    int64_t num_groups_29288;
    
    num_groups_29288 = sdiv_up64(num_elems_29281, group_sizze_29287);
    
    CUdeviceptr kernel_arg_30108 = mem_29280.mem;
    
    if ((((((1 && num_groups_29288 != 0) && 1 != 0) && 1 != 0) &&
          group_sizze_29287 != 0) && 1 != 0) && 1 != 0) {
        int perm[3] = {0, 1, 2};
        
        if (1 >= 1 << 16) {
            perm[1] = perm[0];
            perm[0] = 1;
        }
        if (1 >= 1 << 16) {
            perm[2] = perm[0];
            perm[0] = 2;
        }
        
        size_t grid[3];
        
        grid[perm[0]] = num_groups_29288;
        grid[perm[1]] = 1;
        grid[perm[2]] = 1;
        
        void *kernel_args_30105[] = {&num_elems_29281, &val_29282,
                                     &kernel_arg_30108};
        int64_t time_start_30106 = 0, time_end_30107 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with grid size (",
                    "builtin#replicate_f64.replicate_29284");
            fprintf(stderr, "%d", num_groups_29288);
            fprintf(stderr, ", ");
            fprintf(stderr, "%d", 1);
            fprintf(stderr, ", ");
            fprintf(stderr, "%d", 1);
            fprintf(stderr, ") and block size (");
            fprintf(stderr, "%d", group_sizze_29287);
            fprintf(stderr, ", ");
            fprintf(stderr, "%d", 1);
            fprintf(stderr, ", ");
            fprintf(stderr, "%d", 1);
            fprintf(stderr, ").\n");
            time_start_30106 = get_wall_time();
        }
        
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->builtinzhreplicate_f64zireplicate_29284_runs,
                                      &ctx->builtinzhreplicate_f64zireplicate_29284_total_runtime);
            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED(cuLaunchKernel(ctx->builtinzhreplicate_f64zireplicate_29284,
                                    grid[0], grid[1], grid[2],
                                    group_sizze_29287, 1, 1, 0, NULL,
                                    kernel_args_30105, NULL));
        if (pevents != NULL)
            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
        if (ctx->debugging) {
            CUDA_SUCCEED(cuCtxSynchronize());
            time_end_30107 = get_wall_time();
            fprintf(stderr, "Kernel %s runtime: %ldus\n",
                    "builtin#replicate_f64.replicate_29284", time_end_30107 -
                    time_start_30106);
        }
    }
    
  cleanup:
    { }
    return err;
}
static int futrts_builtinzhreplicate_i64(struct futhark_context *ctx,
                                         struct memblock_device mem_29289,
                                         int32_t num_elems_29290,
                                         int64_t val_29291)
{
    (void) ctx;
    
    int err = 0;
    int64_t group_sizze_29296;
    
    group_sizze_29296 = ctx->sizes.builtinzhreplicate_i64zigroup_sizze_29296;
    
    int64_t num_groups_29297;
    
    num_groups_29297 = sdiv_up64(num_elems_29290, group_sizze_29296);
    
    CUdeviceptr kernel_arg_30112 = mem_29289.mem;
    
    if ((((((1 && num_groups_29297 != 0) && 1 != 0) && 1 != 0) &&
          group_sizze_29296 != 0) && 1 != 0) && 1 != 0) {
        int perm[3] = {0, 1, 2};
        
        if (1 >= 1 << 16) {
            perm[1] = perm[0];
            perm[0] = 1;
        }
        if (1 >= 1 << 16) {
            perm[2] = perm[0];
            perm[0] = 2;
        }
        
        size_t grid[3];
        
        grid[perm[0]] = num_groups_29297;
        grid[perm[1]] = 1;
        grid[perm[2]] = 1;
        
        void *kernel_args_30109[] = {&num_elems_29290, &val_29291,
                                     &kernel_arg_30112};
        int64_t time_start_30110 = 0, time_end_30111 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with grid size (",
                    "builtin#replicate_i64.replicate_29293");
            fprintf(stderr, "%d", num_groups_29297);
            fprintf(stderr, ", ");
            fprintf(stderr, "%d", 1);
            fprintf(stderr, ", ");
            fprintf(stderr, "%d", 1);
            fprintf(stderr, ") and block size (");
            fprintf(stderr, "%d", group_sizze_29296);
            fprintf(stderr, ", ");
            fprintf(stderr, "%d", 1);
            fprintf(stderr, ", ");
            fprintf(stderr, "%d", 1);
            fprintf(stderr, ").\n");
            time_start_30110 = get_wall_time();
        }
        
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->builtinzhreplicate_i64zireplicate_29293_runs,
                                      &ctx->builtinzhreplicate_i64zireplicate_29293_total_runtime);
            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED(cuLaunchKernel(ctx->builtinzhreplicate_i64zireplicate_29293,
                                    grid[0], grid[1], grid[2],
                                    group_sizze_29296, 1, 1, 0, NULL,
                                    kernel_args_30109, NULL));
        if (pevents != NULL)
            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
        if (ctx->debugging) {
            CUDA_SUCCEED(cuCtxSynchronize());
            time_end_30111 = get_wall_time();
            fprintf(stderr, "Kernel %s runtime: %ldus\n",
                    "builtin#replicate_i64.replicate_29293", time_end_30111 -
                    time_start_30110);
        }
    }
    
  cleanup:
    { }
    return err;
}
static int futrts_builtinzhreplicate_i8(struct futhark_context *ctx,
                                        struct memblock_device mem_29181,
                                        int32_t num_elems_29182,
                                        int8_t val_29183)
{
    (void) ctx;
    
    int err = 0;
    int64_t group_sizze_29188;
    
    group_sizze_29188 = ctx->sizes.builtinzhreplicate_i8zigroup_sizze_29188;
    
    int64_t num_groups_29189;
    
    num_groups_29189 = sdiv_up64(num_elems_29182, group_sizze_29188);
    
    CUdeviceptr kernel_arg_30116 = mem_29181.mem;
    
    if ((((((1 && num_groups_29189 != 0) && 1 != 0) && 1 != 0) &&
          group_sizze_29188 != 0) && 1 != 0) && 1 != 0) {
        int perm[3] = {0, 1, 2};
        
        if (1 >= 1 << 16) {
            perm[1] = perm[0];
            perm[0] = 1;
        }
        if (1 >= 1 << 16) {
            perm[2] = perm[0];
            perm[0] = 2;
        }
        
        size_t grid[3];
        
        grid[perm[0]] = num_groups_29189;
        grid[perm[1]] = 1;
        grid[perm[2]] = 1;
        
        void *kernel_args_30113[] = {&num_elems_29182, &val_29183,
                                     &kernel_arg_30116};
        int64_t time_start_30114 = 0, time_end_30115 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with grid size (",
                    "builtin#replicate_i8.replicate_29185");
            fprintf(stderr, "%d", num_groups_29189);
            fprintf(stderr, ", ");
            fprintf(stderr, "%d", 1);
            fprintf(stderr, ", ");
            fprintf(stderr, "%d", 1);
            fprintf(stderr, ") and block size (");
            fprintf(stderr, "%d", group_sizze_29188);
            fprintf(stderr, ", ");
            fprintf(stderr, "%d", 1);
            fprintf(stderr, ", ");
            fprintf(stderr, "%d", 1);
            fprintf(stderr, ").\n");
            time_start_30114 = get_wall_time();
        }
        
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->builtinzhreplicate_i8zireplicate_29185_runs,
                                      &ctx->builtinzhreplicate_i8zireplicate_29185_total_runtime);
            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED(cuLaunchKernel(ctx->builtinzhreplicate_i8zireplicate_29185,
                                    grid[0], grid[1], grid[2],
                                    group_sizze_29188, 1, 1, 0, NULL,
                                    kernel_args_30113, NULL));
        if (pevents != NULL)
            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
        if (ctx->debugging) {
            CUDA_SUCCEED(cuCtxSynchronize());
            time_end_30115 = get_wall_time();
            fprintf(stderr, "Kernel %s runtime: %ldus\n",
                    "builtin#replicate_i8.replicate_29185", time_end_30115 -
                    time_start_30114);
        }
    }
    
  cleanup:
    { }
    return err;
}
static int futrts_eWiseAddEntry(struct futhark_context *ctx,
                                struct memblock_device *out_mem_p_30117,
                                int64_t *out_out_arrsizze_30118,
                                struct memblock_device *out_mem_p_30119,
                                int64_t *out_out_arrsizze_30120,
                                struct memblock_device *out_mem_p_30121,
                                struct memblock_device leftValues_mem_28231,
                                struct memblock_device leftColumns_mem_28232,
                                struct memblock_device leftOffsets_mem_28233,
                                struct memblock_device rightValues_mem_28234,
                                struct memblock_device rightColumns_mem_28235,
                                struct memblock_device rightOffsets_mem_28236,
                                int64_t n_25269, int64_t m_25270,
                                int64_t k_25271)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device out_mem_29119;
    
    out_mem_29119.references = NULL;
    
    int64_t out_arrsizze_29120;
    struct memblock_device out_mem_29121;
    
    out_mem_29121.references = NULL;
    
    int64_t out_arrsizze_29122;
    struct memblock_device out_mem_29123;
    
    out_mem_29123.references = NULL;
    
    int64_t segscan_group_sizze_27532;
    
    segscan_group_sizze_27532 =
        ctx->sizes.eWiseAddEntryzisegscan_group_sizze_27531;
    
    int64_t num_groups_27534;
    int32_t max_num_groups_29124;
    
    max_num_groups_29124 = ctx->sizes.eWiseAddEntryzisegscan_num_groups_27533;
    num_groups_27534 = sext_i64_i32(smax64((int64_t) 1,
                                           smin64(sdiv_up64(m_25270,
                                                            segscan_group_sizze_27532),
                                                  sext_i32_i64(max_num_groups_29124))));
    
    int64_t bytes_28336 = (int64_t) 8 * m_25270;
    struct memblock_device mem_28337;
    
    mem_28337.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28337, bytes_28336, "mem_28337")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t num_threads_28787 = segscan_group_sizze_27532 * num_groups_27534;
    int64_t segred_num_groups_28807;
    
    segred_num_groups_28807 = ctx->sizes.eWiseAddEntryzisegred_num_groups_28806;
    
    int64_t segred_group_sizze_28809;
    
    segred_group_sizze_28809 =
        ctx->sizes.eWiseAddEntryzisegred_group_sizze_28808;
    
    struct memblock_device mem_28856;
    
    mem_28856.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28856, (int64_t) 8, "mem_28856")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_28858;
    
    mem_28858.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28858, (int64_t) 8, "mem_28858")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_28860;
    
    mem_28860.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28860, (int64_t) 8, "mem_28860")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device eWiseAddEntryzicounter_mem_29125 =
                           ctx->eWiseAddEntryzicounter_mem_29125;
    struct memblock_device group_res_arr_mem_29127;
    
    group_res_arr_mem_29127.references = NULL;
    if (memblock_alloc_device(ctx, &group_res_arr_mem_29127,
                              (int64_t) sizeof(int64_t) *
                              (segred_group_sizze_28809 *
                               segred_num_groups_28807),
                              "group_res_arr_mem_29127")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device group_res_arr_mem_29129;
    
    group_res_arr_mem_29129.references = NULL;
    if (memblock_alloc_device(ctx, &group_res_arr_mem_29129,
                              (int64_t) sizeof(int64_t) *
                              (segred_group_sizze_28809 *
                               segred_num_groups_28807),
                              "group_res_arr_mem_29129")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device group_res_arr_mem_29131;
    
    group_res_arr_mem_29131.references = NULL;
    if (memblock_alloc_device(ctx, &group_res_arr_mem_29131,
                              (int64_t) sizeof(int64_t) *
                              (segred_group_sizze_28809 *
                               segred_num_groups_28807),
                              "group_res_arr_mem_29131")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t num_threads_29133;
    
    num_threads_29133 = segred_num_groups_28807 * segred_group_sizze_28809;
    if (ctx->debugging)
        fprintf(stderr, "%s\n", "\n# SegRed");
    
    unsigned int shared_sizze_30126 = (int64_t) sizeof(int64_t) *
                 segred_group_sizze_28809;
    unsigned int shared_sizze_30128 = (int64_t) sizeof(int64_t) *
                 segred_group_sizze_28809;
    unsigned int shared_sizze_30130 = (int64_t) sizeof(int64_t) *
                 segred_group_sizze_28809;
    unsigned int shared_sizze_30132 = (int64_t) sizeof(bool);
    CUdeviceptr kernel_arg_30134 = leftOffsets_mem_28233.mem;
    CUdeviceptr kernel_arg_30135 = rightOffsets_mem_28236.mem;
    CUdeviceptr kernel_arg_30136 = mem_28856.mem;
    CUdeviceptr kernel_arg_30137 = mem_28858.mem;
    CUdeviceptr kernel_arg_30138 = mem_28860.mem;
    CUdeviceptr kernel_arg_30139 = eWiseAddEntryzicounter_mem_29125.mem;
    CUdeviceptr kernel_arg_30140 = group_res_arr_mem_29127.mem;
    CUdeviceptr kernel_arg_30141 = group_res_arr_mem_29129.mem;
    CUdeviceptr kernel_arg_30142 = group_res_arr_mem_29131.mem;
    unsigned int shared_offset_30127 = 0;
    unsigned int shared_offset_30129 = 0 + (shared_sizze_30126 + (8 -
                                                                  shared_sizze_30126 %
                                                                  8) % 8);
    unsigned int shared_offset_30131 = 0 + (shared_sizze_30126 + (8 -
                                                                  shared_sizze_30126 %
                                                                  8) % 8) +
                 (shared_sizze_30128 + (8 - shared_sizze_30128 % 8) % 8);
    unsigned int shared_offset_30133 = 0 + (shared_sizze_30126 + (8 -
                                                                  shared_sizze_30126 %
                                                                  8) % 8) +
                 (shared_sizze_30128 + (8 - shared_sizze_30128 % 8) % 8) +
                 (shared_sizze_30130 + (8 - shared_sizze_30130 % 8) % 8);
    
    if ((((((1 && segred_num_groups_28807 != 0) && 1 != 0) && 1 != 0) &&
          segred_group_sizze_28809 != 0) && 1 != 0) && 1 != 0) {
        int perm[3] = {0, 1, 2};
        
        if (1 >= 1 << 16) {
            perm[1] = perm[0];
            perm[0] = 1;
        }
        if (1 >= 1 << 16) {
            perm[2] = perm[0];
            perm[0] = 2;
        }
        
        size_t grid[3];
        
        grid[perm[0]] = segred_num_groups_28807;
        grid[perm[1]] = 1;
        grid[perm[2]] = 1;
        
        void *kernel_args_30123[] = {&ctx->global_failure,
                                     &ctx->failure_is_an_option,
                                     &ctx->global_failure_args,
                                     &shared_offset_30127, &shared_offset_30129,
                                     &shared_offset_30131, &shared_offset_30133,
                                     &m_25270, &num_threads_29133,
                                     &kernel_arg_30134, &kernel_arg_30135,
                                     &kernel_arg_30136, &kernel_arg_30137,
                                     &kernel_arg_30138, &kernel_arg_30139,
                                     &kernel_arg_30140, &kernel_arg_30141,
                                     &kernel_arg_30142};
        int64_t time_start_30124 = 0, time_end_30125 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with grid size (",
                    "eWiseAddEntry.segred_nonseg_28815");
            fprintf(stderr, "%d", segred_num_groups_28807);
            fprintf(stderr, ", ");
            fprintf(stderr, "%d", 1);
            fprintf(stderr, ", ");
            fprintf(stderr, "%d", 1);
            fprintf(stderr, ") and block size (");
            fprintf(stderr, "%d", segred_group_sizze_28809);
            fprintf(stderr, ", ");
            fprintf(stderr, "%d", 1);
            fprintf(stderr, ", ");
            fprintf(stderr, "%d", 1);
            fprintf(stderr, ").\n");
            time_start_30124 = get_wall_time();
        }
        
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->eWiseAddEntryzisegred_nonseg_28815_runs,
                                      &ctx->eWiseAddEntryzisegred_nonseg_28815_total_runtime);
            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED(cuLaunchKernel(ctx->eWiseAddEntryzisegred_nonseg_28815,
                                    grid[0], grid[1], grid[2],
                                    segred_group_sizze_28809, 1, 1, 0 +
                                    (shared_sizze_30126 + (8 -
                                                           shared_sizze_30126 %
                                                           8) % 8) +
                                    (shared_sizze_30128 + (8 -
                                                           shared_sizze_30128 %
                                                           8) % 8) +
                                    (shared_sizze_30130 + (8 -
                                                           shared_sizze_30130 %
                                                           8) % 8) +
                                    (shared_sizze_30132 + (8 -
                                                           shared_sizze_30132 %
                                                           8) % 8), NULL,
                                    kernel_args_30123, NULL));
        if (pevents != NULL)
            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
        if (ctx->debugging) {
            CUDA_SUCCEED(cuCtxSynchronize());
            time_end_30125 = get_wall_time();
            fprintf(stderr, "Kernel %s runtime: %ldus\n",
                    "eWiseAddEntry.segred_nonseg_28815", time_end_30125 -
                    time_start_30124);
        }
    }
    ctx->failure_is_an_option = 1;
    
    int64_t read_res_30143;
    
    {
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->copy_scalar_from_dev_runs,
                                      &ctx->copy_scalar_from_dev_total_runtime);
            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30143, mem_28856.mem + (int64_t) 0 *
                                  sizeof(int64_t), sizeof(int64_t)));
        if (pevents != NULL)
            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
    }
    if (futhark_context_sync(ctx) != 0)
        return 1;
    
    int64_t max_per_thread_28801 = read_res_30143;
    
    if (memblock_unref_device(ctx, &mem_28856, "mem_28856") != 0)
        return 1;
    
    int64_t read_res_30144;
    
    {
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->copy_scalar_from_dev_runs,
                                      &ctx->copy_scalar_from_dev_total_runtime);
            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30144, mem_28858.mem + (int64_t) 0 *
                                  sizeof(int64_t), sizeof(int64_t)));
        if (pevents != NULL)
            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
    }
    if (futhark_context_sync(ctx) != 0)
        return 1;
    
    int64_t max_per_thread_28802 = read_res_30144;
    
    if (memblock_unref_device(ctx, &mem_28858, "mem_28858") != 0)
        return 1;
    
    int64_t read_res_30145;
    
    {
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->copy_scalar_from_dev_runs,
                                      &ctx->copy_scalar_from_dev_total_runtime);
            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30145, mem_28860.mem + (int64_t) 0 *
                                  sizeof(int64_t), sizeof(int64_t)));
        if (pevents != NULL)
            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
    }
    if (futhark_context_sync(ctx) != 0)
        return 1;
    
    int64_t max_per_thread_28803 = read_res_30145;
    
    if (memblock_unref_device(ctx, &mem_28860, "mem_28860") != 0)
        return 1;
    
    int64_t sizze_sum_28849 = num_threads_28787 * max_per_thread_28801;
    int64_t sizze_sum_28850 = num_threads_28787 * max_per_thread_28802;
    int64_t sizze_sum_28851 = num_threads_28787 * max_per_thread_28803;
    struct memblock_device mem_28318;
    
    mem_28318.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28318, sizze_sum_28849, "mem_28318")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_28254;
    
    mem_28254.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28254, sizze_sum_28849, "mem_28254")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_28252;
    
    mem_28252.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28252, sizze_sum_28849, "mem_28252")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_28250;
    
    mem_28250.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28250, sizze_sum_28849, "mem_28250")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_28248;
    
    mem_28248.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28248, sizze_sum_28849, "mem_28248")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_28239;
    
    mem_28239.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28239, sizze_sum_28849, "mem_28239")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_28256;
    
    mem_28256.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28256, sizze_sum_28850, "mem_28256")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device double_buffer_mem_28763;
    
    double_buffer_mem_28763.references = NULL;
    if (memblock_alloc_device(ctx, &double_buffer_mem_28763, sizze_sum_28851,
                              "double_buffer_mem_28763")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, m_25270)) {
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegScan");
        
        int64_t numThreads_29171;
        
        numThreads_29171 = sdiv_up64(m_25270, segscan_group_sizze_27532 *
                                     (int64_t) 9) * segscan_group_sizze_27532;
        
        int64_t numGroups_29172;
        
        numGroups_29172 = sdiv_up64(m_25270, segscan_group_sizze_27532 *
                                    (int64_t) 9);
        
        struct memblock_device eWiseAddEntryziid_counter_mem_29173 =
                               ctx->eWiseAddEntryziid_counter_mem_29173;
        struct memblock_device status_flags_mem_29175;
        
        status_flags_mem_29175.references = NULL;
        if (memblock_alloc_device(ctx, &status_flags_mem_29175,
                                  (int64_t) sizeof(int8_t) * numGroups_29172,
                                  "status_flags_mem_29175")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device aggregates_mem_29177;
        
        aggregates_mem_29177.references = NULL;
        if (memblock_alloc_device(ctx, &aggregates_mem_29177,
                                  (int64_t) sizeof(int64_t) * numGroups_29172,
                                  "aggregates_mem_29177")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device incprefixes_mem_29179;
        
        incprefixes_mem_29179.references = NULL;
        if (memblock_alloc_device(ctx, &incprefixes_mem_29179,
                                  (int64_t) sizeof(int64_t) * numGroups_29172,
                                  "incprefixes_mem_29179")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_29175,
                                         numGroups_29172, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        
        unsigned int shared_sizze_30150 = smax64(smax64((int64_t) 288,
                                                        (int64_t) 8 *
                                                        segscan_group_sizze_27532),
                                                 (int64_t) 9 *
                                                 segscan_group_sizze_27532 *
                                                 (int64_t) 8);
        CUdeviceptr kernel_arg_30152 = leftColumns_mem_28232.mem;
        CUdeviceptr kernel_arg_30153 = leftOffsets_mem_28233.mem;
        CUdeviceptr kernel_arg_30154 = rightColumns_mem_28235.mem;
        CUdeviceptr kernel_arg_30155 = rightOffsets_mem_28236.mem;
        CUdeviceptr kernel_arg_30156 = mem_28239.mem;
        CUdeviceptr kernel_arg_30157 = mem_28248.mem;
        CUdeviceptr kernel_arg_30158 = mem_28250.mem;
        CUdeviceptr kernel_arg_30159 = mem_28252.mem;
        CUdeviceptr kernel_arg_30160 = mem_28254.mem;
        CUdeviceptr kernel_arg_30161 = mem_28256.mem;
        CUdeviceptr kernel_arg_30162 = mem_28318.mem;
        CUdeviceptr kernel_arg_30163 = mem_28337.mem;
        CUdeviceptr kernel_arg_30164 = double_buffer_mem_28763.mem;
        CUdeviceptr kernel_arg_30165 = eWiseAddEntryziid_counter_mem_29173.mem;
        CUdeviceptr kernel_arg_30166 = status_flags_mem_29175.mem;
        CUdeviceptr kernel_arg_30167 = aggregates_mem_29177.mem;
        CUdeviceptr kernel_arg_30168 = incprefixes_mem_29179.mem;
        unsigned int shared_offset_30151 = 0;
        
        if ((((((1 && sdiv_up64(m_25270, segscan_group_sizze_27532 *
                                (int64_t) 9) != 0) && 1 != 0) && 1 != 0) &&
              segscan_group_sizze_27532 != 0) && 1 != 0) && 1 != 0) {
            int perm[3] = {0, 1, 2};
            
            if (1 >= 1 << 16) {
                perm[1] = perm[0];
                perm[0] = 1;
            }
            if (1 >= 1 << 16) {
                perm[2] = perm[0];
                perm[0] = 2;
            }
            
            size_t grid[3];
            
            grid[perm[0]] = sdiv_up64(m_25270, segscan_group_sizze_27532 *
                                      (int64_t) 9);
            grid[perm[1]] = 1;
            grid[perm[2]] = 1;
            
            void *kernel_args_30147[] = {&ctx->global_failure,
                                         &ctx->failure_is_an_option,
                                         &ctx->global_failure_args,
                                         &shared_offset_30151, &n_25269,
                                         &m_25270, &k_25271, &num_threads_28787,
                                         &kernel_arg_30152, &kernel_arg_30153,
                                         &kernel_arg_30154, &kernel_arg_30155,
                                         &kernel_arg_30156, &kernel_arg_30157,
                                         &kernel_arg_30158, &kernel_arg_30159,
                                         &kernel_arg_30160, &kernel_arg_30161,
                                         &kernel_arg_30162, &kernel_arg_30163,
                                         &kernel_arg_30164, &kernel_arg_30165,
                                         &kernel_arg_30166, &kernel_arg_30167,
                                         &kernel_arg_30168};
            int64_t time_start_30148 = 0, time_end_30149 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with grid size (",
                        "eWiseAddEntry.segscan_27537");
                fprintf(stderr, "%d", sdiv_up64(m_25270,
                                                segscan_group_sizze_27532 *
                                                (int64_t) 9));
                fprintf(stderr, ", ");
                fprintf(stderr, "%d", 1);
                fprintf(stderr, ", ");
                fprintf(stderr, "%d", 1);
                fprintf(stderr, ") and block size (");
                fprintf(stderr, "%d", segscan_group_sizze_27532);
                fprintf(stderr, ", ");
                fprintf(stderr, "%d", 1);
                fprintf(stderr, ", ");
                fprintf(stderr, "%d", 1);
                fprintf(stderr, ").\n");
                time_start_30148 = get_wall_time();
            }
            
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->eWiseAddEntryzisegscan_27537_runs,
                                          &ctx->eWiseAddEntryzisegscan_27537_total_runtime);
                CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED(cuLaunchKernel(ctx->eWiseAddEntryzisegscan_27537,
                                        grid[0], grid[1], grid[2],
                                        segscan_group_sizze_27532, 1, 1, 0 +
                                        (shared_sizze_30150 + (8 -
                                                               shared_sizze_30150 %
                                                               8) % 8), NULL,
                                        kernel_args_30147, NULL));
            if (pevents != NULL)
                CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
            if (ctx->debugging) {
                CUDA_SUCCEED(cuCtxSynchronize());
                time_end_30149 = get_wall_time();
                fprintf(stderr, "Kernel %s runtime: %ldus\n",
                        "eWiseAddEntry.segscan_27537", time_end_30149 -
                        time_start_30148);
            }
        }
        ctx->failure_is_an_option = 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_29179,
                                  "incprefixes_mem_29179") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_29177,
                                  "aggregates_mem_29177") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_29175,
                                  "status_flags_mem_29175") != 0)
            return 1;
    }
    if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28248, "mem_28248") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28250, "mem_28250") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28254, "mem_28254") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28256, "mem_28256") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28318, "mem_28318") != 0)
        return 1;
    if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                              "double_buffer_mem_28763") != 0)
        return 1;
    
    int64_t i_25457 = sub64(m_25270, (int64_t) 1);
    bool x_25458 = sle64((int64_t) 0, i_25457);
    bool y_25459 = slt64(i_25457, m_25270);
    bool bounds_check_25460 = x_25458 && y_25459;
    bool index_certs_25461;
    
    if (!bounds_check_25460) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Index [", i_25457,
                               "] out of bounds for array of shape [", m_25270,
                               "].",
                               "-> #0  sparse.fut:115:30-41\n   #1  sparse.fut:131:23-48\n   #2  sparse.fut:219:17-59\n   #3  sparse.fut:210:1-220:48\n");
        if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                  "double_buffer_mem_28763") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28256, "mem_28256") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28248, "mem_28248") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28250, "mem_28250") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28254, "mem_28254") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28318, "mem_28318") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                  "group_res_arr_mem_29131") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                  "group_res_arr_mem_29129") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                  "group_res_arr_mem_29127") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28860, "mem_28860") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28858, "mem_28858") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28856, "mem_28856") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28337, "mem_28337") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_29123, "out_mem_29123") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_29121, "out_mem_29121") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_29119, "out_mem_29119") != 0)
            return 1;
        return 1;
    }
    
    int64_t read_res_30169;
    
    {
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->copy_scalar_from_dev_runs,
                                      &ctx->copy_scalar_from_dev_total_runtime);
            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30169, mem_28337.mem + i_25457 *
                                  sizeof(int64_t), sizeof(int64_t)));
        if (pevents != NULL)
            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
    }
    if (futhark_context_sync(ctx) != 0)
        return 1;
    
    int64_t eWiseAddOffsets_res_25462 = read_res_30169;
    bool bounds_invalid_upwards_25463 = slt64(eWiseAddOffsets_res_25462,
                                              (int64_t) 0);
    bool valid_25464 = !bounds_invalid_upwards_25463;
    bool range_valid_c_25465;
    
    if (!valid_25464) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Range ", (int64_t) 0, "..", (int64_t) 1, "..<",
                               eWiseAddOffsets_res_25462, " is invalid.",
                               "-> #0  /prelude/array.fut:60:3-10\n   #1  /prelude/array.fut:70:18-23\n   #2  sparse.fut:132:16-35\n   #3  sparse.fut:219:17-59\n   #4  sparse.fut:210:1-220:48\n");
        if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                  "double_buffer_mem_28763") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28256, "mem_28256") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28248, "mem_28248") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28250, "mem_28250") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28254, "mem_28254") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28318, "mem_28318") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                  "group_res_arr_mem_29131") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                  "group_res_arr_mem_29129") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                  "group_res_arr_mem_29127") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28860, "mem_28860") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28858, "mem_28858") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28856, "mem_28856") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28337, "mem_28337") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_29123, "out_mem_29123") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_29121, "out_mem_29121") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_29119, "out_mem_29119") != 0)
            return 1;
        return 1;
    }
    
    int64_t bytes_28338 = (int64_t) 8 * eWiseAddOffsets_res_25462;
    struct memblock_device mem_28339;
    
    mem_28339.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28339, bytes_28338, "mem_28339")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_f64(ctx, mem_28339, eWiseAddOffsets_res_25462,
                                      0.0) != 0) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_28341;
    
    mem_28341.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28341, bytes_28338, "mem_28341")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_28341, eWiseAddOffsets_res_25462,
                                      (int64_t) 0) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t segmap_group_sizze_27674;
    
    segmap_group_sizze_27674 =
        ctx->sizes.eWiseAddEntryzisegmap_group_sizze_27673;
    for (int64_t i_25470 = 0; i_25470 < i_25457; i_25470++) {
        bool y_25473 = slt64(i_25470, m_25270);
        bool index_certs_25474;
        
        if (!y_25473) {
            ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                   "Index [", i_25470,
                                   "] out of bounds for array of shape [",
                                   m_25270, "].",
                                   "-> #0  sparse.fut:140:46-61\n   #1  sparse.fut:219:17-59\n   #2  sparse.fut:210:1-220:48\n");
            if (memblock_unref_device(ctx, &mem_28341, "mem_28341") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28339, "mem_28339") != 0)
                return 1;
            if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                      "double_buffer_mem_28763") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28256, "mem_28256") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28248, "mem_28248") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28250, "mem_28250") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28254, "mem_28254") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28318, "mem_28318") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                      "group_res_arr_mem_29131") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                      "group_res_arr_mem_29129") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                      "group_res_arr_mem_29127") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28860, "mem_28860") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28858, "mem_28858") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28856, "mem_28856") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28337, "mem_28337") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29123, "out_mem_29123") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29121, "out_mem_29121") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29119, "out_mem_29119") !=
                0)
                return 1;
            return 1;
        }
        
        int64_t read_res_30170;
        
        {
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->copy_scalar_from_dev_runs,
                                          &ctx->copy_scalar_from_dev_total_runtime);
                CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30170,
                                      rightOffsets_mem_28236.mem + i_25470 *
                                      sizeof(int64_t), sizeof(int64_t)));
            if (pevents != NULL)
                CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
        }
        if (futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t i_25475 = read_res_30170;
        int64_t i_25476 = add64((int64_t) 1, i_25470);
        bool x_25477 = sle64((int64_t) 0, i_25476);
        bool y_25478 = slt64(i_25476, m_25270);
        bool bounds_check_25479 = x_25477 && y_25478;
        bool index_certs_25480;
        
        if (!bounds_check_25479) {
            ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                   "Index [", i_25476,
                                   "] out of bounds for array of shape [",
                                   m_25270, "].",
                                   "-> #0  sparse.fut:140:63-80\n   #1  sparse.fut:219:17-59\n   #2  sparse.fut:210:1-220:48\n");
            if (memblock_unref_device(ctx, &mem_28341, "mem_28341") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28339, "mem_28339") != 0)
                return 1;
            if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                      "double_buffer_mem_28763") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28256, "mem_28256") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28248, "mem_28248") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28250, "mem_28250") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28254, "mem_28254") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28318, "mem_28318") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                      "group_res_arr_mem_29131") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                      "group_res_arr_mem_29129") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                      "group_res_arr_mem_29127") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28860, "mem_28860") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28858, "mem_28858") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28856, "mem_28856") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28337, "mem_28337") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29123, "out_mem_29123") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29121, "out_mem_29121") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29119, "out_mem_29119") !=
                0)
                return 1;
            return 1;
        }
        
        int64_t read_res_30171;
        
        {
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->copy_scalar_from_dev_runs,
                                          &ctx->copy_scalar_from_dev_total_runtime);
                CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30171,
                                      rightOffsets_mem_28236.mem + i_25476 *
                                      sizeof(int64_t), sizeof(int64_t)));
            if (pevents != NULL)
                CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
        }
        if (futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t j_25481 = read_res_30171;
        int64_t j_m_i_25482 = sub64(j_25481, i_25475);
        bool empty_slice_25483 = j_m_i_25482 == (int64_t) 0;
        int64_t m_25484 = sub64(j_m_i_25482, (int64_t) 1);
        int64_t i_p_m_t_s_25485 = add64(i_25475, m_25484);
        bool zzero_leq_i_p_m_t_s_25486 = sle64((int64_t) 0, i_p_m_t_s_25485);
        bool i_p_m_t_s_leq_w_25487 = slt64(i_p_m_t_s_25485, k_25271);
        bool zzero_lte_i_25488 = sle64((int64_t) 0, i_25475);
        bool i_lte_j_25489 = sle64(i_25475, j_25481);
        bool y_25490 = i_p_m_t_s_leq_w_25487 && zzero_lte_i_25488;
        bool y_25491 = zzero_leq_i_p_m_t_s_25486 && y_25490;
        bool y_25492 = i_lte_j_25489 && y_25491;
        bool forwards_ok_25493 = zzero_lte_i_25488 && y_25492;
        bool ok_or_empty_25494 = empty_slice_25483 || forwards_ok_25493;
        bool index_certs_25495;
        
        if (!ok_or_empty_25494) {
            ctx->error =
                msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                          "Index [", i_25475, ":", j_25481,
                          "] out of bounds for array of shape [", k_25271, "].",
                          "-> #0  sparse.fut:140:32-81\n   #1  sparse.fut:219:17-59\n   #2  sparse.fut:210:1-220:48\n");
            if (memblock_unref_device(ctx, &mem_28341, "mem_28341") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28339, "mem_28339") != 0)
                return 1;
            if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                      "double_buffer_mem_28763") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28256, "mem_28256") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28248, "mem_28248") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28250, "mem_28250") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28254, "mem_28254") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28318, "mem_28318") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                      "group_res_arr_mem_29131") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                      "group_res_arr_mem_29129") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                      "group_res_arr_mem_29127") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28860, "mem_28860") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28858, "mem_28858") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28856, "mem_28856") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28337, "mem_28337") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29123, "out_mem_29123") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29121, "out_mem_29121") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29119, "out_mem_29119") !=
                0)
                return 1;
            return 1;
        }
        
        int64_t read_res_30172;
        
        {
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->copy_scalar_from_dev_runs,
                                          &ctx->copy_scalar_from_dev_total_runtime);
                CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30172,
                                      leftOffsets_mem_28233.mem + i_25470 *
                                      sizeof(int64_t), sizeof(int64_t)));
            if (pevents != NULL)
                CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
        }
        if (futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t i_25497 = read_res_30172;
        int64_t read_res_30173;
        
        {
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->copy_scalar_from_dev_runs,
                                          &ctx->copy_scalar_from_dev_total_runtime);
                CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30173,
                                      leftOffsets_mem_28233.mem + i_25476 *
                                      sizeof(int64_t), sizeof(int64_t)));
            if (pevents != NULL)
                CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
        }
        if (futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t j_25498 = read_res_30173;
        int64_t j_m_i_25499 = sub64(j_25498, i_25497);
        bool empty_slice_25500 = j_m_i_25499 == (int64_t) 0;
        int64_t m_25501 = sub64(j_m_i_25499, (int64_t) 1);
        int64_t i_p_m_t_s_25502 = add64(i_25497, m_25501);
        bool zzero_leq_i_p_m_t_s_25503 = sle64((int64_t) 0, i_p_m_t_s_25502);
        bool i_p_m_t_s_leq_w_25504 = slt64(i_p_m_t_s_25502, n_25269);
        bool zzero_lte_i_25505 = sle64((int64_t) 0, i_25497);
        bool i_lte_j_25506 = sle64(i_25497, j_25498);
        bool y_25507 = i_p_m_t_s_leq_w_25504 && zzero_lte_i_25505;
        bool y_25508 = zzero_leq_i_p_m_t_s_25503 && y_25507;
        bool y_25509 = i_lte_j_25506 && y_25508;
        bool forwards_ok_25510 = zzero_lte_i_25505 && y_25509;
        bool ok_or_empty_25511 = empty_slice_25500 || forwards_ok_25510;
        bool index_certs_25512;
        
        if (!ok_or_empty_25511) {
            ctx->error =
                msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                          "Index [", i_25497, ":", j_25498,
                          "] out of bounds for array of shape [", n_25269, "].",
                          "-> #0  sparse.fut:139:32-78\n   #1  sparse.fut:219:17-59\n   #2  sparse.fut:210:1-220:48\n");
            if (memblock_unref_device(ctx, &mem_28341, "mem_28341") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28339, "mem_28339") != 0)
                return 1;
            if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                      "double_buffer_mem_28763") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28256, "mem_28256") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28248, "mem_28248") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28250, "mem_28250") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28254, "mem_28254") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28318, "mem_28318") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                      "group_res_arr_mem_29131") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                      "group_res_arr_mem_29129") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                      "group_res_arr_mem_29127") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28860, "mem_28860") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28858, "mem_28858") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28856, "mem_28856") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28337, "mem_28337") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29123, "out_mem_29123") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29121, "out_mem_29121") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29119, "out_mem_29119") !=
                0)
                return 1;
            return 1;
        }
        
        int64_t bytes_28356 = (int64_t) 8 * j_m_i_25482;
        struct memblock_device mem_28357;
        
        mem_28357.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28357, bytes_28356, "mem_28357")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i64(ctx, mem_28357, j_m_i_25482,
                                          (int64_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device mem_28359;
        
        mem_28359.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28359, bytes_28356, "mem_28359")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhiota_i64(ctx, mem_28359, j_m_i_25482, (int64_t) 0,
                                     (int64_t) 1) != 0) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device mem_28361;
        
        mem_28361.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28361, bytes_28356, "mem_28361")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i64(ctx, mem_28361, j_m_i_25482,
                                          (int64_t) 1) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t conc_tmp_25517 = j_m_i_25482 + j_m_i_25499;
        int64_t bytes_28362 = (int64_t) 8 * j_m_i_25499;
        int64_t bytes_28366 = (int64_t) 8 * conc_tmp_25517;
        int64_t sizze_25518;
        int64_t sizze_25519;
        int64_t sizze_25520;
        int64_t sizze_25521;
        int64_t unionArrays_res_ixfn_28458;
        int64_t unionArrays_res_ixfn_28459;
        int64_t unionArrays_res_ixfn_28460;
        int64_t unionArrays_res_ixfn_28462;
        int64_t unionArrays_res_ixfn_28463;
        int64_t unionArrays_res_ixfn_28465;
        int64_t unionArrays_res_ixfn_28466;
        int64_t unionArrays_res_ixfn_28468;
        int64_t unionArrays_res_ixfn_28469;
        struct memblock_device unionArrays_res_mem_28461;
        
        unionArrays_res_mem_28461.references = NULL;
        
        struct memblock_device unionArrays_res_mem_28464;
        
        unionArrays_res_mem_28464.references = NULL;
        
        struct memblock_device unionArrays_res_mem_28467;
        
        unionArrays_res_mem_28467.references = NULL;
        
        struct memblock_device unionArrays_res_mem_28470;
        
        unionArrays_res_mem_28470.references = NULL;
        if (empty_slice_25500) {
            sizze_25518 = j_m_i_25482;
            sizze_25519 = j_m_i_25482;
            sizze_25520 = j_m_i_25482;
            sizze_25521 = j_m_i_25482;
            unionArrays_res_ixfn_28458 = j_m_i_25482;
            unionArrays_res_ixfn_28459 = k_25271;
            unionArrays_res_ixfn_28460 = i_25475;
            unionArrays_res_ixfn_28462 = j_m_i_25482;
            unionArrays_res_ixfn_28463 = j_m_i_25482;
            unionArrays_res_ixfn_28465 = j_m_i_25482;
            unionArrays_res_ixfn_28466 = j_m_i_25482;
            unionArrays_res_ixfn_28468 = j_m_i_25482;
            unionArrays_res_ixfn_28469 = j_m_i_25482;
            if (memblock_set_device(ctx, &unionArrays_res_mem_28461,
                                    &rightColumns_mem_28235,
                                    "rightColumns_mem_28235") != 0)
                return 1;
            if (memblock_set_device(ctx, &unionArrays_res_mem_28464, &mem_28361,
                                    "mem_28361") != 0)
                return 1;
            if (memblock_set_device(ctx, &unionArrays_res_mem_28467, &mem_28359,
                                    "mem_28359") != 0)
                return 1;
            if (memblock_set_device(ctx, &unionArrays_res_mem_28470, &mem_28357,
                                    "mem_28357") != 0)
                return 1;
        } else {
            struct memblock_device mem_28363;
            
            mem_28363.references = NULL;
            if (memblock_alloc_device(ctx, &mem_28363, bytes_28362,
                                      "mem_28363")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhreplicate_i64(ctx, mem_28363, j_m_i_25499,
                                              (int64_t) 0) != 0) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device mem_28365;
            
            mem_28365.references = NULL;
            if (memblock_alloc_device(ctx, &mem_28365, bytes_28362,
                                      "mem_28365")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhiota_i64(ctx, mem_28365, j_m_i_25499,
                                         (int64_t) 0, (int64_t) 1) != 0) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device mem_28367;
            
            mem_28367.references = NULL;
            if (memblock_alloc_device(ctx, &mem_28367, bytes_28366,
                                      "mem_28367")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t tmp_offs_29310 = (int64_t) 0;
            
            {
                cudaEvent_t *pevents = NULL;
                
                if (ctx->profiling && !ctx->profiling_paused) {
                    pevents = cuda_get_events(&ctx->cuda,
                                              &ctx->copy_dev_to_dev_runs,
                                              &ctx->copy_dev_to_dev_total_runtime);
                    CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
                }
                CUDA_SUCCEED(cuMemcpy(mem_28367.mem + tmp_offs_29310 *
                                      (int64_t) 8, leftColumns_mem_28232.mem +
                                      i_25497 * (int64_t) 8, j_m_i_25499 *
                                      (int64_t) sizeof(int64_t)));
                if (pevents != NULL)
                    CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
            }
            tmp_offs_29310 += j_m_i_25499;
            {
                cudaEvent_t *pevents = NULL;
                
                if (ctx->profiling && !ctx->profiling_paused) {
                    pevents = cuda_get_events(&ctx->cuda,
                                              &ctx->copy_dev_to_dev_runs,
                                              &ctx->copy_dev_to_dev_total_runtime);
                    CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
                }
                CUDA_SUCCEED(cuMemcpy(mem_28367.mem + tmp_offs_29310 *
                                      (int64_t) 8, rightColumns_mem_28235.mem +
                                      i_25475 * (int64_t) 8, j_m_i_25482 *
                                      (int64_t) sizeof(int64_t)));
                if (pevents != NULL)
                    CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
            }
            tmp_offs_29310 += j_m_i_25482;
            
            struct memblock_device mem_28369;
            
            mem_28369.references = NULL;
            if (memblock_alloc_device(ctx, &mem_28369, bytes_28366,
                                      "mem_28369")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhiota_i64(ctx, mem_28369, conc_tmp_25517,
                                         (int64_t) 0, (int64_t) 1) != 0) {
                err = 1;
                goto cleanup;
            }
            
            bool cond_25530 = conc_tmp_25517 == (int64_t) 0;
            int32_t iters_25531;
            
            if (cond_25530) {
                iters_25531 = 0;
            } else {
                iters_25531 = 32;
            }
            
            bool loop_nonempty_25532 = slt32(0, iters_25531);
            int64_t i_25533 = sub64(conc_tmp_25517, (int64_t) 1);
            bool x_25534 = sle64((int64_t) 0, i_25533);
            bool y_25535 = slt64(i_25533, conc_tmp_25517);
            bool bounds_check_25536 = x_25534 && y_25535;
            bool loop_not_taken_25537 = !loop_nonempty_25532;
            bool protect_assert_disj_25538 = bounds_check_25536 ||
                 loop_not_taken_25537;
            int64_t segscan_group_sizze_27540;
            
            segscan_group_sizze_27540 =
                ctx->sizes.eWiseAddEntryzisegscan_group_sizze_27539;
            
            int64_t num_groups_27542;
            int32_t max_num_groups_29311;
            
            max_num_groups_29311 =
                ctx->sizes.eWiseAddEntryzisegscan_num_groups_27541;
            num_groups_27542 = sext_i64_i32(smax64((int64_t) 1,
                                                   smin64(sdiv_up64(conc_tmp_25517,
                                                                    segscan_group_sizze_27540),
                                                          sext_i32_i64(max_num_groups_29311))));
            
            int64_t segmap_group_sizze_27550;
            
            segmap_group_sizze_27550 =
                ctx->sizes.eWiseAddEntryzisegmap_group_sizze_27549;
            
            int64_t segmap_usable_groups_27551 = sdiv_up_safe64(conc_tmp_25517,
                                                                segmap_group_sizze_27550);
            int64_t segmap_group_sizze_27631;
            
            segmap_group_sizze_27631 =
                ctx->sizes.eWiseAddEntryzisegmap_group_sizze_27608;
            
            int64_t segscan_group_sizze_27658;
            
            segscan_group_sizze_27658 =
                ctx->sizes.eWiseAddEntryzisegscan_group_sizze_27657;
            
            int64_t num_groups_27660;
            int32_t max_num_groups_29312;
            
            max_num_groups_29312 =
                ctx->sizes.eWiseAddEntryzisegscan_num_groups_27659;
            num_groups_27660 = sext_i64_i32(smax64((int64_t) 1,
                                                   smin64(sdiv_up64(conc_tmp_25517,
                                                                    segscan_group_sizze_27658),
                                                          sext_i32_i64(max_num_groups_29312))));
            
            int64_t bytes_28393 = (int64_t) 4 * conc_tmp_25517;
            int64_t unionArrays_res_f_res_ixfn_28446;
            
            if (empty_slice_25483) {
                unionArrays_res_f_res_ixfn_28446 = n_25269;
            } else {
                unionArrays_res_f_res_ixfn_28446 = conc_tmp_25517;
            }
            
            int64_t unionArrays_res_f_res_ixfn_28447;
            
            if (empty_slice_25483) {
                unionArrays_res_f_res_ixfn_28447 = i_25497;
            } else {
                unionArrays_res_f_res_ixfn_28447 = (int64_t) 0;
            }
            
            int64_t unionArrays_res_f_res_ixfn_28450;
            
            if (empty_slice_25483) {
                unionArrays_res_f_res_ixfn_28450 = j_m_i_25499;
            } else {
                unionArrays_res_f_res_ixfn_28450 = conc_tmp_25517;
            }
            
            int64_t sizze_25539;
            int64_t sizze_25540;
            int64_t sizze_25541;
            int64_t sizze_25542;
            int64_t unionArrays_res_f_res_ixfn_28445;
            int64_t unionArrays_res_f_res_ixfn_28449;
            int64_t unionArrays_res_f_res_ixfn_28452;
            int64_t unionArrays_res_f_res_ixfn_28455;
            struct memblock_device unionArrays_res_f_res_mem_28448;
            
            unionArrays_res_f_res_mem_28448.references = NULL;
            
            struct memblock_device unionArrays_res_f_res_mem_28451;
            
            unionArrays_res_f_res_mem_28451.references = NULL;
            
            struct memblock_device unionArrays_res_f_res_mem_28454;
            
            unionArrays_res_f_res_mem_28454.references = NULL;
            
            struct memblock_device unionArrays_res_f_res_mem_28457;
            
            unionArrays_res_f_res_mem_28457.references = NULL;
            if (empty_slice_25483) {
                sizze_25539 = j_m_i_25499;
                sizze_25540 = j_m_i_25499;
                sizze_25541 = j_m_i_25499;
                sizze_25542 = j_m_i_25499;
                unionArrays_res_f_res_ixfn_28445 = j_m_i_25499;
                unionArrays_res_f_res_ixfn_28449 = j_m_i_25499;
                unionArrays_res_f_res_ixfn_28452 = j_m_i_25499;
                unionArrays_res_f_res_ixfn_28455 = j_m_i_25499;
                if (memblock_set_device(ctx, &unionArrays_res_f_res_mem_28448,
                                        &leftColumns_mem_28232,
                                        "leftColumns_mem_28232") != 0)
                    return 1;
                if (memblock_set_device(ctx, &unionArrays_res_f_res_mem_28451,
                                        &mem_28363, "mem_28363") != 0)
                    return 1;
                if (memblock_set_device(ctx, &unionArrays_res_f_res_mem_28454,
                                        &mem_28365, "mem_28365") != 0)
                    return 1;
                if (memblock_set_device(ctx, &unionArrays_res_f_res_mem_28457,
                                        &mem_28363, "mem_28363") != 0)
                    return 1;
            } else {
                bool index_certs_25547;
                
                if (!protect_assert_disj_25538) {
                    ctx->error =
                        msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                  "Index [", i_25533,
                                  "] out of bounds for array of shape [",
                                  conc_tmp_25517, "].",
                                  "-> #0  /prelude/array.fut:18:29-34\n   #1  lib/github.com/diku-dk/sorts/radix_sort.fut:25:24-35\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:53:31-62\n   #3  /prelude/functional.fut:9:42-44\n   #4  lib/github.com/diku-dk/sorts/radix_sort.fut:59:3-61:47\n   #5  lib/github.com/diku-dk/sorts/radix_sort.fut:68:3-51\n   #6  sparse.fut:5:34-6:77\n   #7  sparse.fut:53:12-35\n   #8  sparse.fut:138:59-140:81\n   #9  sparse.fut:219:17-59\n   #10 sparse.fut:210:1-220:48\n");
                    if (memblock_unref_device(ctx,
                                              &unionArrays_res_f_res_mem_28457,
                                              "unionArrays_res_f_res_mem_28457") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &unionArrays_res_f_res_mem_28454,
                                              "unionArrays_res_f_res_mem_28454") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &unionArrays_res_f_res_mem_28451,
                                              "unionArrays_res_f_res_mem_28451") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &unionArrays_res_f_res_mem_28448,
                                              "unionArrays_res_f_res_mem_28448") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28369, "mem_28369") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28367, "mem_28367") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28365, "mem_28365") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28363, "mem_28363") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &unionArrays_res_mem_28470,
                                              "unionArrays_res_mem_28470") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &unionArrays_res_mem_28467,
                                              "unionArrays_res_mem_28467") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &unionArrays_res_mem_28464,
                                              "unionArrays_res_mem_28464") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &unionArrays_res_mem_28461,
                                              "unionArrays_res_mem_28461") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28361, "mem_28361") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28359, "mem_28359") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28357, "mem_28357") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28341, "mem_28341") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28339, "mem_28339") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                              "double_buffer_mem_28763") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28256, "mem_28256") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28239, "mem_28239") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28248, "mem_28248") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28250, "mem_28250") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28252, "mem_28252") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28254, "mem_28254") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28318, "mem_28318") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                              "group_res_arr_mem_29131") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                              "group_res_arr_mem_29129") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                              "group_res_arr_mem_29127") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28860, "mem_28860") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28858, "mem_28858") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28856, "mem_28856") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28337, "mem_28337") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &out_mem_29123,
                                              "out_mem_29123") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &out_mem_29121,
                                              "out_mem_29121") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &out_mem_29119,
                                              "out_mem_29119") != 0)
                        return 1;
                    return 1;
                }
                
                struct memblock_device mem_28386;
                
                mem_28386.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28386, bytes_28366,
                                          "mem_28386")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28388;
                
                mem_28388.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28388, bytes_28366,
                                          "mem_28388")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28390;
                
                mem_28390.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28390, bytes_28366,
                                          "mem_28390")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28392;
                
                mem_28392.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28392, bytes_28366,
                                          "mem_28392")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28394;
                
                mem_28394.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28394, bytes_28393,
                                          "mem_28394")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device defunc_0_f_res_mem_28408;
                
                defunc_0_f_res_mem_28408.references = NULL;
                
                struct memblock_device defunc_0_f_res_mem_28413;
                
                defunc_0_f_res_mem_28413.references = NULL;
                
                struct memblock_device mem_param_28374;
                
                mem_param_28374.references = NULL;
                
                struct memblock_device mem_param_28379;
                
                mem_param_28379.references = NULL;
                if (memblock_set_device(ctx, &mem_param_28374, &mem_28367,
                                        "mem_28367") != 0)
                    return 1;
                if (memblock_set_device(ctx, &mem_param_28379, &mem_28369,
                                        "mem_28369") != 0)
                    return 1;
                for (int32_t i_25550 = 0; i_25550 < iters_25531; i_25550++) {
                    int32_t defunc_2_radix_sort_step_arg_25553 = mul32(2,
                                                                       i_25550);
                    int32_t defunc_0_get_bit_arg_25554 = add32(1,
                                                               defunc_2_radix_sort_step_arg_25553);
                    int64_t i32_res_25555 =
                            sext_i32_i64(defunc_0_get_bit_arg_25554);
                    int64_t i32_res_25556 =
                            sext_i32_i64(defunc_2_radix_sort_step_arg_25553);
                    
                    if (slt64((int64_t) 0, conc_tmp_25517)) {
                        if (ctx->debugging)
                            fprintf(stderr, "%s\n", "\n# SegScan");
                        
                        int64_t numThreads_29317;
                        
                        numThreads_29317 = sdiv_up64(conc_tmp_25517,
                                                     segscan_group_sizze_27540 *
                                                     (int64_t) 9) *
                            segscan_group_sizze_27540;
                        
                        int64_t numGroups_29318;
                        
                        numGroups_29318 = sdiv_up64(conc_tmp_25517,
                                                    segscan_group_sizze_27540 *
                                                    (int64_t) 9);
                        
                        struct memblock_device
                        eWiseAddEntryziid_counter_mem_29319 =
                        ctx->eWiseAddEntryziid_counter_mem_29319;
                        struct memblock_device status_flags_mem_29321;
                        
                        status_flags_mem_29321.references = NULL;
                        if (memblock_alloc_device(ctx, &status_flags_mem_29321,
                                                  (int64_t) sizeof(int8_t) *
                                                  numGroups_29318,
                                                  "status_flags_mem_29321")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        struct memblock_device aggregates_mem_29323;
                        
                        aggregates_mem_29323.references = NULL;
                        if (memblock_alloc_device(ctx, &aggregates_mem_29323,
                                                  (int64_t) sizeof(int64_t) *
                                                  numGroups_29318,
                                                  "aggregates_mem_29323")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        struct memblock_device incprefixes_mem_29325;
                        
                        incprefixes_mem_29325.references = NULL;
                        if (memblock_alloc_device(ctx, &incprefixes_mem_29325,
                                                  (int64_t) sizeof(int64_t) *
                                                  numGroups_29318,
                                                  "incprefixes_mem_29325")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        struct memblock_device aggregates_mem_29327;
                        
                        aggregates_mem_29327.references = NULL;
                        if (memblock_alloc_device(ctx, &aggregates_mem_29327,
                                                  (int64_t) sizeof(int64_t) *
                                                  numGroups_29318,
                                                  "aggregates_mem_29327")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        struct memblock_device incprefixes_mem_29329;
                        
                        incprefixes_mem_29329.references = NULL;
                        if (memblock_alloc_device(ctx, &incprefixes_mem_29329,
                                                  (int64_t) sizeof(int64_t) *
                                                  numGroups_29318,
                                                  "incprefixes_mem_29329")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        struct memblock_device aggregates_mem_29331;
                        
                        aggregates_mem_29331.references = NULL;
                        if (memblock_alloc_device(ctx, &aggregates_mem_29331,
                                                  (int64_t) sizeof(int64_t) *
                                                  numGroups_29318,
                                                  "aggregates_mem_29331")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        struct memblock_device incprefixes_mem_29333;
                        
                        incprefixes_mem_29333.references = NULL;
                        if (memblock_alloc_device(ctx, &incprefixes_mem_29333,
                                                  (int64_t) sizeof(int64_t) *
                                                  numGroups_29318,
                                                  "incprefixes_mem_29333")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        struct memblock_device aggregates_mem_29335;
                        
                        aggregates_mem_29335.references = NULL;
                        if (memblock_alloc_device(ctx, &aggregates_mem_29335,
                                                  (int64_t) sizeof(int64_t) *
                                                  numGroups_29318,
                                                  "aggregates_mem_29335")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        struct memblock_device incprefixes_mem_29337;
                        
                        incprefixes_mem_29337.references = NULL;
                        if (memblock_alloc_device(ctx, &incprefixes_mem_29337,
                                                  (int64_t) sizeof(int64_t) *
                                                  numGroups_29318,
                                                  "incprefixes_mem_29337")) {
                            err = 1;
                            goto cleanup;
                        }
                        if (futrts_builtinzhreplicate_i8(ctx,
                                                         status_flags_mem_29321,
                                                         numGroups_29318,
                                                         (int8_t) 0) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        unsigned int shared_sizze_30178 =
                                     smax64(smax64((int64_t) 1056,
                                                   sdiv_up64(sdiv_up64(sdiv_up64((int64_t) 8 *
                                                                                 segscan_group_sizze_27540,
                                                                                 (int64_t) 8) *
                                                                       (int64_t) 8 +
                                                                       (int64_t) 8 *
                                                                       segscan_group_sizze_27540,
                                                                       (int64_t) 8) *
                                                             (int64_t) 8 +
                                                             (int64_t) 8 *
                                                             segscan_group_sizze_27540,
                                                             (int64_t) 8) *
                                                   (int64_t) 8 + (int64_t) 8 *
                                                   segscan_group_sizze_27540),
                                            smax64(smax64(smax64((int64_t) 9 *
                                                                 segscan_group_sizze_27540 *
                                                                 (int64_t) 8,
                                                                 (int64_t) 9 *
                                                                 segscan_group_sizze_27540 *
                                                                 (int64_t) 8),
                                                          (int64_t) 9 *
                                                          segscan_group_sizze_27540 *
                                                          (int64_t) 8),
                                                   (int64_t) 9 *
                                                   segscan_group_sizze_27540 *
                                                   (int64_t) 8));
                        CUdeviceptr kernel_arg_30180 = mem_param_28374.mem;
                        CUdeviceptr kernel_arg_30181 = mem_28386.mem;
                        CUdeviceptr kernel_arg_30182 = mem_28388.mem;
                        CUdeviceptr kernel_arg_30183 = mem_28390.mem;
                        CUdeviceptr kernel_arg_30184 = mem_28392.mem;
                        CUdeviceptr kernel_arg_30185 = mem_28394.mem;
                        CUdeviceptr kernel_arg_30186 =
                                    eWiseAddEntryziid_counter_mem_29319.mem;
                        CUdeviceptr kernel_arg_30187 =
                                    status_flags_mem_29321.mem;
                        CUdeviceptr kernel_arg_30188 = aggregates_mem_29323.mem;
                        CUdeviceptr kernel_arg_30189 =
                                    incprefixes_mem_29325.mem;
                        CUdeviceptr kernel_arg_30190 = aggregates_mem_29327.mem;
                        CUdeviceptr kernel_arg_30191 =
                                    incprefixes_mem_29329.mem;
                        CUdeviceptr kernel_arg_30192 = aggregates_mem_29331.mem;
                        CUdeviceptr kernel_arg_30193 =
                                    incprefixes_mem_29333.mem;
                        CUdeviceptr kernel_arg_30194 = aggregates_mem_29335.mem;
                        CUdeviceptr kernel_arg_30195 =
                                    incprefixes_mem_29337.mem;
                        unsigned int shared_offset_30179 = 0;
                        
                        if ((((((1 && sdiv_up64(conc_tmp_25517,
                                                segscan_group_sizze_27540 *
                                                (int64_t) 9) != 0) && 1 != 0) &&
                               1 != 0) && segscan_group_sizze_27540 != 0) &&
                             1 != 0) && 1 != 0) {
                            int perm[3] = {0, 1, 2};
                            
                            if (1 >= 1 << 16) {
                                perm[1] = perm[0];
                                perm[0] = 1;
                            }
                            if (1 >= 1 << 16) {
                                perm[2] = perm[0];
                                perm[0] = 2;
                            }
                            
                            size_t grid[3];
                            
                            grid[perm[0]] = sdiv_up64(conc_tmp_25517,
                                                      segscan_group_sizze_27540 *
                                                      (int64_t) 9);
                            grid[perm[1]] = 1;
                            grid[perm[2]] = 1;
                            
                            void *kernel_args_30175[] = {&ctx->global_failure,
                                                         &shared_offset_30179,
                                                         &conc_tmp_25517,
                                                         &i32_res_25555,
                                                         &i32_res_25556,
                                                         &kernel_arg_30180,
                                                         &kernel_arg_30181,
                                                         &kernel_arg_30182,
                                                         &kernel_arg_30183,
                                                         &kernel_arg_30184,
                                                         &kernel_arg_30185,
                                                         &kernel_arg_30186,
                                                         &kernel_arg_30187,
                                                         &kernel_arg_30188,
                                                         &kernel_arg_30189,
                                                         &kernel_arg_30190,
                                                         &kernel_arg_30191,
                                                         &kernel_arg_30192,
                                                         &kernel_arg_30193,
                                                         &kernel_arg_30194,
                                                         &kernel_arg_30195};
                            int64_t time_start_30176 = 0, time_end_30177 = 0;
                            
                            if (ctx->debugging) {
                                fprintf(stderr, "Launching %s with grid size (",
                                        "eWiseAddEntry.segscan_27545");
                                fprintf(stderr, "%d", sdiv_up64(conc_tmp_25517,
                                                                segscan_group_sizze_27540 *
                                                                (int64_t) 9));
                                fprintf(stderr, ", ");
                                fprintf(stderr, "%d", 1);
                                fprintf(stderr, ", ");
                                fprintf(stderr, "%d", 1);
                                fprintf(stderr, ") and block size (");
                                fprintf(stderr, "%d",
                                        segscan_group_sizze_27540);
                                fprintf(stderr, ", ");
                                fprintf(stderr, "%d", 1);
                                fprintf(stderr, ", ");
                                fprintf(stderr, "%d", 1);
                                fprintf(stderr, ").\n");
                                time_start_30176 = get_wall_time();
                            }
                            
                            cudaEvent_t *pevents = NULL;
                            
                            if (ctx->profiling && !ctx->profiling_paused) {
                                pevents = cuda_get_events(&ctx->cuda,
                                                          &ctx->eWiseAddEntryzisegscan_27545_runs,
                                                          &ctx->eWiseAddEntryzisegscan_27545_total_runtime);
                                CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
                            }
                            CUDA_SUCCEED(cuLaunchKernel(ctx->eWiseAddEntryzisegscan_27545,
                                                        grid[0], grid[1],
                                                        grid[2],
                                                        segscan_group_sizze_27540,
                                                        1, 1, 0 +
                                                        (shared_sizze_30178 +
                                                         (8 -
                                                          shared_sizze_30178 %
                                                          8) % 8), NULL,
                                                        kernel_args_30175,
                                                        NULL));
                            if (pevents != NULL)
                                CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
                            if (ctx->debugging) {
                                CUDA_SUCCEED(cuCtxSynchronize());
                                time_end_30177 = get_wall_time();
                                fprintf(stderr, "Kernel %s runtime: %ldus\n",
                                        "eWiseAddEntry.segscan_27545",
                                        time_end_30177 - time_start_30176);
                            }
                        }
                        if (memblock_unref_device(ctx, &incprefixes_mem_29337,
                                                  "incprefixes_mem_29337") != 0)
                            return 1;
                        if (memblock_unref_device(ctx, &aggregates_mem_29335,
                                                  "aggregates_mem_29335") != 0)
                            return 1;
                        if (memblock_unref_device(ctx, &incprefixes_mem_29333,
                                                  "incprefixes_mem_29333") != 0)
                            return 1;
                        if (memblock_unref_device(ctx, &aggregates_mem_29331,
                                                  "aggregates_mem_29331") != 0)
                            return 1;
                        if (memblock_unref_device(ctx, &incprefixes_mem_29329,
                                                  "incprefixes_mem_29329") != 0)
                            return 1;
                        if (memblock_unref_device(ctx, &aggregates_mem_29327,
                                                  "aggregates_mem_29327") != 0)
                            return 1;
                        if (memblock_unref_device(ctx, &incprefixes_mem_29325,
                                                  "incprefixes_mem_29325") != 0)
                            return 1;
                        if (memblock_unref_device(ctx, &aggregates_mem_29323,
                                                  "aggregates_mem_29323") != 0)
                            return 1;
                        if (memblock_unref_device(ctx, &status_flags_mem_29321,
                                                  "status_flags_mem_29321") !=
                            0)
                            return 1;
                    }
                    
                    int64_t read_res_30196;
                    
                    {
                        cudaEvent_t *pevents = NULL;
                        
                        if (ctx->profiling && !ctx->profiling_paused) {
                            pevents = cuda_get_events(&ctx->cuda,
                                                      &ctx->copy_scalar_from_dev_runs,
                                                      &ctx->copy_scalar_from_dev_total_runtime);
                            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
                        }
                        CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30196,
                                                  mem_28386.mem + i_25533 *
                                                  sizeof(int64_t),
                                                  sizeof(int64_t)));
                        if (pevents != NULL)
                            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
                    }
                    if (futhark_context_sync(ctx) != 0)
                        return 1;
                    
                    int64_t last_res_25611 = read_res_30196;
                    int64_t read_res_30197;
                    
                    {
                        cudaEvent_t *pevents = NULL;
                        
                        if (ctx->profiling && !ctx->profiling_paused) {
                            pevents = cuda_get_events(&ctx->cuda,
                                                      &ctx->copy_scalar_from_dev_runs,
                                                      &ctx->copy_scalar_from_dev_total_runtime);
                            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
                        }
                        CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30197,
                                                  mem_28388.mem + i_25533 *
                                                  sizeof(int64_t),
                                                  sizeof(int64_t)));
                        if (pevents != NULL)
                            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
                    }
                    if (futhark_context_sync(ctx) != 0)
                        return 1;
                    
                    int64_t last_res_25612 = read_res_30197;
                    int64_t read_res_30198;
                    
                    {
                        cudaEvent_t *pevents = NULL;
                        
                        if (ctx->profiling && !ctx->profiling_paused) {
                            pevents = cuda_get_events(&ctx->cuda,
                                                      &ctx->copy_scalar_from_dev_runs,
                                                      &ctx->copy_scalar_from_dev_total_runtime);
                            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
                        }
                        CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30198,
                                                  mem_28390.mem + i_25533 *
                                                  sizeof(int64_t),
                                                  sizeof(int64_t)));
                        if (pevents != NULL)
                            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
                    }
                    if (futhark_context_sync(ctx) != 0)
                        return 1;
                    
                    int64_t last_res_25613 = read_res_30198;
                    struct memblock_device mem_28396;
                    
                    mem_28396.references = NULL;
                    if (memblock_alloc_device(ctx, &mem_28396, bytes_28366,
                                              "mem_28396")) {
                        err = 1;
                        goto cleanup;
                    }
                    {
                        cudaEvent_t *pevents = NULL;
                        
                        if (ctx->profiling && !ctx->profiling_paused) {
                            pevents = cuda_get_events(&ctx->cuda,
                                                      &ctx->copy_dev_to_dev_runs,
                                                      &ctx->copy_dev_to_dev_total_runtime);
                            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
                        }
                        CUDA_SUCCEED(cuMemcpy(mem_28396.mem + (int64_t) 0,
                                              mem_param_28374.mem + (int64_t) 0,
                                              conc_tmp_25517 *
                                              (int64_t) sizeof(int64_t)));
                        if (pevents != NULL)
                            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
                    }
                    
                    struct memblock_device mem_28398;
                    
                    mem_28398.references = NULL;
                    if (memblock_alloc_device(ctx, &mem_28398, bytes_28366,
                                              "mem_28398")) {
                        err = 1;
                        goto cleanup;
                    }
                    {
                        cudaEvent_t *pevents = NULL;
                        
                        if (ctx->profiling && !ctx->profiling_paused) {
                            pevents = cuda_get_events(&ctx->cuda,
                                                      &ctx->copy_dev_to_dev_runs,
                                                      &ctx->copy_dev_to_dev_total_runtime);
                            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
                        }
                        CUDA_SUCCEED(cuMemcpy(mem_28398.mem + (int64_t) 0,
                                              mem_param_28379.mem + (int64_t) 0,
                                              conc_tmp_25517 *
                                              (int64_t) sizeof(int64_t)));
                        if (pevents != NULL)
                            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
                    }
                    if (ctx->debugging)
                        fprintf(stderr, "%s\n", "\n# SegMap");
                    
                    CUdeviceptr kernel_arg_30202 = mem_param_28374.mem;
                    CUdeviceptr kernel_arg_30203 = mem_param_28379.mem;
                    CUdeviceptr kernel_arg_30204 = mem_28386.mem;
                    CUdeviceptr kernel_arg_30205 = mem_28388.mem;
                    CUdeviceptr kernel_arg_30206 = mem_28390.mem;
                    CUdeviceptr kernel_arg_30207 = mem_28392.mem;
                    CUdeviceptr kernel_arg_30208 = mem_28394.mem;
                    CUdeviceptr kernel_arg_30209 = mem_28396.mem;
                    CUdeviceptr kernel_arg_30210 = mem_28398.mem;
                    
                    if ((((((1 && segmap_usable_groups_27551 != 0) && 1 != 0) &&
                           1 != 0) && segmap_group_sizze_27550 != 0) && 1 !=
                         0) && 1 != 0) {
                        int perm[3] = {0, 1, 2};
                        
                        if (1 >= 1 << 16) {
                            perm[1] = perm[0];
                            perm[0] = 1;
                        }
                        if (1 >= 1 << 16) {
                            perm[2] = perm[0];
                            perm[0] = 2;
                        }
                        
                        size_t grid[3];
                        
                        grid[perm[0]] = segmap_usable_groups_27551;
                        grid[perm[1]] = 1;
                        grid[perm[2]] = 1;
                        
                        void *kernel_args_30199[] = {&ctx->global_failure,
                                                     &conc_tmp_25517,
                                                     &last_res_25611,
                                                     &last_res_25612,
                                                     &last_res_25613,
                                                     &kernel_arg_30202,
                                                     &kernel_arg_30203,
                                                     &kernel_arg_30204,
                                                     &kernel_arg_30205,
                                                     &kernel_arg_30206,
                                                     &kernel_arg_30207,
                                                     &kernel_arg_30208,
                                                     &kernel_arg_30209,
                                                     &kernel_arg_30210};
                        int64_t time_start_30200 = 0, time_end_30201 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(stderr, "Launching %s with grid size (",
                                    "eWiseAddEntry.segmap_27547");
                            fprintf(stderr, "%d", segmap_usable_groups_27551);
                            fprintf(stderr, ", ");
                            fprintf(stderr, "%d", 1);
                            fprintf(stderr, ", ");
                            fprintf(stderr, "%d", 1);
                            fprintf(stderr, ") and block size (");
                            fprintf(stderr, "%d", segmap_group_sizze_27550);
                            fprintf(stderr, ", ");
                            fprintf(stderr, "%d", 1);
                            fprintf(stderr, ", ");
                            fprintf(stderr, "%d", 1);
                            fprintf(stderr, ").\n");
                            time_start_30200 = get_wall_time();
                        }
                        
                        cudaEvent_t *pevents = NULL;
                        
                        if (ctx->profiling && !ctx->profiling_paused) {
                            pevents = cuda_get_events(&ctx->cuda,
                                                      &ctx->eWiseAddEntryzisegmap_27547_runs,
                                                      &ctx->eWiseAddEntryzisegmap_27547_total_runtime);
                            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
                        }
                        CUDA_SUCCEED(cuLaunchKernel(ctx->eWiseAddEntryzisegmap_27547,
                                                    grid[0], grid[1], grid[2],
                                                    segmap_group_sizze_27550, 1,
                                                    1, 0, NULL,
                                                    kernel_args_30199, NULL));
                        if (pevents != NULL)
                            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
                        if (ctx->debugging) {
                            CUDA_SUCCEED(cuCtxSynchronize());
                            time_end_30201 = get_wall_time();
                            fprintf(stderr, "Kernel %s runtime: %ldus\n",
                                    "eWiseAddEntry.segmap_27547",
                                    time_end_30201 - time_start_30200);
                        }
                    }
                    
                    struct memblock_device mem_param_tmp_29313;
                    
                    mem_param_tmp_29313.references = NULL;
                    if (memblock_set_device(ctx, &mem_param_tmp_29313,
                                            &mem_28396, "mem_28396") != 0)
                        return 1;
                    
                    struct memblock_device mem_param_tmp_29314;
                    
                    mem_param_tmp_29314.references = NULL;
                    if (memblock_set_device(ctx, &mem_param_tmp_29314,
                                            &mem_28398, "mem_28398") != 0)
                        return 1;
                    if (memblock_set_device(ctx, &mem_param_28374,
                                            &mem_param_tmp_29313,
                                            "mem_param_tmp_29313") != 0)
                        return 1;
                    if (memblock_set_device(ctx, &mem_param_28379,
                                            &mem_param_tmp_29314,
                                            "mem_param_tmp_29314") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_param_tmp_29314,
                                              "mem_param_tmp_29314") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_param_tmp_29313,
                                              "mem_param_tmp_29313") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28398, "mem_28398") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28396, "mem_28396") !=
                        0)
                        return 1;
                }
                if (memblock_set_device(ctx, &defunc_0_f_res_mem_28408,
                                        &mem_param_28374, "mem_param_28374") !=
                    0)
                    return 1;
                if (memblock_set_device(ctx, &defunc_0_f_res_mem_28413,
                                        &mem_param_28379, "mem_param_28379") !=
                    0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28386, "mem_28386") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28388, "mem_28388") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28390, "mem_28390") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28392, "mem_28392") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28394, "mem_28394") != 0)
                    return 1;
                
                int64_t segmap_usable_groups_27632 = sdiv_up64(conc_tmp_25517,
                                                               segmap_group_sizze_27631);
                struct memblock_device mem_28416;
                
                mem_28416.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28416, bytes_28366,
                                          "mem_28416")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28418;
                
                mem_28418.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28418, bytes_28366,
                                          "mem_28418")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28420;
                
                mem_28420.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28420, bytes_28366,
                                          "mem_28420")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28422;
                
                mem_28422.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28422, bytes_28366,
                                          "mem_28422")) {
                    err = 1;
                    goto cleanup;
                }
                if (ctx->debugging)
                    fprintf(stderr, "%s\n", "\n# SegMap");
                
                CUdeviceptr kernel_arg_30214 = leftColumns_mem_28232.mem;
                CUdeviceptr kernel_arg_30215 = rightColumns_mem_28235.mem;
                CUdeviceptr kernel_arg_30216 = defunc_0_f_res_mem_28413.mem;
                CUdeviceptr kernel_arg_30217 = mem_28416.mem;
                CUdeviceptr kernel_arg_30218 = mem_28418.mem;
                CUdeviceptr kernel_arg_30219 = mem_28420.mem;
                CUdeviceptr kernel_arg_30220 = mem_28422.mem;
                
                if ((((((1 && segmap_usable_groups_27632 != 0) && 1 != 0) &&
                       1 != 0) && segmap_group_sizze_27631 != 0) && 1 != 0) &&
                    1 != 0) {
                    int perm[3] = {0, 1, 2};
                    
                    if (1 >= 1 << 16) {
                        perm[1] = perm[0];
                        perm[0] = 1;
                    }
                    if (1 >= 1 << 16) {
                        perm[2] = perm[0];
                        perm[0] = 2;
                    }
                    
                    size_t grid[3];
                    
                    grid[perm[0]] = segmap_usable_groups_27632;
                    grid[perm[1]] = 1;
                    grid[perm[2]] = 1;
                    
                    void *kernel_args_30211[] = {&ctx->global_failure,
                                                 &ctx->failure_is_an_option,
                                                 &ctx->global_failure_args,
                                                 &i_25475, &i_25497,
                                                 &j_m_i_25499, &conc_tmp_25517,
                                                 &kernel_arg_30214,
                                                 &kernel_arg_30215,
                                                 &kernel_arg_30216,
                                                 &kernel_arg_30217,
                                                 &kernel_arg_30218,
                                                 &kernel_arg_30219,
                                                 &kernel_arg_30220};
                    int64_t time_start_30212 = 0, time_end_30213 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(stderr, "Launching %s with grid size (",
                                "eWiseAddEntry.segmap_27606");
                        fprintf(stderr, "%d", segmap_usable_groups_27632);
                        fprintf(stderr, ", ");
                        fprintf(stderr, "%d", 1);
                        fprintf(stderr, ", ");
                        fprintf(stderr, "%d", 1);
                        fprintf(stderr, ") and block size (");
                        fprintf(stderr, "%d", segmap_group_sizze_27631);
                        fprintf(stderr, ", ");
                        fprintf(stderr, "%d", 1);
                        fprintf(stderr, ", ");
                        fprintf(stderr, "%d", 1);
                        fprintf(stderr, ").\n");
                        time_start_30212 = get_wall_time();
                    }
                    
                    cudaEvent_t *pevents = NULL;
                    
                    if (ctx->profiling && !ctx->profiling_paused) {
                        pevents = cuda_get_events(&ctx->cuda,
                                                  &ctx->eWiseAddEntryzisegmap_27606_runs,
                                                  &ctx->eWiseAddEntryzisegmap_27606_total_runtime);
                        CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
                    }
                    CUDA_SUCCEED(cuLaunchKernel(ctx->eWiseAddEntryzisegmap_27606,
                                                grid[0], grid[1], grid[2],
                                                segmap_group_sizze_27631, 1, 1,
                                                0, NULL, kernel_args_30211,
                                                NULL));
                    if (pevents != NULL)
                        CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
                    if (ctx->debugging) {
                        CUDA_SUCCEED(cuCtxSynchronize());
                        time_end_30213 = get_wall_time();
                        fprintf(stderr, "Kernel %s runtime: %ldus\n",
                                "eWiseAddEntry.segmap_27606", time_end_30213 -
                                time_start_30212);
                    }
                }
                ctx->failure_is_an_option = 1;
                if (memblock_unref_device(ctx, &defunc_0_f_res_mem_28413,
                                          "defunc_0_f_res_mem_28413") != 0)
                    return 1;
                
                struct memblock_device mem_28425;
                
                mem_28425.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28425, bytes_28366,
                                          "mem_28425")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28427;
                
                mem_28427.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28427, bytes_28366,
                                          "mem_28427")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28429;
                
                mem_28429.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28429, bytes_28366,
                                          "mem_28429")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28431;
                
                mem_28431.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28431, bytes_28366,
                                          "mem_28431")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28433;
                
                mem_28433.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28433, bytes_28366,
                                          "mem_28433")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28435;
                
                mem_28435.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28435, bytes_28366,
                                          "mem_28435")) {
                    err = 1;
                    goto cleanup;
                }
                if (slt64((int64_t) 0, conc_tmp_25517)) {
                    if (ctx->debugging)
                        fprintf(stderr, "%s\n", "\n# SegScan");
                    
                    int64_t numThreads_29540;
                    
                    numThreads_29540 = sdiv_up64(conc_tmp_25517,
                                                 segscan_group_sizze_27658 *
                                                 (int64_t) 9) *
                        segscan_group_sizze_27658;
                    
                    int64_t numGroups_29541;
                    
                    numGroups_29541 = sdiv_up64(conc_tmp_25517,
                                                segscan_group_sizze_27658 *
                                                (int64_t) 9);
                    
                    struct memblock_device eWiseAddEntryziid_counter_mem_29542 =
                                           ctx->eWiseAddEntryziid_counter_mem_29542;
                    struct memblock_device status_flags_mem_29544;
                    
                    status_flags_mem_29544.references = NULL;
                    if (memblock_alloc_device(ctx, &status_flags_mem_29544,
                                              (int64_t) sizeof(int8_t) *
                                              numGroups_29541,
                                              "status_flags_mem_29544")) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    struct memblock_device aggregates_mem_29546;
                    
                    aggregates_mem_29546.references = NULL;
                    if (memblock_alloc_device(ctx, &aggregates_mem_29546,
                                              (int64_t) sizeof(int64_t) *
                                              numGroups_29541,
                                              "aggregates_mem_29546")) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    struct memblock_device incprefixes_mem_29548;
                    
                    incprefixes_mem_29548.references = NULL;
                    if (memblock_alloc_device(ctx, &incprefixes_mem_29548,
                                              (int64_t) sizeof(int64_t) *
                                              numGroups_29541,
                                              "incprefixes_mem_29548")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (futrts_builtinzhreplicate_i8(ctx,
                                                     status_flags_mem_29544,
                                                     numGroups_29541,
                                                     (int8_t) 0) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    unsigned int shared_sizze_30225 =
                                 smax64(smax64((int64_t) 288, (int64_t) 8 *
                                               segscan_group_sizze_27658),
                                        (int64_t) 9 *
                                        segscan_group_sizze_27658 *
                                        (int64_t) 8);
                    CUdeviceptr kernel_arg_30227 = mem_28416.mem;
                    CUdeviceptr kernel_arg_30228 = mem_28418.mem;
                    CUdeviceptr kernel_arg_30229 = mem_28420.mem;
                    CUdeviceptr kernel_arg_30230 = mem_28422.mem;
                    CUdeviceptr kernel_arg_30231 = mem_28425.mem;
                    CUdeviceptr kernel_arg_30232 = mem_28427.mem;
                    CUdeviceptr kernel_arg_30233 = mem_28429.mem;
                    CUdeviceptr kernel_arg_30234 = mem_28431.mem;
                    CUdeviceptr kernel_arg_30235 = mem_28433.mem;
                    CUdeviceptr kernel_arg_30236 = mem_28435.mem;
                    CUdeviceptr kernel_arg_30237 =
                                eWiseAddEntryziid_counter_mem_29542.mem;
                    CUdeviceptr kernel_arg_30238 = status_flags_mem_29544.mem;
                    CUdeviceptr kernel_arg_30239 = aggregates_mem_29546.mem;
                    CUdeviceptr kernel_arg_30240 = incprefixes_mem_29548.mem;
                    unsigned int shared_offset_30226 = 0;
                    
                    if ((((((1 && sdiv_up64(conc_tmp_25517,
                                            segscan_group_sizze_27658 *
                                            (int64_t) 9) != 0) && 1 != 0) &&
                           1 != 0) && segscan_group_sizze_27658 != 0) && 1 !=
                         0) && 1 != 0) {
                        int perm[3] = {0, 1, 2};
                        
                        if (1 >= 1 << 16) {
                            perm[1] = perm[0];
                            perm[0] = 1;
                        }
                        if (1 >= 1 << 16) {
                            perm[2] = perm[0];
                            perm[0] = 2;
                        }
                        
                        size_t grid[3];
                        
                        grid[perm[0]] = sdiv_up64(conc_tmp_25517,
                                                  segscan_group_sizze_27658 *
                                                  (int64_t) 9);
                        grid[perm[1]] = 1;
                        grid[perm[2]] = 1;
                        
                        void *kernel_args_30222[] = {&ctx->global_failure,
                                                     &ctx->failure_is_an_option,
                                                     &ctx->global_failure_args,
                                                     &shared_offset_30226,
                                                     &conc_tmp_25517, &i_25533,
                                                     &kernel_arg_30227,
                                                     &kernel_arg_30228,
                                                     &kernel_arg_30229,
                                                     &kernel_arg_30230,
                                                     &kernel_arg_30231,
                                                     &kernel_arg_30232,
                                                     &kernel_arg_30233,
                                                     &kernel_arg_30234,
                                                     &kernel_arg_30235,
                                                     &kernel_arg_30236,
                                                     &kernel_arg_30237,
                                                     &kernel_arg_30238,
                                                     &kernel_arg_30239,
                                                     &kernel_arg_30240};
                        int64_t time_start_30223 = 0, time_end_30224 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(stderr, "Launching %s with grid size (",
                                    "eWiseAddEntry.segscan_27663");
                            fprintf(stderr, "%d", sdiv_up64(conc_tmp_25517,
                                                            segscan_group_sizze_27658 *
                                                            (int64_t) 9));
                            fprintf(stderr, ", ");
                            fprintf(stderr, "%d", 1);
                            fprintf(stderr, ", ");
                            fprintf(stderr, "%d", 1);
                            fprintf(stderr, ") and block size (");
                            fprintf(stderr, "%d", segscan_group_sizze_27658);
                            fprintf(stderr, ", ");
                            fprintf(stderr, "%d", 1);
                            fprintf(stderr, ", ");
                            fprintf(stderr, "%d", 1);
                            fprintf(stderr, ").\n");
                            time_start_30223 = get_wall_time();
                        }
                        
                        cudaEvent_t *pevents = NULL;
                        
                        if (ctx->profiling && !ctx->profiling_paused) {
                            pevents = cuda_get_events(&ctx->cuda,
                                                      &ctx->eWiseAddEntryzisegscan_27663_runs,
                                                      &ctx->eWiseAddEntryzisegscan_27663_total_runtime);
                            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
                        }
                        CUDA_SUCCEED(cuLaunchKernel(ctx->eWiseAddEntryzisegscan_27663,
                                                    grid[0], grid[1], grid[2],
                                                    segscan_group_sizze_27658,
                                                    1, 1, 0 +
                                                    (shared_sizze_30225 + (8 -
                                                                           shared_sizze_30225 %
                                                                           8) %
                                                     8), NULL,
                                                    kernel_args_30222, NULL));
                        if (pevents != NULL)
                            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
                        if (ctx->debugging) {
                            CUDA_SUCCEED(cuCtxSynchronize());
                            time_end_30224 = get_wall_time();
                            fprintf(stderr, "Kernel %s runtime: %ldus\n",
                                    "eWiseAddEntry.segscan_27663",
                                    time_end_30224 - time_start_30223);
                        }
                    }
                    ctx->failure_is_an_option = 1;
                    if (memblock_unref_device(ctx, &incprefixes_mem_29548,
                                              "incprefixes_mem_29548") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &aggregates_mem_29546,
                                              "aggregates_mem_29546") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &status_flags_mem_29544,
                                              "status_flags_mem_29544") != 0)
                        return 1;
                }
                if (memblock_unref_device(ctx, &mem_28416, "mem_28416") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28418, "mem_28418") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28420, "mem_28420") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28422, "mem_28422") != 0)
                    return 1;
                
                int64_t partition_sizze_25786;
                
                if (cond_25530) {
                    partition_sizze_25786 = (int64_t) 0;
                } else {
                    int64_t read_res_30241;
                    
                    {
                        cudaEvent_t *pevents = NULL;
                        
                        if (ctx->profiling && !ctx->profiling_paused) {
                            pevents = cuda_get_events(&ctx->cuda,
                                                      &ctx->copy_scalar_from_dev_runs,
                                                      &ctx->copy_scalar_from_dev_total_runtime);
                            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
                        }
                        CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30241,
                                                  mem_28425.mem + i_25533 *
                                                  sizeof(int64_t),
                                                  sizeof(int64_t)));
                        if (pevents != NULL)
                            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
                    }
                    if (futhark_context_sync(ctx) != 0)
                        return 1;
                    
                    int64_t last_offset_25787 = read_res_30241;
                    
                    partition_sizze_25786 = last_offset_25787;
                }
                
                struct memblock_device mem_28437;
                
                mem_28437.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28437, bytes_28366,
                                          "mem_28437")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28439;
                
                mem_28439.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28439, bytes_28366,
                                          "mem_28439")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28441;
                
                mem_28441.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28441, bytes_28366,
                                          "mem_28441")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28443;
                
                mem_28443.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28443, bytes_28366,
                                          "mem_28443")) {
                    err = 1;
                    goto cleanup;
                }
                
                int64_t segmap_group_sizze_27668;
                
                segmap_group_sizze_27668 =
                    ctx->sizes.eWiseAddEntryzisegmap_group_sizze_27667;
                
                int64_t segmap_usable_groups_27669 = sdiv_up64(conc_tmp_25517,
                                                               segmap_group_sizze_27668);
                
                if (ctx->debugging)
                    fprintf(stderr, "%s\n", "\n# SegMap");
                
                CUdeviceptr kernel_arg_30245 = mem_28425.mem;
                CUdeviceptr kernel_arg_30246 = mem_28427.mem;
                CUdeviceptr kernel_arg_30247 = mem_28429.mem;
                CUdeviceptr kernel_arg_30248 = mem_28431.mem;
                CUdeviceptr kernel_arg_30249 = mem_28433.mem;
                CUdeviceptr kernel_arg_30250 = mem_28435.mem;
                CUdeviceptr kernel_arg_30251 = mem_28437.mem;
                CUdeviceptr kernel_arg_30252 = mem_28439.mem;
                CUdeviceptr kernel_arg_30253 = mem_28441.mem;
                CUdeviceptr kernel_arg_30254 = mem_28443.mem;
                
                if ((((((1 && segmap_usable_groups_27669 != 0) && 1 != 0) &&
                       1 != 0) && segmap_group_sizze_27668 != 0) && 1 != 0) &&
                    1 != 0) {
                    int perm[3] = {0, 1, 2};
                    
                    if (1 >= 1 << 16) {
                        perm[1] = perm[0];
                        perm[0] = 1;
                    }
                    if (1 >= 1 << 16) {
                        perm[2] = perm[0];
                        perm[0] = 2;
                    }
                    
                    size_t grid[3];
                    
                    grid[perm[0]] = segmap_usable_groups_27669;
                    grid[perm[1]] = 1;
                    grid[perm[2]] = 1;
                    
                    void *kernel_args_30242[] = {&ctx->global_failure,
                                                 &conc_tmp_25517,
                                                 &kernel_arg_30245,
                                                 &kernel_arg_30246,
                                                 &kernel_arg_30247,
                                                 &kernel_arg_30248,
                                                 &kernel_arg_30249,
                                                 &kernel_arg_30250,
                                                 &kernel_arg_30251,
                                                 &kernel_arg_30252,
                                                 &kernel_arg_30253,
                                                 &kernel_arg_30254};
                    int64_t time_start_30243 = 0, time_end_30244 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(stderr, "Launching %s with grid size (",
                                "eWiseAddEntry.segmap_27665");
                        fprintf(stderr, "%d", segmap_usable_groups_27669);
                        fprintf(stderr, ", ");
                        fprintf(stderr, "%d", 1);
                        fprintf(stderr, ", ");
                        fprintf(stderr, "%d", 1);
                        fprintf(stderr, ") and block size (");
                        fprintf(stderr, "%d", segmap_group_sizze_27668);
                        fprintf(stderr, ", ");
                        fprintf(stderr, "%d", 1);
                        fprintf(stderr, ", ");
                        fprintf(stderr, "%d", 1);
                        fprintf(stderr, ").\n");
                        time_start_30243 = get_wall_time();
                    }
                    
                    cudaEvent_t *pevents = NULL;
                    
                    if (ctx->profiling && !ctx->profiling_paused) {
                        pevents = cuda_get_events(&ctx->cuda,
                                                  &ctx->eWiseAddEntryzisegmap_27665_runs,
                                                  &ctx->eWiseAddEntryzisegmap_27665_total_runtime);
                        CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
                    }
                    CUDA_SUCCEED(cuLaunchKernel(ctx->eWiseAddEntryzisegmap_27665,
                                                grid[0], grid[1], grid[2],
                                                segmap_group_sizze_27668, 1, 1,
                                                0, NULL, kernel_args_30242,
                                                NULL));
                    if (pevents != NULL)
                        CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
                    if (ctx->debugging) {
                        CUDA_SUCCEED(cuCtxSynchronize());
                        time_end_30244 = get_wall_time();
                        fprintf(stderr, "Kernel %s runtime: %ldus\n",
                                "eWiseAddEntry.segmap_27665", time_end_30244 -
                                time_start_30243);
                    }
                }
                if (memblock_unref_device(ctx, &mem_28425, "mem_28425") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28427, "mem_28427") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28429, "mem_28429") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28431, "mem_28431") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28433, "mem_28433") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28435, "mem_28435") != 0)
                    return 1;
                
                bool empty_slice_25805 = partition_sizze_25786 == (int64_t) 0;
                int64_t m_25806 = sub64(partition_sizze_25786, (int64_t) 1);
                bool zzero_leq_i_p_m_t_s_25807 = sle64((int64_t) 0, m_25806);
                bool i_p_m_t_s_leq_w_25808 = slt64(m_25806, conc_tmp_25517);
                bool i_lte_j_25809 = sle64((int64_t) 0, partition_sizze_25786);
                bool y_25810 = zzero_leq_i_p_m_t_s_25807 &&
                     i_p_m_t_s_leq_w_25808;
                bool y_25811 = i_lte_j_25809 && y_25810;
                bool ok_or_empty_25812 = empty_slice_25805 || y_25811;
                bool index_certs_25813;
                
                if (!ok_or_empty_25812) {
                    ctx->error =
                        msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                  "Index [:", partition_sizze_25786,
                                  "] out of bounds for array of shape [",
                                  conc_tmp_25517, "].",
                                  "-> #0  /prelude/soacs.fut:141:6-16\n   #1  sparse.fut:58:3-68:56\n   #2  sparse.fut:138:59-140:81\n   #3  sparse.fut:219:17-59\n   #4  sparse.fut:210:1-220:48\n");
                    if (memblock_unref_device(ctx, &mem_28443, "mem_28443") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28441, "mem_28441") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28439, "mem_28439") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28437, "mem_28437") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28435, "mem_28435") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28433, "mem_28433") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28431, "mem_28431") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28429, "mem_28429") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28427, "mem_28427") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28425, "mem_28425") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28422, "mem_28422") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28420, "mem_28420") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28418, "mem_28418") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28416, "mem_28416") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_param_28379,
                                              "mem_param_28379") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_param_28374,
                                              "mem_param_28374") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &defunc_0_f_res_mem_28413,
                                              "defunc_0_f_res_mem_28413") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &defunc_0_f_res_mem_28408,
                                              "defunc_0_f_res_mem_28408") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28394, "mem_28394") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28392, "mem_28392") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28390, "mem_28390") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28388, "mem_28388") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28386, "mem_28386") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &unionArrays_res_f_res_mem_28457,
                                              "unionArrays_res_f_res_mem_28457") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &unionArrays_res_f_res_mem_28454,
                                              "unionArrays_res_f_res_mem_28454") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &unionArrays_res_f_res_mem_28451,
                                              "unionArrays_res_f_res_mem_28451") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &unionArrays_res_f_res_mem_28448,
                                              "unionArrays_res_f_res_mem_28448") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28369, "mem_28369") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28367, "mem_28367") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28365, "mem_28365") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28363, "mem_28363") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &unionArrays_res_mem_28470,
                                              "unionArrays_res_mem_28470") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &unionArrays_res_mem_28467,
                                              "unionArrays_res_mem_28467") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &unionArrays_res_mem_28464,
                                              "unionArrays_res_mem_28464") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &unionArrays_res_mem_28461,
                                              "unionArrays_res_mem_28461") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28361, "mem_28361") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28359, "mem_28359") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28357, "mem_28357") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28341, "mem_28341") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28339, "mem_28339") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                              "double_buffer_mem_28763") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28256, "mem_28256") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28239, "mem_28239") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28248, "mem_28248") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28250, "mem_28250") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28252, "mem_28252") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28254, "mem_28254") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28318, "mem_28318") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                              "group_res_arr_mem_29131") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                              "group_res_arr_mem_29129") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                              "group_res_arr_mem_29127") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28860, "mem_28860") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28858, "mem_28858") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28856, "mem_28856") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28337, "mem_28337") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &out_mem_29123,
                                              "out_mem_29123") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &out_mem_29121,
                                              "out_mem_29121") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &out_mem_29119,
                                              "out_mem_29119") != 0)
                        return 1;
                    return 1;
                }
                sizze_25539 = partition_sizze_25786;
                sizze_25540 = partition_sizze_25786;
                sizze_25541 = partition_sizze_25786;
                sizze_25542 = partition_sizze_25786;
                unionArrays_res_f_res_ixfn_28445 = partition_sizze_25786;
                unionArrays_res_f_res_ixfn_28449 = partition_sizze_25786;
                unionArrays_res_f_res_ixfn_28452 = partition_sizze_25786;
                unionArrays_res_f_res_ixfn_28455 = partition_sizze_25786;
                if (memblock_set_device(ctx, &unionArrays_res_f_res_mem_28448,
                                        &mem_28437, "mem_28437") != 0)
                    return 1;
                if (memblock_set_device(ctx, &unionArrays_res_f_res_mem_28451,
                                        &mem_28439, "mem_28439") != 0)
                    return 1;
                if (memblock_set_device(ctx, &unionArrays_res_f_res_mem_28454,
                                        &mem_28441, "mem_28441") != 0)
                    return 1;
                if (memblock_set_device(ctx, &unionArrays_res_f_res_mem_28457,
                                        &mem_28443, "mem_28443") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28443, "mem_28443") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28441, "mem_28441") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28439, "mem_28439") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28437, "mem_28437") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28435, "mem_28435") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28433, "mem_28433") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28431, "mem_28431") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28429, "mem_28429") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28427, "mem_28427") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28425, "mem_28425") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28422, "mem_28422") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28420, "mem_28420") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28418, "mem_28418") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28416, "mem_28416") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_28379,
                                          "mem_param_28379") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_28374,
                                          "mem_param_28374") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &defunc_0_f_res_mem_28413,
                                          "defunc_0_f_res_mem_28413") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &defunc_0_f_res_mem_28408,
                                          "defunc_0_f_res_mem_28408") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28394, "mem_28394") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28392, "mem_28392") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28390, "mem_28390") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28388, "mem_28388") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28386, "mem_28386") != 0)
                    return 1;
            }
            if (memblock_unref_device(ctx, &mem_28363, "mem_28363") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28365, "mem_28365") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28367, "mem_28367") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28369, "mem_28369") != 0)
                return 1;
            sizze_25518 = sizze_25539;
            sizze_25519 = sizze_25540;
            sizze_25520 = sizze_25541;
            sizze_25521 = sizze_25542;
            unionArrays_res_ixfn_28458 = unionArrays_res_f_res_ixfn_28445;
            unionArrays_res_ixfn_28459 = unionArrays_res_f_res_ixfn_28446;
            unionArrays_res_ixfn_28460 = unionArrays_res_f_res_ixfn_28447;
            unionArrays_res_ixfn_28462 = unionArrays_res_f_res_ixfn_28449;
            unionArrays_res_ixfn_28463 = unionArrays_res_f_res_ixfn_28450;
            unionArrays_res_ixfn_28465 = unionArrays_res_f_res_ixfn_28452;
            unionArrays_res_ixfn_28466 = unionArrays_res_f_res_ixfn_28450;
            unionArrays_res_ixfn_28468 = unionArrays_res_f_res_ixfn_28455;
            unionArrays_res_ixfn_28469 = unionArrays_res_f_res_ixfn_28450;
            if (memblock_set_device(ctx, &unionArrays_res_mem_28461,
                                    &unionArrays_res_f_res_mem_28448,
                                    "unionArrays_res_f_res_mem_28448") != 0)
                return 1;
            if (memblock_set_device(ctx, &unionArrays_res_mem_28464,
                                    &unionArrays_res_f_res_mem_28451,
                                    "unionArrays_res_f_res_mem_28451") != 0)
                return 1;
            if (memblock_set_device(ctx, &unionArrays_res_mem_28467,
                                    &unionArrays_res_f_res_mem_28454,
                                    "unionArrays_res_f_res_mem_28454") != 0)
                return 1;
            if (memblock_set_device(ctx, &unionArrays_res_mem_28470,
                                    &unionArrays_res_f_res_mem_28457,
                                    "unionArrays_res_f_res_mem_28457") != 0)
                return 1;
            if (memblock_unref_device(ctx, &unionArrays_res_f_res_mem_28457,
                                      "unionArrays_res_f_res_mem_28457") != 0)
                return 1;
            if (memblock_unref_device(ctx, &unionArrays_res_f_res_mem_28454,
                                      "unionArrays_res_f_res_mem_28454") != 0)
                return 1;
            if (memblock_unref_device(ctx, &unionArrays_res_f_res_mem_28451,
                                      "unionArrays_res_f_res_mem_28451") != 0)
                return 1;
            if (memblock_unref_device(ctx, &unionArrays_res_f_res_mem_28448,
                                      "unionArrays_res_f_res_mem_28448") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28369, "mem_28369") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28367, "mem_28367") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28365, "mem_28365") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28363, "mem_28363") != 0)
                return 1;
        }
        if (memblock_unref_device(ctx, &mem_28357, "mem_28357") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28359, "mem_28359") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28361, "mem_28361") != 0)
            return 1;
        
        bool dim_match_25818 = sizze_25518 == sizze_25519;
        bool empty_or_match_cert_25819;
        
        if (!dim_match_25818) {
            ctx->error = msgprintf("Error: %s\n\nBacktrace:\n%s",
                                   "Function return value does not match shape of declared return type.",
                                   "-> #0  sparse.fut:45:7-68:56\n   #1  sparse.fut:138:59-140:81\n   #2  sparse.fut:219:17-59\n   #3  sparse.fut:210:1-220:48\n");
            if (memblock_unref_device(ctx, &unionArrays_res_mem_28470,
                                      "unionArrays_res_mem_28470") != 0)
                return 1;
            if (memblock_unref_device(ctx, &unionArrays_res_mem_28467,
                                      "unionArrays_res_mem_28467") != 0)
                return 1;
            if (memblock_unref_device(ctx, &unionArrays_res_mem_28464,
                                      "unionArrays_res_mem_28464") != 0)
                return 1;
            if (memblock_unref_device(ctx, &unionArrays_res_mem_28461,
                                      "unionArrays_res_mem_28461") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28361, "mem_28361") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28359, "mem_28359") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28357, "mem_28357") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28341, "mem_28341") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28339, "mem_28339") != 0)
                return 1;
            if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                      "double_buffer_mem_28763") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28256, "mem_28256") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28248, "mem_28248") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28250, "mem_28250") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28254, "mem_28254") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28318, "mem_28318") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                      "group_res_arr_mem_29131") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                      "group_res_arr_mem_29129") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                      "group_res_arr_mem_29127") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28860, "mem_28860") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28858, "mem_28858") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28856, "mem_28856") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28337, "mem_28337") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29123, "out_mem_29123") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29121, "out_mem_29121") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29119, "out_mem_29119") !=
                0)
                return 1;
            return 1;
        }
        
        bool dim_match_25820 = sizze_25518 == sizze_25520;
        bool empty_or_match_cert_25821;
        
        if (!dim_match_25820) {
            ctx->error = msgprintf("Error: %s\n\nBacktrace:\n%s",
                                   "Function return value does not match shape of declared return type.",
                                   "-> #0  sparse.fut:45:7-68:56\n   #1  sparse.fut:138:59-140:81\n   #2  sparse.fut:219:17-59\n   #3  sparse.fut:210:1-220:48\n");
            if (memblock_unref_device(ctx, &unionArrays_res_mem_28470,
                                      "unionArrays_res_mem_28470") != 0)
                return 1;
            if (memblock_unref_device(ctx, &unionArrays_res_mem_28467,
                                      "unionArrays_res_mem_28467") != 0)
                return 1;
            if (memblock_unref_device(ctx, &unionArrays_res_mem_28464,
                                      "unionArrays_res_mem_28464") != 0)
                return 1;
            if (memblock_unref_device(ctx, &unionArrays_res_mem_28461,
                                      "unionArrays_res_mem_28461") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28361, "mem_28361") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28359, "mem_28359") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28357, "mem_28357") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28341, "mem_28341") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28339, "mem_28339") != 0)
                return 1;
            if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                      "double_buffer_mem_28763") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28256, "mem_28256") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28248, "mem_28248") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28250, "mem_28250") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28254, "mem_28254") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28318, "mem_28318") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                      "group_res_arr_mem_29131") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                      "group_res_arr_mem_29129") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                      "group_res_arr_mem_29127") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28860, "mem_28860") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28858, "mem_28858") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28856, "mem_28856") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28337, "mem_28337") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29123, "out_mem_29123") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29121, "out_mem_29121") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29119, "out_mem_29119") !=
                0)
                return 1;
            return 1;
        }
        
        bool dim_match_25822 = sizze_25518 == sizze_25521;
        bool empty_or_match_cert_25823;
        
        if (!dim_match_25822) {
            ctx->error = msgprintf("Error: %s\n\nBacktrace:\n%s",
                                   "Function return value does not match shape of declared return type.",
                                   "-> #0  sparse.fut:45:7-68:56\n   #1  sparse.fut:138:59-140:81\n   #2  sparse.fut:219:17-59\n   #3  sparse.fut:210:1-220:48\n");
            if (memblock_unref_device(ctx, &unionArrays_res_mem_28470,
                                      "unionArrays_res_mem_28470") != 0)
                return 1;
            if (memblock_unref_device(ctx, &unionArrays_res_mem_28467,
                                      "unionArrays_res_mem_28467") != 0)
                return 1;
            if (memblock_unref_device(ctx, &unionArrays_res_mem_28464,
                                      "unionArrays_res_mem_28464") != 0)
                return 1;
            if (memblock_unref_device(ctx, &unionArrays_res_mem_28461,
                                      "unionArrays_res_mem_28461") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28361, "mem_28361") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28359, "mem_28359") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28357, "mem_28357") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28341, "mem_28341") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28339, "mem_28339") != 0)
                return 1;
            if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                      "double_buffer_mem_28763") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28256, "mem_28256") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28248, "mem_28248") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28250, "mem_28250") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28254, "mem_28254") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28318, "mem_28318") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                      "group_res_arr_mem_29131") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                      "group_res_arr_mem_29129") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                      "group_res_arr_mem_29127") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28860, "mem_28860") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28858, "mem_28858") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28856, "mem_28856") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28337, "mem_28337") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29123, "out_mem_29123") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29121, "out_mem_29121") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29119, "out_mem_29119") !=
                0)
                return 1;
            return 1;
        }
        
        int64_t read_res_30255;
        
        {
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->copy_scalar_from_dev_runs,
                                          &ctx->copy_scalar_from_dev_total_runtime);
                CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30255, mem_28337.mem + i_25476 *
                                      sizeof(int64_t), sizeof(int64_t)));
            if (pevents != NULL)
                CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
        }
        if (futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t x_25824 = read_res_30255;
        int64_t read_res_30256;
        
        {
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->copy_scalar_from_dev_runs,
                                          &ctx->copy_scalar_from_dev_total_runtime);
                CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30256, mem_28337.mem + i_25470 *
                                      sizeof(int64_t), sizeof(int64_t)));
            if (pevents != NULL)
                CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
        }
        if (futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t y_25825 = read_res_30256;
        int64_t indxs_25826 = sub64(x_25824, y_25825);
        bool bounds_invalid_upwards_25827 = slt64(x_25824, y_25825);
        bool valid_25828 = !bounds_invalid_upwards_25827;
        bool range_valid_c_25829;
        
        if (!valid_25828) {
            ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                   "Range ", y_25825, "..<", x_25824,
                                   " is invalid.",
                                   "-> #0  sparse.fut:142:18-42\n   #1  sparse.fut:219:17-59\n   #2  sparse.fut:210:1-220:48\n");
            if (memblock_unref_device(ctx, &unionArrays_res_mem_28470,
                                      "unionArrays_res_mem_28470") != 0)
                return 1;
            if (memblock_unref_device(ctx, &unionArrays_res_mem_28467,
                                      "unionArrays_res_mem_28467") != 0)
                return 1;
            if (memblock_unref_device(ctx, &unionArrays_res_mem_28464,
                                      "unionArrays_res_mem_28464") != 0)
                return 1;
            if (memblock_unref_device(ctx, &unionArrays_res_mem_28461,
                                      "unionArrays_res_mem_28461") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28361, "mem_28361") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28359, "mem_28359") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28357, "mem_28357") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28341, "mem_28341") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28339, "mem_28339") != 0)
                return 1;
            if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                      "double_buffer_mem_28763") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28256, "mem_28256") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28248, "mem_28248") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28250, "mem_28250") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28254, "mem_28254") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28318, "mem_28318") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                      "group_res_arr_mem_29131") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                      "group_res_arr_mem_29129") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                      "group_res_arr_mem_29127") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28860, "mem_28860") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28858, "mem_28858") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28856, "mem_28856") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28337, "mem_28337") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29123, "out_mem_29123") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29121, "out_mem_29121") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29119, "out_mem_29119") !=
                0)
                return 1;
            return 1;
        }
        
        bool dim_match_25831 = indxs_25826 == sizze_25518;
        bool empty_or_match_cert_25832;
        
        if (!dim_match_25831) {
            ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                   "Value of (core language) shape (",
                                   sizze_25518,
                                   ") cannot match shape of type `[",
                                   indxs_25826, "]index`.",
                                   "-> #0  sparse.fut:146:26-51\n   #1  sparse.fut:219:17-59\n   #2  sparse.fut:210:1-220:48\n");
            if (memblock_unref_device(ctx, &unionArrays_res_mem_28470,
                                      "unionArrays_res_mem_28470") != 0)
                return 1;
            if (memblock_unref_device(ctx, &unionArrays_res_mem_28467,
                                      "unionArrays_res_mem_28467") != 0)
                return 1;
            if (memblock_unref_device(ctx, &unionArrays_res_mem_28464,
                                      "unionArrays_res_mem_28464") != 0)
                return 1;
            if (memblock_unref_device(ctx, &unionArrays_res_mem_28461,
                                      "unionArrays_res_mem_28461") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28361, "mem_28361") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28359, "mem_28359") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28357, "mem_28357") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28341, "mem_28341") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28339, "mem_28339") != 0)
                return 1;
            if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                      "double_buffer_mem_28763") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28256, "mem_28256") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28248, "mem_28248") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28250, "mem_28250") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28254, "mem_28254") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28318, "mem_28318") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                      "group_res_arr_mem_29131") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                      "group_res_arr_mem_29129") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                      "group_res_arr_mem_29127") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28860, "mem_28860") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28858, "mem_28858") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28856, "mem_28856") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28337, "mem_28337") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29123, "out_mem_29123") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29121, "out_mem_29121") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29119, "out_mem_29119") !=
                0)
                return 1;
            return 1;
        }
        
        bool empty_or_match_cert_25833;
        
        if (!dim_match_25831) {
            ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                   "Value of (core language) shape (",
                                   sizze_25518,
                                   ") cannot match shape of type `[",
                                   indxs_25826, "]t`.",
                                   "-> #0  sparse.fut:147:25-154:75\n   #1  sparse.fut:219:17-59\n   #2  sparse.fut:210:1-220:48\n");
            if (memblock_unref_device(ctx, &unionArrays_res_mem_28470,
                                      "unionArrays_res_mem_28470") != 0)
                return 1;
            if (memblock_unref_device(ctx, &unionArrays_res_mem_28467,
                                      "unionArrays_res_mem_28467") != 0)
                return 1;
            if (memblock_unref_device(ctx, &unionArrays_res_mem_28464,
                                      "unionArrays_res_mem_28464") != 0)
                return 1;
            if (memblock_unref_device(ctx, &unionArrays_res_mem_28461,
                                      "unionArrays_res_mem_28461") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28361, "mem_28361") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28359, "mem_28359") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28357, "mem_28357") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28341, "mem_28341") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28339, "mem_28339") != 0)
                return 1;
            if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                      "double_buffer_mem_28763") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28256, "mem_28256") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28248, "mem_28248") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28250, "mem_28250") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28254, "mem_28254") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28318, "mem_28318") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                      "group_res_arr_mem_29131") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                      "group_res_arr_mem_29129") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                      "group_res_arr_mem_29127") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28860, "mem_28860") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28858, "mem_28858") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28856, "mem_28856") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28337, "mem_28337") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29123, "out_mem_29123") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29121, "out_mem_29121") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29119, "out_mem_29119") !=
                0)
                return 1;
            return 1;
        }
        
        int64_t segmap_usable_groups_27675 = sdiv_up64(indxs_25826,
                                                       segmap_group_sizze_27674);
        
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegMap");
        
        CUdeviceptr kernel_arg_30260 = leftValues_mem_28231.mem;
        CUdeviceptr kernel_arg_30261 = rightValues_mem_28234.mem;
        CUdeviceptr kernel_arg_30262 = mem_28339.mem;
        CUdeviceptr kernel_arg_30263 = mem_28341.mem;
        CUdeviceptr kernel_arg_30264 = unionArrays_res_mem_28461.mem;
        CUdeviceptr kernel_arg_30265 = unionArrays_res_mem_28464.mem;
        CUdeviceptr kernel_arg_30266 = unionArrays_res_mem_28467.mem;
        CUdeviceptr kernel_arg_30267 = unionArrays_res_mem_28470.mem;
        
        if ((((((1 && segmap_usable_groups_27675 != 0) && 1 != 0) && 1 != 0) &&
              segmap_group_sizze_27674 != 0) && 1 != 0) && 1 != 0) {
            int perm[3] = {0, 1, 2};
            
            if (1 >= 1 << 16) {
                perm[1] = perm[0];
                perm[0] = 1;
            }
            if (1 >= 1 << 16) {
                perm[2] = perm[0];
                perm[0] = 2;
            }
            
            size_t grid[3];
            
            grid[perm[0]] = segmap_usable_groups_27675;
            grid[perm[1]] = 1;
            grid[perm[2]] = 1;
            
            void *kernel_args_30257[] = {&ctx->global_failure,
                                         &ctx->failure_is_an_option,
                                         &ctx->global_failure_args, &n_25269,
                                         &k_25271, &eWiseAddOffsets_res_25462,
                                         &i_25475, &i_25497, &sizze_25518,
                                         &y_25825, &indxs_25826,
                                         &unionArrays_res_ixfn_28460,
                                         &kernel_arg_30260, &kernel_arg_30261,
                                         &kernel_arg_30262, &kernel_arg_30263,
                                         &kernel_arg_30264, &kernel_arg_30265,
                                         &kernel_arg_30266, &kernel_arg_30267};
            int64_t time_start_30258 = 0, time_end_30259 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with grid size (",
                        "eWiseAddEntry.segmap_27671");
                fprintf(stderr, "%d", segmap_usable_groups_27675);
                fprintf(stderr, ", ");
                fprintf(stderr, "%d", 1);
                fprintf(stderr, ", ");
                fprintf(stderr, "%d", 1);
                fprintf(stderr, ") and block size (");
                fprintf(stderr, "%d", segmap_group_sizze_27674);
                fprintf(stderr, ", ");
                fprintf(stderr, "%d", 1);
                fprintf(stderr, ", ");
                fprintf(stderr, "%d", 1);
                fprintf(stderr, ").\n");
                time_start_30258 = get_wall_time();
            }
            
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->eWiseAddEntryzisegmap_27671_runs,
                                          &ctx->eWiseAddEntryzisegmap_27671_total_runtime);
                CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED(cuLaunchKernel(ctx->eWiseAddEntryzisegmap_27671,
                                        grid[0], grid[1], grid[2],
                                        segmap_group_sizze_27674, 1, 1, 0, NULL,
                                        kernel_args_30257, NULL));
            if (pevents != NULL)
                CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
            if (ctx->debugging) {
                CUDA_SUCCEED(cuCtxSynchronize());
                time_end_30259 = get_wall_time();
                fprintf(stderr, "Kernel %s runtime: %ldus\n",
                        "eWiseAddEntry.segmap_27671", time_end_30259 -
                        time_start_30258);
            }
        }
        ctx->failure_is_an_option = 1;
        if (memblock_unref_device(ctx, &unionArrays_res_mem_28461,
                                  "unionArrays_res_mem_28461") != 0)
            return 1;
        if (memblock_unref_device(ctx, &unionArrays_res_mem_28464,
                                  "unionArrays_res_mem_28464") != 0)
            return 1;
        if (memblock_unref_device(ctx, &unionArrays_res_mem_28467,
                                  "unionArrays_res_mem_28467") != 0)
            return 1;
        if (memblock_unref_device(ctx, &unionArrays_res_mem_28470,
                                  "unionArrays_res_mem_28470") != 0)
            return 1;
        if (memblock_unref_device(ctx, &unionArrays_res_mem_28470,
                                  "unionArrays_res_mem_28470") != 0)
            return 1;
        if (memblock_unref_device(ctx, &unionArrays_res_mem_28467,
                                  "unionArrays_res_mem_28467") != 0)
            return 1;
        if (memblock_unref_device(ctx, &unionArrays_res_mem_28464,
                                  "unionArrays_res_mem_28464") != 0)
            return 1;
        if (memblock_unref_device(ctx, &unionArrays_res_mem_28461,
                                  "unionArrays_res_mem_28461") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28361, "mem_28361") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28359, "mem_28359") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28357, "mem_28357") != 0)
            return 1;
    }
    
    struct memblock_device mem_28483;
    
    mem_28483.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28483, bytes_28338, "mem_28483")) {
        err = 1;
        goto cleanup;
    }
    {
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda, &ctx->copy_dev_to_dev_runs,
                                      &ctx->copy_dev_to_dev_total_runtime);
            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED(cuMemcpy(mem_28483.mem + (int64_t) 0, mem_28339.mem +
                              (int64_t) 0, eWiseAddOffsets_res_25462 *
                              (int64_t) sizeof(double)));
        if (pevents != NULL)
            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
    }
    if (memblock_unref_device(ctx, &mem_28339, "mem_28339") != 0)
        return 1;
    
    struct memblock_device mem_28486;
    
    mem_28486.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28486, bytes_28338, "mem_28486")) {
        err = 1;
        goto cleanup;
    }
    {
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda, &ctx->copy_dev_to_dev_runs,
                                      &ctx->copy_dev_to_dev_total_runtime);
            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED(cuMemcpy(mem_28486.mem + (int64_t) 0, mem_28341.mem +
                              (int64_t) 0, eWiseAddOffsets_res_25462 *
                              (int64_t) sizeof(int64_t)));
        if (pevents != NULL)
            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
    }
    if (memblock_unref_device(ctx, &mem_28341, "mem_28341") != 0)
        return 1;
    out_arrsizze_29120 = eWiseAddOffsets_res_25462;
    out_arrsizze_29122 = eWiseAddOffsets_res_25462;
    if (memblock_set_device(ctx, &out_mem_29119, &mem_28483, "mem_28483") != 0)
        return 1;
    if (memblock_set_device(ctx, &out_mem_29121, &mem_28486, "mem_28486") != 0)
        return 1;
    if (memblock_set_device(ctx, &out_mem_29123, &mem_28337, "mem_28337") != 0)
        return 1;
    (*out_mem_p_30117).references = NULL;
    if (memblock_set_device(ctx, &*out_mem_p_30117, &out_mem_29119,
                            "out_mem_29119") != 0)
        return 1;
    *out_out_arrsizze_30118 = out_arrsizze_29120;
    (*out_mem_p_30119).references = NULL;
    if (memblock_set_device(ctx, &*out_mem_p_30119, &out_mem_29121,
                            "out_mem_29121") != 0)
        return 1;
    *out_out_arrsizze_30120 = out_arrsizze_29122;
    (*out_mem_p_30121).references = NULL;
    if (memblock_set_device(ctx, &*out_mem_p_30121, &out_mem_29123,
                            "out_mem_29123") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28486, "mem_28486") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28483, "mem_28483") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28341, "mem_28341") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28339, "mem_28339") != 0)
        return 1;
    if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                              "double_buffer_mem_28763") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28256, "mem_28256") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28248, "mem_28248") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28250, "mem_28250") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28254, "mem_28254") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28318, "mem_28318") != 0)
        return 1;
    if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                              "group_res_arr_mem_29131") != 0)
        return 1;
    if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                              "group_res_arr_mem_29129") != 0)
        return 1;
    if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                              "group_res_arr_mem_29127") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28860, "mem_28860") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28858, "mem_28858") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28856, "mem_28856") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28337, "mem_28337") != 0)
        return 1;
    if (memblock_unref_device(ctx, &out_mem_29123, "out_mem_29123") != 0)
        return 1;
    if (memblock_unref_device(ctx, &out_mem_29121, "out_mem_29121") != 0)
        return 1;
    if (memblock_unref_device(ctx, &out_mem_29119, "out_mem_29119") != 0)
        return 1;
    
  cleanup:
    { }
    return err;
}
static int futrts_eWiseAddMultEntry(struct futhark_context *ctx,
                                    struct memblock_device *out_mem_p_30268,
                                    int64_t *out_out_arrsizze_30269,
                                    struct memblock_device *out_mem_p_30270,
                                    int64_t *out_out_arrsizze_30271,
                                    struct memblock_device *out_mem_p_30272,
                                    struct memblock_device leftValues_mem_28231,
                                    struct memblock_device leftColumns_mem_28232,
                                    struct memblock_device leftOffsets_mem_28233,
                                    struct memblock_device rightValues_mem_28234,
                                    struct memblock_device rightColumns_mem_28235,
                                    struct memblock_device rightOffsets_mem_28236,
                                    int64_t n_26407, int64_t m_26408,
                                    int64_t k_26409)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device out_mem_29119;
    
    out_mem_29119.references = NULL;
    
    int64_t out_arrsizze_29120;
    struct memblock_device out_mem_29121;
    
    out_mem_29121.references = NULL;
    
    int64_t out_arrsizze_29122;
    struct memblock_device out_mem_29123;
    
    out_mem_29123.references = NULL;
    
    int64_t segscan_group_sizze_27818;
    
    segscan_group_sizze_27818 =
        ctx->sizes.eWiseAddMultEntryzisegscan_group_sizze_27817;
    
    int64_t num_groups_27820;
    int32_t max_num_groups_29124;
    
    max_num_groups_29124 =
        ctx->sizes.eWiseAddMultEntryzisegscan_num_groups_27819;
    num_groups_27820 = sext_i64_i32(smax64((int64_t) 1,
                                           smin64(sdiv_up64(m_26408,
                                                            segscan_group_sizze_27818),
                                                  sext_i32_i64(max_num_groups_29124))));
    
    int64_t bytes_28336 = (int64_t) 8 * m_26408;
    struct memblock_device mem_28337;
    
    mem_28337.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28337, bytes_28336, "mem_28337")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t num_threads_28953 = segscan_group_sizze_27818 * num_groups_27820;
    int64_t segred_num_groups_28973;
    
    segred_num_groups_28973 =
        ctx->sizes.eWiseAddMultEntryzisegred_num_groups_28972;
    
    int64_t segred_group_sizze_28975;
    
    segred_group_sizze_28975 =
        ctx->sizes.eWiseAddMultEntryzisegred_group_sizze_28974;
    
    struct memblock_device mem_29022;
    
    mem_29022.references = NULL;
    if (memblock_alloc_device(ctx, &mem_29022, (int64_t) 8, "mem_29022")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_29024;
    
    mem_29024.references = NULL;
    if (memblock_alloc_device(ctx, &mem_29024, (int64_t) 8, "mem_29024")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_29026;
    
    mem_29026.references = NULL;
    if (memblock_alloc_device(ctx, &mem_29026, (int64_t) 8, "mem_29026")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device eWiseAddMultEntryzicounter_mem_29125 =
                           ctx->eWiseAddMultEntryzicounter_mem_29125;
    struct memblock_device group_res_arr_mem_29127;
    
    group_res_arr_mem_29127.references = NULL;
    if (memblock_alloc_device(ctx, &group_res_arr_mem_29127,
                              (int64_t) sizeof(int64_t) *
                              (segred_group_sizze_28975 *
                               segred_num_groups_28973),
                              "group_res_arr_mem_29127")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device group_res_arr_mem_29129;
    
    group_res_arr_mem_29129.references = NULL;
    if (memblock_alloc_device(ctx, &group_res_arr_mem_29129,
                              (int64_t) sizeof(int64_t) *
                              (segred_group_sizze_28975 *
                               segred_num_groups_28973),
                              "group_res_arr_mem_29129")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device group_res_arr_mem_29131;
    
    group_res_arr_mem_29131.references = NULL;
    if (memblock_alloc_device(ctx, &group_res_arr_mem_29131,
                              (int64_t) sizeof(int64_t) *
                              (segred_group_sizze_28975 *
                               segred_num_groups_28973),
                              "group_res_arr_mem_29131")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t num_threads_29133;
    
    num_threads_29133 = segred_num_groups_28973 * segred_group_sizze_28975;
    if (ctx->debugging)
        fprintf(stderr, "%s\n", "\n# SegRed");
    
    unsigned int shared_sizze_30277 = (int64_t) sizeof(int64_t) *
                 segred_group_sizze_28975;
    unsigned int shared_sizze_30279 = (int64_t) sizeof(int64_t) *
                 segred_group_sizze_28975;
    unsigned int shared_sizze_30281 = (int64_t) sizeof(int64_t) *
                 segred_group_sizze_28975;
    unsigned int shared_sizze_30283 = (int64_t) sizeof(bool);
    CUdeviceptr kernel_arg_30285 = leftOffsets_mem_28233.mem;
    CUdeviceptr kernel_arg_30286 = rightOffsets_mem_28236.mem;
    CUdeviceptr kernel_arg_30287 = mem_29022.mem;
    CUdeviceptr kernel_arg_30288 = mem_29024.mem;
    CUdeviceptr kernel_arg_30289 = mem_29026.mem;
    CUdeviceptr kernel_arg_30290 = eWiseAddMultEntryzicounter_mem_29125.mem;
    CUdeviceptr kernel_arg_30291 = group_res_arr_mem_29127.mem;
    CUdeviceptr kernel_arg_30292 = group_res_arr_mem_29129.mem;
    CUdeviceptr kernel_arg_30293 = group_res_arr_mem_29131.mem;
    unsigned int shared_offset_30278 = 0;
    unsigned int shared_offset_30280 = 0 + (shared_sizze_30277 + (8 -
                                                                  shared_sizze_30277 %
                                                                  8) % 8);
    unsigned int shared_offset_30282 = 0 + (shared_sizze_30277 + (8 -
                                                                  shared_sizze_30277 %
                                                                  8) % 8) +
                 (shared_sizze_30279 + (8 - shared_sizze_30279 % 8) % 8);
    unsigned int shared_offset_30284 = 0 + (shared_sizze_30277 + (8 -
                                                                  shared_sizze_30277 %
                                                                  8) % 8) +
                 (shared_sizze_30279 + (8 - shared_sizze_30279 % 8) % 8) +
                 (shared_sizze_30281 + (8 - shared_sizze_30281 % 8) % 8);
    
    if ((((((1 && segred_num_groups_28973 != 0) && 1 != 0) && 1 != 0) &&
          segred_group_sizze_28975 != 0) && 1 != 0) && 1 != 0) {
        int perm[3] = {0, 1, 2};
        
        if (1 >= 1 << 16) {
            perm[1] = perm[0];
            perm[0] = 1;
        }
        if (1 >= 1 << 16) {
            perm[2] = perm[0];
            perm[0] = 2;
        }
        
        size_t grid[3];
        
        grid[perm[0]] = segred_num_groups_28973;
        grid[perm[1]] = 1;
        grid[perm[2]] = 1;
        
        void *kernel_args_30274[] = {&ctx->global_failure,
                                     &ctx->failure_is_an_option,
                                     &ctx->global_failure_args,
                                     &shared_offset_30278, &shared_offset_30280,
                                     &shared_offset_30282, &shared_offset_30284,
                                     &m_26408, &num_threads_29133,
                                     &kernel_arg_30285, &kernel_arg_30286,
                                     &kernel_arg_30287, &kernel_arg_30288,
                                     &kernel_arg_30289, &kernel_arg_30290,
                                     &kernel_arg_30291, &kernel_arg_30292,
                                     &kernel_arg_30293};
        int64_t time_start_30275 = 0, time_end_30276 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with grid size (",
                    "eWiseAddMultEntry.segred_nonseg_28981");
            fprintf(stderr, "%d", segred_num_groups_28973);
            fprintf(stderr, ", ");
            fprintf(stderr, "%d", 1);
            fprintf(stderr, ", ");
            fprintf(stderr, "%d", 1);
            fprintf(stderr, ") and block size (");
            fprintf(stderr, "%d", segred_group_sizze_28975);
            fprintf(stderr, ", ");
            fprintf(stderr, "%d", 1);
            fprintf(stderr, ", ");
            fprintf(stderr, "%d", 1);
            fprintf(stderr, ").\n");
            time_start_30275 = get_wall_time();
        }
        
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->eWiseAddMultEntryzisegred_nonseg_28981_runs,
                                      &ctx->eWiseAddMultEntryzisegred_nonseg_28981_total_runtime);
            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED(cuLaunchKernel(ctx->eWiseAddMultEntryzisegred_nonseg_28981,
                                    grid[0], grid[1], grid[2],
                                    segred_group_sizze_28975, 1, 1, 0 +
                                    (shared_sizze_30277 + (8 -
                                                           shared_sizze_30277 %
                                                           8) % 8) +
                                    (shared_sizze_30279 + (8 -
                                                           shared_sizze_30279 %
                                                           8) % 8) +
                                    (shared_sizze_30281 + (8 -
                                                           shared_sizze_30281 %
                                                           8) % 8) +
                                    (shared_sizze_30283 + (8 -
                                                           shared_sizze_30283 %
                                                           8) % 8), NULL,
                                    kernel_args_30274, NULL));
        if (pevents != NULL)
            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
        if (ctx->debugging) {
            CUDA_SUCCEED(cuCtxSynchronize());
            time_end_30276 = get_wall_time();
            fprintf(stderr, "Kernel %s runtime: %ldus\n",
                    "eWiseAddMultEntry.segred_nonseg_28981", time_end_30276 -
                    time_start_30275);
        }
    }
    ctx->failure_is_an_option = 1;
    
    int64_t read_res_30294;
    
    {
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->copy_scalar_from_dev_runs,
                                      &ctx->copy_scalar_from_dev_total_runtime);
            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30294, mem_29022.mem + (int64_t) 0 *
                                  sizeof(int64_t), sizeof(int64_t)));
        if (pevents != NULL)
            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
    }
    if (futhark_context_sync(ctx) != 0)
        return 1;
    
    int64_t max_per_thread_28967 = read_res_30294;
    
    if (memblock_unref_device(ctx, &mem_29022, "mem_29022") != 0)
        return 1;
    
    int64_t read_res_30295;
    
    {
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->copy_scalar_from_dev_runs,
                                      &ctx->copy_scalar_from_dev_total_runtime);
            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30295, mem_29024.mem + (int64_t) 0 *
                                  sizeof(int64_t), sizeof(int64_t)));
        if (pevents != NULL)
            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
    }
    if (futhark_context_sync(ctx) != 0)
        return 1;
    
    int64_t max_per_thread_28968 = read_res_30295;
    
    if (memblock_unref_device(ctx, &mem_29024, "mem_29024") != 0)
        return 1;
    
    int64_t read_res_30296;
    
    {
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->copy_scalar_from_dev_runs,
                                      &ctx->copy_scalar_from_dev_total_runtime);
            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30296, mem_29026.mem + (int64_t) 0 *
                                  sizeof(int64_t), sizeof(int64_t)));
        if (pevents != NULL)
            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
    }
    if (futhark_context_sync(ctx) != 0)
        return 1;
    
    int64_t max_per_thread_28969 = read_res_30296;
    
    if (memblock_unref_device(ctx, &mem_29026, "mem_29026") != 0)
        return 1;
    
    int64_t sizze_sum_29015 = num_threads_28953 * max_per_thread_28967;
    int64_t sizze_sum_29016 = num_threads_28953 * max_per_thread_28968;
    int64_t sizze_sum_29017 = num_threads_28953 * max_per_thread_28969;
    struct memblock_device mem_28318;
    
    mem_28318.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28318, sizze_sum_29015, "mem_28318")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_28254;
    
    mem_28254.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28254, sizze_sum_29015, "mem_28254")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_28252;
    
    mem_28252.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28252, sizze_sum_29015, "mem_28252")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_28250;
    
    mem_28250.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28250, sizze_sum_29015, "mem_28250")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_28248;
    
    mem_28248.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28248, sizze_sum_29015, "mem_28248")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_28239;
    
    mem_28239.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28239, sizze_sum_29015, "mem_28239")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_28256;
    
    mem_28256.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28256, sizze_sum_29016, "mem_28256")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device double_buffer_mem_28763;
    
    double_buffer_mem_28763.references = NULL;
    if (memblock_alloc_device(ctx, &double_buffer_mem_28763, sizze_sum_29017,
                              "double_buffer_mem_28763")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, m_26408)) {
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegScan");
        
        int64_t numThreads_29171;
        
        numThreads_29171 = sdiv_up64(m_26408, segscan_group_sizze_27818 *
                                     (int64_t) 9) * segscan_group_sizze_27818;
        
        int64_t numGroups_29172;
        
        numGroups_29172 = sdiv_up64(m_26408, segscan_group_sizze_27818 *
                                    (int64_t) 9);
        
        struct memblock_device eWiseAddMultEntryziid_counter_mem_29173 =
                               ctx->eWiseAddMultEntryziid_counter_mem_29173;
        struct memblock_device status_flags_mem_29175;
        
        status_flags_mem_29175.references = NULL;
        if (memblock_alloc_device(ctx, &status_flags_mem_29175,
                                  (int64_t) sizeof(int8_t) * numGroups_29172,
                                  "status_flags_mem_29175")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device aggregates_mem_29177;
        
        aggregates_mem_29177.references = NULL;
        if (memblock_alloc_device(ctx, &aggregates_mem_29177,
                                  (int64_t) sizeof(int64_t) * numGroups_29172,
                                  "aggregates_mem_29177")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device incprefixes_mem_29179;
        
        incprefixes_mem_29179.references = NULL;
        if (memblock_alloc_device(ctx, &incprefixes_mem_29179,
                                  (int64_t) sizeof(int64_t) * numGroups_29172,
                                  "incprefixes_mem_29179")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_29175,
                                         numGroups_29172, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        
        unsigned int shared_sizze_30301 = smax64(smax64((int64_t) 288,
                                                        (int64_t) 8 *
                                                        segscan_group_sizze_27818),
                                                 (int64_t) 9 *
                                                 segscan_group_sizze_27818 *
                                                 (int64_t) 8);
        CUdeviceptr kernel_arg_30303 = leftColumns_mem_28232.mem;
        CUdeviceptr kernel_arg_30304 = leftOffsets_mem_28233.mem;
        CUdeviceptr kernel_arg_30305 = rightColumns_mem_28235.mem;
        CUdeviceptr kernel_arg_30306 = rightOffsets_mem_28236.mem;
        CUdeviceptr kernel_arg_30307 = mem_28239.mem;
        CUdeviceptr kernel_arg_30308 = mem_28248.mem;
        CUdeviceptr kernel_arg_30309 = mem_28250.mem;
        CUdeviceptr kernel_arg_30310 = mem_28252.mem;
        CUdeviceptr kernel_arg_30311 = mem_28254.mem;
        CUdeviceptr kernel_arg_30312 = mem_28256.mem;
        CUdeviceptr kernel_arg_30313 = mem_28318.mem;
        CUdeviceptr kernel_arg_30314 = mem_28337.mem;
        CUdeviceptr kernel_arg_30315 = double_buffer_mem_28763.mem;
        CUdeviceptr kernel_arg_30316 =
                    eWiseAddMultEntryziid_counter_mem_29173.mem;
        CUdeviceptr kernel_arg_30317 = status_flags_mem_29175.mem;
        CUdeviceptr kernel_arg_30318 = aggregates_mem_29177.mem;
        CUdeviceptr kernel_arg_30319 = incprefixes_mem_29179.mem;
        unsigned int shared_offset_30302 = 0;
        
        if ((((((1 && sdiv_up64(m_26408, segscan_group_sizze_27818 *
                                (int64_t) 9) != 0) && 1 != 0) && 1 != 0) &&
              segscan_group_sizze_27818 != 0) && 1 != 0) && 1 != 0) {
            int perm[3] = {0, 1, 2};
            
            if (1 >= 1 << 16) {
                perm[1] = perm[0];
                perm[0] = 1;
            }
            if (1 >= 1 << 16) {
                perm[2] = perm[0];
                perm[0] = 2;
            }
            
            size_t grid[3];
            
            grid[perm[0]] = sdiv_up64(m_26408, segscan_group_sizze_27818 *
                                      (int64_t) 9);
            grid[perm[1]] = 1;
            grid[perm[2]] = 1;
            
            void *kernel_args_30298[] = {&ctx->global_failure,
                                         &ctx->failure_is_an_option,
                                         &ctx->global_failure_args,
                                         &shared_offset_30302, &n_26407,
                                         &m_26408, &k_26409, &num_threads_28953,
                                         &kernel_arg_30303, &kernel_arg_30304,
                                         &kernel_arg_30305, &kernel_arg_30306,
                                         &kernel_arg_30307, &kernel_arg_30308,
                                         &kernel_arg_30309, &kernel_arg_30310,
                                         &kernel_arg_30311, &kernel_arg_30312,
                                         &kernel_arg_30313, &kernel_arg_30314,
                                         &kernel_arg_30315, &kernel_arg_30316,
                                         &kernel_arg_30317, &kernel_arg_30318,
                                         &kernel_arg_30319};
            int64_t time_start_30299 = 0, time_end_30300 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with grid size (",
                        "eWiseAddMultEntry.segscan_27823");
                fprintf(stderr, "%d", sdiv_up64(m_26408,
                                                segscan_group_sizze_27818 *
                                                (int64_t) 9));
                fprintf(stderr, ", ");
                fprintf(stderr, "%d", 1);
                fprintf(stderr, ", ");
                fprintf(stderr, "%d", 1);
                fprintf(stderr, ") and block size (");
                fprintf(stderr, "%d", segscan_group_sizze_27818);
                fprintf(stderr, ", ");
                fprintf(stderr, "%d", 1);
                fprintf(stderr, ", ");
                fprintf(stderr, "%d", 1);
                fprintf(stderr, ").\n");
                time_start_30299 = get_wall_time();
            }
            
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->eWiseAddMultEntryzisegscan_27823_runs,
                                          &ctx->eWiseAddMultEntryzisegscan_27823_total_runtime);
                CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED(cuLaunchKernel(ctx->eWiseAddMultEntryzisegscan_27823,
                                        grid[0], grid[1], grid[2],
                                        segscan_group_sizze_27818, 1, 1, 0 +
                                        (shared_sizze_30301 + (8 -
                                                               shared_sizze_30301 %
                                                               8) % 8), NULL,
                                        kernel_args_30298, NULL));
            if (pevents != NULL)
                CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
            if (ctx->debugging) {
                CUDA_SUCCEED(cuCtxSynchronize());
                time_end_30300 = get_wall_time();
                fprintf(stderr, "Kernel %s runtime: %ldus\n",
                        "eWiseAddMultEntry.segscan_27823", time_end_30300 -
                        time_start_30299);
            }
        }
        ctx->failure_is_an_option = 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_29179,
                                  "incprefixes_mem_29179") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_29177,
                                  "aggregates_mem_29177") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_29175,
                                  "status_flags_mem_29175") != 0)
            return 1;
    }
    if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28248, "mem_28248") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28250, "mem_28250") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28254, "mem_28254") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28256, "mem_28256") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28318, "mem_28318") != 0)
        return 1;
    if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                              "double_buffer_mem_28763") != 0)
        return 1;
    
    int64_t i_26595 = sub64(m_26408, (int64_t) 1);
    bool x_26596 = sle64((int64_t) 0, i_26595);
    bool y_26597 = slt64(i_26595, m_26408);
    bool bounds_check_26598 = x_26596 && y_26597;
    bool index_certs_26599;
    
    if (!bounds_check_26598) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Index [", i_26595,
                               "] out of bounds for array of shape [", m_26408,
                               "].",
                               "-> #0  sparse.fut:115:30-41\n   #1  sparse.fut:131:23-48\n   #2  sparse.fut:243:20-62\n   #3  sparse.fut:234:1-247:60\n");
        if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                  "double_buffer_mem_28763") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28256, "mem_28256") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28248, "mem_28248") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28250, "mem_28250") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28254, "mem_28254") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28318, "mem_28318") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                  "group_res_arr_mem_29131") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                  "group_res_arr_mem_29129") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                  "group_res_arr_mem_29127") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_29026, "mem_29026") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_29024, "mem_29024") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_29022, "mem_29022") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28337, "mem_28337") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_29123, "out_mem_29123") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_29121, "out_mem_29121") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_29119, "out_mem_29119") != 0)
            return 1;
        return 1;
    }
    
    int64_t read_res_30320;
    
    {
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->copy_scalar_from_dev_runs,
                                      &ctx->copy_scalar_from_dev_total_runtime);
            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30320, mem_28337.mem + i_26595 *
                                  sizeof(int64_t), sizeof(int64_t)));
        if (pevents != NULL)
            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
    }
    if (futhark_context_sync(ctx) != 0)
        return 1;
    
    int64_t eWiseAddOffsets_res_26600 = read_res_30320;
    bool bounds_invalid_upwards_26601 = slt64(eWiseAddOffsets_res_26600,
                                              (int64_t) 0);
    bool valid_26602 = !bounds_invalid_upwards_26601;
    bool range_valid_c_26603;
    
    if (!valid_26602) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Range ", (int64_t) 0, "..", (int64_t) 1, "..<",
                               eWiseAddOffsets_res_26600, " is invalid.",
                               "-> #0  /prelude/array.fut:60:3-10\n   #1  /prelude/array.fut:70:18-23\n   #2  sparse.fut:132:16-35\n   #3  sparse.fut:243:20-62\n   #4  sparse.fut:234:1-247:60\n");
        if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                  "double_buffer_mem_28763") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28256, "mem_28256") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28248, "mem_28248") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28250, "mem_28250") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28254, "mem_28254") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28318, "mem_28318") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                  "group_res_arr_mem_29131") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                  "group_res_arr_mem_29129") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                  "group_res_arr_mem_29127") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_29026, "mem_29026") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_29024, "mem_29024") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_29022, "mem_29022") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28337, "mem_28337") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_29123, "out_mem_29123") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_29121, "out_mem_29121") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_29119, "out_mem_29119") != 0)
            return 1;
        return 1;
    }
    
    int64_t bytes_28338 = (int64_t) 8 * eWiseAddOffsets_res_26600;
    struct memblock_device mem_28339;
    
    mem_28339.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28339, bytes_28338, "mem_28339")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_f64(ctx, mem_28339, eWiseAddOffsets_res_26600,
                                      0.0) != 0) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_28341;
    
    mem_28341.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28341, bytes_28338, "mem_28341")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_28341, eWiseAddOffsets_res_26600,
                                      (int64_t) 0) != 0) {
        err = 1;
        goto cleanup;
    }
    
    int64_t segmap_group_sizze_27960;
    
    segmap_group_sizze_27960 =
        ctx->sizes.eWiseAddMultEntryzisegmap_group_sizze_27959;
    for (int64_t i_26608 = 0; i_26608 < i_26595; i_26608++) {
        bool y_26611 = slt64(i_26608, m_26408);
        bool index_certs_26612;
        
        if (!y_26611) {
            ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                   "Index [", i_26608,
                                   "] out of bounds for array of shape [",
                                   m_26408, "].",
                                   "-> #0  sparse.fut:140:46-61\n   #1  sparse.fut:243:20-62\n   #2  sparse.fut:234:1-247:60\n");
            if (memblock_unref_device(ctx, &mem_28341, "mem_28341") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28339, "mem_28339") != 0)
                return 1;
            if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                      "double_buffer_mem_28763") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28256, "mem_28256") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28248, "mem_28248") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28250, "mem_28250") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28254, "mem_28254") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28318, "mem_28318") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                      "group_res_arr_mem_29131") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                      "group_res_arr_mem_29129") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                      "group_res_arr_mem_29127") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29026, "mem_29026") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29024, "mem_29024") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29022, "mem_29022") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28337, "mem_28337") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29123, "out_mem_29123") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29121, "out_mem_29121") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29119, "out_mem_29119") !=
                0)
                return 1;
            return 1;
        }
        
        int64_t read_res_30321;
        
        {
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->copy_scalar_from_dev_runs,
                                          &ctx->copy_scalar_from_dev_total_runtime);
                CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30321,
                                      rightOffsets_mem_28236.mem + i_26608 *
                                      sizeof(int64_t), sizeof(int64_t)));
            if (pevents != NULL)
                CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
        }
        if (futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t i_26613 = read_res_30321;
        int64_t i_26614 = add64((int64_t) 1, i_26608);
        bool x_26615 = sle64((int64_t) 0, i_26614);
        bool y_26616 = slt64(i_26614, m_26408);
        bool bounds_check_26617 = x_26615 && y_26616;
        bool index_certs_26618;
        
        if (!bounds_check_26617) {
            ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                   "Index [", i_26614,
                                   "] out of bounds for array of shape [",
                                   m_26408, "].",
                                   "-> #0  sparse.fut:140:63-80\n   #1  sparse.fut:243:20-62\n   #2  sparse.fut:234:1-247:60\n");
            if (memblock_unref_device(ctx, &mem_28341, "mem_28341") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28339, "mem_28339") != 0)
                return 1;
            if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                      "double_buffer_mem_28763") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28256, "mem_28256") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28248, "mem_28248") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28250, "mem_28250") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28254, "mem_28254") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28318, "mem_28318") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                      "group_res_arr_mem_29131") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                      "group_res_arr_mem_29129") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                      "group_res_arr_mem_29127") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29026, "mem_29026") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29024, "mem_29024") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29022, "mem_29022") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28337, "mem_28337") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29123, "out_mem_29123") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29121, "out_mem_29121") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29119, "out_mem_29119") !=
                0)
                return 1;
            return 1;
        }
        
        int64_t read_res_30322;
        
        {
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->copy_scalar_from_dev_runs,
                                          &ctx->copy_scalar_from_dev_total_runtime);
                CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30322,
                                      rightOffsets_mem_28236.mem + i_26614 *
                                      sizeof(int64_t), sizeof(int64_t)));
            if (pevents != NULL)
                CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
        }
        if (futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t j_26619 = read_res_30322;
        int64_t j_m_i_26620 = sub64(j_26619, i_26613);
        bool empty_slice_26621 = j_m_i_26620 == (int64_t) 0;
        int64_t m_26622 = sub64(j_m_i_26620, (int64_t) 1);
        int64_t i_p_m_t_s_26623 = add64(i_26613, m_26622);
        bool zzero_leq_i_p_m_t_s_26624 = sle64((int64_t) 0, i_p_m_t_s_26623);
        bool i_p_m_t_s_leq_w_26625 = slt64(i_p_m_t_s_26623, k_26409);
        bool zzero_lte_i_26626 = sle64((int64_t) 0, i_26613);
        bool i_lte_j_26627 = sle64(i_26613, j_26619);
        bool y_26628 = i_p_m_t_s_leq_w_26625 && zzero_lte_i_26626;
        bool y_26629 = zzero_leq_i_p_m_t_s_26624 && y_26628;
        bool y_26630 = i_lte_j_26627 && y_26629;
        bool forwards_ok_26631 = zzero_lte_i_26626 && y_26630;
        bool ok_or_empty_26632 = empty_slice_26621 || forwards_ok_26631;
        bool index_certs_26633;
        
        if (!ok_or_empty_26632) {
            ctx->error =
                msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                          "Index [", i_26613, ":", j_26619,
                          "] out of bounds for array of shape [", k_26409, "].",
                          "-> #0  sparse.fut:140:32-81\n   #1  sparse.fut:243:20-62\n   #2  sparse.fut:234:1-247:60\n");
            if (memblock_unref_device(ctx, &mem_28341, "mem_28341") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28339, "mem_28339") != 0)
                return 1;
            if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                      "double_buffer_mem_28763") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28256, "mem_28256") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28248, "mem_28248") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28250, "mem_28250") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28254, "mem_28254") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28318, "mem_28318") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                      "group_res_arr_mem_29131") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                      "group_res_arr_mem_29129") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                      "group_res_arr_mem_29127") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29026, "mem_29026") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29024, "mem_29024") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29022, "mem_29022") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28337, "mem_28337") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29123, "out_mem_29123") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29121, "out_mem_29121") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29119, "out_mem_29119") !=
                0)
                return 1;
            return 1;
        }
        
        int64_t read_res_30323;
        
        {
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->copy_scalar_from_dev_runs,
                                          &ctx->copy_scalar_from_dev_total_runtime);
                CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30323,
                                      leftOffsets_mem_28233.mem + i_26608 *
                                      sizeof(int64_t), sizeof(int64_t)));
            if (pevents != NULL)
                CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
        }
        if (futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t i_26635 = read_res_30323;
        int64_t read_res_30324;
        
        {
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->copy_scalar_from_dev_runs,
                                          &ctx->copy_scalar_from_dev_total_runtime);
                CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30324,
                                      leftOffsets_mem_28233.mem + i_26614 *
                                      sizeof(int64_t), sizeof(int64_t)));
            if (pevents != NULL)
                CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
        }
        if (futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t j_26636 = read_res_30324;
        int64_t j_m_i_26637 = sub64(j_26636, i_26635);
        bool empty_slice_26638 = j_m_i_26637 == (int64_t) 0;
        int64_t m_26639 = sub64(j_m_i_26637, (int64_t) 1);
        int64_t i_p_m_t_s_26640 = add64(i_26635, m_26639);
        bool zzero_leq_i_p_m_t_s_26641 = sle64((int64_t) 0, i_p_m_t_s_26640);
        bool i_p_m_t_s_leq_w_26642 = slt64(i_p_m_t_s_26640, n_26407);
        bool zzero_lte_i_26643 = sle64((int64_t) 0, i_26635);
        bool i_lte_j_26644 = sle64(i_26635, j_26636);
        bool y_26645 = i_p_m_t_s_leq_w_26642 && zzero_lte_i_26643;
        bool y_26646 = zzero_leq_i_p_m_t_s_26641 && y_26645;
        bool y_26647 = i_lte_j_26644 && y_26646;
        bool forwards_ok_26648 = zzero_lte_i_26643 && y_26647;
        bool ok_or_empty_26649 = empty_slice_26638 || forwards_ok_26648;
        bool index_certs_26650;
        
        if (!ok_or_empty_26649) {
            ctx->error =
                msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                          "Index [", i_26635, ":", j_26636,
                          "] out of bounds for array of shape [", n_26407, "].",
                          "-> #0  sparse.fut:139:32-78\n   #1  sparse.fut:243:20-62\n   #2  sparse.fut:234:1-247:60\n");
            if (memblock_unref_device(ctx, &mem_28341, "mem_28341") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28339, "mem_28339") != 0)
                return 1;
            if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                      "double_buffer_mem_28763") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28256, "mem_28256") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28248, "mem_28248") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28250, "mem_28250") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28254, "mem_28254") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28318, "mem_28318") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                      "group_res_arr_mem_29131") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                      "group_res_arr_mem_29129") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                      "group_res_arr_mem_29127") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29026, "mem_29026") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29024, "mem_29024") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29022, "mem_29022") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28337, "mem_28337") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29123, "out_mem_29123") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29121, "out_mem_29121") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29119, "out_mem_29119") !=
                0)
                return 1;
            return 1;
        }
        
        int64_t bytes_28356 = (int64_t) 8 * j_m_i_26620;
        struct memblock_device mem_28357;
        
        mem_28357.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28357, bytes_28356, "mem_28357")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i64(ctx, mem_28357, j_m_i_26620,
                                          (int64_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device mem_28359;
        
        mem_28359.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28359, bytes_28356, "mem_28359")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhiota_i64(ctx, mem_28359, j_m_i_26620, (int64_t) 0,
                                     (int64_t) 1) != 0) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device mem_28361;
        
        mem_28361.references = NULL;
        if (memblock_alloc_device(ctx, &mem_28361, bytes_28356, "mem_28361")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i64(ctx, mem_28361, j_m_i_26620,
                                          (int64_t) 1) != 0) {
            err = 1;
            goto cleanup;
        }
        
        int64_t conc_tmp_26655 = j_m_i_26620 + j_m_i_26637;
        int64_t bytes_28362 = (int64_t) 8 * j_m_i_26637;
        int64_t bytes_28366 = (int64_t) 8 * conc_tmp_26655;
        int64_t sizze_26656;
        int64_t sizze_26657;
        int64_t sizze_26658;
        int64_t sizze_26659;
        int64_t unionArrays_res_ixfn_28458;
        int64_t unionArrays_res_ixfn_28459;
        int64_t unionArrays_res_ixfn_28460;
        int64_t unionArrays_res_ixfn_28462;
        int64_t unionArrays_res_ixfn_28463;
        int64_t unionArrays_res_ixfn_28465;
        int64_t unionArrays_res_ixfn_28466;
        int64_t unionArrays_res_ixfn_28468;
        int64_t unionArrays_res_ixfn_28469;
        struct memblock_device unionArrays_res_mem_28461;
        
        unionArrays_res_mem_28461.references = NULL;
        
        struct memblock_device unionArrays_res_mem_28464;
        
        unionArrays_res_mem_28464.references = NULL;
        
        struct memblock_device unionArrays_res_mem_28467;
        
        unionArrays_res_mem_28467.references = NULL;
        
        struct memblock_device unionArrays_res_mem_28470;
        
        unionArrays_res_mem_28470.references = NULL;
        if (empty_slice_26638) {
            sizze_26656 = j_m_i_26620;
            sizze_26657 = j_m_i_26620;
            sizze_26658 = j_m_i_26620;
            sizze_26659 = j_m_i_26620;
            unionArrays_res_ixfn_28458 = j_m_i_26620;
            unionArrays_res_ixfn_28459 = k_26409;
            unionArrays_res_ixfn_28460 = i_26613;
            unionArrays_res_ixfn_28462 = j_m_i_26620;
            unionArrays_res_ixfn_28463 = j_m_i_26620;
            unionArrays_res_ixfn_28465 = j_m_i_26620;
            unionArrays_res_ixfn_28466 = j_m_i_26620;
            unionArrays_res_ixfn_28468 = j_m_i_26620;
            unionArrays_res_ixfn_28469 = j_m_i_26620;
            if (memblock_set_device(ctx, &unionArrays_res_mem_28461,
                                    &rightColumns_mem_28235,
                                    "rightColumns_mem_28235") != 0)
                return 1;
            if (memblock_set_device(ctx, &unionArrays_res_mem_28464, &mem_28361,
                                    "mem_28361") != 0)
                return 1;
            if (memblock_set_device(ctx, &unionArrays_res_mem_28467, &mem_28359,
                                    "mem_28359") != 0)
                return 1;
            if (memblock_set_device(ctx, &unionArrays_res_mem_28470, &mem_28357,
                                    "mem_28357") != 0)
                return 1;
        } else {
            struct memblock_device mem_28363;
            
            mem_28363.references = NULL;
            if (memblock_alloc_device(ctx, &mem_28363, bytes_28362,
                                      "mem_28363")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhreplicate_i64(ctx, mem_28363, j_m_i_26637,
                                              (int64_t) 0) != 0) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device mem_28365;
            
            mem_28365.references = NULL;
            if (memblock_alloc_device(ctx, &mem_28365, bytes_28362,
                                      "mem_28365")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhiota_i64(ctx, mem_28365, j_m_i_26637,
                                         (int64_t) 0, (int64_t) 1) != 0) {
                err = 1;
                goto cleanup;
            }
            
            struct memblock_device mem_28367;
            
            mem_28367.references = NULL;
            if (memblock_alloc_device(ctx, &mem_28367, bytes_28366,
                                      "mem_28367")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t tmp_offs_29310 = (int64_t) 0;
            
            {
                cudaEvent_t *pevents = NULL;
                
                if (ctx->profiling && !ctx->profiling_paused) {
                    pevents = cuda_get_events(&ctx->cuda,
                                              &ctx->copy_dev_to_dev_runs,
                                              &ctx->copy_dev_to_dev_total_runtime);
                    CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
                }
                CUDA_SUCCEED(cuMemcpy(mem_28367.mem + tmp_offs_29310 *
                                      (int64_t) 8, leftColumns_mem_28232.mem +
                                      i_26635 * (int64_t) 8, j_m_i_26637 *
                                      (int64_t) sizeof(int64_t)));
                if (pevents != NULL)
                    CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
            }
            tmp_offs_29310 += j_m_i_26637;
            {
                cudaEvent_t *pevents = NULL;
                
                if (ctx->profiling && !ctx->profiling_paused) {
                    pevents = cuda_get_events(&ctx->cuda,
                                              &ctx->copy_dev_to_dev_runs,
                                              &ctx->copy_dev_to_dev_total_runtime);
                    CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
                }
                CUDA_SUCCEED(cuMemcpy(mem_28367.mem + tmp_offs_29310 *
                                      (int64_t) 8, rightColumns_mem_28235.mem +
                                      i_26613 * (int64_t) 8, j_m_i_26620 *
                                      (int64_t) sizeof(int64_t)));
                if (pevents != NULL)
                    CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
            }
            tmp_offs_29310 += j_m_i_26620;
            
            struct memblock_device mem_28369;
            
            mem_28369.references = NULL;
            if (memblock_alloc_device(ctx, &mem_28369, bytes_28366,
                                      "mem_28369")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhiota_i64(ctx, mem_28369, conc_tmp_26655,
                                         (int64_t) 0, (int64_t) 1) != 0) {
                err = 1;
                goto cleanup;
            }
            
            bool cond_26668 = conc_tmp_26655 == (int64_t) 0;
            int32_t iters_26669;
            
            if (cond_26668) {
                iters_26669 = 0;
            } else {
                iters_26669 = 32;
            }
            
            bool loop_nonempty_26670 = slt32(0, iters_26669);
            int64_t i_26671 = sub64(conc_tmp_26655, (int64_t) 1);
            bool x_26672 = sle64((int64_t) 0, i_26671);
            bool y_26673 = slt64(i_26671, conc_tmp_26655);
            bool bounds_check_26674 = x_26672 && y_26673;
            bool loop_not_taken_26675 = !loop_nonempty_26670;
            bool protect_assert_disj_26676 = bounds_check_26674 ||
                 loop_not_taken_26675;
            int64_t segscan_group_sizze_27826;
            
            segscan_group_sizze_27826 =
                ctx->sizes.eWiseAddMultEntryzisegscan_group_sizze_27825;
            
            int64_t num_groups_27828;
            int32_t max_num_groups_29311;
            
            max_num_groups_29311 =
                ctx->sizes.eWiseAddMultEntryzisegscan_num_groups_27827;
            num_groups_27828 = sext_i64_i32(smax64((int64_t) 1,
                                                   smin64(sdiv_up64(conc_tmp_26655,
                                                                    segscan_group_sizze_27826),
                                                          sext_i32_i64(max_num_groups_29311))));
            
            int64_t segmap_group_sizze_27836;
            
            segmap_group_sizze_27836 =
                ctx->sizes.eWiseAddMultEntryzisegmap_group_sizze_27835;
            
            int64_t segmap_usable_groups_27837 = sdiv_up_safe64(conc_tmp_26655,
                                                                segmap_group_sizze_27836);
            int64_t segmap_group_sizze_27917;
            
            segmap_group_sizze_27917 =
                ctx->sizes.eWiseAddMultEntryzisegmap_group_sizze_27894;
            
            int64_t segscan_group_sizze_27944;
            
            segscan_group_sizze_27944 =
                ctx->sizes.eWiseAddMultEntryzisegscan_group_sizze_27943;
            
            int64_t num_groups_27946;
            int32_t max_num_groups_29312;
            
            max_num_groups_29312 =
                ctx->sizes.eWiseAddMultEntryzisegscan_num_groups_27945;
            num_groups_27946 = sext_i64_i32(smax64((int64_t) 1,
                                                   smin64(sdiv_up64(conc_tmp_26655,
                                                                    segscan_group_sizze_27944),
                                                          sext_i32_i64(max_num_groups_29312))));
            
            int64_t bytes_28393 = (int64_t) 4 * conc_tmp_26655;
            int64_t unionArrays_res_f_res_ixfn_28446;
            
            if (empty_slice_26621) {
                unionArrays_res_f_res_ixfn_28446 = n_26407;
            } else {
                unionArrays_res_f_res_ixfn_28446 = conc_tmp_26655;
            }
            
            int64_t unionArrays_res_f_res_ixfn_28447;
            
            if (empty_slice_26621) {
                unionArrays_res_f_res_ixfn_28447 = i_26635;
            } else {
                unionArrays_res_f_res_ixfn_28447 = (int64_t) 0;
            }
            
            int64_t unionArrays_res_f_res_ixfn_28450;
            
            if (empty_slice_26621) {
                unionArrays_res_f_res_ixfn_28450 = j_m_i_26637;
            } else {
                unionArrays_res_f_res_ixfn_28450 = conc_tmp_26655;
            }
            
            int64_t sizze_26677;
            int64_t sizze_26678;
            int64_t sizze_26679;
            int64_t sizze_26680;
            int64_t unionArrays_res_f_res_ixfn_28445;
            int64_t unionArrays_res_f_res_ixfn_28449;
            int64_t unionArrays_res_f_res_ixfn_28452;
            int64_t unionArrays_res_f_res_ixfn_28455;
            struct memblock_device unionArrays_res_f_res_mem_28448;
            
            unionArrays_res_f_res_mem_28448.references = NULL;
            
            struct memblock_device unionArrays_res_f_res_mem_28451;
            
            unionArrays_res_f_res_mem_28451.references = NULL;
            
            struct memblock_device unionArrays_res_f_res_mem_28454;
            
            unionArrays_res_f_res_mem_28454.references = NULL;
            
            struct memblock_device unionArrays_res_f_res_mem_28457;
            
            unionArrays_res_f_res_mem_28457.references = NULL;
            if (empty_slice_26621) {
                sizze_26677 = j_m_i_26637;
                sizze_26678 = j_m_i_26637;
                sizze_26679 = j_m_i_26637;
                sizze_26680 = j_m_i_26637;
                unionArrays_res_f_res_ixfn_28445 = j_m_i_26637;
                unionArrays_res_f_res_ixfn_28449 = j_m_i_26637;
                unionArrays_res_f_res_ixfn_28452 = j_m_i_26637;
                unionArrays_res_f_res_ixfn_28455 = j_m_i_26637;
                if (memblock_set_device(ctx, &unionArrays_res_f_res_mem_28448,
                                        &leftColumns_mem_28232,
                                        "leftColumns_mem_28232") != 0)
                    return 1;
                if (memblock_set_device(ctx, &unionArrays_res_f_res_mem_28451,
                                        &mem_28363, "mem_28363") != 0)
                    return 1;
                if (memblock_set_device(ctx, &unionArrays_res_f_res_mem_28454,
                                        &mem_28365, "mem_28365") != 0)
                    return 1;
                if (memblock_set_device(ctx, &unionArrays_res_f_res_mem_28457,
                                        &mem_28363, "mem_28363") != 0)
                    return 1;
            } else {
                bool index_certs_26685;
                
                if (!protect_assert_disj_26676) {
                    ctx->error =
                        msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                  "Index [", i_26671,
                                  "] out of bounds for array of shape [",
                                  conc_tmp_26655, "].",
                                  "-> #0  /prelude/array.fut:18:29-34\n   #1  lib/github.com/diku-dk/sorts/radix_sort.fut:25:24-35\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:53:31-62\n   #3  /prelude/functional.fut:9:42-44\n   #4  lib/github.com/diku-dk/sorts/radix_sort.fut:59:3-61:47\n   #5  lib/github.com/diku-dk/sorts/radix_sort.fut:68:3-51\n   #6  sparse.fut:5:34-6:77\n   #7  sparse.fut:53:12-35\n   #8  sparse.fut:138:59-140:81\n   #9  sparse.fut:243:20-62\n   #10 sparse.fut:234:1-247:60\n");
                    if (memblock_unref_device(ctx,
                                              &unionArrays_res_f_res_mem_28457,
                                              "unionArrays_res_f_res_mem_28457") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &unionArrays_res_f_res_mem_28454,
                                              "unionArrays_res_f_res_mem_28454") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &unionArrays_res_f_res_mem_28451,
                                              "unionArrays_res_f_res_mem_28451") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &unionArrays_res_f_res_mem_28448,
                                              "unionArrays_res_f_res_mem_28448") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28369, "mem_28369") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28367, "mem_28367") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28365, "mem_28365") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28363, "mem_28363") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &unionArrays_res_mem_28470,
                                              "unionArrays_res_mem_28470") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &unionArrays_res_mem_28467,
                                              "unionArrays_res_mem_28467") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &unionArrays_res_mem_28464,
                                              "unionArrays_res_mem_28464") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &unionArrays_res_mem_28461,
                                              "unionArrays_res_mem_28461") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28361, "mem_28361") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28359, "mem_28359") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28357, "mem_28357") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28341, "mem_28341") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28339, "mem_28339") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                              "double_buffer_mem_28763") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28256, "mem_28256") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28239, "mem_28239") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28248, "mem_28248") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28250, "mem_28250") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28252, "mem_28252") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28254, "mem_28254") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28318, "mem_28318") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                              "group_res_arr_mem_29131") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                              "group_res_arr_mem_29129") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                              "group_res_arr_mem_29127") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_29026, "mem_29026") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_29024, "mem_29024") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_29022, "mem_29022") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28337, "mem_28337") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &out_mem_29123,
                                              "out_mem_29123") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &out_mem_29121,
                                              "out_mem_29121") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &out_mem_29119,
                                              "out_mem_29119") != 0)
                        return 1;
                    return 1;
                }
                
                struct memblock_device mem_28386;
                
                mem_28386.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28386, bytes_28366,
                                          "mem_28386")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28388;
                
                mem_28388.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28388, bytes_28366,
                                          "mem_28388")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28390;
                
                mem_28390.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28390, bytes_28366,
                                          "mem_28390")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28392;
                
                mem_28392.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28392, bytes_28366,
                                          "mem_28392")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28394;
                
                mem_28394.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28394, bytes_28393,
                                          "mem_28394")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device defunc_0_f_res_mem_28408;
                
                defunc_0_f_res_mem_28408.references = NULL;
                
                struct memblock_device defunc_0_f_res_mem_28413;
                
                defunc_0_f_res_mem_28413.references = NULL;
                
                struct memblock_device mem_param_28374;
                
                mem_param_28374.references = NULL;
                
                struct memblock_device mem_param_28379;
                
                mem_param_28379.references = NULL;
                if (memblock_set_device(ctx, &mem_param_28374, &mem_28367,
                                        "mem_28367") != 0)
                    return 1;
                if (memblock_set_device(ctx, &mem_param_28379, &mem_28369,
                                        "mem_28369") != 0)
                    return 1;
                for (int32_t i_26688 = 0; i_26688 < iters_26669; i_26688++) {
                    int32_t defunc_2_radix_sort_step_arg_26691 = mul32(2,
                                                                       i_26688);
                    int32_t defunc_0_get_bit_arg_26692 = add32(1,
                                                               defunc_2_radix_sort_step_arg_26691);
                    int64_t i32_res_26693 =
                            sext_i32_i64(defunc_0_get_bit_arg_26692);
                    int64_t i32_res_26694 =
                            sext_i32_i64(defunc_2_radix_sort_step_arg_26691);
                    
                    if (slt64((int64_t) 0, conc_tmp_26655)) {
                        if (ctx->debugging)
                            fprintf(stderr, "%s\n", "\n# SegScan");
                        
                        int64_t numThreads_29317;
                        
                        numThreads_29317 = sdiv_up64(conc_tmp_26655,
                                                     segscan_group_sizze_27826 *
                                                     (int64_t) 9) *
                            segscan_group_sizze_27826;
                        
                        int64_t numGroups_29318;
                        
                        numGroups_29318 = sdiv_up64(conc_tmp_26655,
                                                    segscan_group_sizze_27826 *
                                                    (int64_t) 9);
                        
                        struct memblock_device
                        eWiseAddMultEntryziid_counter_mem_29319 =
                        ctx->eWiseAddMultEntryziid_counter_mem_29319;
                        struct memblock_device status_flags_mem_29321;
                        
                        status_flags_mem_29321.references = NULL;
                        if (memblock_alloc_device(ctx, &status_flags_mem_29321,
                                                  (int64_t) sizeof(int8_t) *
                                                  numGroups_29318,
                                                  "status_flags_mem_29321")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        struct memblock_device aggregates_mem_29323;
                        
                        aggregates_mem_29323.references = NULL;
                        if (memblock_alloc_device(ctx, &aggregates_mem_29323,
                                                  (int64_t) sizeof(int64_t) *
                                                  numGroups_29318,
                                                  "aggregates_mem_29323")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        struct memblock_device incprefixes_mem_29325;
                        
                        incprefixes_mem_29325.references = NULL;
                        if (memblock_alloc_device(ctx, &incprefixes_mem_29325,
                                                  (int64_t) sizeof(int64_t) *
                                                  numGroups_29318,
                                                  "incprefixes_mem_29325")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        struct memblock_device aggregates_mem_29327;
                        
                        aggregates_mem_29327.references = NULL;
                        if (memblock_alloc_device(ctx, &aggregates_mem_29327,
                                                  (int64_t) sizeof(int64_t) *
                                                  numGroups_29318,
                                                  "aggregates_mem_29327")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        struct memblock_device incprefixes_mem_29329;
                        
                        incprefixes_mem_29329.references = NULL;
                        if (memblock_alloc_device(ctx, &incprefixes_mem_29329,
                                                  (int64_t) sizeof(int64_t) *
                                                  numGroups_29318,
                                                  "incprefixes_mem_29329")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        struct memblock_device aggregates_mem_29331;
                        
                        aggregates_mem_29331.references = NULL;
                        if (memblock_alloc_device(ctx, &aggregates_mem_29331,
                                                  (int64_t) sizeof(int64_t) *
                                                  numGroups_29318,
                                                  "aggregates_mem_29331")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        struct memblock_device incprefixes_mem_29333;
                        
                        incprefixes_mem_29333.references = NULL;
                        if (memblock_alloc_device(ctx, &incprefixes_mem_29333,
                                                  (int64_t) sizeof(int64_t) *
                                                  numGroups_29318,
                                                  "incprefixes_mem_29333")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        struct memblock_device aggregates_mem_29335;
                        
                        aggregates_mem_29335.references = NULL;
                        if (memblock_alloc_device(ctx, &aggregates_mem_29335,
                                                  (int64_t) sizeof(int64_t) *
                                                  numGroups_29318,
                                                  "aggregates_mem_29335")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        struct memblock_device incprefixes_mem_29337;
                        
                        incprefixes_mem_29337.references = NULL;
                        if (memblock_alloc_device(ctx, &incprefixes_mem_29337,
                                                  (int64_t) sizeof(int64_t) *
                                                  numGroups_29318,
                                                  "incprefixes_mem_29337")) {
                            err = 1;
                            goto cleanup;
                        }
                        if (futrts_builtinzhreplicate_i8(ctx,
                                                         status_flags_mem_29321,
                                                         numGroups_29318,
                                                         (int8_t) 0) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        unsigned int shared_sizze_30329 =
                                     smax64(smax64((int64_t) 1056,
                                                   sdiv_up64(sdiv_up64(sdiv_up64((int64_t) 8 *
                                                                                 segscan_group_sizze_27826,
                                                                                 (int64_t) 8) *
                                                                       (int64_t) 8 +
                                                                       (int64_t) 8 *
                                                                       segscan_group_sizze_27826,
                                                                       (int64_t) 8) *
                                                             (int64_t) 8 +
                                                             (int64_t) 8 *
                                                             segscan_group_sizze_27826,
                                                             (int64_t) 8) *
                                                   (int64_t) 8 + (int64_t) 8 *
                                                   segscan_group_sizze_27826),
                                            smax64(smax64(smax64((int64_t) 9 *
                                                                 segscan_group_sizze_27826 *
                                                                 (int64_t) 8,
                                                                 (int64_t) 9 *
                                                                 segscan_group_sizze_27826 *
                                                                 (int64_t) 8),
                                                          (int64_t) 9 *
                                                          segscan_group_sizze_27826 *
                                                          (int64_t) 8),
                                                   (int64_t) 9 *
                                                   segscan_group_sizze_27826 *
                                                   (int64_t) 8));
                        CUdeviceptr kernel_arg_30331 = mem_param_28374.mem;
                        CUdeviceptr kernel_arg_30332 = mem_28386.mem;
                        CUdeviceptr kernel_arg_30333 = mem_28388.mem;
                        CUdeviceptr kernel_arg_30334 = mem_28390.mem;
                        CUdeviceptr kernel_arg_30335 = mem_28392.mem;
                        CUdeviceptr kernel_arg_30336 = mem_28394.mem;
                        CUdeviceptr kernel_arg_30337 =
                                    eWiseAddMultEntryziid_counter_mem_29319.mem;
                        CUdeviceptr kernel_arg_30338 =
                                    status_flags_mem_29321.mem;
                        CUdeviceptr kernel_arg_30339 = aggregates_mem_29323.mem;
                        CUdeviceptr kernel_arg_30340 =
                                    incprefixes_mem_29325.mem;
                        CUdeviceptr kernel_arg_30341 = aggregates_mem_29327.mem;
                        CUdeviceptr kernel_arg_30342 =
                                    incprefixes_mem_29329.mem;
                        CUdeviceptr kernel_arg_30343 = aggregates_mem_29331.mem;
                        CUdeviceptr kernel_arg_30344 =
                                    incprefixes_mem_29333.mem;
                        CUdeviceptr kernel_arg_30345 = aggregates_mem_29335.mem;
                        CUdeviceptr kernel_arg_30346 =
                                    incprefixes_mem_29337.mem;
                        unsigned int shared_offset_30330 = 0;
                        
                        if ((((((1 && sdiv_up64(conc_tmp_26655,
                                                segscan_group_sizze_27826 *
                                                (int64_t) 9) != 0) && 1 != 0) &&
                               1 != 0) && segscan_group_sizze_27826 != 0) &&
                             1 != 0) && 1 != 0) {
                            int perm[3] = {0, 1, 2};
                            
                            if (1 >= 1 << 16) {
                                perm[1] = perm[0];
                                perm[0] = 1;
                            }
                            if (1 >= 1 << 16) {
                                perm[2] = perm[0];
                                perm[0] = 2;
                            }
                            
                            size_t grid[3];
                            
                            grid[perm[0]] = sdiv_up64(conc_tmp_26655,
                                                      segscan_group_sizze_27826 *
                                                      (int64_t) 9);
                            grid[perm[1]] = 1;
                            grid[perm[2]] = 1;
                            
                            void *kernel_args_30326[] = {&ctx->global_failure,
                                                         &shared_offset_30330,
                                                         &conc_tmp_26655,
                                                         &i32_res_26693,
                                                         &i32_res_26694,
                                                         &kernel_arg_30331,
                                                         &kernel_arg_30332,
                                                         &kernel_arg_30333,
                                                         &kernel_arg_30334,
                                                         &kernel_arg_30335,
                                                         &kernel_arg_30336,
                                                         &kernel_arg_30337,
                                                         &kernel_arg_30338,
                                                         &kernel_arg_30339,
                                                         &kernel_arg_30340,
                                                         &kernel_arg_30341,
                                                         &kernel_arg_30342,
                                                         &kernel_arg_30343,
                                                         &kernel_arg_30344,
                                                         &kernel_arg_30345,
                                                         &kernel_arg_30346};
                            int64_t time_start_30327 = 0, time_end_30328 = 0;
                            
                            if (ctx->debugging) {
                                fprintf(stderr, "Launching %s with grid size (",
                                        "eWiseAddMultEntry.segscan_27831");
                                fprintf(stderr, "%d", sdiv_up64(conc_tmp_26655,
                                                                segscan_group_sizze_27826 *
                                                                (int64_t) 9));
                                fprintf(stderr, ", ");
                                fprintf(stderr, "%d", 1);
                                fprintf(stderr, ", ");
                                fprintf(stderr, "%d", 1);
                                fprintf(stderr, ") and block size (");
                                fprintf(stderr, "%d",
                                        segscan_group_sizze_27826);
                                fprintf(stderr, ", ");
                                fprintf(stderr, "%d", 1);
                                fprintf(stderr, ", ");
                                fprintf(stderr, "%d", 1);
                                fprintf(stderr, ").\n");
                                time_start_30327 = get_wall_time();
                            }
                            
                            cudaEvent_t *pevents = NULL;
                            
                            if (ctx->profiling && !ctx->profiling_paused) {
                                pevents = cuda_get_events(&ctx->cuda,
                                                          &ctx->eWiseAddMultEntryzisegscan_27831_runs,
                                                          &ctx->eWiseAddMultEntryzisegscan_27831_total_runtime);
                                CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
                            }
                            CUDA_SUCCEED(cuLaunchKernel(ctx->eWiseAddMultEntryzisegscan_27831,
                                                        grid[0], grid[1],
                                                        grid[2],
                                                        segscan_group_sizze_27826,
                                                        1, 1, 0 +
                                                        (shared_sizze_30329 +
                                                         (8 -
                                                          shared_sizze_30329 %
                                                          8) % 8), NULL,
                                                        kernel_args_30326,
                                                        NULL));
                            if (pevents != NULL)
                                CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
                            if (ctx->debugging) {
                                CUDA_SUCCEED(cuCtxSynchronize());
                                time_end_30328 = get_wall_time();
                                fprintf(stderr, "Kernel %s runtime: %ldus\n",
                                        "eWiseAddMultEntry.segscan_27831",
                                        time_end_30328 - time_start_30327);
                            }
                        }
                        if (memblock_unref_device(ctx, &incprefixes_mem_29337,
                                                  "incprefixes_mem_29337") != 0)
                            return 1;
                        if (memblock_unref_device(ctx, &aggregates_mem_29335,
                                                  "aggregates_mem_29335") != 0)
                            return 1;
                        if (memblock_unref_device(ctx, &incprefixes_mem_29333,
                                                  "incprefixes_mem_29333") != 0)
                            return 1;
                        if (memblock_unref_device(ctx, &aggregates_mem_29331,
                                                  "aggregates_mem_29331") != 0)
                            return 1;
                        if (memblock_unref_device(ctx, &incprefixes_mem_29329,
                                                  "incprefixes_mem_29329") != 0)
                            return 1;
                        if (memblock_unref_device(ctx, &aggregates_mem_29327,
                                                  "aggregates_mem_29327") != 0)
                            return 1;
                        if (memblock_unref_device(ctx, &incprefixes_mem_29325,
                                                  "incprefixes_mem_29325") != 0)
                            return 1;
                        if (memblock_unref_device(ctx, &aggregates_mem_29323,
                                                  "aggregates_mem_29323") != 0)
                            return 1;
                        if (memblock_unref_device(ctx, &status_flags_mem_29321,
                                                  "status_flags_mem_29321") !=
                            0)
                            return 1;
                    }
                    
                    int64_t read_res_30347;
                    
                    {
                        cudaEvent_t *pevents = NULL;
                        
                        if (ctx->profiling && !ctx->profiling_paused) {
                            pevents = cuda_get_events(&ctx->cuda,
                                                      &ctx->copy_scalar_from_dev_runs,
                                                      &ctx->copy_scalar_from_dev_total_runtime);
                            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
                        }
                        CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30347,
                                                  mem_28386.mem + i_26671 *
                                                  sizeof(int64_t),
                                                  sizeof(int64_t)));
                        if (pevents != NULL)
                            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
                    }
                    if (futhark_context_sync(ctx) != 0)
                        return 1;
                    
                    int64_t last_res_26749 = read_res_30347;
                    int64_t read_res_30348;
                    
                    {
                        cudaEvent_t *pevents = NULL;
                        
                        if (ctx->profiling && !ctx->profiling_paused) {
                            pevents = cuda_get_events(&ctx->cuda,
                                                      &ctx->copy_scalar_from_dev_runs,
                                                      &ctx->copy_scalar_from_dev_total_runtime);
                            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
                        }
                        CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30348,
                                                  mem_28388.mem + i_26671 *
                                                  sizeof(int64_t),
                                                  sizeof(int64_t)));
                        if (pevents != NULL)
                            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
                    }
                    if (futhark_context_sync(ctx) != 0)
                        return 1;
                    
                    int64_t last_res_26750 = read_res_30348;
                    int64_t read_res_30349;
                    
                    {
                        cudaEvent_t *pevents = NULL;
                        
                        if (ctx->profiling && !ctx->profiling_paused) {
                            pevents = cuda_get_events(&ctx->cuda,
                                                      &ctx->copy_scalar_from_dev_runs,
                                                      &ctx->copy_scalar_from_dev_total_runtime);
                            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
                        }
                        CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30349,
                                                  mem_28390.mem + i_26671 *
                                                  sizeof(int64_t),
                                                  sizeof(int64_t)));
                        if (pevents != NULL)
                            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
                    }
                    if (futhark_context_sync(ctx) != 0)
                        return 1;
                    
                    int64_t last_res_26751 = read_res_30349;
                    struct memblock_device mem_28396;
                    
                    mem_28396.references = NULL;
                    if (memblock_alloc_device(ctx, &mem_28396, bytes_28366,
                                              "mem_28396")) {
                        err = 1;
                        goto cleanup;
                    }
                    {
                        cudaEvent_t *pevents = NULL;
                        
                        if (ctx->profiling && !ctx->profiling_paused) {
                            pevents = cuda_get_events(&ctx->cuda,
                                                      &ctx->copy_dev_to_dev_runs,
                                                      &ctx->copy_dev_to_dev_total_runtime);
                            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
                        }
                        CUDA_SUCCEED(cuMemcpy(mem_28396.mem + (int64_t) 0,
                                              mem_param_28374.mem + (int64_t) 0,
                                              conc_tmp_26655 *
                                              (int64_t) sizeof(int64_t)));
                        if (pevents != NULL)
                            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
                    }
                    
                    struct memblock_device mem_28398;
                    
                    mem_28398.references = NULL;
                    if (memblock_alloc_device(ctx, &mem_28398, bytes_28366,
                                              "mem_28398")) {
                        err = 1;
                        goto cleanup;
                    }
                    {
                        cudaEvent_t *pevents = NULL;
                        
                        if (ctx->profiling && !ctx->profiling_paused) {
                            pevents = cuda_get_events(&ctx->cuda,
                                                      &ctx->copy_dev_to_dev_runs,
                                                      &ctx->copy_dev_to_dev_total_runtime);
                            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
                        }
                        CUDA_SUCCEED(cuMemcpy(mem_28398.mem + (int64_t) 0,
                                              mem_param_28379.mem + (int64_t) 0,
                                              conc_tmp_26655 *
                                              (int64_t) sizeof(int64_t)));
                        if (pevents != NULL)
                            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
                    }
                    if (ctx->debugging)
                        fprintf(stderr, "%s\n", "\n# SegMap");
                    
                    CUdeviceptr kernel_arg_30353 = mem_param_28374.mem;
                    CUdeviceptr kernel_arg_30354 = mem_param_28379.mem;
                    CUdeviceptr kernel_arg_30355 = mem_28386.mem;
                    CUdeviceptr kernel_arg_30356 = mem_28388.mem;
                    CUdeviceptr kernel_arg_30357 = mem_28390.mem;
                    CUdeviceptr kernel_arg_30358 = mem_28392.mem;
                    CUdeviceptr kernel_arg_30359 = mem_28394.mem;
                    CUdeviceptr kernel_arg_30360 = mem_28396.mem;
                    CUdeviceptr kernel_arg_30361 = mem_28398.mem;
                    
                    if ((((((1 && segmap_usable_groups_27837 != 0) && 1 != 0) &&
                           1 != 0) && segmap_group_sizze_27836 != 0) && 1 !=
                         0) && 1 != 0) {
                        int perm[3] = {0, 1, 2};
                        
                        if (1 >= 1 << 16) {
                            perm[1] = perm[0];
                            perm[0] = 1;
                        }
                        if (1 >= 1 << 16) {
                            perm[2] = perm[0];
                            perm[0] = 2;
                        }
                        
                        size_t grid[3];
                        
                        grid[perm[0]] = segmap_usable_groups_27837;
                        grid[perm[1]] = 1;
                        grid[perm[2]] = 1;
                        
                        void *kernel_args_30350[] = {&ctx->global_failure,
                                                     &conc_tmp_26655,
                                                     &last_res_26749,
                                                     &last_res_26750,
                                                     &last_res_26751,
                                                     &kernel_arg_30353,
                                                     &kernel_arg_30354,
                                                     &kernel_arg_30355,
                                                     &kernel_arg_30356,
                                                     &kernel_arg_30357,
                                                     &kernel_arg_30358,
                                                     &kernel_arg_30359,
                                                     &kernel_arg_30360,
                                                     &kernel_arg_30361};
                        int64_t time_start_30351 = 0, time_end_30352 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(stderr, "Launching %s with grid size (",
                                    "eWiseAddMultEntry.segmap_27833");
                            fprintf(stderr, "%d", segmap_usable_groups_27837);
                            fprintf(stderr, ", ");
                            fprintf(stderr, "%d", 1);
                            fprintf(stderr, ", ");
                            fprintf(stderr, "%d", 1);
                            fprintf(stderr, ") and block size (");
                            fprintf(stderr, "%d", segmap_group_sizze_27836);
                            fprintf(stderr, ", ");
                            fprintf(stderr, "%d", 1);
                            fprintf(stderr, ", ");
                            fprintf(stderr, "%d", 1);
                            fprintf(stderr, ").\n");
                            time_start_30351 = get_wall_time();
                        }
                        
                        cudaEvent_t *pevents = NULL;
                        
                        if (ctx->profiling && !ctx->profiling_paused) {
                            pevents = cuda_get_events(&ctx->cuda,
                                                      &ctx->eWiseAddMultEntryzisegmap_27833_runs,
                                                      &ctx->eWiseAddMultEntryzisegmap_27833_total_runtime);
                            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
                        }
                        CUDA_SUCCEED(cuLaunchKernel(ctx->eWiseAddMultEntryzisegmap_27833,
                                                    grid[0], grid[1], grid[2],
                                                    segmap_group_sizze_27836, 1,
                                                    1, 0, NULL,
                                                    kernel_args_30350, NULL));
                        if (pevents != NULL)
                            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
                        if (ctx->debugging) {
                            CUDA_SUCCEED(cuCtxSynchronize());
                            time_end_30352 = get_wall_time();
                            fprintf(stderr, "Kernel %s runtime: %ldus\n",
                                    "eWiseAddMultEntry.segmap_27833",
                                    time_end_30352 - time_start_30351);
                        }
                    }
                    
                    struct memblock_device mem_param_tmp_29313;
                    
                    mem_param_tmp_29313.references = NULL;
                    if (memblock_set_device(ctx, &mem_param_tmp_29313,
                                            &mem_28396, "mem_28396") != 0)
                        return 1;
                    
                    struct memblock_device mem_param_tmp_29314;
                    
                    mem_param_tmp_29314.references = NULL;
                    if (memblock_set_device(ctx, &mem_param_tmp_29314,
                                            &mem_28398, "mem_28398") != 0)
                        return 1;
                    if (memblock_set_device(ctx, &mem_param_28374,
                                            &mem_param_tmp_29313,
                                            "mem_param_tmp_29313") != 0)
                        return 1;
                    if (memblock_set_device(ctx, &mem_param_28379,
                                            &mem_param_tmp_29314,
                                            "mem_param_tmp_29314") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_param_tmp_29314,
                                              "mem_param_tmp_29314") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_param_tmp_29313,
                                              "mem_param_tmp_29313") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28398, "mem_28398") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28396, "mem_28396") !=
                        0)
                        return 1;
                }
                if (memblock_set_device(ctx, &defunc_0_f_res_mem_28408,
                                        &mem_param_28374, "mem_param_28374") !=
                    0)
                    return 1;
                if (memblock_set_device(ctx, &defunc_0_f_res_mem_28413,
                                        &mem_param_28379, "mem_param_28379") !=
                    0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28386, "mem_28386") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28388, "mem_28388") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28390, "mem_28390") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28392, "mem_28392") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28394, "mem_28394") != 0)
                    return 1;
                
                int64_t segmap_usable_groups_27918 = sdiv_up64(conc_tmp_26655,
                                                               segmap_group_sizze_27917);
                struct memblock_device mem_28416;
                
                mem_28416.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28416, bytes_28366,
                                          "mem_28416")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28418;
                
                mem_28418.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28418, bytes_28366,
                                          "mem_28418")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28420;
                
                mem_28420.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28420, bytes_28366,
                                          "mem_28420")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28422;
                
                mem_28422.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28422, bytes_28366,
                                          "mem_28422")) {
                    err = 1;
                    goto cleanup;
                }
                if (ctx->debugging)
                    fprintf(stderr, "%s\n", "\n# SegMap");
                
                CUdeviceptr kernel_arg_30365 = leftColumns_mem_28232.mem;
                CUdeviceptr kernel_arg_30366 = rightColumns_mem_28235.mem;
                CUdeviceptr kernel_arg_30367 = defunc_0_f_res_mem_28413.mem;
                CUdeviceptr kernel_arg_30368 = mem_28416.mem;
                CUdeviceptr kernel_arg_30369 = mem_28418.mem;
                CUdeviceptr kernel_arg_30370 = mem_28420.mem;
                CUdeviceptr kernel_arg_30371 = mem_28422.mem;
                
                if ((((((1 && segmap_usable_groups_27918 != 0) && 1 != 0) &&
                       1 != 0) && segmap_group_sizze_27917 != 0) && 1 != 0) &&
                    1 != 0) {
                    int perm[3] = {0, 1, 2};
                    
                    if (1 >= 1 << 16) {
                        perm[1] = perm[0];
                        perm[0] = 1;
                    }
                    if (1 >= 1 << 16) {
                        perm[2] = perm[0];
                        perm[0] = 2;
                    }
                    
                    size_t grid[3];
                    
                    grid[perm[0]] = segmap_usable_groups_27918;
                    grid[perm[1]] = 1;
                    grid[perm[2]] = 1;
                    
                    void *kernel_args_30362[] = {&ctx->global_failure,
                                                 &ctx->failure_is_an_option,
                                                 &ctx->global_failure_args,
                                                 &i_26613, &i_26635,
                                                 &j_m_i_26637, &conc_tmp_26655,
                                                 &kernel_arg_30365,
                                                 &kernel_arg_30366,
                                                 &kernel_arg_30367,
                                                 &kernel_arg_30368,
                                                 &kernel_arg_30369,
                                                 &kernel_arg_30370,
                                                 &kernel_arg_30371};
                    int64_t time_start_30363 = 0, time_end_30364 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(stderr, "Launching %s with grid size (",
                                "eWiseAddMultEntry.segmap_27892");
                        fprintf(stderr, "%d", segmap_usable_groups_27918);
                        fprintf(stderr, ", ");
                        fprintf(stderr, "%d", 1);
                        fprintf(stderr, ", ");
                        fprintf(stderr, "%d", 1);
                        fprintf(stderr, ") and block size (");
                        fprintf(stderr, "%d", segmap_group_sizze_27917);
                        fprintf(stderr, ", ");
                        fprintf(stderr, "%d", 1);
                        fprintf(stderr, ", ");
                        fprintf(stderr, "%d", 1);
                        fprintf(stderr, ").\n");
                        time_start_30363 = get_wall_time();
                    }
                    
                    cudaEvent_t *pevents = NULL;
                    
                    if (ctx->profiling && !ctx->profiling_paused) {
                        pevents = cuda_get_events(&ctx->cuda,
                                                  &ctx->eWiseAddMultEntryzisegmap_27892_runs,
                                                  &ctx->eWiseAddMultEntryzisegmap_27892_total_runtime);
                        CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
                    }
                    CUDA_SUCCEED(cuLaunchKernel(ctx->eWiseAddMultEntryzisegmap_27892,
                                                grid[0], grid[1], grid[2],
                                                segmap_group_sizze_27917, 1, 1,
                                                0, NULL, kernel_args_30362,
                                                NULL));
                    if (pevents != NULL)
                        CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
                    if (ctx->debugging) {
                        CUDA_SUCCEED(cuCtxSynchronize());
                        time_end_30364 = get_wall_time();
                        fprintf(stderr, "Kernel %s runtime: %ldus\n",
                                "eWiseAddMultEntry.segmap_27892",
                                time_end_30364 - time_start_30363);
                    }
                }
                ctx->failure_is_an_option = 1;
                if (memblock_unref_device(ctx, &defunc_0_f_res_mem_28413,
                                          "defunc_0_f_res_mem_28413") != 0)
                    return 1;
                
                struct memblock_device mem_28425;
                
                mem_28425.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28425, bytes_28366,
                                          "mem_28425")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28427;
                
                mem_28427.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28427, bytes_28366,
                                          "mem_28427")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28429;
                
                mem_28429.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28429, bytes_28366,
                                          "mem_28429")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28431;
                
                mem_28431.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28431, bytes_28366,
                                          "mem_28431")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28433;
                
                mem_28433.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28433, bytes_28366,
                                          "mem_28433")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28435;
                
                mem_28435.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28435, bytes_28366,
                                          "mem_28435")) {
                    err = 1;
                    goto cleanup;
                }
                if (slt64((int64_t) 0, conc_tmp_26655)) {
                    if (ctx->debugging)
                        fprintf(stderr, "%s\n", "\n# SegScan");
                    
                    int64_t numThreads_29540;
                    
                    numThreads_29540 = sdiv_up64(conc_tmp_26655,
                                                 segscan_group_sizze_27944 *
                                                 (int64_t) 9) *
                        segscan_group_sizze_27944;
                    
                    int64_t numGroups_29541;
                    
                    numGroups_29541 = sdiv_up64(conc_tmp_26655,
                                                segscan_group_sizze_27944 *
                                                (int64_t) 9);
                    
                    struct memblock_device
                    eWiseAddMultEntryziid_counter_mem_29542 =
                    ctx->eWiseAddMultEntryziid_counter_mem_29542;
                    struct memblock_device status_flags_mem_29544;
                    
                    status_flags_mem_29544.references = NULL;
                    if (memblock_alloc_device(ctx, &status_flags_mem_29544,
                                              (int64_t) sizeof(int8_t) *
                                              numGroups_29541,
                                              "status_flags_mem_29544")) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    struct memblock_device aggregates_mem_29546;
                    
                    aggregates_mem_29546.references = NULL;
                    if (memblock_alloc_device(ctx, &aggregates_mem_29546,
                                              (int64_t) sizeof(int64_t) *
                                              numGroups_29541,
                                              "aggregates_mem_29546")) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    struct memblock_device incprefixes_mem_29548;
                    
                    incprefixes_mem_29548.references = NULL;
                    if (memblock_alloc_device(ctx, &incprefixes_mem_29548,
                                              (int64_t) sizeof(int64_t) *
                                              numGroups_29541,
                                              "incprefixes_mem_29548")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (futrts_builtinzhreplicate_i8(ctx,
                                                     status_flags_mem_29544,
                                                     numGroups_29541,
                                                     (int8_t) 0) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    unsigned int shared_sizze_30376 =
                                 smax64(smax64((int64_t) 288, (int64_t) 8 *
                                               segscan_group_sizze_27944),
                                        (int64_t) 9 *
                                        segscan_group_sizze_27944 *
                                        (int64_t) 8);
                    CUdeviceptr kernel_arg_30378 = mem_28416.mem;
                    CUdeviceptr kernel_arg_30379 = mem_28418.mem;
                    CUdeviceptr kernel_arg_30380 = mem_28420.mem;
                    CUdeviceptr kernel_arg_30381 = mem_28422.mem;
                    CUdeviceptr kernel_arg_30382 = mem_28425.mem;
                    CUdeviceptr kernel_arg_30383 = mem_28427.mem;
                    CUdeviceptr kernel_arg_30384 = mem_28429.mem;
                    CUdeviceptr kernel_arg_30385 = mem_28431.mem;
                    CUdeviceptr kernel_arg_30386 = mem_28433.mem;
                    CUdeviceptr kernel_arg_30387 = mem_28435.mem;
                    CUdeviceptr kernel_arg_30388 =
                                eWiseAddMultEntryziid_counter_mem_29542.mem;
                    CUdeviceptr kernel_arg_30389 = status_flags_mem_29544.mem;
                    CUdeviceptr kernel_arg_30390 = aggregates_mem_29546.mem;
                    CUdeviceptr kernel_arg_30391 = incprefixes_mem_29548.mem;
                    unsigned int shared_offset_30377 = 0;
                    
                    if ((((((1 && sdiv_up64(conc_tmp_26655,
                                            segscan_group_sizze_27944 *
                                            (int64_t) 9) != 0) && 1 != 0) &&
                           1 != 0) && segscan_group_sizze_27944 != 0) && 1 !=
                         0) && 1 != 0) {
                        int perm[3] = {0, 1, 2};
                        
                        if (1 >= 1 << 16) {
                            perm[1] = perm[0];
                            perm[0] = 1;
                        }
                        if (1 >= 1 << 16) {
                            perm[2] = perm[0];
                            perm[0] = 2;
                        }
                        
                        size_t grid[3];
                        
                        grid[perm[0]] = sdiv_up64(conc_tmp_26655,
                                                  segscan_group_sizze_27944 *
                                                  (int64_t) 9);
                        grid[perm[1]] = 1;
                        grid[perm[2]] = 1;
                        
                        void *kernel_args_30373[] = {&ctx->global_failure,
                                                     &ctx->failure_is_an_option,
                                                     &ctx->global_failure_args,
                                                     &shared_offset_30377,
                                                     &conc_tmp_26655, &i_26671,
                                                     &kernel_arg_30378,
                                                     &kernel_arg_30379,
                                                     &kernel_arg_30380,
                                                     &kernel_arg_30381,
                                                     &kernel_arg_30382,
                                                     &kernel_arg_30383,
                                                     &kernel_arg_30384,
                                                     &kernel_arg_30385,
                                                     &kernel_arg_30386,
                                                     &kernel_arg_30387,
                                                     &kernel_arg_30388,
                                                     &kernel_arg_30389,
                                                     &kernel_arg_30390,
                                                     &kernel_arg_30391};
                        int64_t time_start_30374 = 0, time_end_30375 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(stderr, "Launching %s with grid size (",
                                    "eWiseAddMultEntry.segscan_27949");
                            fprintf(stderr, "%d", sdiv_up64(conc_tmp_26655,
                                                            segscan_group_sizze_27944 *
                                                            (int64_t) 9));
                            fprintf(stderr, ", ");
                            fprintf(stderr, "%d", 1);
                            fprintf(stderr, ", ");
                            fprintf(stderr, "%d", 1);
                            fprintf(stderr, ") and block size (");
                            fprintf(stderr, "%d", segscan_group_sizze_27944);
                            fprintf(stderr, ", ");
                            fprintf(stderr, "%d", 1);
                            fprintf(stderr, ", ");
                            fprintf(stderr, "%d", 1);
                            fprintf(stderr, ").\n");
                            time_start_30374 = get_wall_time();
                        }
                        
                        cudaEvent_t *pevents = NULL;
                        
                        if (ctx->profiling && !ctx->profiling_paused) {
                            pevents = cuda_get_events(&ctx->cuda,
                                                      &ctx->eWiseAddMultEntryzisegscan_27949_runs,
                                                      &ctx->eWiseAddMultEntryzisegscan_27949_total_runtime);
                            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
                        }
                        CUDA_SUCCEED(cuLaunchKernel(ctx->eWiseAddMultEntryzisegscan_27949,
                                                    grid[0], grid[1], grid[2],
                                                    segscan_group_sizze_27944,
                                                    1, 1, 0 +
                                                    (shared_sizze_30376 + (8 -
                                                                           shared_sizze_30376 %
                                                                           8) %
                                                     8), NULL,
                                                    kernel_args_30373, NULL));
                        if (pevents != NULL)
                            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
                        if (ctx->debugging) {
                            CUDA_SUCCEED(cuCtxSynchronize());
                            time_end_30375 = get_wall_time();
                            fprintf(stderr, "Kernel %s runtime: %ldus\n",
                                    "eWiseAddMultEntry.segscan_27949",
                                    time_end_30375 - time_start_30374);
                        }
                    }
                    ctx->failure_is_an_option = 1;
                    if (memblock_unref_device(ctx, &incprefixes_mem_29548,
                                              "incprefixes_mem_29548") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &aggregates_mem_29546,
                                              "aggregates_mem_29546") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &status_flags_mem_29544,
                                              "status_flags_mem_29544") != 0)
                        return 1;
                }
                if (memblock_unref_device(ctx, &mem_28416, "mem_28416") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28418, "mem_28418") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28420, "mem_28420") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28422, "mem_28422") != 0)
                    return 1;
                
                int64_t partition_sizze_26924;
                
                if (cond_26668) {
                    partition_sizze_26924 = (int64_t) 0;
                } else {
                    int64_t read_res_30392;
                    
                    {
                        cudaEvent_t *pevents = NULL;
                        
                        if (ctx->profiling && !ctx->profiling_paused) {
                            pevents = cuda_get_events(&ctx->cuda,
                                                      &ctx->copy_scalar_from_dev_runs,
                                                      &ctx->copy_scalar_from_dev_total_runtime);
                            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
                        }
                        CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30392,
                                                  mem_28425.mem + i_26671 *
                                                  sizeof(int64_t),
                                                  sizeof(int64_t)));
                        if (pevents != NULL)
                            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
                    }
                    if (futhark_context_sync(ctx) != 0)
                        return 1;
                    
                    int64_t last_offset_26925 = read_res_30392;
                    
                    partition_sizze_26924 = last_offset_26925;
                }
                
                struct memblock_device mem_28437;
                
                mem_28437.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28437, bytes_28366,
                                          "mem_28437")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28439;
                
                mem_28439.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28439, bytes_28366,
                                          "mem_28439")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28441;
                
                mem_28441.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28441, bytes_28366,
                                          "mem_28441")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28443;
                
                mem_28443.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28443, bytes_28366,
                                          "mem_28443")) {
                    err = 1;
                    goto cleanup;
                }
                
                int64_t segmap_group_sizze_27954;
                
                segmap_group_sizze_27954 =
                    ctx->sizes.eWiseAddMultEntryzisegmap_group_sizze_27953;
                
                int64_t segmap_usable_groups_27955 = sdiv_up64(conc_tmp_26655,
                                                               segmap_group_sizze_27954);
                
                if (ctx->debugging)
                    fprintf(stderr, "%s\n", "\n# SegMap");
                
                CUdeviceptr kernel_arg_30396 = mem_28425.mem;
                CUdeviceptr kernel_arg_30397 = mem_28427.mem;
                CUdeviceptr kernel_arg_30398 = mem_28429.mem;
                CUdeviceptr kernel_arg_30399 = mem_28431.mem;
                CUdeviceptr kernel_arg_30400 = mem_28433.mem;
                CUdeviceptr kernel_arg_30401 = mem_28435.mem;
                CUdeviceptr kernel_arg_30402 = mem_28437.mem;
                CUdeviceptr kernel_arg_30403 = mem_28439.mem;
                CUdeviceptr kernel_arg_30404 = mem_28441.mem;
                CUdeviceptr kernel_arg_30405 = mem_28443.mem;
                
                if ((((((1 && segmap_usable_groups_27955 != 0) && 1 != 0) &&
                       1 != 0) && segmap_group_sizze_27954 != 0) && 1 != 0) &&
                    1 != 0) {
                    int perm[3] = {0, 1, 2};
                    
                    if (1 >= 1 << 16) {
                        perm[1] = perm[0];
                        perm[0] = 1;
                    }
                    if (1 >= 1 << 16) {
                        perm[2] = perm[0];
                        perm[0] = 2;
                    }
                    
                    size_t grid[3];
                    
                    grid[perm[0]] = segmap_usable_groups_27955;
                    grid[perm[1]] = 1;
                    grid[perm[2]] = 1;
                    
                    void *kernel_args_30393[] = {&ctx->global_failure,
                                                 &conc_tmp_26655,
                                                 &kernel_arg_30396,
                                                 &kernel_arg_30397,
                                                 &kernel_arg_30398,
                                                 &kernel_arg_30399,
                                                 &kernel_arg_30400,
                                                 &kernel_arg_30401,
                                                 &kernel_arg_30402,
                                                 &kernel_arg_30403,
                                                 &kernel_arg_30404,
                                                 &kernel_arg_30405};
                    int64_t time_start_30394 = 0, time_end_30395 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(stderr, "Launching %s with grid size (",
                                "eWiseAddMultEntry.segmap_27951");
                        fprintf(stderr, "%d", segmap_usable_groups_27955);
                        fprintf(stderr, ", ");
                        fprintf(stderr, "%d", 1);
                        fprintf(stderr, ", ");
                        fprintf(stderr, "%d", 1);
                        fprintf(stderr, ") and block size (");
                        fprintf(stderr, "%d", segmap_group_sizze_27954);
                        fprintf(stderr, ", ");
                        fprintf(stderr, "%d", 1);
                        fprintf(stderr, ", ");
                        fprintf(stderr, "%d", 1);
                        fprintf(stderr, ").\n");
                        time_start_30394 = get_wall_time();
                    }
                    
                    cudaEvent_t *pevents = NULL;
                    
                    if (ctx->profiling && !ctx->profiling_paused) {
                        pevents = cuda_get_events(&ctx->cuda,
                                                  &ctx->eWiseAddMultEntryzisegmap_27951_runs,
                                                  &ctx->eWiseAddMultEntryzisegmap_27951_total_runtime);
                        CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
                    }
                    CUDA_SUCCEED(cuLaunchKernel(ctx->eWiseAddMultEntryzisegmap_27951,
                                                grid[0], grid[1], grid[2],
                                                segmap_group_sizze_27954, 1, 1,
                                                0, NULL, kernel_args_30393,
                                                NULL));
                    if (pevents != NULL)
                        CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
                    if (ctx->debugging) {
                        CUDA_SUCCEED(cuCtxSynchronize());
                        time_end_30395 = get_wall_time();
                        fprintf(stderr, "Kernel %s runtime: %ldus\n",
                                "eWiseAddMultEntry.segmap_27951",
                                time_end_30395 - time_start_30394);
                    }
                }
                if (memblock_unref_device(ctx, &mem_28425, "mem_28425") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28427, "mem_28427") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28429, "mem_28429") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28431, "mem_28431") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28433, "mem_28433") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28435, "mem_28435") != 0)
                    return 1;
                
                bool empty_slice_26943 = partition_sizze_26924 == (int64_t) 0;
                int64_t m_26944 = sub64(partition_sizze_26924, (int64_t) 1);
                bool zzero_leq_i_p_m_t_s_26945 = sle64((int64_t) 0, m_26944);
                bool i_p_m_t_s_leq_w_26946 = slt64(m_26944, conc_tmp_26655);
                bool i_lte_j_26947 = sle64((int64_t) 0, partition_sizze_26924);
                bool y_26948 = zzero_leq_i_p_m_t_s_26945 &&
                     i_p_m_t_s_leq_w_26946;
                bool y_26949 = i_lte_j_26947 && y_26948;
                bool ok_or_empty_26950 = empty_slice_26943 || y_26949;
                bool index_certs_26951;
                
                if (!ok_or_empty_26950) {
                    ctx->error =
                        msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                  "Index [:", partition_sizze_26924,
                                  "] out of bounds for array of shape [",
                                  conc_tmp_26655, "].",
                                  "-> #0  /prelude/soacs.fut:141:6-16\n   #1  sparse.fut:58:3-68:56\n   #2  sparse.fut:138:59-140:81\n   #3  sparse.fut:243:20-62\n   #4  sparse.fut:234:1-247:60\n");
                    if (memblock_unref_device(ctx, &mem_28443, "mem_28443") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28441, "mem_28441") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28439, "mem_28439") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28437, "mem_28437") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28435, "mem_28435") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28433, "mem_28433") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28431, "mem_28431") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28429, "mem_28429") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28427, "mem_28427") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28425, "mem_28425") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28422, "mem_28422") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28420, "mem_28420") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28418, "mem_28418") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28416, "mem_28416") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_param_28379,
                                              "mem_param_28379") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_param_28374,
                                              "mem_param_28374") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &defunc_0_f_res_mem_28413,
                                              "defunc_0_f_res_mem_28413") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &defunc_0_f_res_mem_28408,
                                              "defunc_0_f_res_mem_28408") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28394, "mem_28394") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28392, "mem_28392") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28390, "mem_28390") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28388, "mem_28388") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28386, "mem_28386") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &unionArrays_res_f_res_mem_28457,
                                              "unionArrays_res_f_res_mem_28457") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &unionArrays_res_f_res_mem_28454,
                                              "unionArrays_res_f_res_mem_28454") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &unionArrays_res_f_res_mem_28451,
                                              "unionArrays_res_f_res_mem_28451") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &unionArrays_res_f_res_mem_28448,
                                              "unionArrays_res_f_res_mem_28448") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28369, "mem_28369") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28367, "mem_28367") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28365, "mem_28365") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28363, "mem_28363") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &unionArrays_res_mem_28470,
                                              "unionArrays_res_mem_28470") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &unionArrays_res_mem_28467,
                                              "unionArrays_res_mem_28467") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &unionArrays_res_mem_28464,
                                              "unionArrays_res_mem_28464") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &unionArrays_res_mem_28461,
                                              "unionArrays_res_mem_28461") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28361, "mem_28361") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28359, "mem_28359") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28357, "mem_28357") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28341, "mem_28341") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28339, "mem_28339") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                              "double_buffer_mem_28763") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28256, "mem_28256") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28239, "mem_28239") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28248, "mem_28248") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28250, "mem_28250") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28252, "mem_28252") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28254, "mem_28254") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28318, "mem_28318") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                              "group_res_arr_mem_29131") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                              "group_res_arr_mem_29129") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                              "group_res_arr_mem_29127") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_29026, "mem_29026") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_29024, "mem_29024") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_29022, "mem_29022") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28337, "mem_28337") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &out_mem_29123,
                                              "out_mem_29123") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &out_mem_29121,
                                              "out_mem_29121") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &out_mem_29119,
                                              "out_mem_29119") != 0)
                        return 1;
                    return 1;
                }
                sizze_26677 = partition_sizze_26924;
                sizze_26678 = partition_sizze_26924;
                sizze_26679 = partition_sizze_26924;
                sizze_26680 = partition_sizze_26924;
                unionArrays_res_f_res_ixfn_28445 = partition_sizze_26924;
                unionArrays_res_f_res_ixfn_28449 = partition_sizze_26924;
                unionArrays_res_f_res_ixfn_28452 = partition_sizze_26924;
                unionArrays_res_f_res_ixfn_28455 = partition_sizze_26924;
                if (memblock_set_device(ctx, &unionArrays_res_f_res_mem_28448,
                                        &mem_28437, "mem_28437") != 0)
                    return 1;
                if (memblock_set_device(ctx, &unionArrays_res_f_res_mem_28451,
                                        &mem_28439, "mem_28439") != 0)
                    return 1;
                if (memblock_set_device(ctx, &unionArrays_res_f_res_mem_28454,
                                        &mem_28441, "mem_28441") != 0)
                    return 1;
                if (memblock_set_device(ctx, &unionArrays_res_f_res_mem_28457,
                                        &mem_28443, "mem_28443") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28443, "mem_28443") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28441, "mem_28441") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28439, "mem_28439") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28437, "mem_28437") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28435, "mem_28435") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28433, "mem_28433") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28431, "mem_28431") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28429, "mem_28429") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28427, "mem_28427") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28425, "mem_28425") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28422, "mem_28422") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28420, "mem_28420") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28418, "mem_28418") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28416, "mem_28416") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_28379,
                                          "mem_param_28379") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_28374,
                                          "mem_param_28374") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &defunc_0_f_res_mem_28413,
                                          "defunc_0_f_res_mem_28413") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &defunc_0_f_res_mem_28408,
                                          "defunc_0_f_res_mem_28408") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28394, "mem_28394") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28392, "mem_28392") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28390, "mem_28390") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28388, "mem_28388") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28386, "mem_28386") != 0)
                    return 1;
            }
            if (memblock_unref_device(ctx, &mem_28363, "mem_28363") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28365, "mem_28365") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28367, "mem_28367") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28369, "mem_28369") != 0)
                return 1;
            sizze_26656 = sizze_26677;
            sizze_26657 = sizze_26678;
            sizze_26658 = sizze_26679;
            sizze_26659 = sizze_26680;
            unionArrays_res_ixfn_28458 = unionArrays_res_f_res_ixfn_28445;
            unionArrays_res_ixfn_28459 = unionArrays_res_f_res_ixfn_28446;
            unionArrays_res_ixfn_28460 = unionArrays_res_f_res_ixfn_28447;
            unionArrays_res_ixfn_28462 = unionArrays_res_f_res_ixfn_28449;
            unionArrays_res_ixfn_28463 = unionArrays_res_f_res_ixfn_28450;
            unionArrays_res_ixfn_28465 = unionArrays_res_f_res_ixfn_28452;
            unionArrays_res_ixfn_28466 = unionArrays_res_f_res_ixfn_28450;
            unionArrays_res_ixfn_28468 = unionArrays_res_f_res_ixfn_28455;
            unionArrays_res_ixfn_28469 = unionArrays_res_f_res_ixfn_28450;
            if (memblock_set_device(ctx, &unionArrays_res_mem_28461,
                                    &unionArrays_res_f_res_mem_28448,
                                    "unionArrays_res_f_res_mem_28448") != 0)
                return 1;
            if (memblock_set_device(ctx, &unionArrays_res_mem_28464,
                                    &unionArrays_res_f_res_mem_28451,
                                    "unionArrays_res_f_res_mem_28451") != 0)
                return 1;
            if (memblock_set_device(ctx, &unionArrays_res_mem_28467,
                                    &unionArrays_res_f_res_mem_28454,
                                    "unionArrays_res_f_res_mem_28454") != 0)
                return 1;
            if (memblock_set_device(ctx, &unionArrays_res_mem_28470,
                                    &unionArrays_res_f_res_mem_28457,
                                    "unionArrays_res_f_res_mem_28457") != 0)
                return 1;
            if (memblock_unref_device(ctx, &unionArrays_res_f_res_mem_28457,
                                      "unionArrays_res_f_res_mem_28457") != 0)
                return 1;
            if (memblock_unref_device(ctx, &unionArrays_res_f_res_mem_28454,
                                      "unionArrays_res_f_res_mem_28454") != 0)
                return 1;
            if (memblock_unref_device(ctx, &unionArrays_res_f_res_mem_28451,
                                      "unionArrays_res_f_res_mem_28451") != 0)
                return 1;
            if (memblock_unref_device(ctx, &unionArrays_res_f_res_mem_28448,
                                      "unionArrays_res_f_res_mem_28448") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28369, "mem_28369") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28367, "mem_28367") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28365, "mem_28365") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28363, "mem_28363") != 0)
                return 1;
        }
        if (memblock_unref_device(ctx, &mem_28357, "mem_28357") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28359, "mem_28359") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28361, "mem_28361") != 0)
            return 1;
        
        bool dim_match_26956 = sizze_26656 == sizze_26657;
        bool empty_or_match_cert_26957;
        
        if (!dim_match_26956) {
            ctx->error = msgprintf("Error: %s\n\nBacktrace:\n%s",
                                   "Function return value does not match shape of declared return type.",
                                   "-> #0  sparse.fut:45:7-68:56\n   #1  sparse.fut:138:59-140:81\n   #2  sparse.fut:243:20-62\n   #3  sparse.fut:234:1-247:60\n");
            if (memblock_unref_device(ctx, &unionArrays_res_mem_28470,
                                      "unionArrays_res_mem_28470") != 0)
                return 1;
            if (memblock_unref_device(ctx, &unionArrays_res_mem_28467,
                                      "unionArrays_res_mem_28467") != 0)
                return 1;
            if (memblock_unref_device(ctx, &unionArrays_res_mem_28464,
                                      "unionArrays_res_mem_28464") != 0)
                return 1;
            if (memblock_unref_device(ctx, &unionArrays_res_mem_28461,
                                      "unionArrays_res_mem_28461") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28361, "mem_28361") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28359, "mem_28359") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28357, "mem_28357") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28341, "mem_28341") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28339, "mem_28339") != 0)
                return 1;
            if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                      "double_buffer_mem_28763") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28256, "mem_28256") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28248, "mem_28248") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28250, "mem_28250") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28254, "mem_28254") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28318, "mem_28318") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                      "group_res_arr_mem_29131") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                      "group_res_arr_mem_29129") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                      "group_res_arr_mem_29127") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29026, "mem_29026") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29024, "mem_29024") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29022, "mem_29022") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28337, "mem_28337") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29123, "out_mem_29123") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29121, "out_mem_29121") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29119, "out_mem_29119") !=
                0)
                return 1;
            return 1;
        }
        
        bool dim_match_26958 = sizze_26656 == sizze_26658;
        bool empty_or_match_cert_26959;
        
        if (!dim_match_26958) {
            ctx->error = msgprintf("Error: %s\n\nBacktrace:\n%s",
                                   "Function return value does not match shape of declared return type.",
                                   "-> #0  sparse.fut:45:7-68:56\n   #1  sparse.fut:138:59-140:81\n   #2  sparse.fut:243:20-62\n   #3  sparse.fut:234:1-247:60\n");
            if (memblock_unref_device(ctx, &unionArrays_res_mem_28470,
                                      "unionArrays_res_mem_28470") != 0)
                return 1;
            if (memblock_unref_device(ctx, &unionArrays_res_mem_28467,
                                      "unionArrays_res_mem_28467") != 0)
                return 1;
            if (memblock_unref_device(ctx, &unionArrays_res_mem_28464,
                                      "unionArrays_res_mem_28464") != 0)
                return 1;
            if (memblock_unref_device(ctx, &unionArrays_res_mem_28461,
                                      "unionArrays_res_mem_28461") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28361, "mem_28361") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28359, "mem_28359") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28357, "mem_28357") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28341, "mem_28341") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28339, "mem_28339") != 0)
                return 1;
            if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                      "double_buffer_mem_28763") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28256, "mem_28256") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28248, "mem_28248") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28250, "mem_28250") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28254, "mem_28254") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28318, "mem_28318") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                      "group_res_arr_mem_29131") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                      "group_res_arr_mem_29129") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                      "group_res_arr_mem_29127") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29026, "mem_29026") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29024, "mem_29024") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29022, "mem_29022") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28337, "mem_28337") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29123, "out_mem_29123") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29121, "out_mem_29121") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29119, "out_mem_29119") !=
                0)
                return 1;
            return 1;
        }
        
        bool dim_match_26960 = sizze_26656 == sizze_26659;
        bool empty_or_match_cert_26961;
        
        if (!dim_match_26960) {
            ctx->error = msgprintf("Error: %s\n\nBacktrace:\n%s",
                                   "Function return value does not match shape of declared return type.",
                                   "-> #0  sparse.fut:45:7-68:56\n   #1  sparse.fut:138:59-140:81\n   #2  sparse.fut:243:20-62\n   #3  sparse.fut:234:1-247:60\n");
            if (memblock_unref_device(ctx, &unionArrays_res_mem_28470,
                                      "unionArrays_res_mem_28470") != 0)
                return 1;
            if (memblock_unref_device(ctx, &unionArrays_res_mem_28467,
                                      "unionArrays_res_mem_28467") != 0)
                return 1;
            if (memblock_unref_device(ctx, &unionArrays_res_mem_28464,
                                      "unionArrays_res_mem_28464") != 0)
                return 1;
            if (memblock_unref_device(ctx, &unionArrays_res_mem_28461,
                                      "unionArrays_res_mem_28461") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28361, "mem_28361") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28359, "mem_28359") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28357, "mem_28357") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28341, "mem_28341") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28339, "mem_28339") != 0)
                return 1;
            if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                      "double_buffer_mem_28763") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28256, "mem_28256") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28248, "mem_28248") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28250, "mem_28250") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28254, "mem_28254") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28318, "mem_28318") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                      "group_res_arr_mem_29131") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                      "group_res_arr_mem_29129") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                      "group_res_arr_mem_29127") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29026, "mem_29026") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29024, "mem_29024") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29022, "mem_29022") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28337, "mem_28337") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29123, "out_mem_29123") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29121, "out_mem_29121") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29119, "out_mem_29119") !=
                0)
                return 1;
            return 1;
        }
        
        int64_t read_res_30406;
        
        {
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->copy_scalar_from_dev_runs,
                                          &ctx->copy_scalar_from_dev_total_runtime);
                CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30406, mem_28337.mem + i_26614 *
                                      sizeof(int64_t), sizeof(int64_t)));
            if (pevents != NULL)
                CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
        }
        if (futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t x_26962 = read_res_30406;
        int64_t read_res_30407;
        
        {
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->copy_scalar_from_dev_runs,
                                          &ctx->copy_scalar_from_dev_total_runtime);
                CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30407, mem_28337.mem + i_26608 *
                                      sizeof(int64_t), sizeof(int64_t)));
            if (pevents != NULL)
                CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
        }
        if (futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t y_26963 = read_res_30407;
        int64_t indxs_26964 = sub64(x_26962, y_26963);
        bool bounds_invalid_upwards_26965 = slt64(x_26962, y_26963);
        bool valid_26966 = !bounds_invalid_upwards_26965;
        bool range_valid_c_26967;
        
        if (!valid_26966) {
            ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                   "Range ", y_26963, "..<", x_26962,
                                   " is invalid.",
                                   "-> #0  sparse.fut:142:18-42\n   #1  sparse.fut:243:20-62\n   #2  sparse.fut:234:1-247:60\n");
            if (memblock_unref_device(ctx, &unionArrays_res_mem_28470,
                                      "unionArrays_res_mem_28470") != 0)
                return 1;
            if (memblock_unref_device(ctx, &unionArrays_res_mem_28467,
                                      "unionArrays_res_mem_28467") != 0)
                return 1;
            if (memblock_unref_device(ctx, &unionArrays_res_mem_28464,
                                      "unionArrays_res_mem_28464") != 0)
                return 1;
            if (memblock_unref_device(ctx, &unionArrays_res_mem_28461,
                                      "unionArrays_res_mem_28461") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28361, "mem_28361") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28359, "mem_28359") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28357, "mem_28357") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28341, "mem_28341") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28339, "mem_28339") != 0)
                return 1;
            if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                      "double_buffer_mem_28763") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28256, "mem_28256") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28248, "mem_28248") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28250, "mem_28250") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28254, "mem_28254") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28318, "mem_28318") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                      "group_res_arr_mem_29131") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                      "group_res_arr_mem_29129") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                      "group_res_arr_mem_29127") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29026, "mem_29026") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29024, "mem_29024") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29022, "mem_29022") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28337, "mem_28337") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29123, "out_mem_29123") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29121, "out_mem_29121") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29119, "out_mem_29119") !=
                0)
                return 1;
            return 1;
        }
        
        bool dim_match_26969 = indxs_26964 == sizze_26656;
        bool empty_or_match_cert_26970;
        
        if (!dim_match_26969) {
            ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                   "Value of (core language) shape (",
                                   sizze_26656,
                                   ") cannot match shape of type `[",
                                   indxs_26964, "]index`.",
                                   "-> #0  sparse.fut:146:26-51\n   #1  sparse.fut:243:20-62\n   #2  sparse.fut:234:1-247:60\n");
            if (memblock_unref_device(ctx, &unionArrays_res_mem_28470,
                                      "unionArrays_res_mem_28470") != 0)
                return 1;
            if (memblock_unref_device(ctx, &unionArrays_res_mem_28467,
                                      "unionArrays_res_mem_28467") != 0)
                return 1;
            if (memblock_unref_device(ctx, &unionArrays_res_mem_28464,
                                      "unionArrays_res_mem_28464") != 0)
                return 1;
            if (memblock_unref_device(ctx, &unionArrays_res_mem_28461,
                                      "unionArrays_res_mem_28461") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28361, "mem_28361") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28359, "mem_28359") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28357, "mem_28357") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28341, "mem_28341") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28339, "mem_28339") != 0)
                return 1;
            if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                      "double_buffer_mem_28763") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28256, "mem_28256") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28248, "mem_28248") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28250, "mem_28250") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28254, "mem_28254") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28318, "mem_28318") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                      "group_res_arr_mem_29131") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                      "group_res_arr_mem_29129") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                      "group_res_arr_mem_29127") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29026, "mem_29026") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29024, "mem_29024") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29022, "mem_29022") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28337, "mem_28337") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29123, "out_mem_29123") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29121, "out_mem_29121") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29119, "out_mem_29119") !=
                0)
                return 1;
            return 1;
        }
        
        bool empty_or_match_cert_26971;
        
        if (!dim_match_26969) {
            ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                   "Value of (core language) shape (",
                                   sizze_26656,
                                   ") cannot match shape of type `[",
                                   indxs_26964, "]t`.",
                                   "-> #0  sparse.fut:147:25-154:75\n   #1  sparse.fut:243:20-62\n   #2  sparse.fut:234:1-247:60\n");
            if (memblock_unref_device(ctx, &unionArrays_res_mem_28470,
                                      "unionArrays_res_mem_28470") != 0)
                return 1;
            if (memblock_unref_device(ctx, &unionArrays_res_mem_28467,
                                      "unionArrays_res_mem_28467") != 0)
                return 1;
            if (memblock_unref_device(ctx, &unionArrays_res_mem_28464,
                                      "unionArrays_res_mem_28464") != 0)
                return 1;
            if (memblock_unref_device(ctx, &unionArrays_res_mem_28461,
                                      "unionArrays_res_mem_28461") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28361, "mem_28361") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28359, "mem_28359") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28357, "mem_28357") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28341, "mem_28341") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28339, "mem_28339") != 0)
                return 1;
            if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                      "double_buffer_mem_28763") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28256, "mem_28256") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28248, "mem_28248") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28250, "mem_28250") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28254, "mem_28254") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28318, "mem_28318") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                      "group_res_arr_mem_29131") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                      "group_res_arr_mem_29129") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                      "group_res_arr_mem_29127") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29026, "mem_29026") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29024, "mem_29024") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29022, "mem_29022") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28337, "mem_28337") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29123, "out_mem_29123") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29121, "out_mem_29121") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29119, "out_mem_29119") !=
                0)
                return 1;
            return 1;
        }
        
        int64_t segmap_usable_groups_27961 = sdiv_up64(indxs_26964,
                                                       segmap_group_sizze_27960);
        
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegMap");
        
        CUdeviceptr kernel_arg_30411 = leftValues_mem_28231.mem;
        CUdeviceptr kernel_arg_30412 = rightValues_mem_28234.mem;
        CUdeviceptr kernel_arg_30413 = mem_28339.mem;
        CUdeviceptr kernel_arg_30414 = mem_28341.mem;
        CUdeviceptr kernel_arg_30415 = unionArrays_res_mem_28461.mem;
        CUdeviceptr kernel_arg_30416 = unionArrays_res_mem_28464.mem;
        CUdeviceptr kernel_arg_30417 = unionArrays_res_mem_28467.mem;
        CUdeviceptr kernel_arg_30418 = unionArrays_res_mem_28470.mem;
        
        if ((((((1 && segmap_usable_groups_27961 != 0) && 1 != 0) && 1 != 0) &&
              segmap_group_sizze_27960 != 0) && 1 != 0) && 1 != 0) {
            int perm[3] = {0, 1, 2};
            
            if (1 >= 1 << 16) {
                perm[1] = perm[0];
                perm[0] = 1;
            }
            if (1 >= 1 << 16) {
                perm[2] = perm[0];
                perm[0] = 2;
            }
            
            size_t grid[3];
            
            grid[perm[0]] = segmap_usable_groups_27961;
            grid[perm[1]] = 1;
            grid[perm[2]] = 1;
            
            void *kernel_args_30408[] = {&ctx->global_failure,
                                         &ctx->failure_is_an_option,
                                         &ctx->global_failure_args, &n_26407,
                                         &k_26409, &eWiseAddOffsets_res_26600,
                                         &i_26613, &i_26635, &sizze_26656,
                                         &y_26963, &indxs_26964,
                                         &unionArrays_res_ixfn_28460,
                                         &kernel_arg_30411, &kernel_arg_30412,
                                         &kernel_arg_30413, &kernel_arg_30414,
                                         &kernel_arg_30415, &kernel_arg_30416,
                                         &kernel_arg_30417, &kernel_arg_30418};
            int64_t time_start_30409 = 0, time_end_30410 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with grid size (",
                        "eWiseAddMultEntry.segmap_27957");
                fprintf(stderr, "%d", segmap_usable_groups_27961);
                fprintf(stderr, ", ");
                fprintf(stderr, "%d", 1);
                fprintf(stderr, ", ");
                fprintf(stderr, "%d", 1);
                fprintf(stderr, ") and block size (");
                fprintf(stderr, "%d", segmap_group_sizze_27960);
                fprintf(stderr, ", ");
                fprintf(stderr, "%d", 1);
                fprintf(stderr, ", ");
                fprintf(stderr, "%d", 1);
                fprintf(stderr, ").\n");
                time_start_30409 = get_wall_time();
            }
            
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->eWiseAddMultEntryzisegmap_27957_runs,
                                          &ctx->eWiseAddMultEntryzisegmap_27957_total_runtime);
                CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED(cuLaunchKernel(ctx->eWiseAddMultEntryzisegmap_27957,
                                        grid[0], grid[1], grid[2],
                                        segmap_group_sizze_27960, 1, 1, 0, NULL,
                                        kernel_args_30408, NULL));
            if (pevents != NULL)
                CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
            if (ctx->debugging) {
                CUDA_SUCCEED(cuCtxSynchronize());
                time_end_30410 = get_wall_time();
                fprintf(stderr, "Kernel %s runtime: %ldus\n",
                        "eWiseAddMultEntry.segmap_27957", time_end_30410 -
                        time_start_30409);
            }
        }
        ctx->failure_is_an_option = 1;
        if (memblock_unref_device(ctx, &unionArrays_res_mem_28461,
                                  "unionArrays_res_mem_28461") != 0)
            return 1;
        if (memblock_unref_device(ctx, &unionArrays_res_mem_28464,
                                  "unionArrays_res_mem_28464") != 0)
            return 1;
        if (memblock_unref_device(ctx, &unionArrays_res_mem_28467,
                                  "unionArrays_res_mem_28467") != 0)
            return 1;
        if (memblock_unref_device(ctx, &unionArrays_res_mem_28470,
                                  "unionArrays_res_mem_28470") != 0)
            return 1;
        if (memblock_unref_device(ctx, &unionArrays_res_mem_28470,
                                  "unionArrays_res_mem_28470") != 0)
            return 1;
        if (memblock_unref_device(ctx, &unionArrays_res_mem_28467,
                                  "unionArrays_res_mem_28467") != 0)
            return 1;
        if (memblock_unref_device(ctx, &unionArrays_res_mem_28464,
                                  "unionArrays_res_mem_28464") != 0)
            return 1;
        if (memblock_unref_device(ctx, &unionArrays_res_mem_28461,
                                  "unionArrays_res_mem_28461") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28361, "mem_28361") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28359, "mem_28359") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28357, "mem_28357") != 0)
            return 1;
    }
    
    int64_t segscan_group_sizze_27964;
    
    segscan_group_sizze_27964 =
        ctx->sizes.eWiseAddMultEntryzisegscan_group_sizze_27963;
    
    int64_t num_groups_27966;
    int32_t max_num_groups_29631;
    
    max_num_groups_29631 =
        ctx->sizes.eWiseAddMultEntryzisegscan_num_groups_27965;
    num_groups_27966 = sext_i64_i32(smax64((int64_t) 1,
                                           smin64(sdiv_up64(m_26408,
                                                            segscan_group_sizze_27964),
                                                  sext_i32_i64(max_num_groups_29631))));
    
    struct memblock_device mem_28582;
    
    mem_28582.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28582, bytes_28336, "mem_28582")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t num_threads_29036 = segscan_group_sizze_27964 * num_groups_27966;
    int64_t segred_num_groups_29056;
    
    segred_num_groups_29056 =
        ctx->sizes.eWiseAddMultEntryzisegred_num_groups_29055;
    
    int64_t segred_group_sizze_29058;
    
    segred_group_sizze_29058 =
        ctx->sizes.eWiseAddMultEntryzisegred_group_sizze_29057;
    
    struct memblock_device mem_29105;
    
    mem_29105.references = NULL;
    if (memblock_alloc_device(ctx, &mem_29105, (int64_t) 8, "mem_29105")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_29107;
    
    mem_29107.references = NULL;
    if (memblock_alloc_device(ctx, &mem_29107, (int64_t) 8, "mem_29107")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_29109;
    
    mem_29109.references = NULL;
    if (memblock_alloc_device(ctx, &mem_29109, (int64_t) 8, "mem_29109")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device eWiseAddMultEntryzicounter_mem_29632 =
                           ctx->eWiseAddMultEntryzicounter_mem_29632;
    struct memblock_device group_res_arr_mem_29634;
    
    group_res_arr_mem_29634.references = NULL;
    if (memblock_alloc_device(ctx, &group_res_arr_mem_29634,
                              (int64_t) sizeof(int64_t) *
                              (segred_group_sizze_29058 *
                               segred_num_groups_29056),
                              "group_res_arr_mem_29634")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device group_res_arr_mem_29636;
    
    group_res_arr_mem_29636.references = NULL;
    if (memblock_alloc_device(ctx, &group_res_arr_mem_29636,
                              (int64_t) sizeof(int64_t) *
                              (segred_group_sizze_29058 *
                               segred_num_groups_29056),
                              "group_res_arr_mem_29636")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device group_res_arr_mem_29638;
    
    group_res_arr_mem_29638.references = NULL;
    if (memblock_alloc_device(ctx, &group_res_arr_mem_29638,
                              (int64_t) sizeof(int64_t) *
                              (segred_group_sizze_29058 *
                               segred_num_groups_29056),
                              "group_res_arr_mem_29638")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t num_threads_29640;
    
    num_threads_29640 = segred_num_groups_29056 * segred_group_sizze_29058;
    if (ctx->debugging)
        fprintf(stderr, "%s\n", "\n# SegRed");
    
    unsigned int shared_sizze_30423 = (int64_t) sizeof(int64_t) *
                 segred_group_sizze_29058;
    unsigned int shared_sizze_30425 = (int64_t) sizeof(int64_t) *
                 segred_group_sizze_29058;
    unsigned int shared_sizze_30427 = (int64_t) sizeof(int64_t) *
                 segred_group_sizze_29058;
    unsigned int shared_sizze_30429 = (int64_t) sizeof(bool);
    CUdeviceptr kernel_arg_30431 = rightOffsets_mem_28236.mem;
    CUdeviceptr kernel_arg_30432 = mem_28337.mem;
    CUdeviceptr kernel_arg_30433 = mem_29105.mem;
    CUdeviceptr kernel_arg_30434 = mem_29107.mem;
    CUdeviceptr kernel_arg_30435 = mem_29109.mem;
    CUdeviceptr kernel_arg_30436 = eWiseAddMultEntryzicounter_mem_29632.mem;
    CUdeviceptr kernel_arg_30437 = group_res_arr_mem_29634.mem;
    CUdeviceptr kernel_arg_30438 = group_res_arr_mem_29636.mem;
    CUdeviceptr kernel_arg_30439 = group_res_arr_mem_29638.mem;
    unsigned int shared_offset_30424 = 0;
    unsigned int shared_offset_30426 = 0 + (shared_sizze_30423 + (8 -
                                                                  shared_sizze_30423 %
                                                                  8) % 8);
    unsigned int shared_offset_30428 = 0 + (shared_sizze_30423 + (8 -
                                                                  shared_sizze_30423 %
                                                                  8) % 8) +
                 (shared_sizze_30425 + (8 - shared_sizze_30425 % 8) % 8);
    unsigned int shared_offset_30430 = 0 + (shared_sizze_30423 + (8 -
                                                                  shared_sizze_30423 %
                                                                  8) % 8) +
                 (shared_sizze_30425 + (8 - shared_sizze_30425 % 8) % 8) +
                 (shared_sizze_30427 + (8 - shared_sizze_30427 % 8) % 8);
    
    if ((((((1 && segred_num_groups_29056 != 0) && 1 != 0) && 1 != 0) &&
          segred_group_sizze_29058 != 0) && 1 != 0) && 1 != 0) {
        int perm[3] = {0, 1, 2};
        
        if (1 >= 1 << 16) {
            perm[1] = perm[0];
            perm[0] = 1;
        }
        if (1 >= 1 << 16) {
            perm[2] = perm[0];
            perm[0] = 2;
        }
        
        size_t grid[3];
        
        grid[perm[0]] = segred_num_groups_29056;
        grid[perm[1]] = 1;
        grid[perm[2]] = 1;
        
        void *kernel_args_30420[] = {&ctx->global_failure,
                                     &ctx->failure_is_an_option,
                                     &ctx->global_failure_args,
                                     &shared_offset_30424, &shared_offset_30426,
                                     &shared_offset_30428, &shared_offset_30430,
                                     &m_26408, &num_threads_29640,
                                     &kernel_arg_30431, &kernel_arg_30432,
                                     &kernel_arg_30433, &kernel_arg_30434,
                                     &kernel_arg_30435, &kernel_arg_30436,
                                     &kernel_arg_30437, &kernel_arg_30438,
                                     &kernel_arg_30439};
        int64_t time_start_30421 = 0, time_end_30422 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with grid size (",
                    "eWiseAddMultEntry.segred_nonseg_29064");
            fprintf(stderr, "%d", segred_num_groups_29056);
            fprintf(stderr, ", ");
            fprintf(stderr, "%d", 1);
            fprintf(stderr, ", ");
            fprintf(stderr, "%d", 1);
            fprintf(stderr, ") and block size (");
            fprintf(stderr, "%d", segred_group_sizze_29058);
            fprintf(stderr, ", ");
            fprintf(stderr, "%d", 1);
            fprintf(stderr, ", ");
            fprintf(stderr, "%d", 1);
            fprintf(stderr, ").\n");
            time_start_30421 = get_wall_time();
        }
        
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->eWiseAddMultEntryzisegred_nonseg_29064_runs,
                                      &ctx->eWiseAddMultEntryzisegred_nonseg_29064_total_runtime);
            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED(cuLaunchKernel(ctx->eWiseAddMultEntryzisegred_nonseg_29064,
                                    grid[0], grid[1], grid[2],
                                    segred_group_sizze_29058, 1, 1, 0 +
                                    (shared_sizze_30423 + (8 -
                                                           shared_sizze_30423 %
                                                           8) % 8) +
                                    (shared_sizze_30425 + (8 -
                                                           shared_sizze_30425 %
                                                           8) % 8) +
                                    (shared_sizze_30427 + (8 -
                                                           shared_sizze_30427 %
                                                           8) % 8) +
                                    (shared_sizze_30429 + (8 -
                                                           shared_sizze_30429 %
                                                           8) % 8), NULL,
                                    kernel_args_30420, NULL));
        if (pevents != NULL)
            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
        if (ctx->debugging) {
            CUDA_SUCCEED(cuCtxSynchronize());
            time_end_30422 = get_wall_time();
            fprintf(stderr, "Kernel %s runtime: %ldus\n",
                    "eWiseAddMultEntry.segred_nonseg_29064", time_end_30422 -
                    time_start_30421);
        }
    }
    ctx->failure_is_an_option = 1;
    
    int64_t read_res_30440;
    
    {
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->copy_scalar_from_dev_runs,
                                      &ctx->copy_scalar_from_dev_total_runtime);
            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30440, mem_29105.mem + (int64_t) 0 *
                                  sizeof(int64_t), sizeof(int64_t)));
        if (pevents != NULL)
            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
    }
    if (futhark_context_sync(ctx) != 0)
        return 1;
    
    int64_t max_per_thread_29050 = read_res_30440;
    
    if (memblock_unref_device(ctx, &mem_29105, "mem_29105") != 0)
        return 1;
    
    int64_t read_res_30441;
    
    {
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->copy_scalar_from_dev_runs,
                                      &ctx->copy_scalar_from_dev_total_runtime);
            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30441, mem_29107.mem + (int64_t) 0 *
                                  sizeof(int64_t), sizeof(int64_t)));
        if (pevents != NULL)
            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
    }
    if (futhark_context_sync(ctx) != 0)
        return 1;
    
    int64_t max_per_thread_29051 = read_res_30441;
    
    if (memblock_unref_device(ctx, &mem_29107, "mem_29107") != 0)
        return 1;
    
    int64_t read_res_30442;
    
    {
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->copy_scalar_from_dev_runs,
                                      &ctx->copy_scalar_from_dev_total_runtime);
            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30442, mem_29109.mem + (int64_t) 0 *
                                  sizeof(int64_t), sizeof(int64_t)));
        if (pevents != NULL)
            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
    }
    if (futhark_context_sync(ctx) != 0)
        return 1;
    
    int64_t max_per_thread_29052 = read_res_30442;
    
    if (memblock_unref_device(ctx, &mem_29109, "mem_29109") != 0)
        return 1;
    
    int64_t sizze_sum_29098 = num_threads_29036 * max_per_thread_29050;
    int64_t sizze_sum_29099 = num_threads_29036 * max_per_thread_29051;
    int64_t sizze_sum_29100 = num_threads_29036 * max_per_thread_29052;
    struct memblock_device mem_28563;
    
    mem_28563.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28563, sizze_sum_29098, "mem_28563")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_28499;
    
    mem_28499.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28499, sizze_sum_29098, "mem_28499")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_28497;
    
    mem_28497.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28497, sizze_sum_29098, "mem_28497")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_28495;
    
    mem_28495.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28495, sizze_sum_29098, "mem_28495")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_28493;
    
    mem_28493.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28493, sizze_sum_29098, "mem_28493")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_28484;
    
    mem_28484.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28484, sizze_sum_29098, "mem_28484")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_28501;
    
    mem_28501.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28501, sizze_sum_29099, "mem_28501")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device double_buffer_mem_28767;
    
    double_buffer_mem_28767.references = NULL;
    if (memblock_alloc_device(ctx, &double_buffer_mem_28767, sizze_sum_29100,
                              "double_buffer_mem_28767")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, m_26408)) {
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegScan");
        
        int64_t numThreads_29678;
        
        numThreads_29678 = sdiv_up64(m_26408, segscan_group_sizze_27964 *
                                     (int64_t) 9) * segscan_group_sizze_27964;
        
        int64_t numGroups_29679;
        
        numGroups_29679 = sdiv_up64(m_26408, segscan_group_sizze_27964 *
                                    (int64_t) 9);
        
        struct memblock_device eWiseAddMultEntryziid_counter_mem_29680 =
                               ctx->eWiseAddMultEntryziid_counter_mem_29680;
        struct memblock_device status_flags_mem_29682;
        
        status_flags_mem_29682.references = NULL;
        if (memblock_alloc_device(ctx, &status_flags_mem_29682,
                                  (int64_t) sizeof(int8_t) * numGroups_29679,
                                  "status_flags_mem_29682")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device aggregates_mem_29684;
        
        aggregates_mem_29684.references = NULL;
        if (memblock_alloc_device(ctx, &aggregates_mem_29684,
                                  (int64_t) sizeof(int64_t) * numGroups_29679,
                                  "aggregates_mem_29684")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device incprefixes_mem_29686;
        
        incprefixes_mem_29686.references = NULL;
        if (memblock_alloc_device(ctx, &incprefixes_mem_29686,
                                  (int64_t) sizeof(int64_t) * numGroups_29679,
                                  "incprefixes_mem_29686")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_29682,
                                         numGroups_29679, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        
        unsigned int shared_sizze_30447 = smax64(smax64((int64_t) 288,
                                                        (int64_t) 8 *
                                                        segscan_group_sizze_27964),
                                                 (int64_t) 9 *
                                                 segscan_group_sizze_27964 *
                                                 (int64_t) 8);
        CUdeviceptr kernel_arg_30449 = rightColumns_mem_28235.mem;
        CUdeviceptr kernel_arg_30450 = rightOffsets_mem_28236.mem;
        CUdeviceptr kernel_arg_30451 = mem_28337.mem;
        CUdeviceptr kernel_arg_30452 = mem_28341.mem;
        CUdeviceptr kernel_arg_30453 = mem_28484.mem;
        CUdeviceptr kernel_arg_30454 = mem_28493.mem;
        CUdeviceptr kernel_arg_30455 = mem_28495.mem;
        CUdeviceptr kernel_arg_30456 = mem_28497.mem;
        CUdeviceptr kernel_arg_30457 = mem_28499.mem;
        CUdeviceptr kernel_arg_30458 = mem_28501.mem;
        CUdeviceptr kernel_arg_30459 = mem_28563.mem;
        CUdeviceptr kernel_arg_30460 = mem_28582.mem;
        CUdeviceptr kernel_arg_30461 = double_buffer_mem_28767.mem;
        CUdeviceptr kernel_arg_30462 =
                    eWiseAddMultEntryziid_counter_mem_29680.mem;
        CUdeviceptr kernel_arg_30463 = status_flags_mem_29682.mem;
        CUdeviceptr kernel_arg_30464 = aggregates_mem_29684.mem;
        CUdeviceptr kernel_arg_30465 = incprefixes_mem_29686.mem;
        unsigned int shared_offset_30448 = 0;
        
        if ((((((1 && sdiv_up64(m_26408, segscan_group_sizze_27964 *
                                (int64_t) 9) != 0) && 1 != 0) && 1 != 0) &&
              segscan_group_sizze_27964 != 0) && 1 != 0) && 1 != 0) {
            int perm[3] = {0, 1, 2};
            
            if (1 >= 1 << 16) {
                perm[1] = perm[0];
                perm[0] = 1;
            }
            if (1 >= 1 << 16) {
                perm[2] = perm[0];
                perm[0] = 2;
            }
            
            size_t grid[3];
            
            grid[perm[0]] = sdiv_up64(m_26408, segscan_group_sizze_27964 *
                                      (int64_t) 9);
            grid[perm[1]] = 1;
            grid[perm[2]] = 1;
            
            void *kernel_args_30444[] = {&ctx->global_failure,
                                         &ctx->failure_is_an_option,
                                         &ctx->global_failure_args,
                                         &shared_offset_30448, &m_26408,
                                         &k_26409, &eWiseAddOffsets_res_26600,
                                         &num_threads_29036, &kernel_arg_30449,
                                         &kernel_arg_30450, &kernel_arg_30451,
                                         &kernel_arg_30452, &kernel_arg_30453,
                                         &kernel_arg_30454, &kernel_arg_30455,
                                         &kernel_arg_30456, &kernel_arg_30457,
                                         &kernel_arg_30458, &kernel_arg_30459,
                                         &kernel_arg_30460, &kernel_arg_30461,
                                         &kernel_arg_30462, &kernel_arg_30463,
                                         &kernel_arg_30464, &kernel_arg_30465};
            int64_t time_start_30445 = 0, time_end_30446 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with grid size (",
                        "eWiseAddMultEntry.segscan_27969");
                fprintf(stderr, "%d", sdiv_up64(m_26408,
                                                segscan_group_sizze_27964 *
                                                (int64_t) 9));
                fprintf(stderr, ", ");
                fprintf(stderr, "%d", 1);
                fprintf(stderr, ", ");
                fprintf(stderr, "%d", 1);
                fprintf(stderr, ") and block size (");
                fprintf(stderr, "%d", segscan_group_sizze_27964);
                fprintf(stderr, ", ");
                fprintf(stderr, "%d", 1);
                fprintf(stderr, ", ");
                fprintf(stderr, "%d", 1);
                fprintf(stderr, ").\n");
                time_start_30445 = get_wall_time();
            }
            
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->eWiseAddMultEntryzisegscan_27969_runs,
                                          &ctx->eWiseAddMultEntryzisegscan_27969_total_runtime);
                CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED(cuLaunchKernel(ctx->eWiseAddMultEntryzisegscan_27969,
                                        grid[0], grid[1], grid[2],
                                        segscan_group_sizze_27964, 1, 1, 0 +
                                        (shared_sizze_30447 + (8 -
                                                               shared_sizze_30447 %
                                                               8) % 8), NULL,
                                        kernel_args_30444, NULL));
            if (pevents != NULL)
                CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
            if (ctx->debugging) {
                CUDA_SUCCEED(cuCtxSynchronize());
                time_end_30446 = get_wall_time();
                fprintf(stderr, "Kernel %s runtime: %ldus\n",
                        "eWiseAddMultEntry.segscan_27969", time_end_30446 -
                        time_start_30445);
            }
        }
        ctx->failure_is_an_option = 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_29686,
                                  "incprefixes_mem_29686") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_29684,
                                  "aggregates_mem_29684") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_29682,
                                  "status_flags_mem_29682") != 0)
            return 1;
    }
    if (memblock_unref_device(ctx, &mem_28484, "mem_28484") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28493, "mem_28493") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28495, "mem_28495") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28497, "mem_28497") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28499, "mem_28499") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28501, "mem_28501") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28563, "mem_28563") != 0)
        return 1;
    if (memblock_unref_device(ctx, &double_buffer_mem_28767,
                              "double_buffer_mem_28767") != 0)
        return 1;
    
    int64_t read_res_30466;
    
    {
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->copy_scalar_from_dev_runs,
                                      &ctx->copy_scalar_from_dev_total_runtime);
            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30466, mem_28582.mem + i_26595 *
                                  sizeof(int64_t), sizeof(int64_t)));
        if (pevents != NULL)
            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
    }
    if (futhark_context_sync(ctx) != 0)
        return 1;
    
    int64_t eWiseMultOffsets_res_27196 = read_res_30466;
    bool bounds_invalid_upwards_27197 = slt64(eWiseMultOffsets_res_27196,
                                              (int64_t) 0);
    bool valid_27198 = !bounds_invalid_upwards_27197;
    bool range_valid_c_27199;
    
    if (!valid_27198) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Range ", (int64_t) 0, "..", (int64_t) 1, "..<",
                               eWiseMultOffsets_res_27196, " is invalid.",
                               "-> #0  /prelude/array.fut:60:3-10\n   #1  /prelude/array.fut:70:18-23\n   #2  sparse.fut:163:16-35\n   #3  sparse.fut:245:21-96\n   #4  sparse.fut:234:1-247:60\n");
        if (memblock_unref_device(ctx, &double_buffer_mem_28767,
                                  "double_buffer_mem_28767") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28501, "mem_28501") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28484, "mem_28484") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28493, "mem_28493") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28495, "mem_28495") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28497, "mem_28497") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28499, "mem_28499") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28563, "mem_28563") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_29638,
                                  "group_res_arr_mem_29638") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_29636,
                                  "group_res_arr_mem_29636") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_29634,
                                  "group_res_arr_mem_29634") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_29109, "mem_29109") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_29107, "mem_29107") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_29105, "mem_29105") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28582, "mem_28582") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28341, "mem_28341") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28339, "mem_28339") != 0)
            return 1;
        if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                  "double_buffer_mem_28763") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28256, "mem_28256") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28248, "mem_28248") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28250, "mem_28250") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28254, "mem_28254") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28318, "mem_28318") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                  "group_res_arr_mem_29131") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                  "group_res_arr_mem_29129") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                  "group_res_arr_mem_29127") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_29026, "mem_29026") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_29024, "mem_29024") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_29022, "mem_29022") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28337, "mem_28337") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_29123, "out_mem_29123") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_29121, "out_mem_29121") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_29119, "out_mem_29119") != 0)
            return 1;
        return 1;
    }
    
    int64_t bytes_28583 = (int64_t) 8 * eWiseMultOffsets_res_27196;
    struct memblock_device mem_28584;
    
    mem_28584.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28584, bytes_28583, "mem_28584")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_f64(ctx, mem_28584,
                                      eWiseMultOffsets_res_27196, 0.0) != 0) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_28586;
    
    mem_28586.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28586, bytes_28583, "mem_28586")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_28586,
                                      eWiseMultOffsets_res_27196,
                                      (int64_t) 0) != 0) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_28588;
    
    mem_28588.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28588, (int64_t) 0, "mem_28588")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t segmap_group_sizze_28100;
    
    segmap_group_sizze_28100 =
        ctx->sizes.eWiseAddMultEntryzisegmap_group_sizze_28099;
    for (int64_t i_27205 = 0; i_27205 < i_26595; i_27205++) {
        bool y_27208 = slt64(i_27205, m_26408);
        bool index_certs_27209;
        
        if (!y_27208) {
            ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                   "Index [", i_27205,
                                   "] out of bounds for array of shape [",
                                   m_26408, "].",
                                   "-> #0  sparse.fut:171:46-61\n   #1  sparse.fut:245:21-96\n   #2  sparse.fut:234:1-247:60\n");
            if (memblock_unref_device(ctx, &mem_28588, "mem_28588") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28586, "mem_28586") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28584, "mem_28584") != 0)
                return 1;
            if (memblock_unref_device(ctx, &double_buffer_mem_28767,
                                      "double_buffer_mem_28767") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28501, "mem_28501") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28484, "mem_28484") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28493, "mem_28493") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28495, "mem_28495") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28497, "mem_28497") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28499, "mem_28499") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28563, "mem_28563") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29638,
                                      "group_res_arr_mem_29638") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29636,
                                      "group_res_arr_mem_29636") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29634,
                                      "group_res_arr_mem_29634") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29109, "mem_29109") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29107, "mem_29107") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29105, "mem_29105") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28582, "mem_28582") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28341, "mem_28341") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28339, "mem_28339") != 0)
                return 1;
            if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                      "double_buffer_mem_28763") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28256, "mem_28256") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28248, "mem_28248") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28250, "mem_28250") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28254, "mem_28254") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28318, "mem_28318") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                      "group_res_arr_mem_29131") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                      "group_res_arr_mem_29129") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                      "group_res_arr_mem_29127") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29026, "mem_29026") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29024, "mem_29024") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29022, "mem_29022") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28337, "mem_28337") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29123, "out_mem_29123") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29121, "out_mem_29121") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29119, "out_mem_29119") !=
                0)
                return 1;
            return 1;
        }
        
        int64_t read_res_30467;
        
        {
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->copy_scalar_from_dev_runs,
                                          &ctx->copy_scalar_from_dev_total_runtime);
                CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30467,
                                      rightOffsets_mem_28236.mem + i_27205 *
                                      sizeof(int64_t), sizeof(int64_t)));
            if (pevents != NULL)
                CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
        }
        if (futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t i_27210 = read_res_30467;
        int64_t i_27211 = add64((int64_t) 1, i_27205);
        bool x_27212 = sle64((int64_t) 0, i_27211);
        bool y_27213 = slt64(i_27211, m_26408);
        bool bounds_check_27214 = x_27212 && y_27213;
        bool index_certs_27215;
        
        if (!bounds_check_27214) {
            ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                   "Index [", i_27211,
                                   "] out of bounds for array of shape [",
                                   m_26408, "].",
                                   "-> #0  sparse.fut:171:63-80\n   #1  sparse.fut:245:21-96\n   #2  sparse.fut:234:1-247:60\n");
            if (memblock_unref_device(ctx, &mem_28588, "mem_28588") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28586, "mem_28586") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28584, "mem_28584") != 0)
                return 1;
            if (memblock_unref_device(ctx, &double_buffer_mem_28767,
                                      "double_buffer_mem_28767") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28501, "mem_28501") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28484, "mem_28484") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28493, "mem_28493") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28495, "mem_28495") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28497, "mem_28497") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28499, "mem_28499") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28563, "mem_28563") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29638,
                                      "group_res_arr_mem_29638") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29636,
                                      "group_res_arr_mem_29636") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29634,
                                      "group_res_arr_mem_29634") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29109, "mem_29109") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29107, "mem_29107") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29105, "mem_29105") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28582, "mem_28582") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28341, "mem_28341") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28339, "mem_28339") != 0)
                return 1;
            if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                      "double_buffer_mem_28763") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28256, "mem_28256") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28248, "mem_28248") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28250, "mem_28250") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28254, "mem_28254") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28318, "mem_28318") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                      "group_res_arr_mem_29131") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                      "group_res_arr_mem_29129") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                      "group_res_arr_mem_29127") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29026, "mem_29026") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29024, "mem_29024") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29022, "mem_29022") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28337, "mem_28337") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29123, "out_mem_29123") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29121, "out_mem_29121") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29119, "out_mem_29119") !=
                0)
                return 1;
            return 1;
        }
        
        int64_t read_res_30468;
        
        {
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->copy_scalar_from_dev_runs,
                                          &ctx->copy_scalar_from_dev_total_runtime);
                CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30468,
                                      rightOffsets_mem_28236.mem + i_27211 *
                                      sizeof(int64_t), sizeof(int64_t)));
            if (pevents != NULL)
                CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
        }
        if (futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t j_27216 = read_res_30468;
        int64_t j_m_i_27217 = sub64(j_27216, i_27210);
        bool empty_slice_27218 = j_m_i_27217 == (int64_t) 0;
        int64_t m_27219 = sub64(j_m_i_27217, (int64_t) 1);
        int64_t i_p_m_t_s_27220 = add64(i_27210, m_27219);
        bool zzero_leq_i_p_m_t_s_27221 = sle64((int64_t) 0, i_p_m_t_s_27220);
        bool i_p_m_t_s_leq_w_27222 = slt64(i_p_m_t_s_27220, k_26409);
        bool zzero_lte_i_27223 = sle64((int64_t) 0, i_27210);
        bool i_lte_j_27224 = sle64(i_27210, j_27216);
        bool y_27225 = i_p_m_t_s_leq_w_27222 && zzero_lte_i_27223;
        bool y_27226 = zzero_leq_i_p_m_t_s_27221 && y_27225;
        bool y_27227 = i_lte_j_27224 && y_27226;
        bool forwards_ok_27228 = zzero_lte_i_27223 && y_27227;
        bool ok_or_empty_27229 = empty_slice_27218 || forwards_ok_27228;
        bool index_certs_27230;
        
        if (!ok_or_empty_27229) {
            ctx->error =
                msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                          "Index [", i_27210, ":", j_27216,
                          "] out of bounds for array of shape [", k_26409, "].",
                          "-> #0  sparse.fut:171:32-81\n   #1  sparse.fut:245:21-96\n   #2  sparse.fut:234:1-247:60\n");
            if (memblock_unref_device(ctx, &mem_28588, "mem_28588") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28586, "mem_28586") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28584, "mem_28584") != 0)
                return 1;
            if (memblock_unref_device(ctx, &double_buffer_mem_28767,
                                      "double_buffer_mem_28767") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28501, "mem_28501") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28484, "mem_28484") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28493, "mem_28493") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28495, "mem_28495") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28497, "mem_28497") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28499, "mem_28499") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28563, "mem_28563") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29638,
                                      "group_res_arr_mem_29638") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29636,
                                      "group_res_arr_mem_29636") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29634,
                                      "group_res_arr_mem_29634") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29109, "mem_29109") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29107, "mem_29107") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29105, "mem_29105") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28582, "mem_28582") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28341, "mem_28341") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28339, "mem_28339") != 0)
                return 1;
            if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                      "double_buffer_mem_28763") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28256, "mem_28256") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28248, "mem_28248") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28250, "mem_28250") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28254, "mem_28254") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28318, "mem_28318") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                      "group_res_arr_mem_29131") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                      "group_res_arr_mem_29129") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                      "group_res_arr_mem_29127") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29026, "mem_29026") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29024, "mem_29024") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29022, "mem_29022") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28337, "mem_28337") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29123, "out_mem_29123") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29121, "out_mem_29121") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29119, "out_mem_29119") !=
                0)
                return 1;
            return 1;
        }
        
        int64_t read_res_30469;
        
        {
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->copy_scalar_from_dev_runs,
                                          &ctx->copy_scalar_from_dev_total_runtime);
                CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30469, mem_28337.mem + i_27205 *
                                      sizeof(int64_t), sizeof(int64_t)));
            if (pevents != NULL)
                CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
        }
        if (futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t i_27232 = read_res_30469;
        int64_t read_res_30470;
        
        {
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->copy_scalar_from_dev_runs,
                                          &ctx->copy_scalar_from_dev_total_runtime);
                CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30470, mem_28337.mem + i_27211 *
                                      sizeof(int64_t), sizeof(int64_t)));
            if (pevents != NULL)
                CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
        }
        if (futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t j_27233 = read_res_30470;
        int64_t j_m_i_27234 = sub64(j_27233, i_27232);
        bool empty_slice_27235 = j_m_i_27234 == (int64_t) 0;
        int64_t m_27236 = sub64(j_m_i_27234, (int64_t) 1);
        int64_t i_p_m_t_s_27237 = add64(i_27232, m_27236);
        bool zzero_leq_i_p_m_t_s_27238 = sle64((int64_t) 0, i_p_m_t_s_27237);
        bool i_p_m_t_s_leq_w_27239 = slt64(i_p_m_t_s_27237,
                                           eWiseAddOffsets_res_26600);
        bool zzero_lte_i_27240 = sle64((int64_t) 0, i_27232);
        bool i_lte_j_27241 = sle64(i_27232, j_27233);
        bool y_27242 = i_p_m_t_s_leq_w_27239 && zzero_lte_i_27240;
        bool y_27243 = zzero_leq_i_p_m_t_s_27238 && y_27242;
        bool y_27244 = i_lte_j_27241 && y_27243;
        bool forwards_ok_27245 = zzero_lte_i_27240 && y_27244;
        bool ok_or_empty_27246 = empty_slice_27235 || forwards_ok_27245;
        bool index_certs_27247;
        
        if (!ok_or_empty_27246) {
            ctx->error =
                msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                          "Index [", i_27232, ":", j_27233,
                          "] out of bounds for array of shape [",
                          eWiseAddOffsets_res_26600, "].",
                          "-> #0  sparse.fut:170:32-78\n   #1  sparse.fut:245:21-96\n   #2  sparse.fut:234:1-247:60\n");
            if (memblock_unref_device(ctx, &mem_28588, "mem_28588") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28586, "mem_28586") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28584, "mem_28584") != 0)
                return 1;
            if (memblock_unref_device(ctx, &double_buffer_mem_28767,
                                      "double_buffer_mem_28767") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28501, "mem_28501") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28484, "mem_28484") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28493, "mem_28493") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28495, "mem_28495") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28497, "mem_28497") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28499, "mem_28499") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28563, "mem_28563") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29638,
                                      "group_res_arr_mem_29638") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29636,
                                      "group_res_arr_mem_29636") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29634,
                                      "group_res_arr_mem_29634") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29109, "mem_29109") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29107, "mem_29107") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29105, "mem_29105") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28582, "mem_28582") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28341, "mem_28341") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28339, "mem_28339") != 0)
                return 1;
            if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                      "double_buffer_mem_28763") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28256, "mem_28256") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28248, "mem_28248") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28250, "mem_28250") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28254, "mem_28254") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28318, "mem_28318") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                      "group_res_arr_mem_29131") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                      "group_res_arr_mem_29129") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                      "group_res_arr_mem_29127") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29026, "mem_29026") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29024, "mem_29024") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29022, "mem_29022") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28337, "mem_28337") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29123, "out_mem_29123") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29121, "out_mem_29121") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29119, "out_mem_29119") !=
                0)
                return 1;
            return 1;
        }
        
        int64_t conc_tmp_27249 = j_m_i_27217 + j_m_i_27234;
        int64_t j_m_i_27250 = sub64(conc_tmp_27249, (int64_t) 1);
        int64_t bytes_28603 = (int64_t) 8 * conc_tmp_27249;
        int64_t sizze_27251;
        int64_t sizze_27252;
        int64_t sizze_27253;
        int64_t intersectArrays_res_ixfn_28685;
        int64_t intersectArrays_res_ixfn_28686;
        int64_t intersectArrays_res_ixfn_28688;
        int64_t intersectArrays_res_ixfn_28689;
        int64_t intersectArrays_res_ixfn_28691;
        int64_t intersectArrays_res_ixfn_28692;
        struct memblock_device intersectArrays_res_mem_28687;
        
        intersectArrays_res_mem_28687.references = NULL;
        
        struct memblock_device intersectArrays_res_mem_28690;
        
        intersectArrays_res_mem_28690.references = NULL;
        
        struct memblock_device intersectArrays_res_mem_28693;
        
        intersectArrays_res_mem_28693.references = NULL;
        if (empty_slice_27235) {
            sizze_27251 = (int64_t) 0;
            sizze_27252 = (int64_t) 0;
            sizze_27253 = (int64_t) 0;
            intersectArrays_res_ixfn_28685 = (int64_t) 0;
            intersectArrays_res_ixfn_28686 = (int64_t) 0;
            intersectArrays_res_ixfn_28688 = (int64_t) 0;
            intersectArrays_res_ixfn_28689 = (int64_t) 0;
            intersectArrays_res_ixfn_28691 = (int64_t) 0;
            intersectArrays_res_ixfn_28692 = (int64_t) 0;
            if (memblock_set_device(ctx, &intersectArrays_res_mem_28687,
                                    &mem_28588, "mem_28588") != 0)
                return 1;
            if (memblock_set_device(ctx, &intersectArrays_res_mem_28690,
                                    &mem_28588, "mem_28588") != 0)
                return 1;
            if (memblock_set_device(ctx, &intersectArrays_res_mem_28693,
                                    &mem_28588, "mem_28588") != 0)
                return 1;
        } else {
            struct memblock_device mem_28604;
            
            mem_28604.references = NULL;
            if (memblock_alloc_device(ctx, &mem_28604, bytes_28603,
                                      "mem_28604")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t tmp_offs_29780 = (int64_t) 0;
            
            {
                cudaEvent_t *pevents = NULL;
                
                if (ctx->profiling && !ctx->profiling_paused) {
                    pevents = cuda_get_events(&ctx->cuda,
                                              &ctx->copy_dev_to_dev_runs,
                                              &ctx->copy_dev_to_dev_total_runtime);
                    CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
                }
                CUDA_SUCCEED(cuMemcpy(mem_28604.mem + tmp_offs_29780 *
                                      (int64_t) 8, mem_28341.mem + i_27232 *
                                      (int64_t) 8, j_m_i_27234 *
                                      (int64_t) sizeof(int64_t)));
                if (pevents != NULL)
                    CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
            }
            tmp_offs_29780 += j_m_i_27234;
            {
                cudaEvent_t *pevents = NULL;
                
                if (ctx->profiling && !ctx->profiling_paused) {
                    pevents = cuda_get_events(&ctx->cuda,
                                              &ctx->copy_dev_to_dev_runs,
                                              &ctx->copy_dev_to_dev_total_runtime);
                    CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
                }
                CUDA_SUCCEED(cuMemcpy(mem_28604.mem + tmp_offs_29780 *
                                      (int64_t) 8, rightColumns_mem_28235.mem +
                                      i_27210 * (int64_t) 8, j_m_i_27217 *
                                      (int64_t) sizeof(int64_t)));
                if (pevents != NULL)
                    CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
            }
            tmp_offs_29780 += j_m_i_27217;
            
            struct memblock_device mem_28606;
            
            mem_28606.references = NULL;
            if (memblock_alloc_device(ctx, &mem_28606, bytes_28603,
                                      "mem_28606")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhiota_i64(ctx, mem_28606, conc_tmp_27249,
                                         (int64_t) 0, (int64_t) 1) != 0) {
                err = 1;
                goto cleanup;
            }
            
            bool cond_27259 = conc_tmp_27249 == (int64_t) 0;
            int32_t iters_27260;
            
            if (cond_27259) {
                iters_27260 = 0;
            } else {
                iters_27260 = 32;
            }
            
            bool loop_nonempty_27261 = slt32(0, iters_27260);
            bool x_27262 = sle64((int64_t) 0, j_m_i_27250);
            bool y_27263 = slt64(j_m_i_27250, conc_tmp_27249);
            bool bounds_check_27264 = x_27262 && y_27263;
            bool loop_not_taken_27265 = !loop_nonempty_27261;
            bool protect_assert_disj_27266 = bounds_check_27264 ||
                 loop_not_taken_27265;
            int64_t last_index_27268 = j_m_i_27250 - (int64_t) 1;
            bool is_empty_27269 = j_m_i_27250 == (int64_t) 0;
            int64_t segscan_group_sizze_27972;
            
            segscan_group_sizze_27972 =
                ctx->sizes.eWiseAddMultEntryzisegscan_group_sizze_27971;
            
            int64_t num_groups_27974;
            int32_t max_num_groups_29781;
            
            max_num_groups_29781 =
                ctx->sizes.eWiseAddMultEntryzisegscan_num_groups_27973;
            num_groups_27974 = sext_i64_i32(smax64((int64_t) 1,
                                                   smin64(sdiv_up64(conc_tmp_27249,
                                                                    segscan_group_sizze_27972),
                                                          sext_i32_i64(max_num_groups_29781))));
            
            int64_t segmap_group_sizze_27982;
            
            segmap_group_sizze_27982 =
                ctx->sizes.eWiseAddMultEntryzisegmap_group_sizze_27981;
            
            int64_t segmap_usable_groups_27983 = sdiv_up_safe64(conc_tmp_27249,
                                                                segmap_group_sizze_27982);
            int64_t segmap_group_sizze_28059;
            
            segmap_group_sizze_28059 =
                ctx->sizes.eWiseAddMultEntryzisegmap_group_sizze_28037;
            
            bool i_lte_j_27391 = sle64((int64_t) 1, conc_tmp_27249);
            bool y_27392 = bounds_check_27264 && i_lte_j_27391;
            bool ok_or_empty_27393 = is_empty_27269 || y_27392;
            int64_t segscan_group_sizze_28084;
            
            segscan_group_sizze_28084 =
                ctx->sizes.eWiseAddMultEntryzisegscan_group_sizze_28083;
            
            int64_t num_groups_28086;
            int32_t max_num_groups_29782;
            
            max_num_groups_29782 =
                ctx->sizes.eWiseAddMultEntryzisegscan_num_groups_28085;
            num_groups_28086 = sext_i64_i32(smax64((int64_t) 1,
                                                   smin64(sdiv_up64(j_m_i_27250,
                                                                    segscan_group_sizze_28084),
                                                          sext_i32_i64(max_num_groups_29782))));
            
            int64_t bytes_28630 = (int64_t) 4 * conc_tmp_27249;
            int64_t bytes_28669 = (int64_t) 8 * j_m_i_27250;
            int64_t intersectArrays_res_f_res_ixfn_28677;
            
            if (empty_slice_27218) {
                intersectArrays_res_f_res_ixfn_28677 = (int64_t) 0;
            } else {
                intersectArrays_res_f_res_ixfn_28677 = j_m_i_27250;
            }
            
            int64_t sizze_27270;
            int64_t sizze_27271;
            int64_t sizze_27272;
            int64_t intersectArrays_res_f_res_ixfn_28676;
            int64_t intersectArrays_res_f_res_ixfn_28679;
            int64_t intersectArrays_res_f_res_ixfn_28682;
            struct memblock_device intersectArrays_res_f_res_mem_28678;
            
            intersectArrays_res_f_res_mem_28678.references = NULL;
            
            struct memblock_device intersectArrays_res_f_res_mem_28681;
            
            intersectArrays_res_f_res_mem_28681.references = NULL;
            
            struct memblock_device intersectArrays_res_f_res_mem_28684;
            
            intersectArrays_res_f_res_mem_28684.references = NULL;
            if (empty_slice_27218) {
                sizze_27270 = (int64_t) 0;
                sizze_27271 = (int64_t) 0;
                sizze_27272 = (int64_t) 0;
                intersectArrays_res_f_res_ixfn_28676 = (int64_t) 0;
                intersectArrays_res_f_res_ixfn_28679 = (int64_t) 0;
                intersectArrays_res_f_res_ixfn_28682 = (int64_t) 0;
                if (memblock_set_device(ctx,
                                        &intersectArrays_res_f_res_mem_28678,
                                        &mem_28588, "mem_28588") != 0)
                    return 1;
                if (memblock_set_device(ctx,
                                        &intersectArrays_res_f_res_mem_28681,
                                        &mem_28588, "mem_28588") != 0)
                    return 1;
                if (memblock_set_device(ctx,
                                        &intersectArrays_res_f_res_mem_28684,
                                        &mem_28588, "mem_28588") != 0)
                    return 1;
            } else {
                bool index_certs_27276;
                
                if (!protect_assert_disj_27266) {
                    ctx->error =
                        msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                  "Index [", j_m_i_27250,
                                  "] out of bounds for array of shape [",
                                  conc_tmp_27249, "].",
                                  "-> #0  /prelude/array.fut:18:29-34\n   #1  lib/github.com/diku-dk/sorts/radix_sort.fut:25:24-35\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:53:31-62\n   #3  /prelude/functional.fut:9:42-44\n   #4  lib/github.com/diku-dk/sorts/radix_sort.fut:59:3-61:47\n   #5  lib/github.com/diku-dk/sorts/radix_sort.fut:68:3-51\n   #6  sparse.fut:5:34-6:77\n   #7  sparse.fut:86:12-35\n   #8  sparse.fut:169:49-171:81\n   #9  sparse.fut:245:21-96\n   #10 sparse.fut:234:1-247:60\n");
                    if (memblock_unref_device(ctx,
                                              &intersectArrays_res_f_res_mem_28684,
                                              "intersectArrays_res_f_res_mem_28684") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &intersectArrays_res_f_res_mem_28681,
                                              "intersectArrays_res_f_res_mem_28681") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &intersectArrays_res_f_res_mem_28678,
                                              "intersectArrays_res_f_res_mem_28678") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28606, "mem_28606") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28604, "mem_28604") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &intersectArrays_res_mem_28693,
                                              "intersectArrays_res_mem_28693") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &intersectArrays_res_mem_28690,
                                              "intersectArrays_res_mem_28690") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &intersectArrays_res_mem_28687,
                                              "intersectArrays_res_mem_28687") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28588, "mem_28588") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28586, "mem_28586") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28584, "mem_28584") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &double_buffer_mem_28767,
                                              "double_buffer_mem_28767") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28501, "mem_28501") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28484, "mem_28484") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28493, "mem_28493") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28495, "mem_28495") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28497, "mem_28497") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28499, "mem_28499") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28563, "mem_28563") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &group_res_arr_mem_29638,
                                              "group_res_arr_mem_29638") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &group_res_arr_mem_29636,
                                              "group_res_arr_mem_29636") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &group_res_arr_mem_29634,
                                              "group_res_arr_mem_29634") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_29109, "mem_29109") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_29107, "mem_29107") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_29105, "mem_29105") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28582, "mem_28582") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28341, "mem_28341") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28339, "mem_28339") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                              "double_buffer_mem_28763") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28256, "mem_28256") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28239, "mem_28239") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28248, "mem_28248") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28250, "mem_28250") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28252, "mem_28252") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28254, "mem_28254") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28318, "mem_28318") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                              "group_res_arr_mem_29131") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                              "group_res_arr_mem_29129") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                              "group_res_arr_mem_29127") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_29026, "mem_29026") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_29024, "mem_29024") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_29022, "mem_29022") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28337, "mem_28337") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &out_mem_29123,
                                              "out_mem_29123") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &out_mem_29121,
                                              "out_mem_29121") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &out_mem_29119,
                                              "out_mem_29119") != 0)
                        return 1;
                    return 1;
                }
                
                struct memblock_device mem_28623;
                
                mem_28623.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28623, bytes_28603,
                                          "mem_28623")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28625;
                
                mem_28625.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28625, bytes_28603,
                                          "mem_28625")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28627;
                
                mem_28627.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28627, bytes_28603,
                                          "mem_28627")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28629;
                
                mem_28629.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28629, bytes_28603,
                                          "mem_28629")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28631;
                
                mem_28631.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28631, bytes_28630,
                                          "mem_28631")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device defunc_0_f_res_mem_28645;
                
                defunc_0_f_res_mem_28645.references = NULL;
                
                struct memblock_device defunc_0_f_res_mem_28650;
                
                defunc_0_f_res_mem_28650.references = NULL;
                
                struct memblock_device mem_param_28611;
                
                mem_param_28611.references = NULL;
                
                struct memblock_device mem_param_28616;
                
                mem_param_28616.references = NULL;
                if (memblock_set_device(ctx, &mem_param_28611, &mem_28604,
                                        "mem_28604") != 0)
                    return 1;
                if (memblock_set_device(ctx, &mem_param_28616, &mem_28606,
                                        "mem_28606") != 0)
                    return 1;
                for (int32_t i_27279 = 0; i_27279 < iters_27260; i_27279++) {
                    int32_t defunc_2_radix_sort_step_arg_27282 = mul32(2,
                                                                       i_27279);
                    int32_t defunc_0_get_bit_arg_27283 = add32(1,
                                                               defunc_2_radix_sort_step_arg_27282);
                    int64_t i32_res_27284 =
                            sext_i32_i64(defunc_0_get_bit_arg_27283);
                    int64_t i32_res_27285 =
                            sext_i32_i64(defunc_2_radix_sort_step_arg_27282);
                    
                    if (slt64((int64_t) 0, conc_tmp_27249)) {
                        if (ctx->debugging)
                            fprintf(stderr, "%s\n", "\n# SegScan");
                        
                        int64_t numThreads_29787;
                        
                        numThreads_29787 = sdiv_up64(conc_tmp_27249,
                                                     segscan_group_sizze_27972 *
                                                     (int64_t) 9) *
                            segscan_group_sizze_27972;
                        
                        int64_t numGroups_29788;
                        
                        numGroups_29788 = sdiv_up64(conc_tmp_27249,
                                                    segscan_group_sizze_27972 *
                                                    (int64_t) 9);
                        
                        struct memblock_device
                        eWiseAddMultEntryziid_counter_mem_29789 =
                        ctx->eWiseAddMultEntryziid_counter_mem_29789;
                        struct memblock_device status_flags_mem_29791;
                        
                        status_flags_mem_29791.references = NULL;
                        if (memblock_alloc_device(ctx, &status_flags_mem_29791,
                                                  (int64_t) sizeof(int8_t) *
                                                  numGroups_29788,
                                                  "status_flags_mem_29791")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        struct memblock_device aggregates_mem_29793;
                        
                        aggregates_mem_29793.references = NULL;
                        if (memblock_alloc_device(ctx, &aggregates_mem_29793,
                                                  (int64_t) sizeof(int64_t) *
                                                  numGroups_29788,
                                                  "aggregates_mem_29793")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        struct memblock_device incprefixes_mem_29795;
                        
                        incprefixes_mem_29795.references = NULL;
                        if (memblock_alloc_device(ctx, &incprefixes_mem_29795,
                                                  (int64_t) sizeof(int64_t) *
                                                  numGroups_29788,
                                                  "incprefixes_mem_29795")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        struct memblock_device aggregates_mem_29797;
                        
                        aggregates_mem_29797.references = NULL;
                        if (memblock_alloc_device(ctx, &aggregates_mem_29797,
                                                  (int64_t) sizeof(int64_t) *
                                                  numGroups_29788,
                                                  "aggregates_mem_29797")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        struct memblock_device incprefixes_mem_29799;
                        
                        incprefixes_mem_29799.references = NULL;
                        if (memblock_alloc_device(ctx, &incprefixes_mem_29799,
                                                  (int64_t) sizeof(int64_t) *
                                                  numGroups_29788,
                                                  "incprefixes_mem_29799")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        struct memblock_device aggregates_mem_29801;
                        
                        aggregates_mem_29801.references = NULL;
                        if (memblock_alloc_device(ctx, &aggregates_mem_29801,
                                                  (int64_t) sizeof(int64_t) *
                                                  numGroups_29788,
                                                  "aggregates_mem_29801")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        struct memblock_device incprefixes_mem_29803;
                        
                        incprefixes_mem_29803.references = NULL;
                        if (memblock_alloc_device(ctx, &incprefixes_mem_29803,
                                                  (int64_t) sizeof(int64_t) *
                                                  numGroups_29788,
                                                  "incprefixes_mem_29803")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        struct memblock_device aggregates_mem_29805;
                        
                        aggregates_mem_29805.references = NULL;
                        if (memblock_alloc_device(ctx, &aggregates_mem_29805,
                                                  (int64_t) sizeof(int64_t) *
                                                  numGroups_29788,
                                                  "aggregates_mem_29805")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        struct memblock_device incprefixes_mem_29807;
                        
                        incprefixes_mem_29807.references = NULL;
                        if (memblock_alloc_device(ctx, &incprefixes_mem_29807,
                                                  (int64_t) sizeof(int64_t) *
                                                  numGroups_29788,
                                                  "incprefixes_mem_29807")) {
                            err = 1;
                            goto cleanup;
                        }
                        if (futrts_builtinzhreplicate_i8(ctx,
                                                         status_flags_mem_29791,
                                                         numGroups_29788,
                                                         (int8_t) 0) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        unsigned int shared_sizze_30475 =
                                     smax64(smax64((int64_t) 1056,
                                                   sdiv_up64(sdiv_up64(sdiv_up64((int64_t) 8 *
                                                                                 segscan_group_sizze_27972,
                                                                                 (int64_t) 8) *
                                                                       (int64_t) 8 +
                                                                       (int64_t) 8 *
                                                                       segscan_group_sizze_27972,
                                                                       (int64_t) 8) *
                                                             (int64_t) 8 +
                                                             (int64_t) 8 *
                                                             segscan_group_sizze_27972,
                                                             (int64_t) 8) *
                                                   (int64_t) 8 + (int64_t) 8 *
                                                   segscan_group_sizze_27972),
                                            smax64(smax64(smax64((int64_t) 9 *
                                                                 segscan_group_sizze_27972 *
                                                                 (int64_t) 8,
                                                                 (int64_t) 9 *
                                                                 segscan_group_sizze_27972 *
                                                                 (int64_t) 8),
                                                          (int64_t) 9 *
                                                          segscan_group_sizze_27972 *
                                                          (int64_t) 8),
                                                   (int64_t) 9 *
                                                   segscan_group_sizze_27972 *
                                                   (int64_t) 8));
                        CUdeviceptr kernel_arg_30477 = mem_param_28611.mem;
                        CUdeviceptr kernel_arg_30478 = mem_28623.mem;
                        CUdeviceptr kernel_arg_30479 = mem_28625.mem;
                        CUdeviceptr kernel_arg_30480 = mem_28627.mem;
                        CUdeviceptr kernel_arg_30481 = mem_28629.mem;
                        CUdeviceptr kernel_arg_30482 = mem_28631.mem;
                        CUdeviceptr kernel_arg_30483 =
                                    eWiseAddMultEntryziid_counter_mem_29789.mem;
                        CUdeviceptr kernel_arg_30484 =
                                    status_flags_mem_29791.mem;
                        CUdeviceptr kernel_arg_30485 = aggregates_mem_29793.mem;
                        CUdeviceptr kernel_arg_30486 =
                                    incprefixes_mem_29795.mem;
                        CUdeviceptr kernel_arg_30487 = aggregates_mem_29797.mem;
                        CUdeviceptr kernel_arg_30488 =
                                    incprefixes_mem_29799.mem;
                        CUdeviceptr kernel_arg_30489 = aggregates_mem_29801.mem;
                        CUdeviceptr kernel_arg_30490 =
                                    incprefixes_mem_29803.mem;
                        CUdeviceptr kernel_arg_30491 = aggregates_mem_29805.mem;
                        CUdeviceptr kernel_arg_30492 =
                                    incprefixes_mem_29807.mem;
                        unsigned int shared_offset_30476 = 0;
                        
                        if ((((((1 && sdiv_up64(conc_tmp_27249,
                                                segscan_group_sizze_27972 *
                                                (int64_t) 9) != 0) && 1 != 0) &&
                               1 != 0) && segscan_group_sizze_27972 != 0) &&
                             1 != 0) && 1 != 0) {
                            int perm[3] = {0, 1, 2};
                            
                            if (1 >= 1 << 16) {
                                perm[1] = perm[0];
                                perm[0] = 1;
                            }
                            if (1 >= 1 << 16) {
                                perm[2] = perm[0];
                                perm[0] = 2;
                            }
                            
                            size_t grid[3];
                            
                            grid[perm[0]] = sdiv_up64(conc_tmp_27249,
                                                      segscan_group_sizze_27972 *
                                                      (int64_t) 9);
                            grid[perm[1]] = 1;
                            grid[perm[2]] = 1;
                            
                            void *kernel_args_30472[] = {&ctx->global_failure,
                                                         &shared_offset_30476,
                                                         &conc_tmp_27249,
                                                         &i32_res_27284,
                                                         &i32_res_27285,
                                                         &kernel_arg_30477,
                                                         &kernel_arg_30478,
                                                         &kernel_arg_30479,
                                                         &kernel_arg_30480,
                                                         &kernel_arg_30481,
                                                         &kernel_arg_30482,
                                                         &kernel_arg_30483,
                                                         &kernel_arg_30484,
                                                         &kernel_arg_30485,
                                                         &kernel_arg_30486,
                                                         &kernel_arg_30487,
                                                         &kernel_arg_30488,
                                                         &kernel_arg_30489,
                                                         &kernel_arg_30490,
                                                         &kernel_arg_30491,
                                                         &kernel_arg_30492};
                            int64_t time_start_30473 = 0, time_end_30474 = 0;
                            
                            if (ctx->debugging) {
                                fprintf(stderr, "Launching %s with grid size (",
                                        "eWiseAddMultEntry.segscan_27977");
                                fprintf(stderr, "%d", sdiv_up64(conc_tmp_27249,
                                                                segscan_group_sizze_27972 *
                                                                (int64_t) 9));
                                fprintf(stderr, ", ");
                                fprintf(stderr, "%d", 1);
                                fprintf(stderr, ", ");
                                fprintf(stderr, "%d", 1);
                                fprintf(stderr, ") and block size (");
                                fprintf(stderr, "%d",
                                        segscan_group_sizze_27972);
                                fprintf(stderr, ", ");
                                fprintf(stderr, "%d", 1);
                                fprintf(stderr, ", ");
                                fprintf(stderr, "%d", 1);
                                fprintf(stderr, ").\n");
                                time_start_30473 = get_wall_time();
                            }
                            
                            cudaEvent_t *pevents = NULL;
                            
                            if (ctx->profiling && !ctx->profiling_paused) {
                                pevents = cuda_get_events(&ctx->cuda,
                                                          &ctx->eWiseAddMultEntryzisegscan_27977_runs,
                                                          &ctx->eWiseAddMultEntryzisegscan_27977_total_runtime);
                                CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
                            }
                            CUDA_SUCCEED(cuLaunchKernel(ctx->eWiseAddMultEntryzisegscan_27977,
                                                        grid[0], grid[1],
                                                        grid[2],
                                                        segscan_group_sizze_27972,
                                                        1, 1, 0 +
                                                        (shared_sizze_30475 +
                                                         (8 -
                                                          shared_sizze_30475 %
                                                          8) % 8), NULL,
                                                        kernel_args_30472,
                                                        NULL));
                            if (pevents != NULL)
                                CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
                            if (ctx->debugging) {
                                CUDA_SUCCEED(cuCtxSynchronize());
                                time_end_30474 = get_wall_time();
                                fprintf(stderr, "Kernel %s runtime: %ldus\n",
                                        "eWiseAddMultEntry.segscan_27977",
                                        time_end_30474 - time_start_30473);
                            }
                        }
                        if (memblock_unref_device(ctx, &incprefixes_mem_29807,
                                                  "incprefixes_mem_29807") != 0)
                            return 1;
                        if (memblock_unref_device(ctx, &aggregates_mem_29805,
                                                  "aggregates_mem_29805") != 0)
                            return 1;
                        if (memblock_unref_device(ctx, &incprefixes_mem_29803,
                                                  "incprefixes_mem_29803") != 0)
                            return 1;
                        if (memblock_unref_device(ctx, &aggregates_mem_29801,
                                                  "aggregates_mem_29801") != 0)
                            return 1;
                        if (memblock_unref_device(ctx, &incprefixes_mem_29799,
                                                  "incprefixes_mem_29799") != 0)
                            return 1;
                        if (memblock_unref_device(ctx, &aggregates_mem_29797,
                                                  "aggregates_mem_29797") != 0)
                            return 1;
                        if (memblock_unref_device(ctx, &incprefixes_mem_29795,
                                                  "incprefixes_mem_29795") != 0)
                            return 1;
                        if (memblock_unref_device(ctx, &aggregates_mem_29793,
                                                  "aggregates_mem_29793") != 0)
                            return 1;
                        if (memblock_unref_device(ctx, &status_flags_mem_29791,
                                                  "status_flags_mem_29791") !=
                            0)
                            return 1;
                    }
                    
                    int64_t read_res_30493;
                    
                    {
                        cudaEvent_t *pevents = NULL;
                        
                        if (ctx->profiling && !ctx->profiling_paused) {
                            pevents = cuda_get_events(&ctx->cuda,
                                                      &ctx->copy_scalar_from_dev_runs,
                                                      &ctx->copy_scalar_from_dev_total_runtime);
                            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
                        }
                        CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30493,
                                                  mem_28623.mem + j_m_i_27250 *
                                                  sizeof(int64_t),
                                                  sizeof(int64_t)));
                        if (pevents != NULL)
                            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
                    }
                    if (futhark_context_sync(ctx) != 0)
                        return 1;
                    
                    int64_t last_res_27340 = read_res_30493;
                    int64_t read_res_30494;
                    
                    {
                        cudaEvent_t *pevents = NULL;
                        
                        if (ctx->profiling && !ctx->profiling_paused) {
                            pevents = cuda_get_events(&ctx->cuda,
                                                      &ctx->copy_scalar_from_dev_runs,
                                                      &ctx->copy_scalar_from_dev_total_runtime);
                            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
                        }
                        CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30494,
                                                  mem_28625.mem + j_m_i_27250 *
                                                  sizeof(int64_t),
                                                  sizeof(int64_t)));
                        if (pevents != NULL)
                            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
                    }
                    if (futhark_context_sync(ctx) != 0)
                        return 1;
                    
                    int64_t last_res_27341 = read_res_30494;
                    int64_t read_res_30495;
                    
                    {
                        cudaEvent_t *pevents = NULL;
                        
                        if (ctx->profiling && !ctx->profiling_paused) {
                            pevents = cuda_get_events(&ctx->cuda,
                                                      &ctx->copy_scalar_from_dev_runs,
                                                      &ctx->copy_scalar_from_dev_total_runtime);
                            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
                        }
                        CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30495,
                                                  mem_28627.mem + j_m_i_27250 *
                                                  sizeof(int64_t),
                                                  sizeof(int64_t)));
                        if (pevents != NULL)
                            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
                    }
                    if (futhark_context_sync(ctx) != 0)
                        return 1;
                    
                    int64_t last_res_27342 = read_res_30495;
                    struct memblock_device mem_28633;
                    
                    mem_28633.references = NULL;
                    if (memblock_alloc_device(ctx, &mem_28633, bytes_28603,
                                              "mem_28633")) {
                        err = 1;
                        goto cleanup;
                    }
                    {
                        cudaEvent_t *pevents = NULL;
                        
                        if (ctx->profiling && !ctx->profiling_paused) {
                            pevents = cuda_get_events(&ctx->cuda,
                                                      &ctx->copy_dev_to_dev_runs,
                                                      &ctx->copy_dev_to_dev_total_runtime);
                            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
                        }
                        CUDA_SUCCEED(cuMemcpy(mem_28633.mem + (int64_t) 0,
                                              mem_param_28611.mem + (int64_t) 0,
                                              conc_tmp_27249 *
                                              (int64_t) sizeof(int64_t)));
                        if (pevents != NULL)
                            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
                    }
                    
                    struct memblock_device mem_28635;
                    
                    mem_28635.references = NULL;
                    if (memblock_alloc_device(ctx, &mem_28635, bytes_28603,
                                              "mem_28635")) {
                        err = 1;
                        goto cleanup;
                    }
                    {
                        cudaEvent_t *pevents = NULL;
                        
                        if (ctx->profiling && !ctx->profiling_paused) {
                            pevents = cuda_get_events(&ctx->cuda,
                                                      &ctx->copy_dev_to_dev_runs,
                                                      &ctx->copy_dev_to_dev_total_runtime);
                            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
                        }
                        CUDA_SUCCEED(cuMemcpy(mem_28635.mem + (int64_t) 0,
                                              mem_param_28616.mem + (int64_t) 0,
                                              conc_tmp_27249 *
                                              (int64_t) sizeof(int64_t)));
                        if (pevents != NULL)
                            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
                    }
                    if (ctx->debugging)
                        fprintf(stderr, "%s\n", "\n# SegMap");
                    
                    CUdeviceptr kernel_arg_30499 = mem_param_28611.mem;
                    CUdeviceptr kernel_arg_30500 = mem_param_28616.mem;
                    CUdeviceptr kernel_arg_30501 = mem_28623.mem;
                    CUdeviceptr kernel_arg_30502 = mem_28625.mem;
                    CUdeviceptr kernel_arg_30503 = mem_28627.mem;
                    CUdeviceptr kernel_arg_30504 = mem_28629.mem;
                    CUdeviceptr kernel_arg_30505 = mem_28631.mem;
                    CUdeviceptr kernel_arg_30506 = mem_28633.mem;
                    CUdeviceptr kernel_arg_30507 = mem_28635.mem;
                    
                    if ((((((1 && segmap_usable_groups_27983 != 0) && 1 != 0) &&
                           1 != 0) && segmap_group_sizze_27982 != 0) && 1 !=
                         0) && 1 != 0) {
                        int perm[3] = {0, 1, 2};
                        
                        if (1 >= 1 << 16) {
                            perm[1] = perm[0];
                            perm[0] = 1;
                        }
                        if (1 >= 1 << 16) {
                            perm[2] = perm[0];
                            perm[0] = 2;
                        }
                        
                        size_t grid[3];
                        
                        grid[perm[0]] = segmap_usable_groups_27983;
                        grid[perm[1]] = 1;
                        grid[perm[2]] = 1;
                        
                        void *kernel_args_30496[] = {&ctx->global_failure,
                                                     &conc_tmp_27249,
                                                     &last_res_27340,
                                                     &last_res_27341,
                                                     &last_res_27342,
                                                     &kernel_arg_30499,
                                                     &kernel_arg_30500,
                                                     &kernel_arg_30501,
                                                     &kernel_arg_30502,
                                                     &kernel_arg_30503,
                                                     &kernel_arg_30504,
                                                     &kernel_arg_30505,
                                                     &kernel_arg_30506,
                                                     &kernel_arg_30507};
                        int64_t time_start_30497 = 0, time_end_30498 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(stderr, "Launching %s with grid size (",
                                    "eWiseAddMultEntry.segmap_27979");
                            fprintf(stderr, "%d", segmap_usable_groups_27983);
                            fprintf(stderr, ", ");
                            fprintf(stderr, "%d", 1);
                            fprintf(stderr, ", ");
                            fprintf(stderr, "%d", 1);
                            fprintf(stderr, ") and block size (");
                            fprintf(stderr, "%d", segmap_group_sizze_27982);
                            fprintf(stderr, ", ");
                            fprintf(stderr, "%d", 1);
                            fprintf(stderr, ", ");
                            fprintf(stderr, "%d", 1);
                            fprintf(stderr, ").\n");
                            time_start_30497 = get_wall_time();
                        }
                        
                        cudaEvent_t *pevents = NULL;
                        
                        if (ctx->profiling && !ctx->profiling_paused) {
                            pevents = cuda_get_events(&ctx->cuda,
                                                      &ctx->eWiseAddMultEntryzisegmap_27979_runs,
                                                      &ctx->eWiseAddMultEntryzisegmap_27979_total_runtime);
                            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
                        }
                        CUDA_SUCCEED(cuLaunchKernel(ctx->eWiseAddMultEntryzisegmap_27979,
                                                    grid[0], grid[1], grid[2],
                                                    segmap_group_sizze_27982, 1,
                                                    1, 0, NULL,
                                                    kernel_args_30496, NULL));
                        if (pevents != NULL)
                            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
                        if (ctx->debugging) {
                            CUDA_SUCCEED(cuCtxSynchronize());
                            time_end_30498 = get_wall_time();
                            fprintf(stderr, "Kernel %s runtime: %ldus\n",
                                    "eWiseAddMultEntry.segmap_27979",
                                    time_end_30498 - time_start_30497);
                        }
                    }
                    
                    struct memblock_device mem_param_tmp_29783;
                    
                    mem_param_tmp_29783.references = NULL;
                    if (memblock_set_device(ctx, &mem_param_tmp_29783,
                                            &mem_28633, "mem_28633") != 0)
                        return 1;
                    
                    struct memblock_device mem_param_tmp_29784;
                    
                    mem_param_tmp_29784.references = NULL;
                    if (memblock_set_device(ctx, &mem_param_tmp_29784,
                                            &mem_28635, "mem_28635") != 0)
                        return 1;
                    if (memblock_set_device(ctx, &mem_param_28611,
                                            &mem_param_tmp_29783,
                                            "mem_param_tmp_29783") != 0)
                        return 1;
                    if (memblock_set_device(ctx, &mem_param_28616,
                                            &mem_param_tmp_29784,
                                            "mem_param_tmp_29784") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_param_tmp_29784,
                                              "mem_param_tmp_29784") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_param_tmp_29783,
                                              "mem_param_tmp_29783") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28635, "mem_28635") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28633, "mem_28633") !=
                        0)
                        return 1;
                }
                if (memblock_set_device(ctx, &defunc_0_f_res_mem_28645,
                                        &mem_param_28611, "mem_param_28611") !=
                    0)
                    return 1;
                if (memblock_set_device(ctx, &defunc_0_f_res_mem_28650,
                                        &mem_param_28616, "mem_param_28616") !=
                    0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28623, "mem_28623") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28625, "mem_28625") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28627, "mem_28627") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28629, "mem_28629") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28631, "mem_28631") != 0)
                    return 1;
                
                int64_t segmap_usable_groups_28060 = sdiv_up64(conc_tmp_27249,
                                                               segmap_group_sizze_28059);
                struct memblock_device mem_28653;
                
                mem_28653.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28653, bytes_28603,
                                          "mem_28653")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28655;
                
                mem_28655.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28655, bytes_28603,
                                          "mem_28655")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28657;
                
                mem_28657.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28657, bytes_28603,
                                          "mem_28657")) {
                    err = 1;
                    goto cleanup;
                }
                if (ctx->debugging)
                    fprintf(stderr, "%s\n", "\n# SegMap");
                
                CUdeviceptr kernel_arg_30511 = rightColumns_mem_28235.mem;
                CUdeviceptr kernel_arg_30512 = mem_28341.mem;
                CUdeviceptr kernel_arg_30513 = defunc_0_f_res_mem_28650.mem;
                CUdeviceptr kernel_arg_30514 = mem_28653.mem;
                CUdeviceptr kernel_arg_30515 = mem_28655.mem;
                CUdeviceptr kernel_arg_30516 = mem_28657.mem;
                
                if ((((((1 && segmap_usable_groups_28060 != 0) && 1 != 0) &&
                       1 != 0) && segmap_group_sizze_28059 != 0) && 1 != 0) &&
                    1 != 0) {
                    int perm[3] = {0, 1, 2};
                    
                    if (1 >= 1 << 16) {
                        perm[1] = perm[0];
                        perm[0] = 1;
                    }
                    if (1 >= 1 << 16) {
                        perm[2] = perm[0];
                        perm[0] = 2;
                    }
                    
                    size_t grid[3];
                    
                    grid[perm[0]] = segmap_usable_groups_28060;
                    grid[perm[1]] = 1;
                    grid[perm[2]] = 1;
                    
                    void *kernel_args_30508[] = {&ctx->global_failure,
                                                 &ctx->failure_is_an_option,
                                                 &ctx->global_failure_args,
                                                 &i_27210, &i_27232,
                                                 &j_m_i_27234, &conc_tmp_27249,
                                                 &kernel_arg_30511,
                                                 &kernel_arg_30512,
                                                 &kernel_arg_30513,
                                                 &kernel_arg_30514,
                                                 &kernel_arg_30515,
                                                 &kernel_arg_30516};
                    int64_t time_start_30509 = 0, time_end_30510 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(stderr, "Launching %s with grid size (",
                                "eWiseAddMultEntry.segmap_28035");
                        fprintf(stderr, "%d", segmap_usable_groups_28060);
                        fprintf(stderr, ", ");
                        fprintf(stderr, "%d", 1);
                        fprintf(stderr, ", ");
                        fprintf(stderr, "%d", 1);
                        fprintf(stderr, ") and block size (");
                        fprintf(stderr, "%d", segmap_group_sizze_28059);
                        fprintf(stderr, ", ");
                        fprintf(stderr, "%d", 1);
                        fprintf(stderr, ", ");
                        fprintf(stderr, "%d", 1);
                        fprintf(stderr, ").\n");
                        time_start_30509 = get_wall_time();
                    }
                    
                    cudaEvent_t *pevents = NULL;
                    
                    if (ctx->profiling && !ctx->profiling_paused) {
                        pevents = cuda_get_events(&ctx->cuda,
                                                  &ctx->eWiseAddMultEntryzisegmap_28035_runs,
                                                  &ctx->eWiseAddMultEntryzisegmap_28035_total_runtime);
                        CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
                    }
                    CUDA_SUCCEED(cuLaunchKernel(ctx->eWiseAddMultEntryzisegmap_28035,
                                                grid[0], grid[1], grid[2],
                                                segmap_group_sizze_28059, 1, 1,
                                                0, NULL, kernel_args_30508,
                                                NULL));
                    if (pevents != NULL)
                        CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
                    if (ctx->debugging) {
                        CUDA_SUCCEED(cuCtxSynchronize());
                        time_end_30510 = get_wall_time();
                        fprintf(stderr, "Kernel %s runtime: %ldus\n",
                                "eWiseAddMultEntry.segmap_28035",
                                time_end_30510 - time_start_30509);
                    }
                }
                ctx->failure_is_an_option = 1;
                if (memblock_unref_device(ctx, &defunc_0_f_res_mem_28650,
                                          "defunc_0_f_res_mem_28650") != 0)
                    return 1;
                
                bool index_certs_27394;
                
                if (!ok_or_empty_27393) {
                    ctx->error =
                        msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                  "Index [", (int64_t) 1,
                                  ":] out of bounds for array of shape [",
                                  conc_tmp_27249, "].",
                                  "-> #0  sparse.fut:100:59-68\n   #1  sparse.fut:169:49-171:81\n   #2  sparse.fut:245:21-96\n   #3  sparse.fut:234:1-247:60\n");
                    if (memblock_unref_device(ctx, &mem_28657, "mem_28657") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28655, "mem_28655") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28653, "mem_28653") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_param_28616,
                                              "mem_param_28616") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_param_28611,
                                              "mem_param_28611") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &defunc_0_f_res_mem_28650,
                                              "defunc_0_f_res_mem_28650") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &defunc_0_f_res_mem_28645,
                                              "defunc_0_f_res_mem_28645") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28631, "mem_28631") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28629, "mem_28629") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28627, "mem_28627") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28625, "mem_28625") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28623, "mem_28623") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &intersectArrays_res_f_res_mem_28684,
                                              "intersectArrays_res_f_res_mem_28684") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &intersectArrays_res_f_res_mem_28681,
                                              "intersectArrays_res_f_res_mem_28681") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &intersectArrays_res_f_res_mem_28678,
                                              "intersectArrays_res_f_res_mem_28678") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28606, "mem_28606") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28604, "mem_28604") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &intersectArrays_res_mem_28693,
                                              "intersectArrays_res_mem_28693") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &intersectArrays_res_mem_28690,
                                              "intersectArrays_res_mem_28690") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &intersectArrays_res_mem_28687,
                                              "intersectArrays_res_mem_28687") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28588, "mem_28588") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28586, "mem_28586") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28584, "mem_28584") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &double_buffer_mem_28767,
                                              "double_buffer_mem_28767") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28501, "mem_28501") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28484, "mem_28484") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28493, "mem_28493") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28495, "mem_28495") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28497, "mem_28497") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28499, "mem_28499") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28563, "mem_28563") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &group_res_arr_mem_29638,
                                              "group_res_arr_mem_29638") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &group_res_arr_mem_29636,
                                              "group_res_arr_mem_29636") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &group_res_arr_mem_29634,
                                              "group_res_arr_mem_29634") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_29109, "mem_29109") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_29107, "mem_29107") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_29105, "mem_29105") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28582, "mem_28582") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28341, "mem_28341") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28339, "mem_28339") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                              "double_buffer_mem_28763") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28256, "mem_28256") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28239, "mem_28239") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28248, "mem_28248") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28250, "mem_28250") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28252, "mem_28252") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28254, "mem_28254") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28318, "mem_28318") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                              "group_res_arr_mem_29131") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                              "group_res_arr_mem_29129") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                              "group_res_arr_mem_29127") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_29026, "mem_29026") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_29024, "mem_29024") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_29022, "mem_29022") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28337, "mem_28337") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &out_mem_29123,
                                              "out_mem_29123") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &out_mem_29121,
                                              "out_mem_29121") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &out_mem_29119,
                                              "out_mem_29119") != 0)
                        return 1;
                    return 1;
                }
                
                struct memblock_device mem_28660;
                
                mem_28660.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28660, bytes_28669,
                                          "mem_28660")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28662;
                
                mem_28662.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28662, bytes_28669,
                                          "mem_28662")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28664;
                
                mem_28664.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28664, bytes_28669,
                                          "mem_28664")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28666;
                
                mem_28666.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28666, bytes_28669,
                                          "mem_28666")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28668;
                
                mem_28668.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28668, bytes_28669,
                                          "mem_28668")) {
                    err = 1;
                    goto cleanup;
                }
                if (slt64((int64_t) 0, j_m_i_27250)) {
                    if (ctx->debugging)
                        fprintf(stderr, "%s\n", "\n# SegScan");
                    
                    int64_t numThreads_30010;
                    
                    numThreads_30010 = sdiv_up64(j_m_i_27250,
                                                 segscan_group_sizze_28084 *
                                                 (int64_t) 9) *
                        segscan_group_sizze_28084;
                    
                    int64_t numGroups_30011;
                    
                    numGroups_30011 = sdiv_up64(j_m_i_27250,
                                                segscan_group_sizze_28084 *
                                                (int64_t) 9);
                    
                    struct memblock_device
                    eWiseAddMultEntryziid_counter_mem_30012 =
                    ctx->eWiseAddMultEntryziid_counter_mem_30012;
                    struct memblock_device status_flags_mem_30014;
                    
                    status_flags_mem_30014.references = NULL;
                    if (memblock_alloc_device(ctx, &status_flags_mem_30014,
                                              (int64_t) sizeof(int8_t) *
                                              numGroups_30011,
                                              "status_flags_mem_30014")) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    struct memblock_device aggregates_mem_30016;
                    
                    aggregates_mem_30016.references = NULL;
                    if (memblock_alloc_device(ctx, &aggregates_mem_30016,
                                              (int64_t) sizeof(int64_t) *
                                              numGroups_30011,
                                              "aggregates_mem_30016")) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    struct memblock_device incprefixes_mem_30018;
                    
                    incprefixes_mem_30018.references = NULL;
                    if (memblock_alloc_device(ctx, &incprefixes_mem_30018,
                                              (int64_t) sizeof(int64_t) *
                                              numGroups_30011,
                                              "incprefixes_mem_30018")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (futrts_builtinzhreplicate_i8(ctx,
                                                     status_flags_mem_30014,
                                                     numGroups_30011,
                                                     (int8_t) 0) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    unsigned int shared_sizze_30521 =
                                 smax64(smax64((int64_t) 288, (int64_t) 8 *
                                               segscan_group_sizze_28084),
                                        (int64_t) 9 *
                                        segscan_group_sizze_28084 *
                                        (int64_t) 8);
                    CUdeviceptr kernel_arg_30523 = mem_28653.mem;
                    CUdeviceptr kernel_arg_30524 = mem_28655.mem;
                    CUdeviceptr kernel_arg_30525 = mem_28657.mem;
                    CUdeviceptr kernel_arg_30526 = mem_28660.mem;
                    CUdeviceptr kernel_arg_30527 = mem_28662.mem;
                    CUdeviceptr kernel_arg_30528 = mem_28664.mem;
                    CUdeviceptr kernel_arg_30529 = mem_28666.mem;
                    CUdeviceptr kernel_arg_30530 = mem_28668.mem;
                    CUdeviceptr kernel_arg_30531 =
                                eWiseAddMultEntryziid_counter_mem_30012.mem;
                    CUdeviceptr kernel_arg_30532 = status_flags_mem_30014.mem;
                    CUdeviceptr kernel_arg_30533 = aggregates_mem_30016.mem;
                    CUdeviceptr kernel_arg_30534 = incprefixes_mem_30018.mem;
                    unsigned int shared_offset_30522 = 0;
                    
                    if ((((((1 && sdiv_up64(j_m_i_27250,
                                            segscan_group_sizze_28084 *
                                            (int64_t) 9) != 0) && 1 != 0) &&
                           1 != 0) && segscan_group_sizze_28084 != 0) && 1 !=
                         0) && 1 != 0) {
                        int perm[3] = {0, 1, 2};
                        
                        if (1 >= 1 << 16) {
                            perm[1] = perm[0];
                            perm[0] = 1;
                        }
                        if (1 >= 1 << 16) {
                            perm[2] = perm[0];
                            perm[0] = 2;
                        }
                        
                        size_t grid[3];
                        
                        grid[perm[0]] = sdiv_up64(j_m_i_27250,
                                                  segscan_group_sizze_28084 *
                                                  (int64_t) 9);
                        grid[perm[1]] = 1;
                        grid[perm[2]] = 1;
                        
                        void *kernel_args_30518[] = {&ctx->global_failure,
                                                     &ctx->failure_is_an_option,
                                                     &ctx->global_failure_args,
                                                     &shared_offset_30522,
                                                     &conc_tmp_27249,
                                                     &j_m_i_27250,
                                                     &kernel_arg_30523,
                                                     &kernel_arg_30524,
                                                     &kernel_arg_30525,
                                                     &kernel_arg_30526,
                                                     &kernel_arg_30527,
                                                     &kernel_arg_30528,
                                                     &kernel_arg_30529,
                                                     &kernel_arg_30530,
                                                     &kernel_arg_30531,
                                                     &kernel_arg_30532,
                                                     &kernel_arg_30533,
                                                     &kernel_arg_30534};
                        int64_t time_start_30519 = 0, time_end_30520 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(stderr, "Launching %s with grid size (",
                                    "eWiseAddMultEntry.segscan_28089");
                            fprintf(stderr, "%d", sdiv_up64(j_m_i_27250,
                                                            segscan_group_sizze_28084 *
                                                            (int64_t) 9));
                            fprintf(stderr, ", ");
                            fprintf(stderr, "%d", 1);
                            fprintf(stderr, ", ");
                            fprintf(stderr, "%d", 1);
                            fprintf(stderr, ") and block size (");
                            fprintf(stderr, "%d", segscan_group_sizze_28084);
                            fprintf(stderr, ", ");
                            fprintf(stderr, "%d", 1);
                            fprintf(stderr, ", ");
                            fprintf(stderr, "%d", 1);
                            fprintf(stderr, ").\n");
                            time_start_30519 = get_wall_time();
                        }
                        
                        cudaEvent_t *pevents = NULL;
                        
                        if (ctx->profiling && !ctx->profiling_paused) {
                            pevents = cuda_get_events(&ctx->cuda,
                                                      &ctx->eWiseAddMultEntryzisegscan_28089_runs,
                                                      &ctx->eWiseAddMultEntryzisegscan_28089_total_runtime);
                            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
                        }
                        CUDA_SUCCEED(cuLaunchKernel(ctx->eWiseAddMultEntryzisegscan_28089,
                                                    grid[0], grid[1], grid[2],
                                                    segscan_group_sizze_28084,
                                                    1, 1, 0 +
                                                    (shared_sizze_30521 + (8 -
                                                                           shared_sizze_30521 %
                                                                           8) %
                                                     8), NULL,
                                                    kernel_args_30518, NULL));
                        if (pevents != NULL)
                            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
                        if (ctx->debugging) {
                            CUDA_SUCCEED(cuCtxSynchronize());
                            time_end_30520 = get_wall_time();
                            fprintf(stderr, "Kernel %s runtime: %ldus\n",
                                    "eWiseAddMultEntry.segscan_28089",
                                    time_end_30520 - time_start_30519);
                        }
                    }
                    ctx->failure_is_an_option = 1;
                    if (memblock_unref_device(ctx, &incprefixes_mem_30018,
                                              "incprefixes_mem_30018") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &aggregates_mem_30016,
                                              "aggregates_mem_30016") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &status_flags_mem_30014,
                                              "status_flags_mem_30014") != 0)
                        return 1;
                }
                if (memblock_unref_device(ctx, &mem_28653, "mem_28653") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28655, "mem_28655") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28657, "mem_28657") != 0)
                    return 1;
                
                int64_t partition_sizze_27461;
                
                if (is_empty_27269) {
                    partition_sizze_27461 = (int64_t) 0;
                } else {
                    int64_t read_res_30535;
                    
                    {
                        cudaEvent_t *pevents = NULL;
                        
                        if (ctx->profiling && !ctx->profiling_paused) {
                            pevents = cuda_get_events(&ctx->cuda,
                                                      &ctx->copy_scalar_from_dev_runs,
                                                      &ctx->copy_scalar_from_dev_total_runtime);
                            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
                        }
                        CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30535,
                                                  mem_28660.mem +
                                                  last_index_27268 *
                                                  sizeof(int64_t),
                                                  sizeof(int64_t)));
                        if (pevents != NULL)
                            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
                    }
                    if (futhark_context_sync(ctx) != 0)
                        return 1;
                    
                    int64_t last_offset_27462 = read_res_30535;
                    
                    partition_sizze_27461 = last_offset_27462;
                }
                
                struct memblock_device mem_28670;
                
                mem_28670.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28670, bytes_28669,
                                          "mem_28670")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28672;
                
                mem_28672.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28672, bytes_28669,
                                          "mem_28672")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28674;
                
                mem_28674.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28674, bytes_28669,
                                          "mem_28674")) {
                    err = 1;
                    goto cleanup;
                }
                
                int64_t segmap_group_sizze_28094;
                
                segmap_group_sizze_28094 =
                    ctx->sizes.eWiseAddMultEntryzisegmap_group_sizze_28093;
                
                int64_t segmap_usable_groups_28095 = sdiv_up64(j_m_i_27250,
                                                               segmap_group_sizze_28094);
                
                if (ctx->debugging)
                    fprintf(stderr, "%s\n", "\n# SegMap");
                
                CUdeviceptr kernel_arg_30539 = mem_28660.mem;
                CUdeviceptr kernel_arg_30540 = mem_28662.mem;
                CUdeviceptr kernel_arg_30541 = mem_28664.mem;
                CUdeviceptr kernel_arg_30542 = mem_28666.mem;
                CUdeviceptr kernel_arg_30543 = mem_28668.mem;
                CUdeviceptr kernel_arg_30544 = mem_28670.mem;
                CUdeviceptr kernel_arg_30545 = mem_28672.mem;
                CUdeviceptr kernel_arg_30546 = mem_28674.mem;
                
                if ((((((1 && segmap_usable_groups_28095 != 0) && 1 != 0) &&
                       1 != 0) && segmap_group_sizze_28094 != 0) && 1 != 0) &&
                    1 != 0) {
                    int perm[3] = {0, 1, 2};
                    
                    if (1 >= 1 << 16) {
                        perm[1] = perm[0];
                        perm[0] = 1;
                    }
                    if (1 >= 1 << 16) {
                        perm[2] = perm[0];
                        perm[0] = 2;
                    }
                    
                    size_t grid[3];
                    
                    grid[perm[0]] = segmap_usable_groups_28095;
                    grid[perm[1]] = 1;
                    grid[perm[2]] = 1;
                    
                    void *kernel_args_30536[] = {&ctx->global_failure,
                                                 &j_m_i_27250,
                                                 &kernel_arg_30539,
                                                 &kernel_arg_30540,
                                                 &kernel_arg_30541,
                                                 &kernel_arg_30542,
                                                 &kernel_arg_30543,
                                                 &kernel_arg_30544,
                                                 &kernel_arg_30545,
                                                 &kernel_arg_30546};
                    int64_t time_start_30537 = 0, time_end_30538 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(stderr, "Launching %s with grid size (",
                                "eWiseAddMultEntry.segmap_28091");
                        fprintf(stderr, "%d", segmap_usable_groups_28095);
                        fprintf(stderr, ", ");
                        fprintf(stderr, "%d", 1);
                        fprintf(stderr, ", ");
                        fprintf(stderr, "%d", 1);
                        fprintf(stderr, ") and block size (");
                        fprintf(stderr, "%d", segmap_group_sizze_28094);
                        fprintf(stderr, ", ");
                        fprintf(stderr, "%d", 1);
                        fprintf(stderr, ", ");
                        fprintf(stderr, "%d", 1);
                        fprintf(stderr, ").\n");
                        time_start_30537 = get_wall_time();
                    }
                    
                    cudaEvent_t *pevents = NULL;
                    
                    if (ctx->profiling && !ctx->profiling_paused) {
                        pevents = cuda_get_events(&ctx->cuda,
                                                  &ctx->eWiseAddMultEntryzisegmap_28091_runs,
                                                  &ctx->eWiseAddMultEntryzisegmap_28091_total_runtime);
                        CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
                    }
                    CUDA_SUCCEED(cuLaunchKernel(ctx->eWiseAddMultEntryzisegmap_28091,
                                                grid[0], grid[1], grid[2],
                                                segmap_group_sizze_28094, 1, 1,
                                                0, NULL, kernel_args_30536,
                                                NULL));
                    if (pevents != NULL)
                        CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
                    if (ctx->debugging) {
                        CUDA_SUCCEED(cuCtxSynchronize());
                        time_end_30538 = get_wall_time();
                        fprintf(stderr, "Kernel %s runtime: %ldus\n",
                                "eWiseAddMultEntry.segmap_28091",
                                time_end_30538 - time_start_30537);
                    }
                }
                if (memblock_unref_device(ctx, &mem_28660, "mem_28660") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28662, "mem_28662") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28664, "mem_28664") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28666, "mem_28666") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28668, "mem_28668") != 0)
                    return 1;
                
                bool empty_slice_27477 = partition_sizze_27461 == (int64_t) 0;
                int64_t m_27478 = sub64(partition_sizze_27461, (int64_t) 1);
                bool zzero_leq_i_p_m_t_s_27479 = sle64((int64_t) 0, m_27478);
                bool i_p_m_t_s_leq_w_27480 = slt64(m_27478, j_m_i_27250);
                bool i_lte_j_27481 = sle64((int64_t) 0, partition_sizze_27461);
                bool y_27482 = zzero_leq_i_p_m_t_s_27479 &&
                     i_p_m_t_s_leq_w_27480;
                bool y_27483 = i_lte_j_27481 && y_27482;
                bool ok_or_empty_27484 = empty_slice_27477 || y_27483;
                bool index_certs_27485;
                
                if (!ok_or_empty_27484) {
                    ctx->error =
                        msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                  "Index [:", partition_sizze_27461,
                                  "] out of bounds for array of shape [",
                                  j_m_i_27250, "].",
                                  "-> #0  /prelude/soacs.fut:141:6-16\n   #1  sparse.fut:90:3-100:69\n   #2  sparse.fut:169:49-171:81\n   #3  sparse.fut:245:21-96\n   #4  sparse.fut:234:1-247:60\n");
                    if (memblock_unref_device(ctx, &mem_28674, "mem_28674") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28672, "mem_28672") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28670, "mem_28670") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28668, "mem_28668") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28666, "mem_28666") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28664, "mem_28664") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28662, "mem_28662") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28660, "mem_28660") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28657, "mem_28657") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28655, "mem_28655") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28653, "mem_28653") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_param_28616,
                                              "mem_param_28616") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_param_28611,
                                              "mem_param_28611") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &defunc_0_f_res_mem_28650,
                                              "defunc_0_f_res_mem_28650") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &defunc_0_f_res_mem_28645,
                                              "defunc_0_f_res_mem_28645") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28631, "mem_28631") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28629, "mem_28629") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28627, "mem_28627") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28625, "mem_28625") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28623, "mem_28623") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &intersectArrays_res_f_res_mem_28684,
                                              "intersectArrays_res_f_res_mem_28684") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &intersectArrays_res_f_res_mem_28681,
                                              "intersectArrays_res_f_res_mem_28681") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &intersectArrays_res_f_res_mem_28678,
                                              "intersectArrays_res_f_res_mem_28678") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28606, "mem_28606") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28604, "mem_28604") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &intersectArrays_res_mem_28693,
                                              "intersectArrays_res_mem_28693") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &intersectArrays_res_mem_28690,
                                              "intersectArrays_res_mem_28690") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &intersectArrays_res_mem_28687,
                                              "intersectArrays_res_mem_28687") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28588, "mem_28588") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28586, "mem_28586") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28584, "mem_28584") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &double_buffer_mem_28767,
                                              "double_buffer_mem_28767") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28501, "mem_28501") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28484, "mem_28484") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28493, "mem_28493") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28495, "mem_28495") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28497, "mem_28497") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28499, "mem_28499") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28563, "mem_28563") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &group_res_arr_mem_29638,
                                              "group_res_arr_mem_29638") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &group_res_arr_mem_29636,
                                              "group_res_arr_mem_29636") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &group_res_arr_mem_29634,
                                              "group_res_arr_mem_29634") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_29109, "mem_29109") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_29107, "mem_29107") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_29105, "mem_29105") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28582, "mem_28582") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28341, "mem_28341") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28339, "mem_28339") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                              "double_buffer_mem_28763") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28256, "mem_28256") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28239, "mem_28239") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28248, "mem_28248") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28250, "mem_28250") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28252, "mem_28252") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28254, "mem_28254") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28318, "mem_28318") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                              "group_res_arr_mem_29131") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                              "group_res_arr_mem_29129") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                              "group_res_arr_mem_29127") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_29026, "mem_29026") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_29024, "mem_29024") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_29022, "mem_29022") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28337, "mem_28337") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &out_mem_29123,
                                              "out_mem_29123") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &out_mem_29121,
                                              "out_mem_29121") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &out_mem_29119,
                                              "out_mem_29119") != 0)
                        return 1;
                    return 1;
                }
                sizze_27270 = partition_sizze_27461;
                sizze_27271 = partition_sizze_27461;
                sizze_27272 = partition_sizze_27461;
                intersectArrays_res_f_res_ixfn_28676 = partition_sizze_27461;
                intersectArrays_res_f_res_ixfn_28679 = partition_sizze_27461;
                intersectArrays_res_f_res_ixfn_28682 = partition_sizze_27461;
                if (memblock_set_device(ctx,
                                        &intersectArrays_res_f_res_mem_28678,
                                        &mem_28670, "mem_28670") != 0)
                    return 1;
                if (memblock_set_device(ctx,
                                        &intersectArrays_res_f_res_mem_28681,
                                        &mem_28672, "mem_28672") != 0)
                    return 1;
                if (memblock_set_device(ctx,
                                        &intersectArrays_res_f_res_mem_28684,
                                        &mem_28674, "mem_28674") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28674, "mem_28674") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28672, "mem_28672") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28670, "mem_28670") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28668, "mem_28668") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28666, "mem_28666") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28664, "mem_28664") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28662, "mem_28662") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28660, "mem_28660") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28657, "mem_28657") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28655, "mem_28655") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28653, "mem_28653") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_28616,
                                          "mem_param_28616") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_28611,
                                          "mem_param_28611") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &defunc_0_f_res_mem_28650,
                                          "defunc_0_f_res_mem_28650") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &defunc_0_f_res_mem_28645,
                                          "defunc_0_f_res_mem_28645") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28631, "mem_28631") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28629, "mem_28629") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28627, "mem_28627") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28625, "mem_28625") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28623, "mem_28623") != 0)
                    return 1;
            }
            if (memblock_unref_device(ctx, &mem_28604, "mem_28604") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28606, "mem_28606") != 0)
                return 1;
            sizze_27251 = sizze_27270;
            sizze_27252 = sizze_27271;
            sizze_27253 = sizze_27272;
            intersectArrays_res_ixfn_28685 =
                intersectArrays_res_f_res_ixfn_28676;
            intersectArrays_res_ixfn_28686 =
                intersectArrays_res_f_res_ixfn_28677;
            intersectArrays_res_ixfn_28688 =
                intersectArrays_res_f_res_ixfn_28679;
            intersectArrays_res_ixfn_28689 =
                intersectArrays_res_f_res_ixfn_28677;
            intersectArrays_res_ixfn_28691 =
                intersectArrays_res_f_res_ixfn_28682;
            intersectArrays_res_ixfn_28692 =
                intersectArrays_res_f_res_ixfn_28677;
            if (memblock_set_device(ctx, &intersectArrays_res_mem_28687,
                                    &intersectArrays_res_f_res_mem_28678,
                                    "intersectArrays_res_f_res_mem_28678") != 0)
                return 1;
            if (memblock_set_device(ctx, &intersectArrays_res_mem_28690,
                                    &intersectArrays_res_f_res_mem_28681,
                                    "intersectArrays_res_f_res_mem_28681") != 0)
                return 1;
            if (memblock_set_device(ctx, &intersectArrays_res_mem_28693,
                                    &intersectArrays_res_f_res_mem_28684,
                                    "intersectArrays_res_f_res_mem_28684") != 0)
                return 1;
            if (memblock_unref_device(ctx, &intersectArrays_res_f_res_mem_28684,
                                      "intersectArrays_res_f_res_mem_28684") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &intersectArrays_res_f_res_mem_28681,
                                      "intersectArrays_res_f_res_mem_28681") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &intersectArrays_res_f_res_mem_28678,
                                      "intersectArrays_res_f_res_mem_28678") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28606, "mem_28606") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28604, "mem_28604") != 0)
                return 1;
        }
        
        bool dim_match_27489 = sizze_27251 == sizze_27252;
        bool empty_or_match_cert_27490;
        
        if (!dim_match_27489) {
            ctx->error = msgprintf("Error: %s\n\nBacktrace:\n%s",
                                   "Function return value does not match shape of declared return type.",
                                   "-> #0  sparse.fut:81:7-100:69\n   #1  sparse.fut:169:49-171:81\n   #2  sparse.fut:245:21-96\n   #3  sparse.fut:234:1-247:60\n");
            if (memblock_unref_device(ctx, &intersectArrays_res_mem_28693,
                                      "intersectArrays_res_mem_28693") != 0)
                return 1;
            if (memblock_unref_device(ctx, &intersectArrays_res_mem_28690,
                                      "intersectArrays_res_mem_28690") != 0)
                return 1;
            if (memblock_unref_device(ctx, &intersectArrays_res_mem_28687,
                                      "intersectArrays_res_mem_28687") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28588, "mem_28588") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28586, "mem_28586") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28584, "mem_28584") != 0)
                return 1;
            if (memblock_unref_device(ctx, &double_buffer_mem_28767,
                                      "double_buffer_mem_28767") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28501, "mem_28501") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28484, "mem_28484") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28493, "mem_28493") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28495, "mem_28495") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28497, "mem_28497") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28499, "mem_28499") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28563, "mem_28563") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29638,
                                      "group_res_arr_mem_29638") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29636,
                                      "group_res_arr_mem_29636") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29634,
                                      "group_res_arr_mem_29634") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29109, "mem_29109") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29107, "mem_29107") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29105, "mem_29105") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28582, "mem_28582") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28341, "mem_28341") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28339, "mem_28339") != 0)
                return 1;
            if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                      "double_buffer_mem_28763") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28256, "mem_28256") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28248, "mem_28248") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28250, "mem_28250") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28254, "mem_28254") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28318, "mem_28318") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                      "group_res_arr_mem_29131") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                      "group_res_arr_mem_29129") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                      "group_res_arr_mem_29127") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29026, "mem_29026") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29024, "mem_29024") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29022, "mem_29022") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28337, "mem_28337") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29123, "out_mem_29123") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29121, "out_mem_29121") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29119, "out_mem_29119") !=
                0)
                return 1;
            return 1;
        }
        
        bool dim_match_27491 = sizze_27251 == sizze_27253;
        bool empty_or_match_cert_27492;
        
        if (!dim_match_27491) {
            ctx->error = msgprintf("Error: %s\n\nBacktrace:\n%s",
                                   "Function return value does not match shape of declared return type.",
                                   "-> #0  sparse.fut:81:7-100:69\n   #1  sparse.fut:169:49-171:81\n   #2  sparse.fut:245:21-96\n   #3  sparse.fut:234:1-247:60\n");
            if (memblock_unref_device(ctx, &intersectArrays_res_mem_28693,
                                      "intersectArrays_res_mem_28693") != 0)
                return 1;
            if (memblock_unref_device(ctx, &intersectArrays_res_mem_28690,
                                      "intersectArrays_res_mem_28690") != 0)
                return 1;
            if (memblock_unref_device(ctx, &intersectArrays_res_mem_28687,
                                      "intersectArrays_res_mem_28687") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28588, "mem_28588") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28586, "mem_28586") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28584, "mem_28584") != 0)
                return 1;
            if (memblock_unref_device(ctx, &double_buffer_mem_28767,
                                      "double_buffer_mem_28767") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28501, "mem_28501") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28484, "mem_28484") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28493, "mem_28493") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28495, "mem_28495") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28497, "mem_28497") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28499, "mem_28499") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28563, "mem_28563") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29638,
                                      "group_res_arr_mem_29638") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29636,
                                      "group_res_arr_mem_29636") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29634,
                                      "group_res_arr_mem_29634") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29109, "mem_29109") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29107, "mem_29107") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29105, "mem_29105") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28582, "mem_28582") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28341, "mem_28341") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28339, "mem_28339") != 0)
                return 1;
            if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                      "double_buffer_mem_28763") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28256, "mem_28256") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28248, "mem_28248") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28250, "mem_28250") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28254, "mem_28254") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28318, "mem_28318") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                      "group_res_arr_mem_29131") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                      "group_res_arr_mem_29129") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                      "group_res_arr_mem_29127") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29026, "mem_29026") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29024, "mem_29024") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29022, "mem_29022") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28337, "mem_28337") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29123, "out_mem_29123") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29121, "out_mem_29121") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29119, "out_mem_29119") !=
                0)
                return 1;
            return 1;
        }
        
        int64_t read_res_30547;
        
        {
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->copy_scalar_from_dev_runs,
                                          &ctx->copy_scalar_from_dev_total_runtime);
                CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30547, mem_28582.mem + i_27211 *
                                      sizeof(int64_t), sizeof(int64_t)));
            if (pevents != NULL)
                CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
        }
        if (futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t x_27493 = read_res_30547;
        int64_t read_res_30548;
        
        {
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->copy_scalar_from_dev_runs,
                                          &ctx->copy_scalar_from_dev_total_runtime);
                CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30548, mem_28582.mem + i_27205 *
                                      sizeof(int64_t), sizeof(int64_t)));
            if (pevents != NULL)
                CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
        }
        if (futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t y_27494 = read_res_30548;
        int64_t indxs_27495 = sub64(x_27493, y_27494);
        bool bounds_invalid_upwards_27496 = slt64(x_27493, y_27494);
        bool valid_27497 = !bounds_invalid_upwards_27496;
        bool range_valid_c_27498;
        
        if (!valid_27497) {
            ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                   "Range ", y_27494, "..<", x_27493,
                                   " is invalid.",
                                   "-> #0  sparse.fut:173:18-42\n   #1  sparse.fut:245:21-96\n   #2  sparse.fut:234:1-247:60\n");
            if (memblock_unref_device(ctx, &intersectArrays_res_mem_28693,
                                      "intersectArrays_res_mem_28693") != 0)
                return 1;
            if (memblock_unref_device(ctx, &intersectArrays_res_mem_28690,
                                      "intersectArrays_res_mem_28690") != 0)
                return 1;
            if (memblock_unref_device(ctx, &intersectArrays_res_mem_28687,
                                      "intersectArrays_res_mem_28687") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28588, "mem_28588") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28586, "mem_28586") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28584, "mem_28584") != 0)
                return 1;
            if (memblock_unref_device(ctx, &double_buffer_mem_28767,
                                      "double_buffer_mem_28767") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28501, "mem_28501") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28484, "mem_28484") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28493, "mem_28493") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28495, "mem_28495") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28497, "mem_28497") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28499, "mem_28499") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28563, "mem_28563") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29638,
                                      "group_res_arr_mem_29638") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29636,
                                      "group_res_arr_mem_29636") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29634,
                                      "group_res_arr_mem_29634") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29109, "mem_29109") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29107, "mem_29107") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29105, "mem_29105") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28582, "mem_28582") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28341, "mem_28341") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28339, "mem_28339") != 0)
                return 1;
            if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                      "double_buffer_mem_28763") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28256, "mem_28256") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28248, "mem_28248") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28250, "mem_28250") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28254, "mem_28254") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28318, "mem_28318") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                      "group_res_arr_mem_29131") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                      "group_res_arr_mem_29129") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                      "group_res_arr_mem_29127") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29026, "mem_29026") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29024, "mem_29024") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29022, "mem_29022") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28337, "mem_28337") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29123, "out_mem_29123") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29121, "out_mem_29121") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29119, "out_mem_29119") !=
                0)
                return 1;
            return 1;
        }
        
        bool dim_match_27500 = indxs_27495 == sizze_27251;
        bool empty_or_match_cert_27501;
        
        if (!dim_match_27500) {
            ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                   "Value of (core language) shape (",
                                   sizze_27251,
                                   ") cannot match shape of type `[",
                                   indxs_27495, "]index`.",
                                   "-> #0  sparse.fut:177:26-51\n   #1  sparse.fut:245:21-96\n   #2  sparse.fut:234:1-247:60\n");
            if (memblock_unref_device(ctx, &intersectArrays_res_mem_28693,
                                      "intersectArrays_res_mem_28693") != 0)
                return 1;
            if (memblock_unref_device(ctx, &intersectArrays_res_mem_28690,
                                      "intersectArrays_res_mem_28690") != 0)
                return 1;
            if (memblock_unref_device(ctx, &intersectArrays_res_mem_28687,
                                      "intersectArrays_res_mem_28687") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28588, "mem_28588") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28586, "mem_28586") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28584, "mem_28584") != 0)
                return 1;
            if (memblock_unref_device(ctx, &double_buffer_mem_28767,
                                      "double_buffer_mem_28767") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28501, "mem_28501") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28484, "mem_28484") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28493, "mem_28493") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28495, "mem_28495") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28497, "mem_28497") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28499, "mem_28499") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28563, "mem_28563") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29638,
                                      "group_res_arr_mem_29638") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29636,
                                      "group_res_arr_mem_29636") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29634,
                                      "group_res_arr_mem_29634") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29109, "mem_29109") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29107, "mem_29107") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29105, "mem_29105") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28582, "mem_28582") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28341, "mem_28341") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28339, "mem_28339") != 0)
                return 1;
            if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                      "double_buffer_mem_28763") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28256, "mem_28256") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28248, "mem_28248") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28250, "mem_28250") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28254, "mem_28254") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28318, "mem_28318") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                      "group_res_arr_mem_29131") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                      "group_res_arr_mem_29129") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                      "group_res_arr_mem_29127") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29026, "mem_29026") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29024, "mem_29024") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29022, "mem_29022") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28337, "mem_28337") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29123, "out_mem_29123") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29121, "out_mem_29121") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29119, "out_mem_29119") !=
                0)
                return 1;
            return 1;
        }
        
        bool empty_or_match_cert_27502;
        
        if (!dim_match_27500) {
            ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                   "Value of (core language) shape (",
                                   sizze_27251,
                                   ") cannot match shape of type `[",
                                   indxs_27495, "]t`.",
                                   "-> #0  sparse.fut:178:25-181:75\n   #1  sparse.fut:245:21-96\n   #2  sparse.fut:234:1-247:60\n");
            if (memblock_unref_device(ctx, &intersectArrays_res_mem_28693,
                                      "intersectArrays_res_mem_28693") != 0)
                return 1;
            if (memblock_unref_device(ctx, &intersectArrays_res_mem_28690,
                                      "intersectArrays_res_mem_28690") != 0)
                return 1;
            if (memblock_unref_device(ctx, &intersectArrays_res_mem_28687,
                                      "intersectArrays_res_mem_28687") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28588, "mem_28588") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28586, "mem_28586") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28584, "mem_28584") != 0)
                return 1;
            if (memblock_unref_device(ctx, &double_buffer_mem_28767,
                                      "double_buffer_mem_28767") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28501, "mem_28501") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28484, "mem_28484") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28493, "mem_28493") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28495, "mem_28495") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28497, "mem_28497") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28499, "mem_28499") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28563, "mem_28563") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29638,
                                      "group_res_arr_mem_29638") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29636,
                                      "group_res_arr_mem_29636") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29634,
                                      "group_res_arr_mem_29634") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29109, "mem_29109") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29107, "mem_29107") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29105, "mem_29105") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28582, "mem_28582") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28341, "mem_28341") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28339, "mem_28339") != 0)
                return 1;
            if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                      "double_buffer_mem_28763") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28256, "mem_28256") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28248, "mem_28248") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28250, "mem_28250") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28254, "mem_28254") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28318, "mem_28318") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                      "group_res_arr_mem_29131") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                      "group_res_arr_mem_29129") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                      "group_res_arr_mem_29127") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29026, "mem_29026") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29024, "mem_29024") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_29022, "mem_29022") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28337, "mem_28337") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29123, "out_mem_29123") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29121, "out_mem_29121") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29119, "out_mem_29119") !=
                0)
                return 1;
            return 1;
        }
        
        int64_t segmap_usable_groups_28101 = sdiv_up64(indxs_27495,
                                                       segmap_group_sizze_28100);
        
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegMap");
        
        CUdeviceptr kernel_arg_30552 = rightValues_mem_28234.mem;
        CUdeviceptr kernel_arg_30553 = mem_28339.mem;
        CUdeviceptr kernel_arg_30554 = mem_28584.mem;
        CUdeviceptr kernel_arg_30555 = mem_28586.mem;
        CUdeviceptr kernel_arg_30556 = intersectArrays_res_mem_28687.mem;
        CUdeviceptr kernel_arg_30557 = intersectArrays_res_mem_28690.mem;
        CUdeviceptr kernel_arg_30558 = intersectArrays_res_mem_28693.mem;
        
        if ((((((1 && segmap_usable_groups_28101 != 0) && 1 != 0) && 1 != 0) &&
              segmap_group_sizze_28100 != 0) && 1 != 0) && 1 != 0) {
            int perm[3] = {0, 1, 2};
            
            if (1 >= 1 << 16) {
                perm[1] = perm[0];
                perm[0] = 1;
            }
            if (1 >= 1 << 16) {
                perm[2] = perm[0];
                perm[0] = 2;
            }
            
            size_t grid[3];
            
            grid[perm[0]] = segmap_usable_groups_28101;
            grid[perm[1]] = 1;
            grid[perm[2]] = 1;
            
            void *kernel_args_30549[] = {&ctx->global_failure,
                                         &ctx->failure_is_an_option,
                                         &ctx->global_failure_args, &k_26409,
                                         &eWiseAddOffsets_res_26600,
                                         &eWiseMultOffsets_res_27196, &i_27210,
                                         &i_27232, &sizze_27251, &y_27494,
                                         &indxs_27495, &kernel_arg_30552,
                                         &kernel_arg_30553, &kernel_arg_30554,
                                         &kernel_arg_30555, &kernel_arg_30556,
                                         &kernel_arg_30557, &kernel_arg_30558};
            int64_t time_start_30550 = 0, time_end_30551 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with grid size (",
                        "eWiseAddMultEntry.segmap_28097");
                fprintf(stderr, "%d", segmap_usable_groups_28101);
                fprintf(stderr, ", ");
                fprintf(stderr, "%d", 1);
                fprintf(stderr, ", ");
                fprintf(stderr, "%d", 1);
                fprintf(stderr, ") and block size (");
                fprintf(stderr, "%d", segmap_group_sizze_28100);
                fprintf(stderr, ", ");
                fprintf(stderr, "%d", 1);
                fprintf(stderr, ", ");
                fprintf(stderr, "%d", 1);
                fprintf(stderr, ").\n");
                time_start_30550 = get_wall_time();
            }
            
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->eWiseAddMultEntryzisegmap_28097_runs,
                                          &ctx->eWiseAddMultEntryzisegmap_28097_total_runtime);
                CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED(cuLaunchKernel(ctx->eWiseAddMultEntryzisegmap_28097,
                                        grid[0], grid[1], grid[2],
                                        segmap_group_sizze_28100, 1, 1, 0, NULL,
                                        kernel_args_30549, NULL));
            if (pevents != NULL)
                CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
            if (ctx->debugging) {
                CUDA_SUCCEED(cuCtxSynchronize());
                time_end_30551 = get_wall_time();
                fprintf(stderr, "Kernel %s runtime: %ldus\n",
                        "eWiseAddMultEntry.segmap_28097", time_end_30551 -
                        time_start_30550);
            }
        }
        ctx->failure_is_an_option = 1;
        if (memblock_unref_device(ctx, &intersectArrays_res_mem_28687,
                                  "intersectArrays_res_mem_28687") != 0)
            return 1;
        if (memblock_unref_device(ctx, &intersectArrays_res_mem_28690,
                                  "intersectArrays_res_mem_28690") != 0)
            return 1;
        if (memblock_unref_device(ctx, &intersectArrays_res_mem_28693,
                                  "intersectArrays_res_mem_28693") != 0)
            return 1;
        if (memblock_unref_device(ctx, &intersectArrays_res_mem_28693,
                                  "intersectArrays_res_mem_28693") != 0)
            return 1;
        if (memblock_unref_device(ctx, &intersectArrays_res_mem_28690,
                                  "intersectArrays_res_mem_28690") != 0)
            return 1;
        if (memblock_unref_device(ctx, &intersectArrays_res_mem_28687,
                                  "intersectArrays_res_mem_28687") != 0)
            return 1;
    }
    if (memblock_unref_device(ctx, &mem_28337, "mem_28337") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28339, "mem_28339") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28341, "mem_28341") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28588, "mem_28588") != 0)
        return 1;
    
    struct memblock_device mem_28706;
    
    mem_28706.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28706, bytes_28583, "mem_28706")) {
        err = 1;
        goto cleanup;
    }
    {
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda, &ctx->copy_dev_to_dev_runs,
                                      &ctx->copy_dev_to_dev_total_runtime);
            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED(cuMemcpy(mem_28706.mem + (int64_t) 0, mem_28584.mem +
                              (int64_t) 0, eWiseMultOffsets_res_27196 *
                              (int64_t) sizeof(double)));
        if (pevents != NULL)
            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
    }
    if (memblock_unref_device(ctx, &mem_28584, "mem_28584") != 0)
        return 1;
    
    struct memblock_device mem_28709;
    
    mem_28709.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28709, bytes_28583, "mem_28709")) {
        err = 1;
        goto cleanup;
    }
    {
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda, &ctx->copy_dev_to_dev_runs,
                                      &ctx->copy_dev_to_dev_total_runtime);
            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED(cuMemcpy(mem_28709.mem + (int64_t) 0, mem_28586.mem +
                              (int64_t) 0, eWiseMultOffsets_res_27196 *
                              (int64_t) sizeof(int64_t)));
        if (pevents != NULL)
            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
    }
    if (memblock_unref_device(ctx, &mem_28586, "mem_28586") != 0)
        return 1;
    out_arrsizze_29120 = eWiseMultOffsets_res_27196;
    out_arrsizze_29122 = eWiseMultOffsets_res_27196;
    if (memblock_set_device(ctx, &out_mem_29119, &mem_28706, "mem_28706") != 0)
        return 1;
    if (memblock_set_device(ctx, &out_mem_29121, &mem_28709, "mem_28709") != 0)
        return 1;
    if (memblock_set_device(ctx, &out_mem_29123, &mem_28582, "mem_28582") != 0)
        return 1;
    (*out_mem_p_30268).references = NULL;
    if (memblock_set_device(ctx, &*out_mem_p_30268, &out_mem_29119,
                            "out_mem_29119") != 0)
        return 1;
    *out_out_arrsizze_30269 = out_arrsizze_29120;
    (*out_mem_p_30270).references = NULL;
    if (memblock_set_device(ctx, &*out_mem_p_30270, &out_mem_29121,
                            "out_mem_29121") != 0)
        return 1;
    *out_out_arrsizze_30271 = out_arrsizze_29122;
    (*out_mem_p_30272).references = NULL;
    if (memblock_set_device(ctx, &*out_mem_p_30272, &out_mem_29123,
                            "out_mem_29123") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28709, "mem_28709") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28706, "mem_28706") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28588, "mem_28588") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28586, "mem_28586") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28584, "mem_28584") != 0)
        return 1;
    if (memblock_unref_device(ctx, &double_buffer_mem_28767,
                              "double_buffer_mem_28767") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28501, "mem_28501") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28484, "mem_28484") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28493, "mem_28493") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28495, "mem_28495") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28497, "mem_28497") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28499, "mem_28499") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28563, "mem_28563") != 0)
        return 1;
    if (memblock_unref_device(ctx, &group_res_arr_mem_29638,
                              "group_res_arr_mem_29638") != 0)
        return 1;
    if (memblock_unref_device(ctx, &group_res_arr_mem_29636,
                              "group_res_arr_mem_29636") != 0)
        return 1;
    if (memblock_unref_device(ctx, &group_res_arr_mem_29634,
                              "group_res_arr_mem_29634") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_29109, "mem_29109") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_29107, "mem_29107") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_29105, "mem_29105") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28582, "mem_28582") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28341, "mem_28341") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28339, "mem_28339") != 0)
        return 1;
    if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                              "double_buffer_mem_28763") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28256, "mem_28256") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28248, "mem_28248") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28250, "mem_28250") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28254, "mem_28254") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28318, "mem_28318") != 0)
        return 1;
    if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                              "group_res_arr_mem_29131") != 0)
        return 1;
    if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                              "group_res_arr_mem_29129") != 0)
        return 1;
    if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                              "group_res_arr_mem_29127") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_29026, "mem_29026") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_29024, "mem_29024") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_29022, "mem_29022") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28337, "mem_28337") != 0)
        return 1;
    if (memblock_unref_device(ctx, &out_mem_29123, "out_mem_29123") != 0)
        return 1;
    if (memblock_unref_device(ctx, &out_mem_29121, "out_mem_29121") != 0)
        return 1;
    if (memblock_unref_device(ctx, &out_mem_29119, "out_mem_29119") != 0)
        return 1;
    
  cleanup:
    { }
    return err;
}
static int futrts_eWiseMultEntry(struct futhark_context *ctx,
                                 struct memblock_device *out_mem_p_30559,
                                 int64_t *out_out_arrsizze_30560,
                                 struct memblock_device *out_mem_p_30561,
                                 int64_t *out_out_arrsizze_30562,
                                 struct memblock_device *out_mem_p_30563,
                                 struct memblock_device leftValues_mem_28231,
                                 struct memblock_device leftColumns_mem_28232,
                                 struct memblock_device leftOffsets_mem_28233,
                                 struct memblock_device rightValues_mem_28234,
                                 struct memblock_device rightColumns_mem_28235,
                                 struct memblock_device rightOffsets_mem_28236,
                                 int64_t n_25880, int64_t m_25881,
                                 int64_t k_25882)
{
    (void) ctx;
    
    int err = 0;
    struct memblock_device out_mem_29119;
    
    out_mem_29119.references = NULL;
    
    int64_t out_arrsizze_29120;
    struct memblock_device out_mem_29121;
    
    out_mem_29121.references = NULL;
    
    int64_t out_arrsizze_29122;
    struct memblock_device out_mem_29123;
    
    out_mem_29123.references = NULL;
    
    int64_t segscan_group_sizze_27678;
    
    segscan_group_sizze_27678 =
        ctx->sizes.eWiseMultEntryzisegscan_group_sizze_27677;
    
    int64_t num_groups_27680;
    int32_t max_num_groups_29124;
    
    max_num_groups_29124 = ctx->sizes.eWiseMultEntryzisegscan_num_groups_27679;
    num_groups_27680 = sext_i64_i32(smax64((int64_t) 1,
                                           smin64(sdiv_up64(m_25881,
                                                            segscan_group_sizze_27678),
                                                  sext_i32_i64(max_num_groups_29124))));
    
    int64_t bytes_28336 = (int64_t) 8 * m_25881;
    struct memblock_device mem_28337;
    
    mem_28337.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28337, bytes_28336, "mem_28337")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t num_threads_28870 = segscan_group_sizze_27678 * num_groups_27680;
    int64_t segred_num_groups_28890;
    
    segred_num_groups_28890 =
        ctx->sizes.eWiseMultEntryzisegred_num_groups_28889;
    
    int64_t segred_group_sizze_28892;
    
    segred_group_sizze_28892 =
        ctx->sizes.eWiseMultEntryzisegred_group_sizze_28891;
    
    struct memblock_device mem_28939;
    
    mem_28939.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28939, (int64_t) 8, "mem_28939")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_28941;
    
    mem_28941.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28941, (int64_t) 8, "mem_28941")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_28943;
    
    mem_28943.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28943, (int64_t) 8, "mem_28943")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device eWiseMultEntryzicounter_mem_29125 =
                           ctx->eWiseMultEntryzicounter_mem_29125;
    struct memblock_device group_res_arr_mem_29127;
    
    group_res_arr_mem_29127.references = NULL;
    if (memblock_alloc_device(ctx, &group_res_arr_mem_29127,
                              (int64_t) sizeof(int64_t) *
                              (segred_group_sizze_28892 *
                               segred_num_groups_28890),
                              "group_res_arr_mem_29127")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device group_res_arr_mem_29129;
    
    group_res_arr_mem_29129.references = NULL;
    if (memblock_alloc_device(ctx, &group_res_arr_mem_29129,
                              (int64_t) sizeof(int64_t) *
                              (segred_group_sizze_28892 *
                               segred_num_groups_28890),
                              "group_res_arr_mem_29129")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device group_res_arr_mem_29131;
    
    group_res_arr_mem_29131.references = NULL;
    if (memblock_alloc_device(ctx, &group_res_arr_mem_29131,
                              (int64_t) sizeof(int64_t) *
                              (segred_group_sizze_28892 *
                               segred_num_groups_28890),
                              "group_res_arr_mem_29131")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t num_threads_29133;
    
    num_threads_29133 = segred_num_groups_28890 * segred_group_sizze_28892;
    if (ctx->debugging)
        fprintf(stderr, "%s\n", "\n# SegRed");
    
    unsigned int shared_sizze_30568 = (int64_t) sizeof(int64_t) *
                 segred_group_sizze_28892;
    unsigned int shared_sizze_30570 = (int64_t) sizeof(int64_t) *
                 segred_group_sizze_28892;
    unsigned int shared_sizze_30572 = (int64_t) sizeof(int64_t) *
                 segred_group_sizze_28892;
    unsigned int shared_sizze_30574 = (int64_t) sizeof(bool);
    CUdeviceptr kernel_arg_30576 = leftOffsets_mem_28233.mem;
    CUdeviceptr kernel_arg_30577 = rightOffsets_mem_28236.mem;
    CUdeviceptr kernel_arg_30578 = mem_28939.mem;
    CUdeviceptr kernel_arg_30579 = mem_28941.mem;
    CUdeviceptr kernel_arg_30580 = mem_28943.mem;
    CUdeviceptr kernel_arg_30581 = eWiseMultEntryzicounter_mem_29125.mem;
    CUdeviceptr kernel_arg_30582 = group_res_arr_mem_29127.mem;
    CUdeviceptr kernel_arg_30583 = group_res_arr_mem_29129.mem;
    CUdeviceptr kernel_arg_30584 = group_res_arr_mem_29131.mem;
    unsigned int shared_offset_30569 = 0;
    unsigned int shared_offset_30571 = 0 + (shared_sizze_30568 + (8 -
                                                                  shared_sizze_30568 %
                                                                  8) % 8);
    unsigned int shared_offset_30573 = 0 + (shared_sizze_30568 + (8 -
                                                                  shared_sizze_30568 %
                                                                  8) % 8) +
                 (shared_sizze_30570 + (8 - shared_sizze_30570 % 8) % 8);
    unsigned int shared_offset_30575 = 0 + (shared_sizze_30568 + (8 -
                                                                  shared_sizze_30568 %
                                                                  8) % 8) +
                 (shared_sizze_30570 + (8 - shared_sizze_30570 % 8) % 8) +
                 (shared_sizze_30572 + (8 - shared_sizze_30572 % 8) % 8);
    
    if ((((((1 && segred_num_groups_28890 != 0) && 1 != 0) && 1 != 0) &&
          segred_group_sizze_28892 != 0) && 1 != 0) && 1 != 0) {
        int perm[3] = {0, 1, 2};
        
        if (1 >= 1 << 16) {
            perm[1] = perm[0];
            perm[0] = 1;
        }
        if (1 >= 1 << 16) {
            perm[2] = perm[0];
            perm[0] = 2;
        }
        
        size_t grid[3];
        
        grid[perm[0]] = segred_num_groups_28890;
        grid[perm[1]] = 1;
        grid[perm[2]] = 1;
        
        void *kernel_args_30565[] = {&ctx->global_failure,
                                     &ctx->failure_is_an_option,
                                     &ctx->global_failure_args,
                                     &shared_offset_30569, &shared_offset_30571,
                                     &shared_offset_30573, &shared_offset_30575,
                                     &m_25881, &num_threads_29133,
                                     &kernel_arg_30576, &kernel_arg_30577,
                                     &kernel_arg_30578, &kernel_arg_30579,
                                     &kernel_arg_30580, &kernel_arg_30581,
                                     &kernel_arg_30582, &kernel_arg_30583,
                                     &kernel_arg_30584};
        int64_t time_start_30566 = 0, time_end_30567 = 0;
        
        if (ctx->debugging) {
            fprintf(stderr, "Launching %s with grid size (",
                    "eWiseMultEntry.segred_nonseg_28898");
            fprintf(stderr, "%d", segred_num_groups_28890);
            fprintf(stderr, ", ");
            fprintf(stderr, "%d", 1);
            fprintf(stderr, ", ");
            fprintf(stderr, "%d", 1);
            fprintf(stderr, ") and block size (");
            fprintf(stderr, "%d", segred_group_sizze_28892);
            fprintf(stderr, ", ");
            fprintf(stderr, "%d", 1);
            fprintf(stderr, ", ");
            fprintf(stderr, "%d", 1);
            fprintf(stderr, ").\n");
            time_start_30566 = get_wall_time();
        }
        
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->eWiseMultEntryzisegred_nonseg_28898_runs,
                                      &ctx->eWiseMultEntryzisegred_nonseg_28898_total_runtime);
            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED(cuLaunchKernel(ctx->eWiseMultEntryzisegred_nonseg_28898,
                                    grid[0], grid[1], grid[2],
                                    segred_group_sizze_28892, 1, 1, 0 +
                                    (shared_sizze_30568 + (8 -
                                                           shared_sizze_30568 %
                                                           8) % 8) +
                                    (shared_sizze_30570 + (8 -
                                                           shared_sizze_30570 %
                                                           8) % 8) +
                                    (shared_sizze_30572 + (8 -
                                                           shared_sizze_30572 %
                                                           8) % 8) +
                                    (shared_sizze_30574 + (8 -
                                                           shared_sizze_30574 %
                                                           8) % 8), NULL,
                                    kernel_args_30565, NULL));
        if (pevents != NULL)
            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
        if (ctx->debugging) {
            CUDA_SUCCEED(cuCtxSynchronize());
            time_end_30567 = get_wall_time();
            fprintf(stderr, "Kernel %s runtime: %ldus\n",
                    "eWiseMultEntry.segred_nonseg_28898", time_end_30567 -
                    time_start_30566);
        }
    }
    ctx->failure_is_an_option = 1;
    
    int64_t read_res_30585;
    
    {
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->copy_scalar_from_dev_runs,
                                      &ctx->copy_scalar_from_dev_total_runtime);
            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30585, mem_28939.mem + (int64_t) 0 *
                                  sizeof(int64_t), sizeof(int64_t)));
        if (pevents != NULL)
            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
    }
    if (futhark_context_sync(ctx) != 0)
        return 1;
    
    int64_t max_per_thread_28884 = read_res_30585;
    
    if (memblock_unref_device(ctx, &mem_28939, "mem_28939") != 0)
        return 1;
    
    int64_t read_res_30586;
    
    {
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->copy_scalar_from_dev_runs,
                                      &ctx->copy_scalar_from_dev_total_runtime);
            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30586, mem_28941.mem + (int64_t) 0 *
                                  sizeof(int64_t), sizeof(int64_t)));
        if (pevents != NULL)
            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
    }
    if (futhark_context_sync(ctx) != 0)
        return 1;
    
    int64_t max_per_thread_28885 = read_res_30586;
    
    if (memblock_unref_device(ctx, &mem_28941, "mem_28941") != 0)
        return 1;
    
    int64_t read_res_30587;
    
    {
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->copy_scalar_from_dev_runs,
                                      &ctx->copy_scalar_from_dev_total_runtime);
            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30587, mem_28943.mem + (int64_t) 0 *
                                  sizeof(int64_t), sizeof(int64_t)));
        if (pevents != NULL)
            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
    }
    if (futhark_context_sync(ctx) != 0)
        return 1;
    
    int64_t max_per_thread_28886 = read_res_30587;
    
    if (memblock_unref_device(ctx, &mem_28943, "mem_28943") != 0)
        return 1;
    
    int64_t sizze_sum_28932 = num_threads_28870 * max_per_thread_28884;
    int64_t sizze_sum_28933 = num_threads_28870 * max_per_thread_28885;
    int64_t sizze_sum_28934 = num_threads_28870 * max_per_thread_28886;
    struct memblock_device mem_28318;
    
    mem_28318.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28318, sizze_sum_28932, "mem_28318")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_28254;
    
    mem_28254.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28254, sizze_sum_28932, "mem_28254")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_28252;
    
    mem_28252.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28252, sizze_sum_28932, "mem_28252")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_28250;
    
    mem_28250.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28250, sizze_sum_28932, "mem_28250")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_28248;
    
    mem_28248.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28248, sizze_sum_28932, "mem_28248")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_28239;
    
    mem_28239.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28239, sizze_sum_28932, "mem_28239")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_28256;
    
    mem_28256.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28256, sizze_sum_28933, "mem_28256")) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device double_buffer_mem_28763;
    
    double_buffer_mem_28763.references = NULL;
    if (memblock_alloc_device(ctx, &double_buffer_mem_28763, sizze_sum_28934,
                              "double_buffer_mem_28763")) {
        err = 1;
        goto cleanup;
    }
    if (slt64((int64_t) 0, m_25881)) {
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegScan");
        
        int64_t numThreads_29171;
        
        numThreads_29171 = sdiv_up64(m_25881, segscan_group_sizze_27678 *
                                     (int64_t) 9) * segscan_group_sizze_27678;
        
        int64_t numGroups_29172;
        
        numGroups_29172 = sdiv_up64(m_25881, segscan_group_sizze_27678 *
                                    (int64_t) 9);
        
        struct memblock_device eWiseMultEntryziid_counter_mem_29173 =
                               ctx->eWiseMultEntryziid_counter_mem_29173;
        struct memblock_device status_flags_mem_29175;
        
        status_flags_mem_29175.references = NULL;
        if (memblock_alloc_device(ctx, &status_flags_mem_29175,
                                  (int64_t) sizeof(int8_t) * numGroups_29172,
                                  "status_flags_mem_29175")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device aggregates_mem_29177;
        
        aggregates_mem_29177.references = NULL;
        if (memblock_alloc_device(ctx, &aggregates_mem_29177,
                                  (int64_t) sizeof(int64_t) * numGroups_29172,
                                  "aggregates_mem_29177")) {
            err = 1;
            goto cleanup;
        }
        
        struct memblock_device incprefixes_mem_29179;
        
        incprefixes_mem_29179.references = NULL;
        if (memblock_alloc_device(ctx, &incprefixes_mem_29179,
                                  (int64_t) sizeof(int64_t) * numGroups_29172,
                                  "incprefixes_mem_29179")) {
            err = 1;
            goto cleanup;
        }
        if (futrts_builtinzhreplicate_i8(ctx, status_flags_mem_29175,
                                         numGroups_29172, (int8_t) 0) != 0) {
            err = 1;
            goto cleanup;
        }
        
        unsigned int shared_sizze_30592 = smax64(smax64((int64_t) 288,
                                                        (int64_t) 8 *
                                                        segscan_group_sizze_27678),
                                                 (int64_t) 9 *
                                                 segscan_group_sizze_27678 *
                                                 (int64_t) 8);
        CUdeviceptr kernel_arg_30594 = leftColumns_mem_28232.mem;
        CUdeviceptr kernel_arg_30595 = leftOffsets_mem_28233.mem;
        CUdeviceptr kernel_arg_30596 = rightColumns_mem_28235.mem;
        CUdeviceptr kernel_arg_30597 = rightOffsets_mem_28236.mem;
        CUdeviceptr kernel_arg_30598 = mem_28239.mem;
        CUdeviceptr kernel_arg_30599 = mem_28248.mem;
        CUdeviceptr kernel_arg_30600 = mem_28250.mem;
        CUdeviceptr kernel_arg_30601 = mem_28252.mem;
        CUdeviceptr kernel_arg_30602 = mem_28254.mem;
        CUdeviceptr kernel_arg_30603 = mem_28256.mem;
        CUdeviceptr kernel_arg_30604 = mem_28318.mem;
        CUdeviceptr kernel_arg_30605 = mem_28337.mem;
        CUdeviceptr kernel_arg_30606 = double_buffer_mem_28763.mem;
        CUdeviceptr kernel_arg_30607 = eWiseMultEntryziid_counter_mem_29173.mem;
        CUdeviceptr kernel_arg_30608 = status_flags_mem_29175.mem;
        CUdeviceptr kernel_arg_30609 = aggregates_mem_29177.mem;
        CUdeviceptr kernel_arg_30610 = incprefixes_mem_29179.mem;
        unsigned int shared_offset_30593 = 0;
        
        if ((((((1 && sdiv_up64(m_25881, segscan_group_sizze_27678 *
                                (int64_t) 9) != 0) && 1 != 0) && 1 != 0) &&
              segscan_group_sizze_27678 != 0) && 1 != 0) && 1 != 0) {
            int perm[3] = {0, 1, 2};
            
            if (1 >= 1 << 16) {
                perm[1] = perm[0];
                perm[0] = 1;
            }
            if (1 >= 1 << 16) {
                perm[2] = perm[0];
                perm[0] = 2;
            }
            
            size_t grid[3];
            
            grid[perm[0]] = sdiv_up64(m_25881, segscan_group_sizze_27678 *
                                      (int64_t) 9);
            grid[perm[1]] = 1;
            grid[perm[2]] = 1;
            
            void *kernel_args_30589[] = {&ctx->global_failure,
                                         &ctx->failure_is_an_option,
                                         &ctx->global_failure_args,
                                         &shared_offset_30593, &n_25880,
                                         &m_25881, &k_25882, &num_threads_28870,
                                         &kernel_arg_30594, &kernel_arg_30595,
                                         &kernel_arg_30596, &kernel_arg_30597,
                                         &kernel_arg_30598, &kernel_arg_30599,
                                         &kernel_arg_30600, &kernel_arg_30601,
                                         &kernel_arg_30602, &kernel_arg_30603,
                                         &kernel_arg_30604, &kernel_arg_30605,
                                         &kernel_arg_30606, &kernel_arg_30607,
                                         &kernel_arg_30608, &kernel_arg_30609,
                                         &kernel_arg_30610};
            int64_t time_start_30590 = 0, time_end_30591 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with grid size (",
                        "eWiseMultEntry.segscan_27683");
                fprintf(stderr, "%d", sdiv_up64(m_25881,
                                                segscan_group_sizze_27678 *
                                                (int64_t) 9));
                fprintf(stderr, ", ");
                fprintf(stderr, "%d", 1);
                fprintf(stderr, ", ");
                fprintf(stderr, "%d", 1);
                fprintf(stderr, ") and block size (");
                fprintf(stderr, "%d", segscan_group_sizze_27678);
                fprintf(stderr, ", ");
                fprintf(stderr, "%d", 1);
                fprintf(stderr, ", ");
                fprintf(stderr, "%d", 1);
                fprintf(stderr, ").\n");
                time_start_30590 = get_wall_time();
            }
            
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->eWiseMultEntryzisegscan_27683_runs,
                                          &ctx->eWiseMultEntryzisegscan_27683_total_runtime);
                CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED(cuLaunchKernel(ctx->eWiseMultEntryzisegscan_27683,
                                        grid[0], grid[1], grid[2],
                                        segscan_group_sizze_27678, 1, 1, 0 +
                                        (shared_sizze_30592 + (8 -
                                                               shared_sizze_30592 %
                                                               8) % 8), NULL,
                                        kernel_args_30589, NULL));
            if (pevents != NULL)
                CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
            if (ctx->debugging) {
                CUDA_SUCCEED(cuCtxSynchronize());
                time_end_30591 = get_wall_time();
                fprintf(stderr, "Kernel %s runtime: %ldus\n",
                        "eWiseMultEntry.segscan_27683", time_end_30591 -
                        time_start_30590);
            }
        }
        ctx->failure_is_an_option = 1;
        if (memblock_unref_device(ctx, &incprefixes_mem_29179,
                                  "incprefixes_mem_29179") != 0)
            return 1;
        if (memblock_unref_device(ctx, &aggregates_mem_29177,
                                  "aggregates_mem_29177") != 0)
            return 1;
        if (memblock_unref_device(ctx, &status_flags_mem_29175,
                                  "status_flags_mem_29175") != 0)
            return 1;
    }
    if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28248, "mem_28248") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28250, "mem_28250") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28254, "mem_28254") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28256, "mem_28256") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28318, "mem_28318") != 0)
        return 1;
    if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                              "double_buffer_mem_28763") != 0)
        return 1;
    
    int64_t i_26068 = sub64(m_25881, (int64_t) 1);
    bool x_26069 = sle64((int64_t) 0, i_26068);
    bool y_26070 = slt64(i_26068, m_25881);
    bool bounds_check_26071 = x_26069 && y_26070;
    bool index_certs_26072;
    
    if (!bounds_check_26071) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Index [", i_26068,
                               "] out of bounds for array of shape [", m_25881,
                               "].",
                               "-> #0  sparse.fut:126:26-37\n   #1  sparse.fut:162:23-49\n   #2  sparse.fut:231:17-60\n   #3  sparse.fut:222:1-232:48\n");
        if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                  "double_buffer_mem_28763") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28256, "mem_28256") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28248, "mem_28248") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28250, "mem_28250") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28254, "mem_28254") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28318, "mem_28318") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                  "group_res_arr_mem_29131") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                  "group_res_arr_mem_29129") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                  "group_res_arr_mem_29127") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28943, "mem_28943") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28941, "mem_28941") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28939, "mem_28939") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28337, "mem_28337") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_29123, "out_mem_29123") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_29121, "out_mem_29121") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_29119, "out_mem_29119") != 0)
            return 1;
        return 1;
    }
    
    int64_t read_res_30611;
    
    {
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda,
                                      &ctx->copy_scalar_from_dev_runs,
                                      &ctx->copy_scalar_from_dev_total_runtime);
            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30611, mem_28337.mem + i_26068 *
                                  sizeof(int64_t), sizeof(int64_t)));
        if (pevents != NULL)
            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
    }
    if (futhark_context_sync(ctx) != 0)
        return 1;
    
    int64_t eWiseMultOffsets_res_26073 = read_res_30611;
    bool bounds_invalid_upwards_26074 = slt64(eWiseMultOffsets_res_26073,
                                              (int64_t) 0);
    bool valid_26075 = !bounds_invalid_upwards_26074;
    bool range_valid_c_26076;
    
    if (!valid_26075) {
        ctx->error = msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                               "Range ", (int64_t) 0, "..", (int64_t) 1, "..<",
                               eWiseMultOffsets_res_26073, " is invalid.",
                               "-> #0  /prelude/array.fut:60:3-10\n   #1  /prelude/array.fut:70:18-23\n   #2  sparse.fut:163:16-35\n   #3  sparse.fut:231:17-60\n   #4  sparse.fut:222:1-232:48\n");
        if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                  "double_buffer_mem_28763") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28256, "mem_28256") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28248, "mem_28248") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28250, "mem_28250") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28254, "mem_28254") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28318, "mem_28318") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                  "group_res_arr_mem_29131") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                  "group_res_arr_mem_29129") != 0)
            return 1;
        if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                  "group_res_arr_mem_29127") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28943, "mem_28943") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28941, "mem_28941") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28939, "mem_28939") != 0)
            return 1;
        if (memblock_unref_device(ctx, &mem_28337, "mem_28337") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_29123, "out_mem_29123") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_29121, "out_mem_29121") != 0)
            return 1;
        if (memblock_unref_device(ctx, &out_mem_29119, "out_mem_29119") != 0)
            return 1;
        return 1;
    }
    
    int64_t bytes_28338 = (int64_t) 8 * eWiseMultOffsets_res_26073;
    struct memblock_device mem_28339;
    
    mem_28339.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28339, bytes_28338, "mem_28339")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_f64(ctx, mem_28339,
                                      eWiseMultOffsets_res_26073, 0.0) != 0) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_28341;
    
    mem_28341.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28341, bytes_28338, "mem_28341")) {
        err = 1;
        goto cleanup;
    }
    if (futrts_builtinzhreplicate_i64(ctx, mem_28341,
                                      eWiseMultOffsets_res_26073,
                                      (int64_t) 0) != 0) {
        err = 1;
        goto cleanup;
    }
    
    struct memblock_device mem_28343;
    
    mem_28343.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28343, (int64_t) 0, "mem_28343")) {
        err = 1;
        goto cleanup;
    }
    
    int64_t segmap_group_sizze_27814;
    
    segmap_group_sizze_27814 =
        ctx->sizes.eWiseMultEntryzisegmap_group_sizze_27813;
    for (int64_t i_26082 = 0; i_26082 < i_26068; i_26082++) {
        bool y_26085 = slt64(i_26082, m_25881);
        bool index_certs_26086;
        
        if (!y_26085) {
            ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                   "Index [", i_26082,
                                   "] out of bounds for array of shape [",
                                   m_25881, "].",
                                   "-> #0  sparse.fut:171:46-61\n   #1  sparse.fut:231:17-60\n   #2  sparse.fut:222:1-232:48\n");
            if (memblock_unref_device(ctx, &mem_28343, "mem_28343") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28341, "mem_28341") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28339, "mem_28339") != 0)
                return 1;
            if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                      "double_buffer_mem_28763") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28256, "mem_28256") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28248, "mem_28248") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28250, "mem_28250") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28254, "mem_28254") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28318, "mem_28318") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                      "group_res_arr_mem_29131") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                      "group_res_arr_mem_29129") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                      "group_res_arr_mem_29127") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28943, "mem_28943") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28941, "mem_28941") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28939, "mem_28939") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28337, "mem_28337") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29123, "out_mem_29123") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29121, "out_mem_29121") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29119, "out_mem_29119") !=
                0)
                return 1;
            return 1;
        }
        
        int64_t read_res_30612;
        
        {
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->copy_scalar_from_dev_runs,
                                          &ctx->copy_scalar_from_dev_total_runtime);
                CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30612,
                                      rightOffsets_mem_28236.mem + i_26082 *
                                      sizeof(int64_t), sizeof(int64_t)));
            if (pevents != NULL)
                CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
        }
        if (futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t i_26087 = read_res_30612;
        int64_t i_26088 = add64((int64_t) 1, i_26082);
        bool x_26089 = sle64((int64_t) 0, i_26088);
        bool y_26090 = slt64(i_26088, m_25881);
        bool bounds_check_26091 = x_26089 && y_26090;
        bool index_certs_26092;
        
        if (!bounds_check_26091) {
            ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                   "Index [", i_26088,
                                   "] out of bounds for array of shape [",
                                   m_25881, "].",
                                   "-> #0  sparse.fut:171:63-80\n   #1  sparse.fut:231:17-60\n   #2  sparse.fut:222:1-232:48\n");
            if (memblock_unref_device(ctx, &mem_28343, "mem_28343") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28341, "mem_28341") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28339, "mem_28339") != 0)
                return 1;
            if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                      "double_buffer_mem_28763") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28256, "mem_28256") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28248, "mem_28248") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28250, "mem_28250") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28254, "mem_28254") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28318, "mem_28318") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                      "group_res_arr_mem_29131") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                      "group_res_arr_mem_29129") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                      "group_res_arr_mem_29127") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28943, "mem_28943") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28941, "mem_28941") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28939, "mem_28939") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28337, "mem_28337") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29123, "out_mem_29123") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29121, "out_mem_29121") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29119, "out_mem_29119") !=
                0)
                return 1;
            return 1;
        }
        
        int64_t read_res_30613;
        
        {
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->copy_scalar_from_dev_runs,
                                          &ctx->copy_scalar_from_dev_total_runtime);
                CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30613,
                                      rightOffsets_mem_28236.mem + i_26088 *
                                      sizeof(int64_t), sizeof(int64_t)));
            if (pevents != NULL)
                CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
        }
        if (futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t j_26093 = read_res_30613;
        int64_t j_m_i_26094 = sub64(j_26093, i_26087);
        bool empty_slice_26095 = j_m_i_26094 == (int64_t) 0;
        int64_t m_26096 = sub64(j_m_i_26094, (int64_t) 1);
        int64_t i_p_m_t_s_26097 = add64(i_26087, m_26096);
        bool zzero_leq_i_p_m_t_s_26098 = sle64((int64_t) 0, i_p_m_t_s_26097);
        bool i_p_m_t_s_leq_w_26099 = slt64(i_p_m_t_s_26097, k_25882);
        bool zzero_lte_i_26100 = sle64((int64_t) 0, i_26087);
        bool i_lte_j_26101 = sle64(i_26087, j_26093);
        bool y_26102 = i_p_m_t_s_leq_w_26099 && zzero_lte_i_26100;
        bool y_26103 = zzero_leq_i_p_m_t_s_26098 && y_26102;
        bool y_26104 = i_lte_j_26101 && y_26103;
        bool forwards_ok_26105 = zzero_lte_i_26100 && y_26104;
        bool ok_or_empty_26106 = empty_slice_26095 || forwards_ok_26105;
        bool index_certs_26107;
        
        if (!ok_or_empty_26106) {
            ctx->error =
                msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                          "Index [", i_26087, ":", j_26093,
                          "] out of bounds for array of shape [", k_25882, "].",
                          "-> #0  sparse.fut:171:32-81\n   #1  sparse.fut:231:17-60\n   #2  sparse.fut:222:1-232:48\n");
            if (memblock_unref_device(ctx, &mem_28343, "mem_28343") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28341, "mem_28341") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28339, "mem_28339") != 0)
                return 1;
            if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                      "double_buffer_mem_28763") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28256, "mem_28256") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28248, "mem_28248") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28250, "mem_28250") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28254, "mem_28254") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28318, "mem_28318") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                      "group_res_arr_mem_29131") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                      "group_res_arr_mem_29129") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                      "group_res_arr_mem_29127") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28943, "mem_28943") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28941, "mem_28941") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28939, "mem_28939") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28337, "mem_28337") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29123, "out_mem_29123") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29121, "out_mem_29121") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29119, "out_mem_29119") !=
                0)
                return 1;
            return 1;
        }
        
        int64_t read_res_30614;
        
        {
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->copy_scalar_from_dev_runs,
                                          &ctx->copy_scalar_from_dev_total_runtime);
                CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30614,
                                      leftOffsets_mem_28233.mem + i_26082 *
                                      sizeof(int64_t), sizeof(int64_t)));
            if (pevents != NULL)
                CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
        }
        if (futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t i_26109 = read_res_30614;
        int64_t read_res_30615;
        
        {
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->copy_scalar_from_dev_runs,
                                          &ctx->copy_scalar_from_dev_total_runtime);
                CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30615,
                                      leftOffsets_mem_28233.mem + i_26088 *
                                      sizeof(int64_t), sizeof(int64_t)));
            if (pevents != NULL)
                CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
        }
        if (futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t j_26110 = read_res_30615;
        int64_t j_m_i_26111 = sub64(j_26110, i_26109);
        bool empty_slice_26112 = j_m_i_26111 == (int64_t) 0;
        int64_t m_26113 = sub64(j_m_i_26111, (int64_t) 1);
        int64_t i_p_m_t_s_26114 = add64(i_26109, m_26113);
        bool zzero_leq_i_p_m_t_s_26115 = sle64((int64_t) 0, i_p_m_t_s_26114);
        bool i_p_m_t_s_leq_w_26116 = slt64(i_p_m_t_s_26114, n_25880);
        bool zzero_lte_i_26117 = sle64((int64_t) 0, i_26109);
        bool i_lte_j_26118 = sle64(i_26109, j_26110);
        bool y_26119 = i_p_m_t_s_leq_w_26116 && zzero_lte_i_26117;
        bool y_26120 = zzero_leq_i_p_m_t_s_26115 && y_26119;
        bool y_26121 = i_lte_j_26118 && y_26120;
        bool forwards_ok_26122 = zzero_lte_i_26117 && y_26121;
        bool ok_or_empty_26123 = empty_slice_26112 || forwards_ok_26122;
        bool index_certs_26124;
        
        if (!ok_or_empty_26123) {
            ctx->error =
                msgprintf("Error: %s%lld%s%lld%s%lld%s\n\nBacktrace:\n%s",
                          "Index [", i_26109, ":", j_26110,
                          "] out of bounds for array of shape [", n_25880, "].",
                          "-> #0  sparse.fut:170:32-78\n   #1  sparse.fut:231:17-60\n   #2  sparse.fut:222:1-232:48\n");
            if (memblock_unref_device(ctx, &mem_28343, "mem_28343") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28341, "mem_28341") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28339, "mem_28339") != 0)
                return 1;
            if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                      "double_buffer_mem_28763") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28256, "mem_28256") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28248, "mem_28248") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28250, "mem_28250") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28254, "mem_28254") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28318, "mem_28318") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                      "group_res_arr_mem_29131") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                      "group_res_arr_mem_29129") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                      "group_res_arr_mem_29127") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28943, "mem_28943") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28941, "mem_28941") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28939, "mem_28939") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28337, "mem_28337") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29123, "out_mem_29123") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29121, "out_mem_29121") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29119, "out_mem_29119") !=
                0)
                return 1;
            return 1;
        }
        
        int64_t conc_tmp_26126 = j_m_i_26094 + j_m_i_26111;
        int64_t j_m_i_26127 = sub64(conc_tmp_26126, (int64_t) 1);
        int64_t bytes_28358 = (int64_t) 8 * conc_tmp_26126;
        int64_t sizze_26128;
        int64_t sizze_26129;
        int64_t sizze_26130;
        int64_t intersectArrays_res_ixfn_28440;
        int64_t intersectArrays_res_ixfn_28441;
        int64_t intersectArrays_res_ixfn_28443;
        int64_t intersectArrays_res_ixfn_28444;
        int64_t intersectArrays_res_ixfn_28446;
        int64_t intersectArrays_res_ixfn_28447;
        struct memblock_device intersectArrays_res_mem_28442;
        
        intersectArrays_res_mem_28442.references = NULL;
        
        struct memblock_device intersectArrays_res_mem_28445;
        
        intersectArrays_res_mem_28445.references = NULL;
        
        struct memblock_device intersectArrays_res_mem_28448;
        
        intersectArrays_res_mem_28448.references = NULL;
        if (empty_slice_26112) {
            sizze_26128 = (int64_t) 0;
            sizze_26129 = (int64_t) 0;
            sizze_26130 = (int64_t) 0;
            intersectArrays_res_ixfn_28440 = (int64_t) 0;
            intersectArrays_res_ixfn_28441 = (int64_t) 0;
            intersectArrays_res_ixfn_28443 = (int64_t) 0;
            intersectArrays_res_ixfn_28444 = (int64_t) 0;
            intersectArrays_res_ixfn_28446 = (int64_t) 0;
            intersectArrays_res_ixfn_28447 = (int64_t) 0;
            if (memblock_set_device(ctx, &intersectArrays_res_mem_28442,
                                    &mem_28343, "mem_28343") != 0)
                return 1;
            if (memblock_set_device(ctx, &intersectArrays_res_mem_28445,
                                    &mem_28343, "mem_28343") != 0)
                return 1;
            if (memblock_set_device(ctx, &intersectArrays_res_mem_28448,
                                    &mem_28343, "mem_28343") != 0)
                return 1;
        } else {
            struct memblock_device mem_28359;
            
            mem_28359.references = NULL;
            if (memblock_alloc_device(ctx, &mem_28359, bytes_28358,
                                      "mem_28359")) {
                err = 1;
                goto cleanup;
            }
            
            int64_t tmp_offs_29300 = (int64_t) 0;
            
            {
                cudaEvent_t *pevents = NULL;
                
                if (ctx->profiling && !ctx->profiling_paused) {
                    pevents = cuda_get_events(&ctx->cuda,
                                              &ctx->copy_dev_to_dev_runs,
                                              &ctx->copy_dev_to_dev_total_runtime);
                    CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
                }
                CUDA_SUCCEED(cuMemcpy(mem_28359.mem + tmp_offs_29300 *
                                      (int64_t) 8, leftColumns_mem_28232.mem +
                                      i_26109 * (int64_t) 8, j_m_i_26111 *
                                      (int64_t) sizeof(int64_t)));
                if (pevents != NULL)
                    CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
            }
            tmp_offs_29300 += j_m_i_26111;
            {
                cudaEvent_t *pevents = NULL;
                
                if (ctx->profiling && !ctx->profiling_paused) {
                    pevents = cuda_get_events(&ctx->cuda,
                                              &ctx->copy_dev_to_dev_runs,
                                              &ctx->copy_dev_to_dev_total_runtime);
                    CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
                }
                CUDA_SUCCEED(cuMemcpy(mem_28359.mem + tmp_offs_29300 *
                                      (int64_t) 8, rightColumns_mem_28235.mem +
                                      i_26087 * (int64_t) 8, j_m_i_26094 *
                                      (int64_t) sizeof(int64_t)));
                if (pevents != NULL)
                    CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
            }
            tmp_offs_29300 += j_m_i_26094;
            
            struct memblock_device mem_28361;
            
            mem_28361.references = NULL;
            if (memblock_alloc_device(ctx, &mem_28361, bytes_28358,
                                      "mem_28361")) {
                err = 1;
                goto cleanup;
            }
            if (futrts_builtinzhiota_i64(ctx, mem_28361, conc_tmp_26126,
                                         (int64_t) 0, (int64_t) 1) != 0) {
                err = 1;
                goto cleanup;
            }
            
            bool cond_26136 = conc_tmp_26126 == (int64_t) 0;
            int32_t iters_26137;
            
            if (cond_26136) {
                iters_26137 = 0;
            } else {
                iters_26137 = 32;
            }
            
            bool loop_nonempty_26138 = slt32(0, iters_26137);
            bool x_26139 = sle64((int64_t) 0, j_m_i_26127);
            bool y_26140 = slt64(j_m_i_26127, conc_tmp_26126);
            bool bounds_check_26141 = x_26139 && y_26140;
            bool loop_not_taken_26142 = !loop_nonempty_26138;
            bool protect_assert_disj_26143 = bounds_check_26141 ||
                 loop_not_taken_26142;
            int64_t last_index_26145 = j_m_i_26127 - (int64_t) 1;
            bool is_empty_26146 = j_m_i_26127 == (int64_t) 0;
            int64_t segscan_group_sizze_27686;
            
            segscan_group_sizze_27686 =
                ctx->sizes.eWiseMultEntryzisegscan_group_sizze_27685;
            
            int64_t num_groups_27688;
            int32_t max_num_groups_29311;
            
            max_num_groups_29311 =
                ctx->sizes.eWiseMultEntryzisegscan_num_groups_27687;
            num_groups_27688 = sext_i64_i32(smax64((int64_t) 1,
                                                   smin64(sdiv_up64(conc_tmp_26126,
                                                                    segscan_group_sizze_27686),
                                                          sext_i32_i64(max_num_groups_29311))));
            
            int64_t segmap_group_sizze_27696;
            
            segmap_group_sizze_27696 =
                ctx->sizes.eWiseMultEntryzisegmap_group_sizze_27695;
            
            int64_t segmap_usable_groups_27697 = sdiv_up_safe64(conc_tmp_26126,
                                                                segmap_group_sizze_27696);
            int64_t segmap_group_sizze_27773;
            
            segmap_group_sizze_27773 =
                ctx->sizes.eWiseMultEntryzisegmap_group_sizze_27751;
            
            bool i_lte_j_26268 = sle64((int64_t) 1, conc_tmp_26126);
            bool y_26269 = bounds_check_26141 && i_lte_j_26268;
            bool ok_or_empty_26270 = is_empty_26146 || y_26269;
            int64_t segscan_group_sizze_27798;
            
            segscan_group_sizze_27798 =
                ctx->sizes.eWiseMultEntryzisegscan_group_sizze_27797;
            
            int64_t num_groups_27800;
            int32_t max_num_groups_29312;
            
            max_num_groups_29312 =
                ctx->sizes.eWiseMultEntryzisegscan_num_groups_27799;
            num_groups_27800 = sext_i64_i32(smax64((int64_t) 1,
                                                   smin64(sdiv_up64(j_m_i_26127,
                                                                    segscan_group_sizze_27798),
                                                          sext_i32_i64(max_num_groups_29312))));
            
            int64_t bytes_28385 = (int64_t) 4 * conc_tmp_26126;
            int64_t bytes_28424 = (int64_t) 8 * j_m_i_26127;
            int64_t intersectArrays_res_f_res_ixfn_28432;
            
            if (empty_slice_26095) {
                intersectArrays_res_f_res_ixfn_28432 = (int64_t) 0;
            } else {
                intersectArrays_res_f_res_ixfn_28432 = j_m_i_26127;
            }
            
            int64_t sizze_26147;
            int64_t sizze_26148;
            int64_t sizze_26149;
            int64_t intersectArrays_res_f_res_ixfn_28431;
            int64_t intersectArrays_res_f_res_ixfn_28434;
            int64_t intersectArrays_res_f_res_ixfn_28437;
            struct memblock_device intersectArrays_res_f_res_mem_28433;
            
            intersectArrays_res_f_res_mem_28433.references = NULL;
            
            struct memblock_device intersectArrays_res_f_res_mem_28436;
            
            intersectArrays_res_f_res_mem_28436.references = NULL;
            
            struct memblock_device intersectArrays_res_f_res_mem_28439;
            
            intersectArrays_res_f_res_mem_28439.references = NULL;
            if (empty_slice_26095) {
                sizze_26147 = (int64_t) 0;
                sizze_26148 = (int64_t) 0;
                sizze_26149 = (int64_t) 0;
                intersectArrays_res_f_res_ixfn_28431 = (int64_t) 0;
                intersectArrays_res_f_res_ixfn_28434 = (int64_t) 0;
                intersectArrays_res_f_res_ixfn_28437 = (int64_t) 0;
                if (memblock_set_device(ctx,
                                        &intersectArrays_res_f_res_mem_28433,
                                        &mem_28343, "mem_28343") != 0)
                    return 1;
                if (memblock_set_device(ctx,
                                        &intersectArrays_res_f_res_mem_28436,
                                        &mem_28343, "mem_28343") != 0)
                    return 1;
                if (memblock_set_device(ctx,
                                        &intersectArrays_res_f_res_mem_28439,
                                        &mem_28343, "mem_28343") != 0)
                    return 1;
            } else {
                bool index_certs_26153;
                
                if (!protect_assert_disj_26143) {
                    ctx->error =
                        msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                  "Index [", j_m_i_26127,
                                  "] out of bounds for array of shape [",
                                  conc_tmp_26126, "].",
                                  "-> #0  /prelude/array.fut:18:29-34\n   #1  lib/github.com/diku-dk/sorts/radix_sort.fut:25:24-35\n   #2  lib/github.com/diku-dk/sorts/radix_sort.fut:53:31-62\n   #3  /prelude/functional.fut:9:42-44\n   #4  lib/github.com/diku-dk/sorts/radix_sort.fut:59:3-61:47\n   #5  lib/github.com/diku-dk/sorts/radix_sort.fut:68:3-51\n   #6  sparse.fut:5:34-6:77\n   #7  sparse.fut:86:12-35\n   #8  sparse.fut:169:49-171:81\n   #9  sparse.fut:231:17-60\n   #10 sparse.fut:222:1-232:48\n");
                    if (memblock_unref_device(ctx,
                                              &intersectArrays_res_f_res_mem_28439,
                                              "intersectArrays_res_f_res_mem_28439") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &intersectArrays_res_f_res_mem_28436,
                                              "intersectArrays_res_f_res_mem_28436") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &intersectArrays_res_f_res_mem_28433,
                                              "intersectArrays_res_f_res_mem_28433") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28361, "mem_28361") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28359, "mem_28359") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &intersectArrays_res_mem_28448,
                                              "intersectArrays_res_mem_28448") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &intersectArrays_res_mem_28445,
                                              "intersectArrays_res_mem_28445") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &intersectArrays_res_mem_28442,
                                              "intersectArrays_res_mem_28442") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28343, "mem_28343") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28341, "mem_28341") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28339, "mem_28339") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                              "double_buffer_mem_28763") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28256, "mem_28256") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28239, "mem_28239") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28248, "mem_28248") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28250, "mem_28250") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28252, "mem_28252") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28254, "mem_28254") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28318, "mem_28318") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                              "group_res_arr_mem_29131") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                              "group_res_arr_mem_29129") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                              "group_res_arr_mem_29127") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28943, "mem_28943") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28941, "mem_28941") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28939, "mem_28939") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28337, "mem_28337") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &out_mem_29123,
                                              "out_mem_29123") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &out_mem_29121,
                                              "out_mem_29121") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &out_mem_29119,
                                              "out_mem_29119") != 0)
                        return 1;
                    return 1;
                }
                
                struct memblock_device mem_28378;
                
                mem_28378.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28378, bytes_28358,
                                          "mem_28378")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28380;
                
                mem_28380.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28380, bytes_28358,
                                          "mem_28380")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28382;
                
                mem_28382.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28382, bytes_28358,
                                          "mem_28382")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28384;
                
                mem_28384.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28384, bytes_28358,
                                          "mem_28384")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28386;
                
                mem_28386.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28386, bytes_28385,
                                          "mem_28386")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device defunc_0_f_res_mem_28400;
                
                defunc_0_f_res_mem_28400.references = NULL;
                
                struct memblock_device defunc_0_f_res_mem_28405;
                
                defunc_0_f_res_mem_28405.references = NULL;
                
                struct memblock_device mem_param_28366;
                
                mem_param_28366.references = NULL;
                
                struct memblock_device mem_param_28371;
                
                mem_param_28371.references = NULL;
                if (memblock_set_device(ctx, &mem_param_28366, &mem_28359,
                                        "mem_28359") != 0)
                    return 1;
                if (memblock_set_device(ctx, &mem_param_28371, &mem_28361,
                                        "mem_28361") != 0)
                    return 1;
                for (int32_t i_26156 = 0; i_26156 < iters_26137; i_26156++) {
                    int32_t defunc_2_radix_sort_step_arg_26159 = mul32(2,
                                                                       i_26156);
                    int32_t defunc_0_get_bit_arg_26160 = add32(1,
                                                               defunc_2_radix_sort_step_arg_26159);
                    int64_t i32_res_26161 =
                            sext_i32_i64(defunc_0_get_bit_arg_26160);
                    int64_t i32_res_26162 =
                            sext_i32_i64(defunc_2_radix_sort_step_arg_26159);
                    
                    if (slt64((int64_t) 0, conc_tmp_26126)) {
                        if (ctx->debugging)
                            fprintf(stderr, "%s\n", "\n# SegScan");
                        
                        int64_t numThreads_29317;
                        
                        numThreads_29317 = sdiv_up64(conc_tmp_26126,
                                                     segscan_group_sizze_27686 *
                                                     (int64_t) 9) *
                            segscan_group_sizze_27686;
                        
                        int64_t numGroups_29318;
                        
                        numGroups_29318 = sdiv_up64(conc_tmp_26126,
                                                    segscan_group_sizze_27686 *
                                                    (int64_t) 9);
                        
                        struct memblock_device
                        eWiseMultEntryziid_counter_mem_29319 =
                        ctx->eWiseMultEntryziid_counter_mem_29319;
                        struct memblock_device status_flags_mem_29321;
                        
                        status_flags_mem_29321.references = NULL;
                        if (memblock_alloc_device(ctx, &status_flags_mem_29321,
                                                  (int64_t) sizeof(int8_t) *
                                                  numGroups_29318,
                                                  "status_flags_mem_29321")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        struct memblock_device aggregates_mem_29323;
                        
                        aggregates_mem_29323.references = NULL;
                        if (memblock_alloc_device(ctx, &aggregates_mem_29323,
                                                  (int64_t) sizeof(int64_t) *
                                                  numGroups_29318,
                                                  "aggregates_mem_29323")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        struct memblock_device incprefixes_mem_29325;
                        
                        incprefixes_mem_29325.references = NULL;
                        if (memblock_alloc_device(ctx, &incprefixes_mem_29325,
                                                  (int64_t) sizeof(int64_t) *
                                                  numGroups_29318,
                                                  "incprefixes_mem_29325")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        struct memblock_device aggregates_mem_29327;
                        
                        aggregates_mem_29327.references = NULL;
                        if (memblock_alloc_device(ctx, &aggregates_mem_29327,
                                                  (int64_t) sizeof(int64_t) *
                                                  numGroups_29318,
                                                  "aggregates_mem_29327")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        struct memblock_device incprefixes_mem_29329;
                        
                        incprefixes_mem_29329.references = NULL;
                        if (memblock_alloc_device(ctx, &incprefixes_mem_29329,
                                                  (int64_t) sizeof(int64_t) *
                                                  numGroups_29318,
                                                  "incprefixes_mem_29329")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        struct memblock_device aggregates_mem_29331;
                        
                        aggregates_mem_29331.references = NULL;
                        if (memblock_alloc_device(ctx, &aggregates_mem_29331,
                                                  (int64_t) sizeof(int64_t) *
                                                  numGroups_29318,
                                                  "aggregates_mem_29331")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        struct memblock_device incprefixes_mem_29333;
                        
                        incprefixes_mem_29333.references = NULL;
                        if (memblock_alloc_device(ctx, &incprefixes_mem_29333,
                                                  (int64_t) sizeof(int64_t) *
                                                  numGroups_29318,
                                                  "incprefixes_mem_29333")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        struct memblock_device aggregates_mem_29335;
                        
                        aggregates_mem_29335.references = NULL;
                        if (memblock_alloc_device(ctx, &aggregates_mem_29335,
                                                  (int64_t) sizeof(int64_t) *
                                                  numGroups_29318,
                                                  "aggregates_mem_29335")) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        struct memblock_device incprefixes_mem_29337;
                        
                        incprefixes_mem_29337.references = NULL;
                        if (memblock_alloc_device(ctx, &incprefixes_mem_29337,
                                                  (int64_t) sizeof(int64_t) *
                                                  numGroups_29318,
                                                  "incprefixes_mem_29337")) {
                            err = 1;
                            goto cleanup;
                        }
                        if (futrts_builtinzhreplicate_i8(ctx,
                                                         status_flags_mem_29321,
                                                         numGroups_29318,
                                                         (int8_t) 0) != 0) {
                            err = 1;
                            goto cleanup;
                        }
                        
                        unsigned int shared_sizze_30620 =
                                     smax64(smax64((int64_t) 1056,
                                                   sdiv_up64(sdiv_up64(sdiv_up64((int64_t) 8 *
                                                                                 segscan_group_sizze_27686,
                                                                                 (int64_t) 8) *
                                                                       (int64_t) 8 +
                                                                       (int64_t) 8 *
                                                                       segscan_group_sizze_27686,
                                                                       (int64_t) 8) *
                                                             (int64_t) 8 +
                                                             (int64_t) 8 *
                                                             segscan_group_sizze_27686,
                                                             (int64_t) 8) *
                                                   (int64_t) 8 + (int64_t) 8 *
                                                   segscan_group_sizze_27686),
                                            smax64(smax64(smax64((int64_t) 9 *
                                                                 segscan_group_sizze_27686 *
                                                                 (int64_t) 8,
                                                                 (int64_t) 9 *
                                                                 segscan_group_sizze_27686 *
                                                                 (int64_t) 8),
                                                          (int64_t) 9 *
                                                          segscan_group_sizze_27686 *
                                                          (int64_t) 8),
                                                   (int64_t) 9 *
                                                   segscan_group_sizze_27686 *
                                                   (int64_t) 8));
                        CUdeviceptr kernel_arg_30622 = mem_param_28366.mem;
                        CUdeviceptr kernel_arg_30623 = mem_28378.mem;
                        CUdeviceptr kernel_arg_30624 = mem_28380.mem;
                        CUdeviceptr kernel_arg_30625 = mem_28382.mem;
                        CUdeviceptr kernel_arg_30626 = mem_28384.mem;
                        CUdeviceptr kernel_arg_30627 = mem_28386.mem;
                        CUdeviceptr kernel_arg_30628 =
                                    eWiseMultEntryziid_counter_mem_29319.mem;
                        CUdeviceptr kernel_arg_30629 =
                                    status_flags_mem_29321.mem;
                        CUdeviceptr kernel_arg_30630 = aggregates_mem_29323.mem;
                        CUdeviceptr kernel_arg_30631 =
                                    incprefixes_mem_29325.mem;
                        CUdeviceptr kernel_arg_30632 = aggregates_mem_29327.mem;
                        CUdeviceptr kernel_arg_30633 =
                                    incprefixes_mem_29329.mem;
                        CUdeviceptr kernel_arg_30634 = aggregates_mem_29331.mem;
                        CUdeviceptr kernel_arg_30635 =
                                    incprefixes_mem_29333.mem;
                        CUdeviceptr kernel_arg_30636 = aggregates_mem_29335.mem;
                        CUdeviceptr kernel_arg_30637 =
                                    incprefixes_mem_29337.mem;
                        unsigned int shared_offset_30621 = 0;
                        
                        if ((((((1 && sdiv_up64(conc_tmp_26126,
                                                segscan_group_sizze_27686 *
                                                (int64_t) 9) != 0) && 1 != 0) &&
                               1 != 0) && segscan_group_sizze_27686 != 0) &&
                             1 != 0) && 1 != 0) {
                            int perm[3] = {0, 1, 2};
                            
                            if (1 >= 1 << 16) {
                                perm[1] = perm[0];
                                perm[0] = 1;
                            }
                            if (1 >= 1 << 16) {
                                perm[2] = perm[0];
                                perm[0] = 2;
                            }
                            
                            size_t grid[3];
                            
                            grid[perm[0]] = sdiv_up64(conc_tmp_26126,
                                                      segscan_group_sizze_27686 *
                                                      (int64_t) 9);
                            grid[perm[1]] = 1;
                            grid[perm[2]] = 1;
                            
                            void *kernel_args_30617[] = {&ctx->global_failure,
                                                         &shared_offset_30621,
                                                         &conc_tmp_26126,
                                                         &i32_res_26161,
                                                         &i32_res_26162,
                                                         &kernel_arg_30622,
                                                         &kernel_arg_30623,
                                                         &kernel_arg_30624,
                                                         &kernel_arg_30625,
                                                         &kernel_arg_30626,
                                                         &kernel_arg_30627,
                                                         &kernel_arg_30628,
                                                         &kernel_arg_30629,
                                                         &kernel_arg_30630,
                                                         &kernel_arg_30631,
                                                         &kernel_arg_30632,
                                                         &kernel_arg_30633,
                                                         &kernel_arg_30634,
                                                         &kernel_arg_30635,
                                                         &kernel_arg_30636,
                                                         &kernel_arg_30637};
                            int64_t time_start_30618 = 0, time_end_30619 = 0;
                            
                            if (ctx->debugging) {
                                fprintf(stderr, "Launching %s with grid size (",
                                        "eWiseMultEntry.segscan_27691");
                                fprintf(stderr, "%d", sdiv_up64(conc_tmp_26126,
                                                                segscan_group_sizze_27686 *
                                                                (int64_t) 9));
                                fprintf(stderr, ", ");
                                fprintf(stderr, "%d", 1);
                                fprintf(stderr, ", ");
                                fprintf(stderr, "%d", 1);
                                fprintf(stderr, ") and block size (");
                                fprintf(stderr, "%d",
                                        segscan_group_sizze_27686);
                                fprintf(stderr, ", ");
                                fprintf(stderr, "%d", 1);
                                fprintf(stderr, ", ");
                                fprintf(stderr, "%d", 1);
                                fprintf(stderr, ").\n");
                                time_start_30618 = get_wall_time();
                            }
                            
                            cudaEvent_t *pevents = NULL;
                            
                            if (ctx->profiling && !ctx->profiling_paused) {
                                pevents = cuda_get_events(&ctx->cuda,
                                                          &ctx->eWiseMultEntryzisegscan_27691_runs,
                                                          &ctx->eWiseMultEntryzisegscan_27691_total_runtime);
                                CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
                            }
                            CUDA_SUCCEED(cuLaunchKernel(ctx->eWiseMultEntryzisegscan_27691,
                                                        grid[0], grid[1],
                                                        grid[2],
                                                        segscan_group_sizze_27686,
                                                        1, 1, 0 +
                                                        (shared_sizze_30620 +
                                                         (8 -
                                                          shared_sizze_30620 %
                                                          8) % 8), NULL,
                                                        kernel_args_30617,
                                                        NULL));
                            if (pevents != NULL)
                                CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
                            if (ctx->debugging) {
                                CUDA_SUCCEED(cuCtxSynchronize());
                                time_end_30619 = get_wall_time();
                                fprintf(stderr, "Kernel %s runtime: %ldus\n",
                                        "eWiseMultEntry.segscan_27691",
                                        time_end_30619 - time_start_30618);
                            }
                        }
                        if (memblock_unref_device(ctx, &incprefixes_mem_29337,
                                                  "incprefixes_mem_29337") != 0)
                            return 1;
                        if (memblock_unref_device(ctx, &aggregates_mem_29335,
                                                  "aggregates_mem_29335") != 0)
                            return 1;
                        if (memblock_unref_device(ctx, &incprefixes_mem_29333,
                                                  "incprefixes_mem_29333") != 0)
                            return 1;
                        if (memblock_unref_device(ctx, &aggregates_mem_29331,
                                                  "aggregates_mem_29331") != 0)
                            return 1;
                        if (memblock_unref_device(ctx, &incprefixes_mem_29329,
                                                  "incprefixes_mem_29329") != 0)
                            return 1;
                        if (memblock_unref_device(ctx, &aggregates_mem_29327,
                                                  "aggregates_mem_29327") != 0)
                            return 1;
                        if (memblock_unref_device(ctx, &incprefixes_mem_29325,
                                                  "incprefixes_mem_29325") != 0)
                            return 1;
                        if (memblock_unref_device(ctx, &aggregates_mem_29323,
                                                  "aggregates_mem_29323") != 0)
                            return 1;
                        if (memblock_unref_device(ctx, &status_flags_mem_29321,
                                                  "status_flags_mem_29321") !=
                            0)
                            return 1;
                    }
                    
                    int64_t read_res_30638;
                    
                    {
                        cudaEvent_t *pevents = NULL;
                        
                        if (ctx->profiling && !ctx->profiling_paused) {
                            pevents = cuda_get_events(&ctx->cuda,
                                                      &ctx->copy_scalar_from_dev_runs,
                                                      &ctx->copy_scalar_from_dev_total_runtime);
                            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
                        }
                        CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30638,
                                                  mem_28378.mem + j_m_i_26127 *
                                                  sizeof(int64_t),
                                                  sizeof(int64_t)));
                        if (pevents != NULL)
                            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
                    }
                    if (futhark_context_sync(ctx) != 0)
                        return 1;
                    
                    int64_t last_res_26217 = read_res_30638;
                    int64_t read_res_30639;
                    
                    {
                        cudaEvent_t *pevents = NULL;
                        
                        if (ctx->profiling && !ctx->profiling_paused) {
                            pevents = cuda_get_events(&ctx->cuda,
                                                      &ctx->copy_scalar_from_dev_runs,
                                                      &ctx->copy_scalar_from_dev_total_runtime);
                            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
                        }
                        CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30639,
                                                  mem_28380.mem + j_m_i_26127 *
                                                  sizeof(int64_t),
                                                  sizeof(int64_t)));
                        if (pevents != NULL)
                            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
                    }
                    if (futhark_context_sync(ctx) != 0)
                        return 1;
                    
                    int64_t last_res_26218 = read_res_30639;
                    int64_t read_res_30640;
                    
                    {
                        cudaEvent_t *pevents = NULL;
                        
                        if (ctx->profiling && !ctx->profiling_paused) {
                            pevents = cuda_get_events(&ctx->cuda,
                                                      &ctx->copy_scalar_from_dev_runs,
                                                      &ctx->copy_scalar_from_dev_total_runtime);
                            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
                        }
                        CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30640,
                                                  mem_28382.mem + j_m_i_26127 *
                                                  sizeof(int64_t),
                                                  sizeof(int64_t)));
                        if (pevents != NULL)
                            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
                    }
                    if (futhark_context_sync(ctx) != 0)
                        return 1;
                    
                    int64_t last_res_26219 = read_res_30640;
                    struct memblock_device mem_28388;
                    
                    mem_28388.references = NULL;
                    if (memblock_alloc_device(ctx, &mem_28388, bytes_28358,
                                              "mem_28388")) {
                        err = 1;
                        goto cleanup;
                    }
                    {
                        cudaEvent_t *pevents = NULL;
                        
                        if (ctx->profiling && !ctx->profiling_paused) {
                            pevents = cuda_get_events(&ctx->cuda,
                                                      &ctx->copy_dev_to_dev_runs,
                                                      &ctx->copy_dev_to_dev_total_runtime);
                            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
                        }
                        CUDA_SUCCEED(cuMemcpy(mem_28388.mem + (int64_t) 0,
                                              mem_param_28366.mem + (int64_t) 0,
                                              conc_tmp_26126 *
                                              (int64_t) sizeof(int64_t)));
                        if (pevents != NULL)
                            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
                    }
                    
                    struct memblock_device mem_28390;
                    
                    mem_28390.references = NULL;
                    if (memblock_alloc_device(ctx, &mem_28390, bytes_28358,
                                              "mem_28390")) {
                        err = 1;
                        goto cleanup;
                    }
                    {
                        cudaEvent_t *pevents = NULL;
                        
                        if (ctx->profiling && !ctx->profiling_paused) {
                            pevents = cuda_get_events(&ctx->cuda,
                                                      &ctx->copy_dev_to_dev_runs,
                                                      &ctx->copy_dev_to_dev_total_runtime);
                            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
                        }
                        CUDA_SUCCEED(cuMemcpy(mem_28390.mem + (int64_t) 0,
                                              mem_param_28371.mem + (int64_t) 0,
                                              conc_tmp_26126 *
                                              (int64_t) sizeof(int64_t)));
                        if (pevents != NULL)
                            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
                    }
                    if (ctx->debugging)
                        fprintf(stderr, "%s\n", "\n# SegMap");
                    
                    CUdeviceptr kernel_arg_30644 = mem_param_28366.mem;
                    CUdeviceptr kernel_arg_30645 = mem_param_28371.mem;
                    CUdeviceptr kernel_arg_30646 = mem_28378.mem;
                    CUdeviceptr kernel_arg_30647 = mem_28380.mem;
                    CUdeviceptr kernel_arg_30648 = mem_28382.mem;
                    CUdeviceptr kernel_arg_30649 = mem_28384.mem;
                    CUdeviceptr kernel_arg_30650 = mem_28386.mem;
                    CUdeviceptr kernel_arg_30651 = mem_28388.mem;
                    CUdeviceptr kernel_arg_30652 = mem_28390.mem;
                    
                    if ((((((1 && segmap_usable_groups_27697 != 0) && 1 != 0) &&
                           1 != 0) && segmap_group_sizze_27696 != 0) && 1 !=
                         0) && 1 != 0) {
                        int perm[3] = {0, 1, 2};
                        
                        if (1 >= 1 << 16) {
                            perm[1] = perm[0];
                            perm[0] = 1;
                        }
                        if (1 >= 1 << 16) {
                            perm[2] = perm[0];
                            perm[0] = 2;
                        }
                        
                        size_t grid[3];
                        
                        grid[perm[0]] = segmap_usable_groups_27697;
                        grid[perm[1]] = 1;
                        grid[perm[2]] = 1;
                        
                        void *kernel_args_30641[] = {&ctx->global_failure,
                                                     &conc_tmp_26126,
                                                     &last_res_26217,
                                                     &last_res_26218,
                                                     &last_res_26219,
                                                     &kernel_arg_30644,
                                                     &kernel_arg_30645,
                                                     &kernel_arg_30646,
                                                     &kernel_arg_30647,
                                                     &kernel_arg_30648,
                                                     &kernel_arg_30649,
                                                     &kernel_arg_30650,
                                                     &kernel_arg_30651,
                                                     &kernel_arg_30652};
                        int64_t time_start_30642 = 0, time_end_30643 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(stderr, "Launching %s with grid size (",
                                    "eWiseMultEntry.segmap_27693");
                            fprintf(stderr, "%d", segmap_usable_groups_27697);
                            fprintf(stderr, ", ");
                            fprintf(stderr, "%d", 1);
                            fprintf(stderr, ", ");
                            fprintf(stderr, "%d", 1);
                            fprintf(stderr, ") and block size (");
                            fprintf(stderr, "%d", segmap_group_sizze_27696);
                            fprintf(stderr, ", ");
                            fprintf(stderr, "%d", 1);
                            fprintf(stderr, ", ");
                            fprintf(stderr, "%d", 1);
                            fprintf(stderr, ").\n");
                            time_start_30642 = get_wall_time();
                        }
                        
                        cudaEvent_t *pevents = NULL;
                        
                        if (ctx->profiling && !ctx->profiling_paused) {
                            pevents = cuda_get_events(&ctx->cuda,
                                                      &ctx->eWiseMultEntryzisegmap_27693_runs,
                                                      &ctx->eWiseMultEntryzisegmap_27693_total_runtime);
                            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
                        }
                        CUDA_SUCCEED(cuLaunchKernel(ctx->eWiseMultEntryzisegmap_27693,
                                                    grid[0], grid[1], grid[2],
                                                    segmap_group_sizze_27696, 1,
                                                    1, 0, NULL,
                                                    kernel_args_30641, NULL));
                        if (pevents != NULL)
                            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
                        if (ctx->debugging) {
                            CUDA_SUCCEED(cuCtxSynchronize());
                            time_end_30643 = get_wall_time();
                            fprintf(stderr, "Kernel %s runtime: %ldus\n",
                                    "eWiseMultEntry.segmap_27693",
                                    time_end_30643 - time_start_30642);
                        }
                    }
                    
                    struct memblock_device mem_param_tmp_29313;
                    
                    mem_param_tmp_29313.references = NULL;
                    if (memblock_set_device(ctx, &mem_param_tmp_29313,
                                            &mem_28388, "mem_28388") != 0)
                        return 1;
                    
                    struct memblock_device mem_param_tmp_29314;
                    
                    mem_param_tmp_29314.references = NULL;
                    if (memblock_set_device(ctx, &mem_param_tmp_29314,
                                            &mem_28390, "mem_28390") != 0)
                        return 1;
                    if (memblock_set_device(ctx, &mem_param_28366,
                                            &mem_param_tmp_29313,
                                            "mem_param_tmp_29313") != 0)
                        return 1;
                    if (memblock_set_device(ctx, &mem_param_28371,
                                            &mem_param_tmp_29314,
                                            "mem_param_tmp_29314") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_param_tmp_29314,
                                              "mem_param_tmp_29314") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_param_tmp_29313,
                                              "mem_param_tmp_29313") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28390, "mem_28390") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28388, "mem_28388") !=
                        0)
                        return 1;
                }
                if (memblock_set_device(ctx, &defunc_0_f_res_mem_28400,
                                        &mem_param_28366, "mem_param_28366") !=
                    0)
                    return 1;
                if (memblock_set_device(ctx, &defunc_0_f_res_mem_28405,
                                        &mem_param_28371, "mem_param_28371") !=
                    0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28378, "mem_28378") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28380, "mem_28380") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28382, "mem_28382") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28384, "mem_28384") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28386, "mem_28386") != 0)
                    return 1;
                
                int64_t segmap_usable_groups_27774 = sdiv_up64(conc_tmp_26126,
                                                               segmap_group_sizze_27773);
                struct memblock_device mem_28408;
                
                mem_28408.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28408, bytes_28358,
                                          "mem_28408")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28410;
                
                mem_28410.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28410, bytes_28358,
                                          "mem_28410")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28412;
                
                mem_28412.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28412, bytes_28358,
                                          "mem_28412")) {
                    err = 1;
                    goto cleanup;
                }
                if (ctx->debugging)
                    fprintf(stderr, "%s\n", "\n# SegMap");
                
                CUdeviceptr kernel_arg_30656 = leftColumns_mem_28232.mem;
                CUdeviceptr kernel_arg_30657 = rightColumns_mem_28235.mem;
                CUdeviceptr kernel_arg_30658 = defunc_0_f_res_mem_28405.mem;
                CUdeviceptr kernel_arg_30659 = mem_28408.mem;
                CUdeviceptr kernel_arg_30660 = mem_28410.mem;
                CUdeviceptr kernel_arg_30661 = mem_28412.mem;
                
                if ((((((1 && segmap_usable_groups_27774 != 0) && 1 != 0) &&
                       1 != 0) && segmap_group_sizze_27773 != 0) && 1 != 0) &&
                    1 != 0) {
                    int perm[3] = {0, 1, 2};
                    
                    if (1 >= 1 << 16) {
                        perm[1] = perm[0];
                        perm[0] = 1;
                    }
                    if (1 >= 1 << 16) {
                        perm[2] = perm[0];
                        perm[0] = 2;
                    }
                    
                    size_t grid[3];
                    
                    grid[perm[0]] = segmap_usable_groups_27774;
                    grid[perm[1]] = 1;
                    grid[perm[2]] = 1;
                    
                    void *kernel_args_30653[] = {&ctx->global_failure,
                                                 &ctx->failure_is_an_option,
                                                 &ctx->global_failure_args,
                                                 &i_26087, &i_26109,
                                                 &j_m_i_26111, &conc_tmp_26126,
                                                 &kernel_arg_30656,
                                                 &kernel_arg_30657,
                                                 &kernel_arg_30658,
                                                 &kernel_arg_30659,
                                                 &kernel_arg_30660,
                                                 &kernel_arg_30661};
                    int64_t time_start_30654 = 0, time_end_30655 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(stderr, "Launching %s with grid size (",
                                "eWiseMultEntry.segmap_27749");
                        fprintf(stderr, "%d", segmap_usable_groups_27774);
                        fprintf(stderr, ", ");
                        fprintf(stderr, "%d", 1);
                        fprintf(stderr, ", ");
                        fprintf(stderr, "%d", 1);
                        fprintf(stderr, ") and block size (");
                        fprintf(stderr, "%d", segmap_group_sizze_27773);
                        fprintf(stderr, ", ");
                        fprintf(stderr, "%d", 1);
                        fprintf(stderr, ", ");
                        fprintf(stderr, "%d", 1);
                        fprintf(stderr, ").\n");
                        time_start_30654 = get_wall_time();
                    }
                    
                    cudaEvent_t *pevents = NULL;
                    
                    if (ctx->profiling && !ctx->profiling_paused) {
                        pevents = cuda_get_events(&ctx->cuda,
                                                  &ctx->eWiseMultEntryzisegmap_27749_runs,
                                                  &ctx->eWiseMultEntryzisegmap_27749_total_runtime);
                        CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
                    }
                    CUDA_SUCCEED(cuLaunchKernel(ctx->eWiseMultEntryzisegmap_27749,
                                                grid[0], grid[1], grid[2],
                                                segmap_group_sizze_27773, 1, 1,
                                                0, NULL, kernel_args_30653,
                                                NULL));
                    if (pevents != NULL)
                        CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
                    if (ctx->debugging) {
                        CUDA_SUCCEED(cuCtxSynchronize());
                        time_end_30655 = get_wall_time();
                        fprintf(stderr, "Kernel %s runtime: %ldus\n",
                                "eWiseMultEntry.segmap_27749", time_end_30655 -
                                time_start_30654);
                    }
                }
                ctx->failure_is_an_option = 1;
                if (memblock_unref_device(ctx, &defunc_0_f_res_mem_28405,
                                          "defunc_0_f_res_mem_28405") != 0)
                    return 1;
                
                bool index_certs_26271;
                
                if (!ok_or_empty_26270) {
                    ctx->error =
                        msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                  "Index [", (int64_t) 1,
                                  ":] out of bounds for array of shape [",
                                  conc_tmp_26126, "].",
                                  "-> #0  sparse.fut:100:59-68\n   #1  sparse.fut:169:49-171:81\n   #2  sparse.fut:231:17-60\n   #3  sparse.fut:222:1-232:48\n");
                    if (memblock_unref_device(ctx, &mem_28412, "mem_28412") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28410, "mem_28410") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28408, "mem_28408") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_param_28371,
                                              "mem_param_28371") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_param_28366,
                                              "mem_param_28366") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &defunc_0_f_res_mem_28405,
                                              "defunc_0_f_res_mem_28405") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &defunc_0_f_res_mem_28400,
                                              "defunc_0_f_res_mem_28400") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28386, "mem_28386") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28384, "mem_28384") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28382, "mem_28382") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28380, "mem_28380") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28378, "mem_28378") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &intersectArrays_res_f_res_mem_28439,
                                              "intersectArrays_res_f_res_mem_28439") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &intersectArrays_res_f_res_mem_28436,
                                              "intersectArrays_res_f_res_mem_28436") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &intersectArrays_res_f_res_mem_28433,
                                              "intersectArrays_res_f_res_mem_28433") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28361, "mem_28361") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28359, "mem_28359") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &intersectArrays_res_mem_28448,
                                              "intersectArrays_res_mem_28448") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &intersectArrays_res_mem_28445,
                                              "intersectArrays_res_mem_28445") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &intersectArrays_res_mem_28442,
                                              "intersectArrays_res_mem_28442") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28343, "mem_28343") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28341, "mem_28341") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28339, "mem_28339") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                              "double_buffer_mem_28763") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28256, "mem_28256") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28239, "mem_28239") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28248, "mem_28248") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28250, "mem_28250") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28252, "mem_28252") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28254, "mem_28254") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28318, "mem_28318") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                              "group_res_arr_mem_29131") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                              "group_res_arr_mem_29129") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                              "group_res_arr_mem_29127") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28943, "mem_28943") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28941, "mem_28941") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28939, "mem_28939") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28337, "mem_28337") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &out_mem_29123,
                                              "out_mem_29123") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &out_mem_29121,
                                              "out_mem_29121") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &out_mem_29119,
                                              "out_mem_29119") != 0)
                        return 1;
                    return 1;
                }
                
                struct memblock_device mem_28415;
                
                mem_28415.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28415, bytes_28424,
                                          "mem_28415")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28417;
                
                mem_28417.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28417, bytes_28424,
                                          "mem_28417")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28419;
                
                mem_28419.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28419, bytes_28424,
                                          "mem_28419")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28421;
                
                mem_28421.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28421, bytes_28424,
                                          "mem_28421")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28423;
                
                mem_28423.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28423, bytes_28424,
                                          "mem_28423")) {
                    err = 1;
                    goto cleanup;
                }
                if (slt64((int64_t) 0, j_m_i_26127)) {
                    if (ctx->debugging)
                        fprintf(stderr, "%s\n", "\n# SegScan");
                    
                    int64_t numThreads_29540;
                    
                    numThreads_29540 = sdiv_up64(j_m_i_26127,
                                                 segscan_group_sizze_27798 *
                                                 (int64_t) 9) *
                        segscan_group_sizze_27798;
                    
                    int64_t numGroups_29541;
                    
                    numGroups_29541 = sdiv_up64(j_m_i_26127,
                                                segscan_group_sizze_27798 *
                                                (int64_t) 9);
                    
                    struct memblock_device eWiseMultEntryziid_counter_mem_29542
                                           =
                                           ctx->eWiseMultEntryziid_counter_mem_29542;
                    struct memblock_device status_flags_mem_29544;
                    
                    status_flags_mem_29544.references = NULL;
                    if (memblock_alloc_device(ctx, &status_flags_mem_29544,
                                              (int64_t) sizeof(int8_t) *
                                              numGroups_29541,
                                              "status_flags_mem_29544")) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    struct memblock_device aggregates_mem_29546;
                    
                    aggregates_mem_29546.references = NULL;
                    if (memblock_alloc_device(ctx, &aggregates_mem_29546,
                                              (int64_t) sizeof(int64_t) *
                                              numGroups_29541,
                                              "aggregates_mem_29546")) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    struct memblock_device incprefixes_mem_29548;
                    
                    incprefixes_mem_29548.references = NULL;
                    if (memblock_alloc_device(ctx, &incprefixes_mem_29548,
                                              (int64_t) sizeof(int64_t) *
                                              numGroups_29541,
                                              "incprefixes_mem_29548")) {
                        err = 1;
                        goto cleanup;
                    }
                    if (futrts_builtinzhreplicate_i8(ctx,
                                                     status_flags_mem_29544,
                                                     numGroups_29541,
                                                     (int8_t) 0) != 0) {
                        err = 1;
                        goto cleanup;
                    }
                    
                    unsigned int shared_sizze_30666 =
                                 smax64(smax64((int64_t) 288, (int64_t) 8 *
                                               segscan_group_sizze_27798),
                                        (int64_t) 9 *
                                        segscan_group_sizze_27798 *
                                        (int64_t) 8);
                    CUdeviceptr kernel_arg_30668 = mem_28408.mem;
                    CUdeviceptr kernel_arg_30669 = mem_28410.mem;
                    CUdeviceptr kernel_arg_30670 = mem_28412.mem;
                    CUdeviceptr kernel_arg_30671 = mem_28415.mem;
                    CUdeviceptr kernel_arg_30672 = mem_28417.mem;
                    CUdeviceptr kernel_arg_30673 = mem_28419.mem;
                    CUdeviceptr kernel_arg_30674 = mem_28421.mem;
                    CUdeviceptr kernel_arg_30675 = mem_28423.mem;
                    CUdeviceptr kernel_arg_30676 =
                                eWiseMultEntryziid_counter_mem_29542.mem;
                    CUdeviceptr kernel_arg_30677 = status_flags_mem_29544.mem;
                    CUdeviceptr kernel_arg_30678 = aggregates_mem_29546.mem;
                    CUdeviceptr kernel_arg_30679 = incprefixes_mem_29548.mem;
                    unsigned int shared_offset_30667 = 0;
                    
                    if ((((((1 && sdiv_up64(j_m_i_26127,
                                            segscan_group_sizze_27798 *
                                            (int64_t) 9) != 0) && 1 != 0) &&
                           1 != 0) && segscan_group_sizze_27798 != 0) && 1 !=
                         0) && 1 != 0) {
                        int perm[3] = {0, 1, 2};
                        
                        if (1 >= 1 << 16) {
                            perm[1] = perm[0];
                            perm[0] = 1;
                        }
                        if (1 >= 1 << 16) {
                            perm[2] = perm[0];
                            perm[0] = 2;
                        }
                        
                        size_t grid[3];
                        
                        grid[perm[0]] = sdiv_up64(j_m_i_26127,
                                                  segscan_group_sizze_27798 *
                                                  (int64_t) 9);
                        grid[perm[1]] = 1;
                        grid[perm[2]] = 1;
                        
                        void *kernel_args_30663[] = {&ctx->global_failure,
                                                     &ctx->failure_is_an_option,
                                                     &ctx->global_failure_args,
                                                     &shared_offset_30667,
                                                     &conc_tmp_26126,
                                                     &j_m_i_26127,
                                                     &kernel_arg_30668,
                                                     &kernel_arg_30669,
                                                     &kernel_arg_30670,
                                                     &kernel_arg_30671,
                                                     &kernel_arg_30672,
                                                     &kernel_arg_30673,
                                                     &kernel_arg_30674,
                                                     &kernel_arg_30675,
                                                     &kernel_arg_30676,
                                                     &kernel_arg_30677,
                                                     &kernel_arg_30678,
                                                     &kernel_arg_30679};
                        int64_t time_start_30664 = 0, time_end_30665 = 0;
                        
                        if (ctx->debugging) {
                            fprintf(stderr, "Launching %s with grid size (",
                                    "eWiseMultEntry.segscan_27803");
                            fprintf(stderr, "%d", sdiv_up64(j_m_i_26127,
                                                            segscan_group_sizze_27798 *
                                                            (int64_t) 9));
                            fprintf(stderr, ", ");
                            fprintf(stderr, "%d", 1);
                            fprintf(stderr, ", ");
                            fprintf(stderr, "%d", 1);
                            fprintf(stderr, ") and block size (");
                            fprintf(stderr, "%d", segscan_group_sizze_27798);
                            fprintf(stderr, ", ");
                            fprintf(stderr, "%d", 1);
                            fprintf(stderr, ", ");
                            fprintf(stderr, "%d", 1);
                            fprintf(stderr, ").\n");
                            time_start_30664 = get_wall_time();
                        }
                        
                        cudaEvent_t *pevents = NULL;
                        
                        if (ctx->profiling && !ctx->profiling_paused) {
                            pevents = cuda_get_events(&ctx->cuda,
                                                      &ctx->eWiseMultEntryzisegscan_27803_runs,
                                                      &ctx->eWiseMultEntryzisegscan_27803_total_runtime);
                            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
                        }
                        CUDA_SUCCEED(cuLaunchKernel(ctx->eWiseMultEntryzisegscan_27803,
                                                    grid[0], grid[1], grid[2],
                                                    segscan_group_sizze_27798,
                                                    1, 1, 0 +
                                                    (shared_sizze_30666 + (8 -
                                                                           shared_sizze_30666 %
                                                                           8) %
                                                     8), NULL,
                                                    kernel_args_30663, NULL));
                        if (pevents != NULL)
                            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
                        if (ctx->debugging) {
                            CUDA_SUCCEED(cuCtxSynchronize());
                            time_end_30665 = get_wall_time();
                            fprintf(stderr, "Kernel %s runtime: %ldus\n",
                                    "eWiseMultEntry.segscan_27803",
                                    time_end_30665 - time_start_30664);
                        }
                    }
                    ctx->failure_is_an_option = 1;
                    if (memblock_unref_device(ctx, &incprefixes_mem_29548,
                                              "incprefixes_mem_29548") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &aggregates_mem_29546,
                                              "aggregates_mem_29546") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &status_flags_mem_29544,
                                              "status_flags_mem_29544") != 0)
                        return 1;
                }
                if (memblock_unref_device(ctx, &mem_28408, "mem_28408") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28410, "mem_28410") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28412, "mem_28412") != 0)
                    return 1;
                
                int64_t partition_sizze_26338;
                
                if (is_empty_26146) {
                    partition_sizze_26338 = (int64_t) 0;
                } else {
                    int64_t read_res_30680;
                    
                    {
                        cudaEvent_t *pevents = NULL;
                        
                        if (ctx->profiling && !ctx->profiling_paused) {
                            pevents = cuda_get_events(&ctx->cuda,
                                                      &ctx->copy_scalar_from_dev_runs,
                                                      &ctx->copy_scalar_from_dev_total_runtime);
                            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
                        }
                        CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30680,
                                                  mem_28415.mem +
                                                  last_index_26145 *
                                                  sizeof(int64_t),
                                                  sizeof(int64_t)));
                        if (pevents != NULL)
                            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
                    }
                    if (futhark_context_sync(ctx) != 0)
                        return 1;
                    
                    int64_t last_offset_26339 = read_res_30680;
                    
                    partition_sizze_26338 = last_offset_26339;
                }
                
                struct memblock_device mem_28425;
                
                mem_28425.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28425, bytes_28424,
                                          "mem_28425")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28427;
                
                mem_28427.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28427, bytes_28424,
                                          "mem_28427")) {
                    err = 1;
                    goto cleanup;
                }
                
                struct memblock_device mem_28429;
                
                mem_28429.references = NULL;
                if (memblock_alloc_device(ctx, &mem_28429, bytes_28424,
                                          "mem_28429")) {
                    err = 1;
                    goto cleanup;
                }
                
                int64_t segmap_group_sizze_27808;
                
                segmap_group_sizze_27808 =
                    ctx->sizes.eWiseMultEntryzisegmap_group_sizze_27807;
                
                int64_t segmap_usable_groups_27809 = sdiv_up64(j_m_i_26127,
                                                               segmap_group_sizze_27808);
                
                if (ctx->debugging)
                    fprintf(stderr, "%s\n", "\n# SegMap");
                
                CUdeviceptr kernel_arg_30684 = mem_28415.mem;
                CUdeviceptr kernel_arg_30685 = mem_28417.mem;
                CUdeviceptr kernel_arg_30686 = mem_28419.mem;
                CUdeviceptr kernel_arg_30687 = mem_28421.mem;
                CUdeviceptr kernel_arg_30688 = mem_28423.mem;
                CUdeviceptr kernel_arg_30689 = mem_28425.mem;
                CUdeviceptr kernel_arg_30690 = mem_28427.mem;
                CUdeviceptr kernel_arg_30691 = mem_28429.mem;
                
                if ((((((1 && segmap_usable_groups_27809 != 0) && 1 != 0) &&
                       1 != 0) && segmap_group_sizze_27808 != 0) && 1 != 0) &&
                    1 != 0) {
                    int perm[3] = {0, 1, 2};
                    
                    if (1 >= 1 << 16) {
                        perm[1] = perm[0];
                        perm[0] = 1;
                    }
                    if (1 >= 1 << 16) {
                        perm[2] = perm[0];
                        perm[0] = 2;
                    }
                    
                    size_t grid[3];
                    
                    grid[perm[0]] = segmap_usable_groups_27809;
                    grid[perm[1]] = 1;
                    grid[perm[2]] = 1;
                    
                    void *kernel_args_30681[] = {&ctx->global_failure,
                                                 &j_m_i_26127,
                                                 &kernel_arg_30684,
                                                 &kernel_arg_30685,
                                                 &kernel_arg_30686,
                                                 &kernel_arg_30687,
                                                 &kernel_arg_30688,
                                                 &kernel_arg_30689,
                                                 &kernel_arg_30690,
                                                 &kernel_arg_30691};
                    int64_t time_start_30682 = 0, time_end_30683 = 0;
                    
                    if (ctx->debugging) {
                        fprintf(stderr, "Launching %s with grid size (",
                                "eWiseMultEntry.segmap_27805");
                        fprintf(stderr, "%d", segmap_usable_groups_27809);
                        fprintf(stderr, ", ");
                        fprintf(stderr, "%d", 1);
                        fprintf(stderr, ", ");
                        fprintf(stderr, "%d", 1);
                        fprintf(stderr, ") and block size (");
                        fprintf(stderr, "%d", segmap_group_sizze_27808);
                        fprintf(stderr, ", ");
                        fprintf(stderr, "%d", 1);
                        fprintf(stderr, ", ");
                        fprintf(stderr, "%d", 1);
                        fprintf(stderr, ").\n");
                        time_start_30682 = get_wall_time();
                    }
                    
                    cudaEvent_t *pevents = NULL;
                    
                    if (ctx->profiling && !ctx->profiling_paused) {
                        pevents = cuda_get_events(&ctx->cuda,
                                                  &ctx->eWiseMultEntryzisegmap_27805_runs,
                                                  &ctx->eWiseMultEntryzisegmap_27805_total_runtime);
                        CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
                    }
                    CUDA_SUCCEED(cuLaunchKernel(ctx->eWiseMultEntryzisegmap_27805,
                                                grid[0], grid[1], grid[2],
                                                segmap_group_sizze_27808, 1, 1,
                                                0, NULL, kernel_args_30681,
                                                NULL));
                    if (pevents != NULL)
                        CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
                    if (ctx->debugging) {
                        CUDA_SUCCEED(cuCtxSynchronize());
                        time_end_30683 = get_wall_time();
                        fprintf(stderr, "Kernel %s runtime: %ldus\n",
                                "eWiseMultEntry.segmap_27805", time_end_30683 -
                                time_start_30682);
                    }
                }
                if (memblock_unref_device(ctx, &mem_28415, "mem_28415") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28417, "mem_28417") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28419, "mem_28419") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28421, "mem_28421") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28423, "mem_28423") != 0)
                    return 1;
                
                bool empty_slice_26354 = partition_sizze_26338 == (int64_t) 0;
                int64_t m_26355 = sub64(partition_sizze_26338, (int64_t) 1);
                bool zzero_leq_i_p_m_t_s_26356 = sle64((int64_t) 0, m_26355);
                bool i_p_m_t_s_leq_w_26357 = slt64(m_26355, j_m_i_26127);
                bool i_lte_j_26358 = sle64((int64_t) 0, partition_sizze_26338);
                bool y_26359 = zzero_leq_i_p_m_t_s_26356 &&
                     i_p_m_t_s_leq_w_26357;
                bool y_26360 = i_lte_j_26358 && y_26359;
                bool ok_or_empty_26361 = empty_slice_26354 || y_26360;
                bool index_certs_26362;
                
                if (!ok_or_empty_26361) {
                    ctx->error =
                        msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                  "Index [:", partition_sizze_26338,
                                  "] out of bounds for array of shape [",
                                  j_m_i_26127, "].",
                                  "-> #0  /prelude/soacs.fut:141:6-16\n   #1  sparse.fut:90:3-100:69\n   #2  sparse.fut:169:49-171:81\n   #3  sparse.fut:231:17-60\n   #4  sparse.fut:222:1-232:48\n");
                    if (memblock_unref_device(ctx, &mem_28429, "mem_28429") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28427, "mem_28427") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28425, "mem_28425") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28423, "mem_28423") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28421, "mem_28421") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28419, "mem_28419") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28417, "mem_28417") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28415, "mem_28415") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28412, "mem_28412") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28410, "mem_28410") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28408, "mem_28408") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_param_28371,
                                              "mem_param_28371") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_param_28366,
                                              "mem_param_28366") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &defunc_0_f_res_mem_28405,
                                              "defunc_0_f_res_mem_28405") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &defunc_0_f_res_mem_28400,
                                              "defunc_0_f_res_mem_28400") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28386, "mem_28386") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28384, "mem_28384") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28382, "mem_28382") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28380, "mem_28380") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28378, "mem_28378") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &intersectArrays_res_f_res_mem_28439,
                                              "intersectArrays_res_f_res_mem_28439") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &intersectArrays_res_f_res_mem_28436,
                                              "intersectArrays_res_f_res_mem_28436") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &intersectArrays_res_f_res_mem_28433,
                                              "intersectArrays_res_f_res_mem_28433") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28361, "mem_28361") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28359, "mem_28359") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &intersectArrays_res_mem_28448,
                                              "intersectArrays_res_mem_28448") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &intersectArrays_res_mem_28445,
                                              "intersectArrays_res_mem_28445") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx,
                                              &intersectArrays_res_mem_28442,
                                              "intersectArrays_res_mem_28442") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28343, "mem_28343") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28341, "mem_28341") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28339, "mem_28339") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                              "double_buffer_mem_28763") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28256, "mem_28256") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28239, "mem_28239") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28248, "mem_28248") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28250, "mem_28250") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28252, "mem_28252") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28254, "mem_28254") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28318, "mem_28318") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                              "group_res_arr_mem_29131") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                              "group_res_arr_mem_29129") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                              "group_res_arr_mem_29127") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28943, "mem_28943") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28941, "mem_28941") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28939, "mem_28939") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &mem_28337, "mem_28337") !=
                        0)
                        return 1;
                    if (memblock_unref_device(ctx, &out_mem_29123,
                                              "out_mem_29123") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &out_mem_29121,
                                              "out_mem_29121") != 0)
                        return 1;
                    if (memblock_unref_device(ctx, &out_mem_29119,
                                              "out_mem_29119") != 0)
                        return 1;
                    return 1;
                }
                sizze_26147 = partition_sizze_26338;
                sizze_26148 = partition_sizze_26338;
                sizze_26149 = partition_sizze_26338;
                intersectArrays_res_f_res_ixfn_28431 = partition_sizze_26338;
                intersectArrays_res_f_res_ixfn_28434 = partition_sizze_26338;
                intersectArrays_res_f_res_ixfn_28437 = partition_sizze_26338;
                if (memblock_set_device(ctx,
                                        &intersectArrays_res_f_res_mem_28433,
                                        &mem_28425, "mem_28425") != 0)
                    return 1;
                if (memblock_set_device(ctx,
                                        &intersectArrays_res_f_res_mem_28436,
                                        &mem_28427, "mem_28427") != 0)
                    return 1;
                if (memblock_set_device(ctx,
                                        &intersectArrays_res_f_res_mem_28439,
                                        &mem_28429, "mem_28429") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28429, "mem_28429") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28427, "mem_28427") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28425, "mem_28425") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28423, "mem_28423") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28421, "mem_28421") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28419, "mem_28419") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28417, "mem_28417") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28415, "mem_28415") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28412, "mem_28412") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28410, "mem_28410") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28408, "mem_28408") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_28371,
                                          "mem_param_28371") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_param_28366,
                                          "mem_param_28366") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &defunc_0_f_res_mem_28405,
                                          "defunc_0_f_res_mem_28405") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &defunc_0_f_res_mem_28400,
                                          "defunc_0_f_res_mem_28400") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28386, "mem_28386") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28384, "mem_28384") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28382, "mem_28382") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28380, "mem_28380") != 0)
                    return 1;
                if (memblock_unref_device(ctx, &mem_28378, "mem_28378") != 0)
                    return 1;
            }
            if (memblock_unref_device(ctx, &mem_28359, "mem_28359") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28361, "mem_28361") != 0)
                return 1;
            sizze_26128 = sizze_26147;
            sizze_26129 = sizze_26148;
            sizze_26130 = sizze_26149;
            intersectArrays_res_ixfn_28440 =
                intersectArrays_res_f_res_ixfn_28431;
            intersectArrays_res_ixfn_28441 =
                intersectArrays_res_f_res_ixfn_28432;
            intersectArrays_res_ixfn_28443 =
                intersectArrays_res_f_res_ixfn_28434;
            intersectArrays_res_ixfn_28444 =
                intersectArrays_res_f_res_ixfn_28432;
            intersectArrays_res_ixfn_28446 =
                intersectArrays_res_f_res_ixfn_28437;
            intersectArrays_res_ixfn_28447 =
                intersectArrays_res_f_res_ixfn_28432;
            if (memblock_set_device(ctx, &intersectArrays_res_mem_28442,
                                    &intersectArrays_res_f_res_mem_28433,
                                    "intersectArrays_res_f_res_mem_28433") != 0)
                return 1;
            if (memblock_set_device(ctx, &intersectArrays_res_mem_28445,
                                    &intersectArrays_res_f_res_mem_28436,
                                    "intersectArrays_res_f_res_mem_28436") != 0)
                return 1;
            if (memblock_set_device(ctx, &intersectArrays_res_mem_28448,
                                    &intersectArrays_res_f_res_mem_28439,
                                    "intersectArrays_res_f_res_mem_28439") != 0)
                return 1;
            if (memblock_unref_device(ctx, &intersectArrays_res_f_res_mem_28439,
                                      "intersectArrays_res_f_res_mem_28439") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &intersectArrays_res_f_res_mem_28436,
                                      "intersectArrays_res_f_res_mem_28436") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &intersectArrays_res_f_res_mem_28433,
                                      "intersectArrays_res_f_res_mem_28433") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28361, "mem_28361") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28359, "mem_28359") != 0)
                return 1;
        }
        
        bool dim_match_26366 = sizze_26128 == sizze_26129;
        bool empty_or_match_cert_26367;
        
        if (!dim_match_26366) {
            ctx->error = msgprintf("Error: %s\n\nBacktrace:\n%s",
                                   "Function return value does not match shape of declared return type.",
                                   "-> #0  sparse.fut:81:7-100:69\n   #1  sparse.fut:169:49-171:81\n   #2  sparse.fut:231:17-60\n   #3  sparse.fut:222:1-232:48\n");
            if (memblock_unref_device(ctx, &intersectArrays_res_mem_28448,
                                      "intersectArrays_res_mem_28448") != 0)
                return 1;
            if (memblock_unref_device(ctx, &intersectArrays_res_mem_28445,
                                      "intersectArrays_res_mem_28445") != 0)
                return 1;
            if (memblock_unref_device(ctx, &intersectArrays_res_mem_28442,
                                      "intersectArrays_res_mem_28442") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28343, "mem_28343") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28341, "mem_28341") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28339, "mem_28339") != 0)
                return 1;
            if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                      "double_buffer_mem_28763") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28256, "mem_28256") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28248, "mem_28248") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28250, "mem_28250") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28254, "mem_28254") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28318, "mem_28318") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                      "group_res_arr_mem_29131") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                      "group_res_arr_mem_29129") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                      "group_res_arr_mem_29127") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28943, "mem_28943") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28941, "mem_28941") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28939, "mem_28939") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28337, "mem_28337") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29123, "out_mem_29123") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29121, "out_mem_29121") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29119, "out_mem_29119") !=
                0)
                return 1;
            return 1;
        }
        
        bool dim_match_26368 = sizze_26128 == sizze_26130;
        bool empty_or_match_cert_26369;
        
        if (!dim_match_26368) {
            ctx->error = msgprintf("Error: %s\n\nBacktrace:\n%s",
                                   "Function return value does not match shape of declared return type.",
                                   "-> #0  sparse.fut:81:7-100:69\n   #1  sparse.fut:169:49-171:81\n   #2  sparse.fut:231:17-60\n   #3  sparse.fut:222:1-232:48\n");
            if (memblock_unref_device(ctx, &intersectArrays_res_mem_28448,
                                      "intersectArrays_res_mem_28448") != 0)
                return 1;
            if (memblock_unref_device(ctx, &intersectArrays_res_mem_28445,
                                      "intersectArrays_res_mem_28445") != 0)
                return 1;
            if (memblock_unref_device(ctx, &intersectArrays_res_mem_28442,
                                      "intersectArrays_res_mem_28442") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28343, "mem_28343") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28341, "mem_28341") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28339, "mem_28339") != 0)
                return 1;
            if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                      "double_buffer_mem_28763") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28256, "mem_28256") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28248, "mem_28248") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28250, "mem_28250") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28254, "mem_28254") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28318, "mem_28318") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                      "group_res_arr_mem_29131") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                      "group_res_arr_mem_29129") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                      "group_res_arr_mem_29127") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28943, "mem_28943") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28941, "mem_28941") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28939, "mem_28939") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28337, "mem_28337") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29123, "out_mem_29123") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29121, "out_mem_29121") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29119, "out_mem_29119") !=
                0)
                return 1;
            return 1;
        }
        
        int64_t read_res_30692;
        
        {
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->copy_scalar_from_dev_runs,
                                          &ctx->copy_scalar_from_dev_total_runtime);
                CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30692, mem_28337.mem + i_26088 *
                                      sizeof(int64_t), sizeof(int64_t)));
            if (pevents != NULL)
                CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
        }
        if (futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t x_26370 = read_res_30692;
        int64_t read_res_30693;
        
        {
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->copy_scalar_from_dev_runs,
                                          &ctx->copy_scalar_from_dev_total_runtime);
                CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED(cuMemcpyDtoH(&read_res_30693, mem_28337.mem + i_26082 *
                                      sizeof(int64_t), sizeof(int64_t)));
            if (pevents != NULL)
                CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
        }
        if (futhark_context_sync(ctx) != 0)
            return 1;
        
        int64_t y_26371 = read_res_30693;
        int64_t indxs_26372 = sub64(x_26370, y_26371);
        bool bounds_invalid_upwards_26373 = slt64(x_26370, y_26371);
        bool valid_26374 = !bounds_invalid_upwards_26373;
        bool range_valid_c_26375;
        
        if (!valid_26374) {
            ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                   "Range ", y_26371, "..<", x_26370,
                                   " is invalid.",
                                   "-> #0  sparse.fut:173:18-42\n   #1  sparse.fut:231:17-60\n   #2  sparse.fut:222:1-232:48\n");
            if (memblock_unref_device(ctx, &intersectArrays_res_mem_28448,
                                      "intersectArrays_res_mem_28448") != 0)
                return 1;
            if (memblock_unref_device(ctx, &intersectArrays_res_mem_28445,
                                      "intersectArrays_res_mem_28445") != 0)
                return 1;
            if (memblock_unref_device(ctx, &intersectArrays_res_mem_28442,
                                      "intersectArrays_res_mem_28442") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28343, "mem_28343") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28341, "mem_28341") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28339, "mem_28339") != 0)
                return 1;
            if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                      "double_buffer_mem_28763") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28256, "mem_28256") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28248, "mem_28248") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28250, "mem_28250") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28254, "mem_28254") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28318, "mem_28318") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                      "group_res_arr_mem_29131") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                      "group_res_arr_mem_29129") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                      "group_res_arr_mem_29127") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28943, "mem_28943") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28941, "mem_28941") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28939, "mem_28939") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28337, "mem_28337") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29123, "out_mem_29123") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29121, "out_mem_29121") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29119, "out_mem_29119") !=
                0)
                return 1;
            return 1;
        }
        
        bool dim_match_26377 = indxs_26372 == sizze_26128;
        bool empty_or_match_cert_26378;
        
        if (!dim_match_26377) {
            ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                   "Value of (core language) shape (",
                                   sizze_26128,
                                   ") cannot match shape of type `[",
                                   indxs_26372, "]index`.",
                                   "-> #0  sparse.fut:177:26-51\n   #1  sparse.fut:231:17-60\n   #2  sparse.fut:222:1-232:48\n");
            if (memblock_unref_device(ctx, &intersectArrays_res_mem_28448,
                                      "intersectArrays_res_mem_28448") != 0)
                return 1;
            if (memblock_unref_device(ctx, &intersectArrays_res_mem_28445,
                                      "intersectArrays_res_mem_28445") != 0)
                return 1;
            if (memblock_unref_device(ctx, &intersectArrays_res_mem_28442,
                                      "intersectArrays_res_mem_28442") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28343, "mem_28343") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28341, "mem_28341") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28339, "mem_28339") != 0)
                return 1;
            if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                      "double_buffer_mem_28763") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28256, "mem_28256") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28248, "mem_28248") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28250, "mem_28250") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28254, "mem_28254") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28318, "mem_28318") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                      "group_res_arr_mem_29131") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                      "group_res_arr_mem_29129") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                      "group_res_arr_mem_29127") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28943, "mem_28943") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28941, "mem_28941") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28939, "mem_28939") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28337, "mem_28337") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29123, "out_mem_29123") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29121, "out_mem_29121") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29119, "out_mem_29119") !=
                0)
                return 1;
            return 1;
        }
        
        bool empty_or_match_cert_26379;
        
        if (!dim_match_26377) {
            ctx->error = msgprintf("Error: %s%lld%s%lld%s\n\nBacktrace:\n%s",
                                   "Value of (core language) shape (",
                                   sizze_26128,
                                   ") cannot match shape of type `[",
                                   indxs_26372, "]t`.",
                                   "-> #0  sparse.fut:178:25-181:75\n   #1  sparse.fut:231:17-60\n   #2  sparse.fut:222:1-232:48\n");
            if (memblock_unref_device(ctx, &intersectArrays_res_mem_28448,
                                      "intersectArrays_res_mem_28448") != 0)
                return 1;
            if (memblock_unref_device(ctx, &intersectArrays_res_mem_28445,
                                      "intersectArrays_res_mem_28445") != 0)
                return 1;
            if (memblock_unref_device(ctx, &intersectArrays_res_mem_28442,
                                      "intersectArrays_res_mem_28442") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28343, "mem_28343") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28341, "mem_28341") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28339, "mem_28339") != 0)
                return 1;
            if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                                      "double_buffer_mem_28763") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28256, "mem_28256") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28248, "mem_28248") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28250, "mem_28250") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28254, "mem_28254") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28318, "mem_28318") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                                      "group_res_arr_mem_29131") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                                      "group_res_arr_mem_29129") != 0)
                return 1;
            if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                                      "group_res_arr_mem_29127") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28943, "mem_28943") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28941, "mem_28941") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28939, "mem_28939") != 0)
                return 1;
            if (memblock_unref_device(ctx, &mem_28337, "mem_28337") != 0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29123, "out_mem_29123") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29121, "out_mem_29121") !=
                0)
                return 1;
            if (memblock_unref_device(ctx, &out_mem_29119, "out_mem_29119") !=
                0)
                return 1;
            return 1;
        }
        
        int64_t segmap_usable_groups_27815 = sdiv_up64(indxs_26372,
                                                       segmap_group_sizze_27814);
        
        if (ctx->debugging)
            fprintf(stderr, "%s\n", "\n# SegMap");
        
        CUdeviceptr kernel_arg_30697 = leftValues_mem_28231.mem;
        CUdeviceptr kernel_arg_30698 = rightValues_mem_28234.mem;
        CUdeviceptr kernel_arg_30699 = mem_28339.mem;
        CUdeviceptr kernel_arg_30700 = mem_28341.mem;
        CUdeviceptr kernel_arg_30701 = intersectArrays_res_mem_28442.mem;
        CUdeviceptr kernel_arg_30702 = intersectArrays_res_mem_28445.mem;
        CUdeviceptr kernel_arg_30703 = intersectArrays_res_mem_28448.mem;
        
        if ((((((1 && segmap_usable_groups_27815 != 0) && 1 != 0) && 1 != 0) &&
              segmap_group_sizze_27814 != 0) && 1 != 0) && 1 != 0) {
            int perm[3] = {0, 1, 2};
            
            if (1 >= 1 << 16) {
                perm[1] = perm[0];
                perm[0] = 1;
            }
            if (1 >= 1 << 16) {
                perm[2] = perm[0];
                perm[0] = 2;
            }
            
            size_t grid[3];
            
            grid[perm[0]] = segmap_usable_groups_27815;
            grid[perm[1]] = 1;
            grid[perm[2]] = 1;
            
            void *kernel_args_30694[] = {&ctx->global_failure,
                                         &ctx->failure_is_an_option,
                                         &ctx->global_failure_args, &n_25880,
                                         &k_25882, &eWiseMultOffsets_res_26073,
                                         &i_26087, &i_26109, &sizze_26128,
                                         &y_26371, &indxs_26372,
                                         &kernel_arg_30697, &kernel_arg_30698,
                                         &kernel_arg_30699, &kernel_arg_30700,
                                         &kernel_arg_30701, &kernel_arg_30702,
                                         &kernel_arg_30703};
            int64_t time_start_30695 = 0, time_end_30696 = 0;
            
            if (ctx->debugging) {
                fprintf(stderr, "Launching %s with grid size (",
                        "eWiseMultEntry.segmap_27811");
                fprintf(stderr, "%d", segmap_usable_groups_27815);
                fprintf(stderr, ", ");
                fprintf(stderr, "%d", 1);
                fprintf(stderr, ", ");
                fprintf(stderr, "%d", 1);
                fprintf(stderr, ") and block size (");
                fprintf(stderr, "%d", segmap_group_sizze_27814);
                fprintf(stderr, ", ");
                fprintf(stderr, "%d", 1);
                fprintf(stderr, ", ");
                fprintf(stderr, "%d", 1);
                fprintf(stderr, ").\n");
                time_start_30695 = get_wall_time();
            }
            
            cudaEvent_t *pevents = NULL;
            
            if (ctx->profiling && !ctx->profiling_paused) {
                pevents = cuda_get_events(&ctx->cuda,
                                          &ctx->eWiseMultEntryzisegmap_27811_runs,
                                          &ctx->eWiseMultEntryzisegmap_27811_total_runtime);
                CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
            }
            CUDA_SUCCEED(cuLaunchKernel(ctx->eWiseMultEntryzisegmap_27811,
                                        grid[0], grid[1], grid[2],
                                        segmap_group_sizze_27814, 1, 1, 0, NULL,
                                        kernel_args_30694, NULL));
            if (pevents != NULL)
                CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
            if (ctx->debugging) {
                CUDA_SUCCEED(cuCtxSynchronize());
                time_end_30696 = get_wall_time();
                fprintf(stderr, "Kernel %s runtime: %ldus\n",
                        "eWiseMultEntry.segmap_27811", time_end_30696 -
                        time_start_30695);
            }
        }
        ctx->failure_is_an_option = 1;
        if (memblock_unref_device(ctx, &intersectArrays_res_mem_28442,
                                  "intersectArrays_res_mem_28442") != 0)
            return 1;
        if (memblock_unref_device(ctx, &intersectArrays_res_mem_28445,
                                  "intersectArrays_res_mem_28445") != 0)
            return 1;
        if (memblock_unref_device(ctx, &intersectArrays_res_mem_28448,
                                  "intersectArrays_res_mem_28448") != 0)
            return 1;
        if (memblock_unref_device(ctx, &intersectArrays_res_mem_28448,
                                  "intersectArrays_res_mem_28448") != 0)
            return 1;
        if (memblock_unref_device(ctx, &intersectArrays_res_mem_28445,
                                  "intersectArrays_res_mem_28445") != 0)
            return 1;
        if (memblock_unref_device(ctx, &intersectArrays_res_mem_28442,
                                  "intersectArrays_res_mem_28442") != 0)
            return 1;
    }
    if (memblock_unref_device(ctx, &mem_28343, "mem_28343") != 0)
        return 1;
    
    struct memblock_device mem_28461;
    
    mem_28461.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28461, bytes_28338, "mem_28461")) {
        err = 1;
        goto cleanup;
    }
    {
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda, &ctx->copy_dev_to_dev_runs,
                                      &ctx->copy_dev_to_dev_total_runtime);
            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED(cuMemcpy(mem_28461.mem + (int64_t) 0, mem_28339.mem +
                              (int64_t) 0, eWiseMultOffsets_res_26073 *
                              (int64_t) sizeof(double)));
        if (pevents != NULL)
            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
    }
    if (memblock_unref_device(ctx, &mem_28339, "mem_28339") != 0)
        return 1;
    
    struct memblock_device mem_28464;
    
    mem_28464.references = NULL;
    if (memblock_alloc_device(ctx, &mem_28464, bytes_28338, "mem_28464")) {
        err = 1;
        goto cleanup;
    }
    {
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda, &ctx->copy_dev_to_dev_runs,
                                      &ctx->copy_dev_to_dev_total_runtime);
            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED(cuMemcpy(mem_28464.mem + (int64_t) 0, mem_28341.mem +
                              (int64_t) 0, eWiseMultOffsets_res_26073 *
                              (int64_t) sizeof(int64_t)));
        if (pevents != NULL)
            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
    }
    if (memblock_unref_device(ctx, &mem_28341, "mem_28341") != 0)
        return 1;
    out_arrsizze_29120 = eWiseMultOffsets_res_26073;
    out_arrsizze_29122 = eWiseMultOffsets_res_26073;
    if (memblock_set_device(ctx, &out_mem_29119, &mem_28461, "mem_28461") != 0)
        return 1;
    if (memblock_set_device(ctx, &out_mem_29121, &mem_28464, "mem_28464") != 0)
        return 1;
    if (memblock_set_device(ctx, &out_mem_29123, &mem_28337, "mem_28337") != 0)
        return 1;
    (*out_mem_p_30559).references = NULL;
    if (memblock_set_device(ctx, &*out_mem_p_30559, &out_mem_29119,
                            "out_mem_29119") != 0)
        return 1;
    *out_out_arrsizze_30560 = out_arrsizze_29120;
    (*out_mem_p_30561).references = NULL;
    if (memblock_set_device(ctx, &*out_mem_p_30561, &out_mem_29121,
                            "out_mem_29121") != 0)
        return 1;
    *out_out_arrsizze_30562 = out_arrsizze_29122;
    (*out_mem_p_30563).references = NULL;
    if (memblock_set_device(ctx, &*out_mem_p_30563, &out_mem_29123,
                            "out_mem_29123") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28464, "mem_28464") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28461, "mem_28461") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28343, "mem_28343") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28341, "mem_28341") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28339, "mem_28339") != 0)
        return 1;
    if (memblock_unref_device(ctx, &double_buffer_mem_28763,
                              "double_buffer_mem_28763") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28256, "mem_28256") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28239, "mem_28239") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28248, "mem_28248") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28250, "mem_28250") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28252, "mem_28252") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28254, "mem_28254") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28318, "mem_28318") != 0)
        return 1;
    if (memblock_unref_device(ctx, &group_res_arr_mem_29131,
                              "group_res_arr_mem_29131") != 0)
        return 1;
    if (memblock_unref_device(ctx, &group_res_arr_mem_29129,
                              "group_res_arr_mem_29129") != 0)
        return 1;
    if (memblock_unref_device(ctx, &group_res_arr_mem_29127,
                              "group_res_arr_mem_29127") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28943, "mem_28943") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28941, "mem_28941") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28939, "mem_28939") != 0)
        return 1;
    if (memblock_unref_device(ctx, &mem_28337, "mem_28337") != 0)
        return 1;
    if (memblock_unref_device(ctx, &out_mem_29123, "out_mem_29123") != 0)
        return 1;
    if (memblock_unref_device(ctx, &out_mem_29121, "out_mem_29121") != 0)
        return 1;
    if (memblock_unref_device(ctx, &out_mem_29119, "out_mem_29119") != 0)
        return 1;
    
  cleanup:
    { }
    return err;
}
struct futhark_i64_1d {
    struct memblock_device mem;
    int64_t shape[1];
} ;
struct futhark_i64_1d *futhark_new_i64_1d(struct futhark_context *ctx, const
                                          int64_t *data, int64_t dim0)
{
    struct futhark_i64_1d *bad = NULL;
    struct futhark_i64_1d *arr =
                          (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED(cuCtxPushCurrent(ctx->cuda.cu_ctx));
    arr->mem.references = NULL;
    if (memblock_alloc_device(ctx, &arr->mem, (size_t) dim0 * sizeof(int64_t),
                              "arr->mem"))
        return NULL;
    arr->shape[0] = dim0;
    {
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda, &ctx->copy_host_to_dev_runs,
                                      &ctx->copy_host_to_dev_total_runtime);
            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED(cuMemcpyHtoD(arr->mem.mem + 0, data + 0, (size_t) dim0 *
                                  sizeof(int64_t)));
        if (pevents != NULL)
            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
    }
    CUDA_SUCCEED(cuCtxPopCurrent(&ctx->cuda.cu_ctx));
    lock_unlock(&ctx->lock);
    return arr;
}
struct futhark_i64_1d *futhark_new_raw_i64_1d(struct futhark_context *ctx, const
                                              CUdeviceptr data, int offset,
                                              int64_t dim0)
{
    struct futhark_i64_1d *bad = NULL;
    struct futhark_i64_1d *arr =
                          (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED(cuCtxPushCurrent(ctx->cuda.cu_ctx));
    arr->mem.references = NULL;
    if (memblock_alloc_device(ctx, &arr->mem, (size_t) dim0 * sizeof(int64_t),
                              "arr->mem"))
        return NULL;
    arr->shape[0] = dim0;
    {
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda, &ctx->copy_dev_to_dev_runs,
                                      &ctx->copy_dev_to_dev_total_runtime);
            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED(cuMemcpy(arr->mem.mem + 0, data + offset, (size_t) dim0 *
                              sizeof(int64_t)));
        if (pevents != NULL)
            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
    }
    CUDA_SUCCEED(cuCtxPopCurrent(&ctx->cuda.cu_ctx));
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_i64_1d(struct futhark_context *ctx, struct futhark_i64_1d *arr)
{
    lock_lock(&ctx->lock);
    CUDA_SUCCEED(cuCtxPushCurrent(ctx->cuda.cu_ctx));
    if (memblock_unref_device(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    CUDA_SUCCEED(cuCtxPopCurrent(&ctx->cuda.cu_ctx));
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_i64_1d(struct futhark_context *ctx,
                          struct futhark_i64_1d *arr, int64_t *data)
{
    lock_lock(&ctx->lock);
    CUDA_SUCCEED(cuCtxPushCurrent(ctx->cuda.cu_ctx));
    {
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda, &ctx->copy_dev_to_host_runs,
                                      &ctx->copy_dev_to_host_total_runtime);
            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED(cuMemcpyDtoH(data + 0, arr->mem.mem + 0,
                                  (size_t) arr->shape[0] * sizeof(int64_t)));
        if (pevents != NULL)
            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
    }
    CUDA_SUCCEED(cuCtxPopCurrent(&ctx->cuda.cu_ctx));
    lock_unlock(&ctx->lock);
    return 0;
}
CUdeviceptr futhark_values_raw_i64_1d(struct futhark_context *ctx,
                                      struct futhark_i64_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_i64_1d(struct futhark_context *ctx,
                                    struct futhark_i64_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
struct futhark_f64_1d {
    struct memblock_device mem;
    int64_t shape[1];
} ;
struct futhark_f64_1d *futhark_new_f64_1d(struct futhark_context *ctx, const
                                          double *data, int64_t dim0)
{
    struct futhark_f64_1d *bad = NULL;
    struct futhark_f64_1d *arr =
                          (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED(cuCtxPushCurrent(ctx->cuda.cu_ctx));
    arr->mem.references = NULL;
    if (memblock_alloc_device(ctx, &arr->mem, (size_t) dim0 * sizeof(double),
                              "arr->mem"))
        return NULL;
    arr->shape[0] = dim0;
    {
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda, &ctx->copy_host_to_dev_runs,
                                      &ctx->copy_host_to_dev_total_runtime);
            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED(cuMemcpyHtoD(arr->mem.mem + 0, data + 0, (size_t) dim0 *
                                  sizeof(double)));
        if (pevents != NULL)
            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
    }
    CUDA_SUCCEED(cuCtxPopCurrent(&ctx->cuda.cu_ctx));
    lock_unlock(&ctx->lock);
    return arr;
}
struct futhark_f64_1d *futhark_new_raw_f64_1d(struct futhark_context *ctx, const
                                              CUdeviceptr data, int offset,
                                              int64_t dim0)
{
    struct futhark_f64_1d *bad = NULL;
    struct futhark_f64_1d *arr =
                          (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d));
    
    if (arr == NULL)
        return bad;
    lock_lock(&ctx->lock);
    CUDA_SUCCEED(cuCtxPushCurrent(ctx->cuda.cu_ctx));
    arr->mem.references = NULL;
    if (memblock_alloc_device(ctx, &arr->mem, (size_t) dim0 * sizeof(double),
                              "arr->mem"))
        return NULL;
    arr->shape[0] = dim0;
    {
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda, &ctx->copy_dev_to_dev_runs,
                                      &ctx->copy_dev_to_dev_total_runtime);
            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED(cuMemcpy(arr->mem.mem + 0, data + offset, (size_t) dim0 *
                              sizeof(double)));
        if (pevents != NULL)
            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
    }
    CUDA_SUCCEED(cuCtxPopCurrent(&ctx->cuda.cu_ctx));
    lock_unlock(&ctx->lock);
    return arr;
}
int futhark_free_f64_1d(struct futhark_context *ctx, struct futhark_f64_1d *arr)
{
    lock_lock(&ctx->lock);
    CUDA_SUCCEED(cuCtxPushCurrent(ctx->cuda.cu_ctx));
    if (memblock_unref_device(ctx, &arr->mem, "arr->mem") != 0)
        return 1;
    CUDA_SUCCEED(cuCtxPopCurrent(&ctx->cuda.cu_ctx));
    lock_unlock(&ctx->lock);
    free(arr);
    return 0;
}
int futhark_values_f64_1d(struct futhark_context *ctx,
                          struct futhark_f64_1d *arr, double *data)
{
    lock_lock(&ctx->lock);
    CUDA_SUCCEED(cuCtxPushCurrent(ctx->cuda.cu_ctx));
    {
        cudaEvent_t *pevents = NULL;
        
        if (ctx->profiling && !ctx->profiling_paused) {
            pevents = cuda_get_events(&ctx->cuda, &ctx->copy_dev_to_host_runs,
                                      &ctx->copy_dev_to_host_total_runtime);
            CUDA_SUCCEED(cudaEventRecord(pevents[0], 0));
        }
        CUDA_SUCCEED(cuMemcpyDtoH(data + 0, arr->mem.mem + 0,
                                  (size_t) arr->shape[0] * sizeof(double)));
        if (pevents != NULL)
            CUDA_SUCCEED(cudaEventRecord(pevents[1], 0));
    }
    CUDA_SUCCEED(cuCtxPopCurrent(&ctx->cuda.cu_ctx));
    lock_unlock(&ctx->lock);
    return 0;
}
CUdeviceptr futhark_values_raw_f64_1d(struct futhark_context *ctx,
                                      struct futhark_f64_1d *arr)
{
    (void) ctx;
    return arr->mem.mem;
}
const int64_t *futhark_shape_f64_1d(struct futhark_context *ctx,
                                    struct futhark_f64_1d *arr)
{
    (void) ctx;
    return arr->shape;
}
int futhark_entry_eWiseAddEntry(struct futhark_context *ctx,
                                struct futhark_f64_1d **out0,
                                struct futhark_i64_1d **out1,
                                struct futhark_i64_1d **out2, const
                                struct futhark_f64_1d *in0, const
                                struct futhark_i64_1d *in1, const
                                struct futhark_i64_1d *in2, const
                                struct futhark_f64_1d *in3, const
                                struct futhark_i64_1d *in4, const
                                struct futhark_i64_1d *in5)
{
    struct memblock_device leftValues_mem_28231;
    
    leftValues_mem_28231.references = NULL;
    
    struct memblock_device leftColumns_mem_28232;
    
    leftColumns_mem_28232.references = NULL;
    
    struct memblock_device leftOffsets_mem_28233;
    
    leftOffsets_mem_28233.references = NULL;
    
    struct memblock_device rightValues_mem_28234;
    
    rightValues_mem_28234.references = NULL;
    
    struct memblock_device rightColumns_mem_28235;
    
    rightColumns_mem_28235.references = NULL;
    
    struct memblock_device rightOffsets_mem_28236;
    
    rightOffsets_mem_28236.references = NULL;
    
    int64_t n_25269;
    int64_t m_25270;
    int64_t k_25271;
    struct memblock_device out_mem_29119;
    
    out_mem_29119.references = NULL;
    
    int64_t out_arrsizze_29120;
    struct memblock_device out_mem_29121;
    
    out_mem_29121.references = NULL;
    
    int64_t out_arrsizze_29122;
    struct memblock_device out_mem_29123;
    
    out_mem_29123.references = NULL;
    
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED(cuCtxPushCurrent(ctx->cuda.cu_ctx));
    leftValues_mem_28231 = in0->mem;
    n_25269 = in0->shape[0];
    leftColumns_mem_28232 = in1->mem;
    n_25269 = in1->shape[0];
    leftOffsets_mem_28233 = in2->mem;
    m_25270 = in2->shape[0];
    rightValues_mem_28234 = in3->mem;
    k_25271 = in3->shape[0];
    rightColumns_mem_28235 = in4->mem;
    k_25271 = in4->shape[0];
    rightOffsets_mem_28236 = in5->mem;
    m_25270 = in5->shape[0];
    if (!(n_25269 == in0->shape[0] && (n_25269 == in1->shape[0] && (m_25270 ==
                                                                    in2->shape[0] &&
                                                                    (k_25271 ==
                                                                     in3->shape[0] &&
                                                                     (k_25271 ==
                                                                      in4->shape[0] &&
                                                                      m_25270 ==
                                                                      in5->shape[0])))))) {
        ret = 1;
        if (!ctx->error)
            ctx->error =
                msgprintf("Error: entry point arguments have invalid sizes.\n");
    } else {
        ret = futrts_eWiseAddEntry(ctx, &out_mem_29119, &out_arrsizze_29120,
                                   &out_mem_29121, &out_arrsizze_29122,
                                   &out_mem_29123, leftValues_mem_28231,
                                   leftColumns_mem_28232, leftOffsets_mem_28233,
                                   rightValues_mem_28234,
                                   rightColumns_mem_28235,
                                   rightOffsets_mem_28236, n_25269, m_25270,
                                   k_25271);
        if (ret == 0) {
            assert((*out0 =
                    (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) !=
                NULL);
            (*out0)->mem = out_mem_29119;
            (*out0)->shape[0] = out_arrsizze_29120;
            assert((*out1 =
                    (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) !=
                NULL);
            (*out1)->mem = out_mem_29121;
            (*out1)->shape[0] = out_arrsizze_29122;
            assert((*out2 =
                    (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) !=
                NULL);
            (*out2)->mem = out_mem_29123;
            (*out2)->shape[0] = m_25270;
        }
    }
    CUDA_SUCCEED(cuCtxPopCurrent(&ctx->cuda.cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_eWiseAddMultEntry(struct futhark_context *ctx,
                                    struct futhark_f64_1d **out0,
                                    struct futhark_i64_1d **out1,
                                    struct futhark_i64_1d **out2, const
                                    struct futhark_f64_1d *in0, const
                                    struct futhark_i64_1d *in1, const
                                    struct futhark_i64_1d *in2, const
                                    struct futhark_f64_1d *in3, const
                                    struct futhark_i64_1d *in4, const
                                    struct futhark_i64_1d *in5)
{
    struct memblock_device leftValues_mem_28231;
    
    leftValues_mem_28231.references = NULL;
    
    struct memblock_device leftColumns_mem_28232;
    
    leftColumns_mem_28232.references = NULL;
    
    struct memblock_device leftOffsets_mem_28233;
    
    leftOffsets_mem_28233.references = NULL;
    
    struct memblock_device rightValues_mem_28234;
    
    rightValues_mem_28234.references = NULL;
    
    struct memblock_device rightColumns_mem_28235;
    
    rightColumns_mem_28235.references = NULL;
    
    struct memblock_device rightOffsets_mem_28236;
    
    rightOffsets_mem_28236.references = NULL;
    
    int64_t n_26407;
    int64_t m_26408;
    int64_t k_26409;
    struct memblock_device out_mem_29119;
    
    out_mem_29119.references = NULL;
    
    int64_t out_arrsizze_29120;
    struct memblock_device out_mem_29121;
    
    out_mem_29121.references = NULL;
    
    int64_t out_arrsizze_29122;
    struct memblock_device out_mem_29123;
    
    out_mem_29123.references = NULL;
    
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED(cuCtxPushCurrent(ctx->cuda.cu_ctx));
    leftValues_mem_28231 = in0->mem;
    n_26407 = in0->shape[0];
    leftColumns_mem_28232 = in1->mem;
    n_26407 = in1->shape[0];
    leftOffsets_mem_28233 = in2->mem;
    m_26408 = in2->shape[0];
    rightValues_mem_28234 = in3->mem;
    k_26409 = in3->shape[0];
    rightColumns_mem_28235 = in4->mem;
    k_26409 = in4->shape[0];
    rightOffsets_mem_28236 = in5->mem;
    m_26408 = in5->shape[0];
    if (!(n_26407 == in0->shape[0] && (n_26407 == in1->shape[0] && (m_26408 ==
                                                                    in2->shape[0] &&
                                                                    (k_26409 ==
                                                                     in3->shape[0] &&
                                                                     (k_26409 ==
                                                                      in4->shape[0] &&
                                                                      m_26408 ==
                                                                      in5->shape[0])))))) {
        ret = 1;
        if (!ctx->error)
            ctx->error =
                msgprintf("Error: entry point arguments have invalid sizes.\n");
    } else {
        ret = futrts_eWiseAddMultEntry(ctx, &out_mem_29119, &out_arrsizze_29120,
                                       &out_mem_29121, &out_arrsizze_29122,
                                       &out_mem_29123, leftValues_mem_28231,
                                       leftColumns_mem_28232,
                                       leftOffsets_mem_28233,
                                       rightValues_mem_28234,
                                       rightColumns_mem_28235,
                                       rightOffsets_mem_28236, n_26407, m_26408,
                                       k_26409);
        if (ret == 0) {
            assert((*out0 =
                    (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) !=
                NULL);
            (*out0)->mem = out_mem_29119;
            (*out0)->shape[0] = out_arrsizze_29120;
            assert((*out1 =
                    (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) !=
                NULL);
            (*out1)->mem = out_mem_29121;
            (*out1)->shape[0] = out_arrsizze_29122;
            assert((*out2 =
                    (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) !=
                NULL);
            (*out2)->mem = out_mem_29123;
            (*out2)->shape[0] = m_26408;
        }
    }
    CUDA_SUCCEED(cuCtxPopCurrent(&ctx->cuda.cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
int futhark_entry_eWiseMultEntry(struct futhark_context *ctx,
                                 struct futhark_f64_1d **out0,
                                 struct futhark_i64_1d **out1,
                                 struct futhark_i64_1d **out2, const
                                 struct futhark_f64_1d *in0, const
                                 struct futhark_i64_1d *in1, const
                                 struct futhark_i64_1d *in2, const
                                 struct futhark_f64_1d *in3, const
                                 struct futhark_i64_1d *in4, const
                                 struct futhark_i64_1d *in5)
{
    struct memblock_device leftValues_mem_28231;
    
    leftValues_mem_28231.references = NULL;
    
    struct memblock_device leftColumns_mem_28232;
    
    leftColumns_mem_28232.references = NULL;
    
    struct memblock_device leftOffsets_mem_28233;
    
    leftOffsets_mem_28233.references = NULL;
    
    struct memblock_device rightValues_mem_28234;
    
    rightValues_mem_28234.references = NULL;
    
    struct memblock_device rightColumns_mem_28235;
    
    rightColumns_mem_28235.references = NULL;
    
    struct memblock_device rightOffsets_mem_28236;
    
    rightOffsets_mem_28236.references = NULL;
    
    int64_t n_25880;
    int64_t m_25881;
    int64_t k_25882;
    struct memblock_device out_mem_29119;
    
    out_mem_29119.references = NULL;
    
    int64_t out_arrsizze_29120;
    struct memblock_device out_mem_29121;
    
    out_mem_29121.references = NULL;
    
    int64_t out_arrsizze_29122;
    struct memblock_device out_mem_29123;
    
    out_mem_29123.references = NULL;
    
    int ret = 0;
    
    lock_lock(&ctx->lock);
    CUDA_SUCCEED(cuCtxPushCurrent(ctx->cuda.cu_ctx));
    leftValues_mem_28231 = in0->mem;
    n_25880 = in0->shape[0];
    leftColumns_mem_28232 = in1->mem;
    n_25880 = in1->shape[0];
    leftOffsets_mem_28233 = in2->mem;
    m_25881 = in2->shape[0];
    rightValues_mem_28234 = in3->mem;
    k_25882 = in3->shape[0];
    rightColumns_mem_28235 = in4->mem;
    k_25882 = in4->shape[0];
    rightOffsets_mem_28236 = in5->mem;
    m_25881 = in5->shape[0];
    if (!(n_25880 == in0->shape[0] && (n_25880 == in1->shape[0] && (m_25881 ==
                                                                    in2->shape[0] &&
                                                                    (k_25882 ==
                                                                     in3->shape[0] &&
                                                                     (k_25882 ==
                                                                      in4->shape[0] &&
                                                                      m_25881 ==
                                                                      in5->shape[0])))))) {
        ret = 1;
        if (!ctx->error)
            ctx->error =
                msgprintf("Error: entry point arguments have invalid sizes.\n");
    } else {
        ret = futrts_eWiseMultEntry(ctx, &out_mem_29119, &out_arrsizze_29120,
                                    &out_mem_29121, &out_arrsizze_29122,
                                    &out_mem_29123, leftValues_mem_28231,
                                    leftColumns_mem_28232,
                                    leftOffsets_mem_28233,
                                    rightValues_mem_28234,
                                    rightColumns_mem_28235,
                                    rightOffsets_mem_28236, n_25880, m_25881,
                                    k_25882);
        if (ret == 0) {
            assert((*out0 =
                    (struct futhark_f64_1d *) malloc(sizeof(struct futhark_f64_1d))) !=
                NULL);
            (*out0)->mem = out_mem_29119;
            (*out0)->shape[0] = out_arrsizze_29120;
            assert((*out1 =
                    (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) !=
                NULL);
            (*out1)->mem = out_mem_29121;
            (*out1)->shape[0] = out_arrsizze_29122;
            assert((*out2 =
                    (struct futhark_i64_1d *) malloc(sizeof(struct futhark_i64_1d))) !=
                NULL);
            (*out2)->mem = out_mem_29123;
            (*out2)->shape[0] = m_25881;
        }
    }
    CUDA_SUCCEED(cuCtxPopCurrent(&ctx->cuda.cu_ctx));
    lock_unlock(&ctx->lock);
    return ret;
}
